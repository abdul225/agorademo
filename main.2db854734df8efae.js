(self.webpackChunkagora_video=self.webpackChunkagora_video||[]).push([[179],{558:(se,ee,x)=>{"use strict";function I(t){return"function"==typeof t}function C(t){const r=t(i=>{Error.call(i),i.stack=(new Error).stack});return r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,r}const w=C(t=>function(r){t(this),this.message=r?`${r.length} errors occurred during unsubscription:\n${r.map((i,o)=>`${o+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=r});function b(t,n){if(t){const r=t.indexOf(n);0<=r&&t.splice(r,1)}}class D{constructor(n){this.initialTeardown=n,this.closed=!1,this._parentage=null,this._teardowns=null}unsubscribe(){let n;if(!this.closed){this.closed=!0;const{_parentage:r}=this;if(r)if(this._parentage=null,Array.isArray(r))for(const s of r)s.remove(this);else r.remove(this);const{initialTeardown:i}=this;if(I(i))try{i()}catch(s){n=s instanceof w?s.errors:[s]}const{_teardowns:o}=this;if(o){this._teardowns=null;for(const s of o)try{f(s)}catch(a){n=null!=n?n:[],a instanceof w?n=[...n,...a.errors]:n.push(a)}}if(n)throw new w(n)}}add(n){var r;if(n&&n!==this)if(this.closed)f(n);else{if(n instanceof D){if(n.closed||n._hasParent(this))return;n._addParent(this)}(this._teardowns=null!==(r=this._teardowns)&&void 0!==r?r:[]).push(n)}}_hasParent(n){const{_parentage:r}=this;return r===n||Array.isArray(r)&&r.includes(n)}_addParent(n){const{_parentage:r}=this;this._parentage=Array.isArray(r)?(r.push(n),r):r?[r,n]:n}_removeParent(n){const{_parentage:r}=this;r===n?this._parentage=null:Array.isArray(r)&&b(r,n)}remove(n){const{_teardowns:r}=this;r&&b(r,n),n instanceof D&&n._removeParent(this)}}D.EMPTY=(()=>{const t=new D;return t.closed=!0,t})();const m=D.EMPTY;function R(t){return t instanceof D||t&&"closed"in t&&I(t.remove)&&I(t.add)&&I(t.unsubscribe)}function f(t){I(t)?t():t.unsubscribe()}const g={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},y={setTimeout(...t){const{delegate:n}=y;return((null==n?void 0:n.setTimeout)||setTimeout)(...t)},clearTimeout(t){const{delegate:n}=y;return((null==n?void 0:n.clearTimeout)||clearTimeout)(t)},delegate:void 0};function M(t){y.setTimeout(()=>{const{onUnhandledError:n}=g;if(!n)throw t;n(t)})}function j(){}const A=N("C",void 0,void 0);function N(t,n,r){return{kind:t,value:n,error:r}}let H=null;function O(t){if(g.useDeprecatedSynchronousErrorHandling){const n=!H;if(n&&(H={errorThrown:!1,error:null}),t(),n){const{errorThrown:r,error:i}=H;if(H=null,r)throw i}}else t()}class te extends D{constructor(n){super(),this.isStopped=!1,n?(this.destination=n,R(n)&&n.add(this)):this.destination=u}static create(n,r,i){return new Y(n,r,i)}next(n){this.isStopped?_(function F(t){return N("N",t,void 0)}(n),this):this._next(n)}error(n){this.isStopped?_(function E(t){return N("E",void 0,t)}(n),this):(this.isStopped=!0,this._error(n))}complete(){this.isStopped?_(A,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(n){this.destination.next(n)}_error(n){try{this.destination.error(n)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}class Y extends te{constructor(n,r,i){let o;if(super(),I(n))o=n;else if(n){let s;({next:o,error:r,complete:i}=n),this&&g.useDeprecatedNextContext?(s=Object.create(n),s.unsubscribe=()=>this.unsubscribe()):s=n,o=null==o?void 0:o.bind(s),r=null==r?void 0:r.bind(s),i=null==i?void 0:i.bind(s)}this.destination={next:o?ne(o):j,error:ne(null!=r?r:G),complete:i?ne(i):j}}}function ne(t,n){return(...r)=>{try{t(...r)}catch(i){g.useDeprecatedSynchronousErrorHandling?function J(t){g.useDeprecatedSynchronousErrorHandling&&H&&(H.errorThrown=!0,H.error=t)}(i):M(i)}}}function G(t){throw t}function _(t,n){const{onStoppedNotification:r}=g;r&&y.setTimeout(()=>r(t,n))}const u={closed:!0,next:j,error:G,complete:j},B="function"==typeof Symbol&&Symbol.observable||"@@observable";function S(t){return t}let d=(()=>{class t{constructor(r){r&&(this._subscribe=r)}lift(r){const i=new t;return i.source=this,i.operator=r,i}subscribe(r,i,o){const s=function $(t){return t&&t instanceof te||function L(t){return t&&I(t.next)&&I(t.error)&&I(t.complete)}(t)&&R(t)}(r)?r:new Y(r,i,o);return O(()=>{const{operator:a,source:l}=this;s.add(a?a.call(s,l):l?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(r){try{return this._subscribe(r)}catch(i){r.error(i)}}forEach(r,i){return new(i=T(i))((o,s)=>{let a;a=this.subscribe(l=>{try{r(l)}catch(v){s(v),null==a||a.unsubscribe()}},s,o)})}_subscribe(r){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(r)}[B](){return this}pipe(...r){return function z(t){return 0===t.length?S:1===t.length?t[0]:function(r){return t.reduce((i,o)=>o(i),r)}}(r)(this)}toPromise(r){return new(r=T(r))((i,o)=>{let s;this.subscribe(a=>s=a,a=>o(a),()=>i(s))})}}return t.create=n=>new t(n),t})();function T(t){var n;return null!==(n=null!=t?t:g.Promise)&&void 0!==n?n:Promise}const Z=C(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let ce=(()=>{class t extends d{constructor(){super(),this.closed=!1,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(r){const i=new re(this,this);return i.operator=r,i}_throwIfClosed(){if(this.closed)throw new Z}next(r){O(()=>{if(this._throwIfClosed(),!this.isStopped){const i=this.observers.slice();for(const o of i)o.next(r)}})}error(r){O(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=r;const{observers:i}=this;for(;i.length;)i.shift().error(r)}})}complete(){O(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:r}=this;for(;r.length;)r.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=null}get observed(){var r;return(null===(r=this.observers)||void 0===r?void 0:r.length)>0}_trySubscribe(r){return this._throwIfClosed(),super._trySubscribe(r)}_subscribe(r){return this._throwIfClosed(),this._checkFinalizedStatuses(r),this._innerSubscribe(r)}_innerSubscribe(r){const{hasError:i,isStopped:o,observers:s}=this;return i||o?m:(s.push(r),new D(()=>b(s,r)))}_checkFinalizedStatuses(r){const{hasError:i,thrownError:o,isStopped:s}=this;i?r.error(o):s&&r.complete()}asObservable(){const r=new d;return r.source=this,r}}return t.create=(n,r)=>new re(n,r),t})();class re extends ce{constructor(n,r){super(),this.destination=n,this.source=r}next(n){var r,i;null===(i=null===(r=this.destination)||void 0===r?void 0:r.next)||void 0===i||i.call(r,n)}error(n){var r,i;null===(i=null===(r=this.destination)||void 0===r?void 0:r.error)||void 0===i||i.call(r,n)}complete(){var n,r;null===(r=null===(n=this.destination)||void 0===n?void 0:n.complete)||void 0===r||r.call(n)}_subscribe(n){var r,i;return null!==(i=null===(r=this.source)||void 0===r?void 0:r.subscribe(n))&&void 0!==i?i:m}}function U(t){return I(null==t?void 0:t.lift)}function V(t){return n=>{if(U(n))return n.lift(function(r){try{return t(r,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}class q extends te{constructor(n,r,i,o,s){super(n),this.onFinalize=s,this._next=r?function(a){try{r(a)}catch(l){n.error(l)}}:super._next,this._error=o?function(a){try{o(a)}catch(l){n.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){n.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var n;const{closed:r}=this;super.unsubscribe(),!r&&(null===(n=this.onFinalize)||void 0===n||n.call(this))}}function pe(t,n){return V((r,i)=>{let o=0;r.subscribe(new q(i,s=>{i.next(t.call(n,s,o++))}))})}function ie(t){return this instanceof ie?(this.v=t,this):new ie(t)}function h(t,n,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,i=r.apply(t,n||[]),s=[];return o={},a("next"),a("throw"),a("return"),o[Symbol.asyncIterator]=function(){return this},o;function a(ue){i[ue]&&(o[ue]=function(he){return new Promise(function(Se,we){s.push([ue,he,Se,we])>1||l(ue,he)})})}function l(ue,he){try{!function v(ue){ue.value instanceof ie?Promise.resolve(ue.value.v).then(P,W):X(s[0][2],ue)}(i[ue](he))}catch(Se){X(s[0][3],Se)}}function P(ue){l("next",ue)}function W(ue){l("throw",ue)}function X(ue,he){ue(he),s.shift(),s.length&&l(s[0][0],s[0][1])}}function ae(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,n=t[Symbol.asyncIterator];return n?n.call(t):(t=function Ae(t){var n="function"==typeof Symbol&&Symbol.iterator,r=n&&t[n],i=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}(t),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(s){r[s]=t[s]&&function(a){return new Promise(function(l,v){!function o(s,a,l,v){Promise.resolve(v).then(function(P){s({value:P,done:l})},a)}(l,v,(a=t[s](a)).done,a.value)})}}}const _e=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function Pe(t){return I(null==t?void 0:t.then)}function ke(t){return I(t[B])}function xe(t){return Symbol.asyncIterator&&I(null==t?void 0:t[Symbol.asyncIterator])}function ze(t){return new TypeError(`You provided ${null!==t&&"object"==typeof t?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const ct=function Be(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function Je(t){return I(null==t?void 0:t[ct])}function bt(t){return h(this,arguments,function*(){const r=t.getReader();try{for(;;){const{value:i,done:o}=yield ie(r.read());if(o)return yield ie(void 0);yield yield ie(i)}}finally{r.releaseLock()}})}function At(t){return I(null==t?void 0:t.getReader)}function Nt(t){if(t instanceof d)return t;if(null!=t){if(ke(t))return function _r(t){return new d(n=>{const r=t[B]();if(I(r.subscribe))return r.subscribe(n);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(t);if(_e(t))return function Ei(t){return new d(n=>{for(let r=0;r<t.length&&!n.closed;r++)n.next(t[r]);n.complete()})}(t);if(Pe(t))return function Si(t){return new d(n=>{t.then(r=>{n.closed||(n.next(r),n.complete())},r=>n.error(r)).then(null,M)})}(t);if(xe(t))return Bf(t);if(Je(t))return function Pc(t){return new d(n=>{for(const r of t)if(n.next(r),n.closed)return;n.complete()})}(t);if(At(t))return function BE(t){return Bf(bt(t))}(t)}throw ze(t)}function Bf(t){return new d(n=>{(function HE(t,n){var r,i,o,s;return function Le(t,n,r,i){return new(r||(r=Promise))(function(s,a){function l(W){try{P(i.next(W))}catch(X){a(X)}}function v(W){try{P(i.throw(W))}catch(X){a(X)}}function P(W){W.done?s(W.value):function o(s){return s instanceof r?s:new r(function(a){a(s)})}(W.value).then(l,v)}P((i=i.apply(t,n||[])).next())})}(this,void 0,void 0,function*(){try{for(r=ae(t);!(i=yield r.next()).done;)if(n.next(i.value),n.closed)return}catch(a){o={error:a}}finally{try{i&&!i.done&&(s=r.return)&&(yield s.call(r))}finally{if(o)throw o.error}}n.complete()})})(t,n).catch(r=>n.error(r))})}function Er(t,n,r,i=0,o=!1){const s=n.schedule(function(){r(),o?t.add(this.schedule(null,i)):this.unsubscribe()},i);if(t.add(s),!o)return s}function Yt(t,n,r=1/0){return I(n)?Yt((i,o)=>pe((s,a)=>n(i,s,o,a))(Nt(t(i,o))),r):("number"==typeof n&&(r=n),V((i,o)=>function GE(t,n,r,i,o,s,a,l){const v=[];let P=0,W=0,X=!1;const ue=()=>{X&&!v.length&&!P&&n.complete()},he=we=>P<i?Se(we):v.push(we),Se=we=>{s&&n.next(we),P++;let De=!1;Nt(r(we,W++)).subscribe(new q(n,Oe=>{null==o||o(Oe),s?he(Oe):n.next(Oe)},()=>{De=!0},void 0,()=>{if(De)try{for(P--;v.length&&P<i;){const Oe=v.shift();a?Er(n,a,()=>Se(Oe)):Se(Oe)}ue()}catch(Oe){n.error(Oe)}}))};return t.subscribe(new q(n,he,()=>{X=!0,ue()})),()=>{null==l||l()}}(i,o,t,r)))}function Ro(t=1/0){return Yt(S,t)}const Sr=new d(t=>t.complete());function Lc(t){return t[t.length-1]}function Hf(t){return I(Lc(t))?t.pop():void 0}function Ao(t){return function qE(t){return t&&I(t.schedule)}(Lc(t))?t.pop():void 0}function Gf(t,n=0){return V((r,i)=>{r.subscribe(new q(i,o=>Er(i,t,()=>i.next(o),n),()=>Er(i,t,()=>i.complete(),n),o=>Er(i,t,()=>i.error(o),n)))})}function Wf(t,n=0){return V((r,i)=>{i.add(t.schedule(()=>r.subscribe(i),n))})}function qf(t,n){if(!t)throw new Error("Iterable cannot be null");return new d(r=>{Er(r,n,()=>{const i=t[Symbol.asyncIterator]();Er(r,n,()=>{i.next().then(o=>{o.done?r.complete():r.next(o.value)})},0,!0)})})}function Kt(t,n){return n?function QE(t,n){if(null!=t){if(ke(t))return function JE(t,n){return Nt(t).pipe(Wf(n),Gf(n))}(t,n);if(_e(t))return function KE(t,n){return new d(r=>{let i=0;return n.schedule(function(){i===t.length?r.complete():(r.next(t[i++]),r.closed||this.schedule())})})}(t,n);if(Pe(t))return function YE(t,n){return Nt(t).pipe(Wf(n),Gf(n))}(t,n);if(xe(t))return qf(t,n);if(Je(t))return function $E(t,n){return new d(r=>{let i;return Er(r,n,()=>{i=t[ct](),Er(r,n,()=>{let o,s;try{({value:o,done:s}=i.next())}catch(a){return void r.error(a)}s?r.complete():r.next(o)},0,!0)}),()=>I(null==i?void 0:i.return)&&i.return()})}(t,n);if(At(t))return function XE(t,n){return qf(bt(t),n)}(t,n)}throw ze(t)}(t,n):Nt(t)}function Us(t){return t<=0?()=>Sr:V((n,r)=>{let i=0;n.subscribe(new q(r,o=>{++i<=t&&(r.next(o),t<=i&&r.complete())}))})}function kc(t,n,...r){return!0===n?(t(),null):!1===n?null:n(...r).pipe(Us(1)).subscribe(()=>t())}function _t(t){for(let n in t)if(t[n]===_t)return n;throw Error("Could not find renamed property on target object.")}function xc(t,n){for(const r in n)n.hasOwnProperty(r)&&!t.hasOwnProperty(r)&&(t[r]=n[r])}function mt(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(mt).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const n=t.toString();if(null==n)return""+n;const r=n.indexOf("\n");return-1===r?n:n.substring(0,r)}function Fc(t,n){return null==t||""===t?null===n?"":n:null==n||""===n?t:t+" "+n}const t0=_t({__forward_ref__:_t});function Ct(t){return t.__forward_ref__=Ct,t.toString=function(){return mt(this())},t}function it(t){return zf(t)?t():t}function zf(t){return"function"==typeof t&&t.hasOwnProperty(t0)&&t.__forward_ref__===Ct}class ht extends Error{constructor(n,r){super(function Vc(t,n){return`NG0${Math.abs(t)}${n?": "+n:""}`}(n,r)),this.code=n}}function on(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():function Ze(t){return"string"==typeof t?t:null==t?"":String(t)}(t)}function Bs(t,n){const r=n?` in ${n}`:"";throw new ht(-201,`No provider for ${on(t)} found${r}`)}function _n(t,n){null==t&&function It(t,n,r,i){throw new Error(`ASSERTION ERROR: ${t}`+(null==i?"":` [Expected=> ${r} ${i} ${n} <=Actual]`))}(n,t,null,"!=")}function nt(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function pn(t){return{providers:t.providers||[],imports:t.imports||[]}}function jc(t){return Jf(t,Hs)||Jf(t,Kf)}function Jf(t,n){return t.hasOwnProperty(n)?t[n]:null}function Yf(t){return t&&(t.hasOwnProperty(Uc)||t.hasOwnProperty(u0))?t[Uc]:null}const Hs=_t({\u0275prov:_t}),Uc=_t({\u0275inj:_t}),Kf=_t({ngInjectableDef:_t}),u0=_t({ngInjectorDef:_t});var tt=(()=>((tt=tt||{})[tt.Default=0]="Default",tt[tt.Host=1]="Host",tt[tt.Self=2]="Self",tt[tt.SkipSelf=4]="SkipSelf",tt[tt.Optional=8]="Optional",tt))();let Bc;function Fr(t){const n=Bc;return Bc=t,n}function $f(t,n,r){const i=jc(t);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:r&tt.Optional?null:void 0!==n?n:void Bs(mt(t),"Injector")}function Vr(t){return{toString:t}.toString()}var Hn=(()=>((Hn=Hn||{})[Hn.OnPush=0]="OnPush",Hn[Hn.Default=1]="Default",Hn))(),nr=(()=>{return(t=nr||(nr={}))[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",nr;var t})();const d0="undefined"!=typeof globalThis&&globalThis,f0="undefined"!=typeof window&&window,p0="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,vt=d0||"undefined"!=typeof global&&global||f0||p0,bi={},Et=[],Gs=_t({\u0275cmp:_t}),Hc=_t({\u0275dir:_t}),Gc=_t({\u0275pipe:_t}),Xf=_t({\u0275mod:_t}),Cr=_t({\u0275fac:_t}),Io=_t({__NG_ELEMENT_ID__:_t});let h0=0;function wo(t){return Vr(()=>{const r={},i={type:t.type,providersResolver:null,decls:t.decls,vars:t.vars,factory:null,template:t.template||null,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:r,inputs:null,outputs:null,exportAs:t.exportAs||null,onPush:t.changeDetection===Hn.OnPush,directiveDefs:null,pipeDefs:null,selectors:t.selectors||Et,viewQuery:t.viewQuery||null,features:t.features||null,data:t.data||{},encapsulation:t.encapsulation||nr.Emulated,id:"c",styles:t.styles||Et,_:null,setInput:null,schemas:t.schemas||null,tView:null},o=t.directives,s=t.features,a=t.pipes;return i.id+=h0++,i.inputs=tp(t.inputs,r),i.outputs=tp(t.outputs),s&&s.forEach(l=>l(i)),i.directiveDefs=o?()=>("function"==typeof o?o():o).map(Qf):null,i.pipeDefs=a?()=>("function"==typeof a?a():a).map(Zf):null,i})}function Qf(t){return Zt(t)||function jr(t){return t[Hc]||null}(t)}function Zf(t){return function Zr(t){return t[Gc]||null}(t)}const ep={};function En(t){return Vr(()=>{const n={type:t.type,bootstrap:t.bootstrap||Et,declarations:t.declarations||Et,imports:t.imports||Et,exports:t.exports||Et,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null};return null!=t.id&&(ep[t.id]=t.type),n})}function tp(t,n){if(null==t)return bi;const r={};for(const i in t)if(t.hasOwnProperty(i)){let o=t[i],s=o;Array.isArray(o)&&(s=o[1],o=o[0]),r[o]=i,n&&(n[o]=s)}return r}const Xe=wo;function Zt(t){return t[Gs]||null}function Pn(t,n){const r=t[Xf]||null;if(!r&&!0===n)throw new Error(`Type ${mt(t)} does not have '\u0275mod' property.`);return r}function rr(t){return Array.isArray(t)&&"object"==typeof t[1]}function Wn(t){return Array.isArray(t)&&!0===t[1]}function zc(t){return 0!=(8&t.flags)}function Js(t){return 2==(2&t.flags)}function Ys(t){return 1==(1&t.flags)}function qn(t){return null!==t.template}function E0(t){return 0!=(512&t[2])}function ri(t,n){return t.hasOwnProperty(Cr)?t[Cr]:null}class C0{constructor(n,r,i){this.previousValue=n,this.currentValue=r,this.firstChange=i}isFirstChange(){return this.firstChange}}function bn(){return rp}function rp(t){return t.type.prototype.ngOnChanges&&(t.setInput=R0),T0}function T0(){const t=op(this),n=null==t?void 0:t.current;if(n){const r=t.previous;if(r===bi)t.previous=n;else for(let i in n)r[i]=n[i];t.current=null,this.ngOnChanges(n)}}function R0(t,n,r,i){const o=op(t)||function A0(t,n){return t[ip]=n}(t,{previous:bi,current:null}),s=o.current||(o.current={}),a=o.previous,l=this.declaredInputs[r],v=a[l];s[l]=new C0(v&&v.currentValue,n,a===bi),t[i]=n}bn.ngInherit=!0;const ip="__ngSimpleChanges__";function op(t){return t[ip]||null}let Kc;function Mt(t){return!!t.listen}const cp={createRenderer:(t,n)=>function $c(){return void 0!==Kc?Kc:"undefined"!=typeof document?document:void 0}()};function Vt(t){for(;Array.isArray(t);)t=t[0];return t}function xn(t,n){return Vt(n[t.index])}function Xc(t,n){return t.data[n]}function Cn(t,n){const r=n[t];return rr(r)?r:r[0]}function Qc(t){return 128==(128&t[2])}function Ur(t,n){return null==n?null:t[n]}function lp(t){t[18]=0}function Zc(t,n){t[5]+=n;let r=t,i=t[3];for(;null!==i&&(1===n&&1===r[5]||-1===n&&0===r[5]);)i[5]+=n,r=i,i=i[3]}const Qe={lFrame:yp(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function dp(){return Qe.bindingsEnabled}function Ne(){return Qe.lFrame.lView}function gt(){return Qe.lFrame.tView}function Gt(){let t=fp();for(;null!==t&&64===t.type;)t=t.parent;return t}function fp(){return Qe.lFrame.currentTNode}function ir(t,n){const r=Qe.lFrame;r.currentTNode=t,r.isParent=n}function eu(){return Qe.lFrame.isParent}function $s(){return Qe.isInCheckNoChangesMode}function Xs(t){Qe.isInCheckNoChangesMode=t}function B0(t,n){const r=Qe.lFrame;r.bindingIndex=r.bindingRootIndex=t,nu(n)}function nu(t){Qe.lFrame.currentDirectiveIndex=t}function iu(t){Qe.lFrame.currentQueryIndex=t}function G0(t){const n=t[1];return 2===n.type?n.declTNode:1===n.type?t[6]:null}function mp(t,n,r){if(r&tt.SkipSelf){let o=n,s=t;for(;!(o=o.parent,null!==o||r&tt.Host||(o=G0(s),null===o||(s=s[15],10&o.type))););if(null===o)return!1;n=o,t=s}const i=Qe.lFrame=vp();return i.currentTNode=n,i.lView=t,!0}function Qs(t){const n=vp(),r=t[1];Qe.lFrame=n,n.currentTNode=r.firstChild,n.lView=t,n.tView=r,n.contextLView=t,n.bindingIndex=r.bindingStartIndex,n.inI18n=!1}function vp(){const t=Qe.lFrame,n=null===t?null:t.child;return null===n?yp(t):n}function yp(t){const n={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=n),n}function _p(){const t=Qe.lFrame;return Qe.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const Ep=_p;function Zs(){const t=_p();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function an(){return Qe.lFrame.selectedIndex}function Br(t){Qe.lFrame.selectedIndex=t}function ea(t,n){for(let r=n.directiveStart,i=n.directiveEnd;r<i;r++){const s=t.data[r].type.prototype,{ngAfterContentInit:a,ngAfterContentChecked:l,ngAfterViewInit:v,ngAfterViewChecked:P,ngOnDestroy:W}=s;a&&(t.contentHooks||(t.contentHooks=[])).push(-r,a),l&&((t.contentHooks||(t.contentHooks=[])).push(r,l),(t.contentCheckHooks||(t.contentCheckHooks=[])).push(r,l)),v&&(t.viewHooks||(t.viewHooks=[])).push(-r,v),P&&((t.viewHooks||(t.viewHooks=[])).push(r,P),(t.viewCheckHooks||(t.viewCheckHooks=[])).push(r,P)),null!=W&&(t.destroyHooks||(t.destroyHooks=[])).push(r,W)}}function ta(t,n,r){Sp(t,n,3,r)}function na(t,n,r,i){(3&t[2])===r&&Sp(t,n,r,i)}function ou(t,n){let r=t[2];(3&r)===n&&(r&=2047,r+=1,t[2]=r)}function Sp(t,n,r,i){const s=null!=i?i:-1,a=n.length-1;let l=0;for(let v=void 0!==i?65535&t[18]:0;v<a;v++)if("number"==typeof n[v+1]){if(l=n[v],null!=i&&l>=i)break}else n[v]<0&&(t[18]+=65536),(l<s||-1==s)&&(Q0(t,r,n,v),t[18]=(4294901760&t[18])+v+2),v++}function Q0(t,n,r,i){const o=r[i]<0,s=r[i+1],l=t[o?-r[i]:r[i]];if(o){if(t[2]>>11<t[18]>>16&&(3&t[2])===n){t[2]+=2048;try{s.call(l)}finally{}}}else try{s.call(l)}finally{}}class Po{constructor(n,r,i){this.factory=n,this.resolving=!1,this.canSeeViewProviders=r,this.injectImpl=i}}function ra(t,n,r){const i=Mt(t);let o=0;for(;o<r.length;){const s=r[o];if("number"==typeof s){if(0!==s)break;o++;const a=r[o++],l=r[o++],v=r[o++];i?t.setAttribute(n,l,v,a):n.setAttributeNS(a,l,v)}else{const a=s,l=r[++o];au(a)?i&&t.setProperty(n,a,l):i?t.setAttribute(n,a,l):n.setAttribute(a,l),o++}}return o}function bp(t){return 3===t||4===t||6===t}function au(t){return 64===t.charCodeAt(0)}function ia(t,n){if(null!==n&&0!==n.length)if(null===t||0===t.length)t=n.slice();else{let r=-1;for(let i=0;i<n.length;i++){const o=n[i];"number"==typeof o?r=o:0===r||Cp(t,r,o,null,-1===r||2===r?n[++i]:null)}}return t}function Cp(t,n,r,i,o){let s=0,a=t.length;if(-1===n)a=-1;else for(;s<t.length;){const l=t[s++];if("number"==typeof l){if(l===n){a=-1;break}if(l>n){a=s-1;break}}}for(;s<t.length;){const l=t[s];if("number"==typeof l)break;if(l===r){if(null===i)return void(null!==o&&(t[s+1]=o));if(i===t[s+1])return void(t[s+2]=o)}s++,null!==i&&s++,null!==o&&s++}-1!==a&&(t.splice(a,0,n),s=a+1),t.splice(s++,0,r),null!==i&&t.splice(s++,0,i),null!==o&&t.splice(s++,0,o)}function Tp(t){return-1!==t}function Di(t){return 32767&t}function Oi(t,n){let r=function rS(t){return t>>16}(t),i=n;for(;r>0;)i=i[15],r--;return i}let cu=!0;function oa(t){const n=cu;return cu=t,n}let iS=0;function ko(t,n){const r=lu(t,n);if(-1!==r)return r;const i=n[1];i.firstCreatePass&&(t.injectorIndex=n.length,uu(i.data,t),uu(n,null),uu(i.blueprint,null));const o=sa(t,n),s=t.injectorIndex;if(Tp(o)){const a=Di(o),l=Oi(o,n),v=l[1].data;for(let P=0;P<8;P++)n[s+P]=l[a+P]|v[a+P]}return n[s+8]=o,s}function uu(t,n){t.push(0,0,0,0,0,0,0,0,n)}function lu(t,n){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===n[t.injectorIndex+8]?-1:t.injectorIndex}function sa(t,n){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let r=0,i=null,o=n;for(;null!==o;){const s=o[1],a=s.type;if(i=2===a?s.declTNode:1===a?o[6]:null,null===i)return-1;if(r++,o=o[15],-1!==i.injectorIndex)return i.injectorIndex|r<<16}return-1}function aa(t,n,r){!function oS(t,n,r){let i;"string"==typeof r?i=r.charCodeAt(0)||0:r.hasOwnProperty(Io)&&(i=r[Io]),null==i&&(i=r[Io]=iS++);const o=255&i;n.data[t+(o>>5)]|=1<<o}(t,n,r)}function Ip(t,n,r){if(r&tt.Optional)return t;Bs(n,"NodeInjector")}function wp(t,n,r,i){if(r&tt.Optional&&void 0===i&&(i=null),0==(r&(tt.Self|tt.Host))){const o=t[9],s=Fr(void 0);try{return o?o.get(n,i,r&tt.Optional):$f(n,i,r&tt.Optional)}finally{Fr(s)}}return Ip(i,n,r)}function Dp(t,n,r,i=tt.Default,o){if(null!==t){const s=function uS(t){if("string"==typeof t)return t.charCodeAt(0)||0;const n=t.hasOwnProperty(Io)?t[Io]:void 0;return"number"==typeof n?n>=0?255&n:aS:n}(r);if("function"==typeof s){if(!mp(n,t,i))return i&tt.Host?Ip(o,r,i):wp(n,r,i,o);try{const a=s(i);if(null!=a||i&tt.Optional)return a;Bs(r)}finally{Ep()}}else if("number"==typeof s){let a=null,l=lu(t,n),v=-1,P=i&tt.Host?n[16][6]:null;for((-1===l||i&tt.SkipSelf)&&(v=-1===l?sa(t,n):n[l+8],-1!==v&&Mp(i,!1)?(a=n[1],l=Di(v),n=Oi(v,n)):l=-1);-1!==l;){const W=n[1];if(Np(s,l,W.data)){const X=cS(l,n,r,a,i,P);if(X!==Op)return X}v=n[l+8],-1!==v&&Mp(i,n[1].data[l+8]===P)&&Np(s,l,n)?(a=W,l=Di(v),n=Oi(v,n)):l=-1}}}return wp(n,r,i,o)}const Op={};function aS(){return new Ni(Gt(),Ne())}function cS(t,n,r,i,o,s){const a=n[1],l=a.data[t+8],W=function ca(t,n,r,i,o){const s=t.providerIndexes,a=n.data,l=1048575&s,v=t.directiveStart,W=s>>20,ue=o?l+W:t.directiveEnd;for(let he=i?l:l+W;he<ue;he++){const Se=a[he];if(he<v&&r===Se||he>=v&&Se.type===r)return he}if(o){const he=a[v];if(he&&qn(he)&&he.type===r)return v}return null}(l,a,r,null==i?Js(l)&&cu:i!=a&&0!=(3&l.type),o&tt.Host&&s===l);return null!==W?xo(n,a,W,l):Op}function xo(t,n,r,i){let o=t[r];const s=n.data;if(function Z0(t){return t instanceof Po}(o)){const a=o;a.resolving&&function n0(t,n){const r=n?`. Dependency path: ${n.join(" > ")} > ${t}`:"";throw new ht(-200,`Circular dependency in DI detected for ${t}${r}`)}(on(s[r]));const l=oa(a.canSeeViewProviders);a.resolving=!0;const v=a.injectImpl?Fr(a.injectImpl):null;mp(t,i,tt.Default);try{o=t[r]=a.factory(void 0,s,t,i),n.firstCreatePass&&r>=i.directiveStart&&function X0(t,n,r){const{ngOnChanges:i,ngOnInit:o,ngDoCheck:s}=n.type.prototype;if(i){const a=rp(n);(r.preOrderHooks||(r.preOrderHooks=[])).push(t,a),(r.preOrderCheckHooks||(r.preOrderCheckHooks=[])).push(t,a)}o&&(r.preOrderHooks||(r.preOrderHooks=[])).push(0-t,o),s&&((r.preOrderHooks||(r.preOrderHooks=[])).push(t,s),(r.preOrderCheckHooks||(r.preOrderCheckHooks=[])).push(t,s))}(r,s[r],n)}finally{null!==v&&Fr(v),oa(l),a.resolving=!1,Ep()}}return o}function Np(t,n,r){return!!(r[n+(t>>5)]&1<<t)}function Mp(t,n){return!(t&tt.Self||t&tt.Host&&n)}class Ni{constructor(n,r){this._tNode=n,this._lView=r}get(n,r,i){return Dp(this._tNode,this._lView,n,i,r)}}function mn(t){return Vr(()=>{const n=t.prototype.constructor,r=n[Cr]||du(n),i=Object.prototype;let o=Object.getPrototypeOf(t.prototype).constructor;for(;o&&o!==i;){const s=o[Cr]||du(o);if(s&&s!==r)return s;o=Object.getPrototypeOf(o)}return s=>new s})}function du(t){return zf(t)?()=>{const n=du(it(t));return n&&n()}:ri(t)}const Pi="__parameters__";function ki(t,n,r){return Vr(()=>{const i=function fu(t){return function(...r){if(t){const i=t(...r);for(const o in i)this[o]=i[o]}}}(n);function o(...s){if(this instanceof o)return i.apply(this,s),this;const a=new o(...s);return l.annotation=a,l;function l(v,P,W){const X=v.hasOwnProperty(Pi)?v[Pi]:Object.defineProperty(v,Pi,{value:[]})[Pi];for(;X.length<=W;)X.push(null);return(X[W]=X[W]||[]).push(a),v}}return r&&(o.prototype=Object.create(r.prototype)),o.prototype.ngMetadataName=t,o.annotationCls=o,o})}class st{constructor(n,r){this._desc=n,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof r?this.__NG_ELEMENT_ID__=r:void 0!==r&&(this.\u0275prov=nt({token:this,providedIn:r.providedIn||"root",factory:r.factory}))}toString(){return`InjectionToken ${this._desc}`}}const dS=new st("AnalyzeForEntryComponents");function or(t,n){t.forEach(r=>Array.isArray(r)?or(r,n):n(r))}function Lp(t,n,r){n>=t.length?t.push(r):t.splice(n,0,r)}function ua(t,n){return n>=t.length-1?t.pop():t.splice(n,1)[0]}function Tn(t,n,r){let i=xi(t,n);return i>=0?t[1|i]=r:(i=~i,function hS(t,n,r,i){let o=t.length;if(o==n)t.push(r,i);else if(1===o)t.push(i,t[0]),t[0]=r;else{for(o--,t.push(t[o-1],t[o]);o>n;)t[o]=t[o-2],o--;t[n]=r,t[n+1]=i}}(t,i,n,r)),i}function hu(t,n){const r=xi(t,n);if(r>=0)return t[1|r]}function xi(t,n){return function Fp(t,n,r){let i=0,o=t.length>>r;for(;o!==i;){const s=i+(o-i>>1),a=t[s<<r];if(n===a)return s<<r;a>n?o=s:i=s+1}return~(o<<r)}(t,n,1)}const Bo={},mu="__NG_DI_FLAG__",da="ngTempTokenPath",SS=/\n/gm,jp="__source",CS=_t({provide:String,useValue:_t});let Ho;function Up(t){const n=Ho;return Ho=t,n}function TS(t,n=tt.Default){if(void 0===Ho)throw new ht(203,"");return null===Ho?$f(t,void 0,n):Ho.get(t,n&tt.Optional?null:void 0,n)}function qe(t,n=tt.Default){return(function l0(){return Bc}()||TS)(it(t),n)}function vu(t){const n=[];for(let r=0;r<t.length;r++){const i=it(t[r]);if(Array.isArray(i)){if(0===i.length)throw new ht(900,"");let o,s=tt.Default;for(let a=0;a<i.length;a++){const l=i[a],v=RS(l);"number"==typeof v?-1===v?o=l.token:s|=v:o=l}n.push(qe(o,s))}else n.push(qe(i))}return n}function Go(t,n){return t[mu]=n,t.prototype[mu]=n,t}function RS(t){return t[mu]}const Wo=Go(ki("Inject",t=>({token:t})),-1),sr=Go(ki("Optional"),8),Fi=Go(ki("SkipSelf"),4);const oh="__ngContext__";function tn(t,n){t[oh]=n}function Iu(t){const n=function Ko(t){return t[oh]||null}(t);return n?Array.isArray(n)?n:n.lView:null}function Du(t){return t.ngOriginalError}function v2(t,...n){t.error(...n)}class Ui{constructor(){this._console=console}handleError(n){const r=this._findOriginalError(n),i=function m2(t){return t&&t.ngErrorLogger||v2}(n);i(this._console,"ERROR",n),r&&i(this._console,"ORIGINAL ERROR",r)}_findOriginalError(n){let r=n&&Du(n);for(;r&&Du(r);)r=Du(r);return r||null}}const lh=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(vt))();function cr(t){return t instanceof Function?t():t}var Rn=(()=>((Rn=Rn||{})[Rn.Important=1]="Important",Rn[Rn.DashCase=2]="DashCase",Rn))();function Nu(t,n){return undefined(t,n)}function $o(t){const n=t[3];return Wn(n)?n[3]:n}function Mu(t){return gh(t[13])}function Pu(t){return gh(t[4])}function gh(t){for(;null!==t&&!Wn(t);)t=t[4];return t}function Hi(t,n,r,i,o){if(null!=i){let s,a=!1;Wn(i)?s=i:rr(i)&&(a=!0,i=i[0]);const l=Vt(i);0===t&&null!==r?null==o?Sh(n,r,l):ii(n,r,l,o||null,!0):1===t&&null!==r?ii(n,r,l,o||null,!0):2===t?function wh(t,n,r){const i=va(t,n);i&&function U2(t,n,r,i){Mt(t)?t.removeChild(n,r,i):n.removeChild(r)}(t,i,n,r)}(n,l,a):3===t&&n.destroyNode(l),null!=s&&function G2(t,n,r,i,o){const s=r[7];s!==Vt(r)&&Hi(n,t,i,s,o);for(let l=10;l<r.length;l++){const v=r[l];Xo(v[1],v,t,n,i,s)}}(n,t,s,r,o)}}function ku(t,n,r){return Mt(t)?t.createElement(n,r):null===r?t.createElement(n):t.createElementNS(r,n)}function vh(t,n){const r=t[9],i=r.indexOf(n),o=n[3];1024&n[2]&&(n[2]&=-1025,Zc(o,-1)),r.splice(i,1)}function xu(t,n){if(t.length<=10)return;const r=10+n,i=t[r];if(i){const o=i[17];null!==o&&o!==t&&vh(o,i),n>0&&(t[r-1][4]=i[4]);const s=ua(t,10+n);!function M2(t,n){Xo(t,n,n[11],2,null,null),n[0]=null,n[6]=null}(i[1],i);const a=s[19];null!==a&&a.detachView(s[1]),i[3]=null,i[4]=null,i[2]&=-129}return i}function yh(t,n){if(!(256&n[2])){const r=n[11];Mt(r)&&r.destroyNode&&Xo(t,n,r,3,null,null),function k2(t){let n=t[13];if(!n)return Fu(t[1],t);for(;n;){let r=null;if(rr(n))r=n[13];else{const i=n[10];i&&(r=i)}if(!r){for(;n&&!n[4]&&n!==t;)rr(n)&&Fu(n[1],n),n=n[3];null===n&&(n=t),rr(n)&&Fu(n[1],n),r=n&&n[4]}n=r}}(n)}}function Fu(t,n){if(!(256&n[2])){n[2]&=-129,n[2]|=256,function j2(t,n){let r;if(null!=t&&null!=(r=t.destroyHooks))for(let i=0;i<r.length;i+=2){const o=n[r[i]];if(!(o instanceof Po)){const s=r[i+1];if(Array.isArray(s))for(let a=0;a<s.length;a+=2){const l=o[s[a]],v=s[a+1];try{v.call(l)}finally{}}else try{s.call(o)}finally{}}}}(t,n),function V2(t,n){const r=t.cleanup,i=n[7];let o=-1;if(null!==r)for(let s=0;s<r.length-1;s+=2)if("string"==typeof r[s]){const a=r[s+1],l="function"==typeof a?a(n):Vt(n[a]),v=i[o=r[s+2]],P=r[s+3];"boolean"==typeof P?l.removeEventListener(r[s],v,P):P>=0?i[o=P]():i[o=-P].unsubscribe(),s+=2}else{const a=i[o=r[s+1]];r[s].call(a)}if(null!==i){for(let s=o+1;s<i.length;s++)i[s]();n[7]=null}}(t,n),1===n[1].type&&Mt(n[11])&&n[11].destroy();const r=n[17];if(null!==r&&Wn(n[3])){r!==n[3]&&vh(r,n);const i=n[19];null!==i&&i.detachView(t)}}}function _h(t,n,r){return function Eh(t,n,r){let i=n;for(;null!==i&&40&i.type;)i=(n=i).parent;if(null===i)return r[0];if(2&i.flags){const o=t.data[i.directiveStart].encapsulation;if(o===nr.None||o===nr.Emulated)return null}return xn(i,r)}(t,n.parent,r)}function ii(t,n,r,i,o){Mt(t)?t.insertBefore(n,r,i,o):n.insertBefore(r,i,o)}function Sh(t,n,r){Mt(t)?t.appendChild(n,r):n.appendChild(r)}function bh(t,n,r,i,o){null!==i?ii(t,n,r,i,o):Sh(t,n,r)}function va(t,n){return Mt(t)?t.parentNode(n):n.parentNode}let Rh=function Th(t,n,r){return 40&t.type?xn(t,r):null};function ya(t,n,r,i){const o=_h(t,i,n),s=n[11],l=function Ch(t,n,r){return Rh(t,n,r)}(i.parent||n[6],i,n);if(null!=o)if(Array.isArray(r))for(let v=0;v<r.length;v++)bh(s,o,r[v],l,!1);else bh(s,o,r,l,!1)}function _a(t,n){if(null!==n){const r=n.type;if(3&r)return xn(n,t);if(4&r)return ju(-1,t[n.index]);if(8&r){const i=n.child;if(null!==i)return _a(t,i);{const o=t[n.index];return Wn(o)?ju(-1,o):Vt(o)}}if(32&r)return Nu(n,t)()||Vt(t[n.index]);{const i=Ih(t,n);return null!==i?Array.isArray(i)?i[0]:_a($o(t[16]),i):_a(t,n.next)}}return null}function Ih(t,n){return null!==n?t[16][6].projection[n.projection]:null}function ju(t,n){const r=10+t+1;if(r<n.length){const i=n[r],o=i[1].firstChild;if(null!==o)return _a(i,o)}return n[7]}function Uu(t,n,r,i,o,s,a){for(;null!=r;){const l=i[r.index],v=r.type;if(a&&0===n&&(l&&tn(Vt(l),i),r.flags|=4),64!=(64&r.flags))if(8&v)Uu(t,n,r.child,i,o,s,!1),Hi(n,t,o,l,s);else if(32&v){const P=Nu(r,i);let W;for(;W=P();)Hi(n,t,o,W,s);Hi(n,t,o,l,s)}else 16&v?Dh(t,n,i,r,o,s):Hi(n,t,o,l,s);r=a?r.projectionNext:r.next}}function Xo(t,n,r,i,o,s){Uu(r,i,t.firstChild,n,o,s,!1)}function Dh(t,n,r,i,o,s){const a=r[16],v=a[6].projection[i.projection];if(Array.isArray(v))for(let P=0;P<v.length;P++)Hi(n,t,o,v[P],s);else Uu(t,n,v,a[3],o,s,!0)}function Oh(t,n,r){Mt(t)?t.setAttribute(n,"style",r):n.style.cssText=r}function Bu(t,n,r){Mt(t)?""===r?t.removeAttribute(n,"class"):t.setAttribute(n,"class",r):n.className=r}function Nh(t,n,r){let i=t.length;for(;;){const o=t.indexOf(n,r);if(-1===o)return o;if(0===o||t.charCodeAt(o-1)<=32){const s=n.length;if(o+s===i||t.charCodeAt(o+s)<=32)return o}r=o+1}}const Mh="ng-template";function q2(t,n,r){let i=0;for(;i<t.length;){let o=t[i++];if(r&&"class"===o){if(o=t[i],-1!==Nh(o.toLowerCase(),n,0))return!0}else if(1===o){for(;i<t.length&&"string"==typeof(o=t[i++]);)if(o.toLowerCase()===n)return!0;return!1}}return!1}function Ph(t){return 4===t.type&&t.value!==Mh}function z2(t,n,r){return n===(4!==t.type||r?t.value:Mh)}function J2(t,n,r){let i=4;const o=t.attrs||[],s=function $2(t){for(let n=0;n<t.length;n++)if(bp(t[n]))return n;return t.length}(o);let a=!1;for(let l=0;l<n.length;l++){const v=n[l];if("number"!=typeof v){if(!a)if(4&i){if(i=2|1&i,""!==v&&!z2(t,v,r)||""===v&&1===n.length){if(zn(i))return!1;a=!0}}else{const P=8&i?v:n[++l];if(8&i&&null!==t.attrs){if(!q2(t.attrs,P,r)){if(zn(i))return!1;a=!0}continue}const X=Y2(8&i?"class":v,o,Ph(t),r);if(-1===X){if(zn(i))return!1;a=!0;continue}if(""!==P){let ue;ue=X>s?"":o[X+1].toLowerCase();const he=8&i?ue:null;if(he&&-1!==Nh(he,P,0)||2&i&&P!==ue){if(zn(i))return!1;a=!0}}}}else{if(!a&&!zn(i)&&!zn(v))return!1;if(a&&zn(v))continue;a=!1,i=v|1&i}}return zn(i)||a}function zn(t){return 0==(1&t)}function Y2(t,n,r,i){if(null===n)return-1;let o=0;if(i||!r){let s=!1;for(;o<n.length;){const a=n[o];if(a===t)return o;if(3===a||6===a)s=!0;else{if(1===a||2===a){let l=n[++o];for(;"string"==typeof l;)l=n[++o];continue}if(4===a)break;if(0===a){o+=4;continue}}o+=s?1:2}return-1}return function X2(t,n){let r=t.indexOf(4);if(r>-1)for(r++;r<t.length;){const i=t[r];if("number"==typeof i)return-1;if(i===n)return r;r++}return-1}(n,t)}function Lh(t,n,r=!1){for(let i=0;i<n.length;i++)if(J2(t,n[i],r))return!0;return!1}function kh(t,n){return t?":not("+n.trim()+")":n}function Z2(t){let n=t[0],r=1,i=2,o="",s=!1;for(;r<t.length;){let a=t[r];if("string"==typeof a)if(2&i){const l=t[++r];o+="["+a+(l.length>0?'="'+l+'"':"")+"]"}else 8&i?o+="."+a:4&i&&(o+=" "+a);else""!==o&&!zn(a)&&(n+=kh(s,o),o=""),i=a,s=s||!zn(i);r++}return""!==o&&(n+=kh(s,o)),n}const et={};function Ea(t){xh(gt(),Ne(),an()+t,$s())}function xh(t,n,r,i){if(!i)if(3==(3&n[2])){const s=t.preOrderCheckHooks;null!==s&&ta(n,s,r)}else{const s=t.preOrderHooks;null!==s&&na(n,s,0,r)}Br(r)}function Sa(t,n){return t<<17|n<<2}function Jn(t){return t>>17&32767}function Hu(t){return 2|t}function Ar(t){return(131068&t)>>2}function Gu(t,n){return-131069&t|n<<2}function Wu(t){return 1|t}function Jh(t,n){const r=t.contentQueries;if(null!==r)for(let i=0;i<r.length;i+=2){const o=r[i],s=r[i+1];if(-1!==s){const a=t.data[s];iu(o),a.contentQueries(2,n[s],s)}}}function Qo(t,n,r,i,o,s,a,l,v,P){const W=n.blueprint.slice();return W[0]=o,W[2]=140|i,lp(W),W[3]=W[15]=t,W[8]=r,W[10]=a||t&&t[10],W[11]=l||t&&t[11],W[12]=v||t&&t[12]||null,W[9]=P||t&&t[9]||null,W[6]=s,W[16]=2==n.type?t[16]:W,W}function Gi(t,n,r,i,o){let s=t.data[n];if(null===s)s=function Zu(t,n,r,i,o){const s=fp(),a=eu(),v=t.data[n]=function vb(t,n,r,i,o,s){return{type:r,index:i,insertBeforeIndex:null,injectorIndex:n?n.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:o,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:n,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,a?s:s&&s.parent,r,n,i,o);return null===t.firstChild&&(t.firstChild=v),null!==s&&(a?null==s.child&&null!==v.parent&&(s.child=v):null===s.next&&(s.next=v)),v}(t,n,r,i,o),function U0(){return Qe.lFrame.inI18n}()&&(s.flags|=64);else if(64&s.type){s.type=r,s.value=i,s.attrs=o;const a=function Mo(){const t=Qe.lFrame,n=t.currentTNode;return t.isParent?n:n.parent}();s.injectorIndex=null===a?-1:a.injectorIndex}return ir(s,!0),s}function Wi(t,n,r,i){if(0===r)return-1;const o=n.length;for(let s=0;s<r;s++)n.push(i),t.blueprint.push(i),t.data.push(null);return o}function Zo(t,n,r){Qs(n);try{const i=t.viewQuery;null!==i&&cl(1,i,r);const o=t.template;null!==o&&Yh(t,n,o,1,r),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&Jh(t,n),t.staticViewQueries&&cl(2,t.viewQuery,r);const s=t.components;null!==s&&function hb(t,n){for(let r=0;r<n.length;r++)kb(t,n[r])}(n,s)}catch(i){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),i}finally{n[2]&=-5,Zs()}}function qi(t,n,r,i){const o=n[2];if(256==(256&o))return;Qs(n);const s=$s();try{lp(n),function pp(t){return Qe.lFrame.bindingIndex=t}(t.bindingStartIndex),null!==r&&Yh(t,n,r,2,i);const a=3==(3&o);if(!s)if(a){const P=t.preOrderCheckHooks;null!==P&&ta(n,P,null)}else{const P=t.preOrderHooks;null!==P&&na(n,P,0,null),ou(n,0)}if(function Pb(t){for(let n=Mu(t);null!==n;n=Pu(n)){if(!n[2])continue;const r=n[9];for(let i=0;i<r.length;i++){const o=r[i],s=o[3];0==(1024&o[2])&&Zc(s,1),o[2]|=1024}}}(n),function Mb(t){for(let n=Mu(t);null!==n;n=Pu(n))for(let r=10;r<n.length;r++){const i=n[r],o=i[1];Qc(i)&&qi(o,i,o.template,i[8])}}(n),null!==t.contentQueries&&Jh(t,n),!s)if(a){const P=t.contentCheckHooks;null!==P&&ta(n,P)}else{const P=t.contentHooks;null!==P&&na(n,P,1),ou(n,1)}!function fb(t,n){const r=t.hostBindingOpCodes;if(null!==r)try{for(let i=0;i<r.length;i++){const o=r[i];if(o<0)Br(~o);else{const s=o,a=r[++i],l=r[++i];B0(a,s),l(2,n[s])}}}finally{Br(-1)}}(t,n);const l=t.components;null!==l&&function pb(t,n){for(let r=0;r<n.length;r++)Lb(t,n[r])}(n,l);const v=t.viewQuery;if(null!==v&&cl(2,v,i),!s)if(a){const P=t.viewCheckHooks;null!==P&&ta(n,P)}else{const P=t.viewHooks;null!==P&&na(n,P,2),ou(n,2)}!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),s||(n[2]&=-73),1024&n[2]&&(n[2]&=-1025,Zc(n[3],-1))}finally{Zs()}}function gb(t,n,r,i){const o=n[10],s=!$s(),a=function up(t){return 4==(4&t[2])}(n);try{s&&!a&&o.begin&&o.begin(),a&&Zo(t,n,i),qi(t,n,r,i)}finally{s&&!a&&o.end&&o.end()}}function Yh(t,n,r,i,o){const s=an(),a=2&i;try{Br(-1),a&&n.length>20&&xh(t,n,20,$s()),r(i,o)}finally{Br(s)}}function el(t,n,r){!dp()||(function Tb(t,n,r,i){const o=r.directiveStart,s=r.directiveEnd;t.firstCreatePass||ko(r,n),tn(i,n);const a=r.initialInputs;for(let l=o;l<s;l++){const v=t.data[l],P=qn(v);P&&Db(n,r,v);const W=xo(n,t,l,r);tn(W,n),null!==a&&Ob(0,l-o,W,v,0,a),P&&(Cn(r.index,n)[8]=W)}}(t,n,r,xn(r,n)),128==(128&r.flags)&&function Rb(t,n,r){const i=r.directiveStart,o=r.directiveEnd,a=r.index,l=function H0(){return Qe.lFrame.currentDirectiveIndex}();try{Br(a);for(let v=i;v<o;v++){const P=t.data[v],W=n[v];nu(v),(null!==P.hostBindings||0!==P.hostVars||null!==P.hostAttrs)&&rg(P,W)}}finally{Br(-1),nu(l)}}(t,n,r))}function tl(t,n,r=xn){const i=n.localNames;if(null!==i){let o=n.index+1;for(let s=0;s<i.length;s+=2){const a=i[s+1],l=-1===a?r(n,t):t[a];t[o++]=l}}}function $h(t){const n=t.tView;return null===n||n.incompleteFirstPass?t.tView=Ta(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts):n}function Ta(t,n,r,i,o,s,a,l,v,P){const W=20+i,X=W+o,ue=function mb(t,n){const r=[];for(let i=0;i<n;i++)r.push(i<t?null:et);return r}(W,X),he="function"==typeof P?P():P;return ue[1]={type:t,blueprint:ue,template:r,queries:null,viewQuery:l,declTNode:n,data:ue.slice().fill(null,W),bindingStartIndex:W,expandoStartIndex:X,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof a?a():a,firstChild:null,schemas:v,consts:he,incompleteFirstPass:!1}}function eg(t,n,r){for(let i in t)if(t.hasOwnProperty(i)){const o=t[i];(r=null===r?{}:r).hasOwnProperty(i)?r[i].push(n,o):r[i]=[n,o]}return r}function nl(t,n,r,i){let o=!1;if(dp()){const s=function Ab(t,n,r){const i=t.directiveRegistry;let o=null;if(i)for(let s=0;s<i.length;s++){const a=i[s];Lh(r,a.selectors,!1)&&(o||(o=[]),aa(ko(r,n),t,a.type),qn(a)?(ig(t,r),o.unshift(a)):o.push(a))}return o}(t,n,r),a=null===i?null:{"":-1};if(null!==s){o=!0,og(r,t.data.length,s.length);for(let W=0;W<s.length;W++){const X=s[W];X.providersResolver&&X.providersResolver(X)}let l=!1,v=!1,P=Wi(t,n,s.length,null);for(let W=0;W<s.length;W++){const X=s[W];r.mergedAttrs=ia(r.mergedAttrs,X.hostAttrs),sg(t,r,n,P,X),wb(P,X,a),null!==X.contentQueries&&(r.flags|=8),(null!==X.hostBindings||null!==X.hostAttrs||0!==X.hostVars)&&(r.flags|=128);const ue=X.type.prototype;!l&&(ue.ngOnChanges||ue.ngOnInit||ue.ngDoCheck)&&((t.preOrderHooks||(t.preOrderHooks=[])).push(r.index),l=!0),!v&&(ue.ngOnChanges||ue.ngDoCheck)&&((t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(r.index),v=!0),P++}!function yb(t,n){const i=n.directiveEnd,o=t.data,s=n.attrs,a=[];let l=null,v=null;for(let P=n.directiveStart;P<i;P++){const W=o[P],X=W.inputs,ue=null===s||Ph(n)?null:Nb(X,s);a.push(ue),l=eg(X,P,l),v=eg(W.outputs,P,v)}null!==l&&(l.hasOwnProperty("class")&&(n.flags|=16),l.hasOwnProperty("style")&&(n.flags|=32)),n.initialInputs=a,n.inputs=l,n.outputs=v}(t,r)}a&&function Ib(t,n,r){if(n){const i=t.localNames=[];for(let o=0;o<n.length;o+=2){const s=r[n[o+1]];if(null==s)throw new ht(-301,`Export of name '${n[o+1]}' not found!`);i.push(n[o],s)}}}(r,i,a)}return r.mergedAttrs=ia(r.mergedAttrs,r.attrs),o}function ng(t,n,r,i,o,s){const a=s.hostBindings;if(a){let l=t.hostBindingOpCodes;null===l&&(l=t.hostBindingOpCodes=[]);const v=~n.index;(function Cb(t){let n=t.length;for(;n>0;){const r=t[--n];if("number"==typeof r&&r<0)return r}return 0})(l)!=v&&l.push(v),l.push(i,o,a)}}function rg(t,n){null!==t.hostBindings&&t.hostBindings(1,n)}function ig(t,n){n.flags|=2,(t.components||(t.components=[])).push(n.index)}function wb(t,n,r){if(r){if(n.exportAs)for(let i=0;i<n.exportAs.length;i++)r[n.exportAs[i]]=t;qn(n)&&(r[""]=t)}}function og(t,n,r){t.flags|=1,t.directiveStart=n,t.directiveEnd=n+r,t.providerIndexes=n}function sg(t,n,r,i,o){t.data[i]=o;const s=o.factory||(o.factory=ri(o.type)),a=new Po(s,qn(o),null);t.blueprint[i]=a,r[i]=a,ng(t,n,0,i,Wi(t,r,o.hostVars,et),o)}function Db(t,n,r){const i=xn(n,t),o=$h(r),s=t[10],a=Ra(t,Qo(t,o,null,r.onPush?64:16,i,n,s,s.createRenderer(i,r),null,null));t[n.index]=a}function Ob(t,n,r,i,o,s){const a=s[n];if(null!==a){const l=i.setInput;for(let v=0;v<a.length;){const P=a[v++],W=a[v++],X=a[v++];null!==l?i.setInput(r,X,P,W):r[W]=X}}}function Nb(t,n){let r=null,i=0;for(;i<n.length;){const o=n[i];if(0!==o)if(5!==o){if("number"==typeof o)break;t.hasOwnProperty(o)&&(null===r&&(r=[]),r.push(o,t[o],n[i+1])),i+=2}else i+=2;else i+=4}return r}function ag(t,n,r,i){return new Array(t,!0,!1,n,null,0,i,r,null,null)}function Lb(t,n){const r=Cn(n,t);if(Qc(r)){const i=r[1];80&r[2]?qi(i,r,i.template,r[8]):r[5]>0&&il(r)}}function il(t){for(let i=Mu(t);null!==i;i=Pu(i))for(let o=10;o<i.length;o++){const s=i[o];if(1024&s[2]){const a=s[1];qi(a,s,a.template,s[8])}else s[5]>0&&il(s)}const r=t[1].components;if(null!==r)for(let i=0;i<r.length;i++){const o=Cn(r[i],t);Qc(o)&&o[5]>0&&il(o)}}function kb(t,n){const r=Cn(n,t),i=r[1];(function xb(t,n){for(let r=n.length;r<t.blueprint.length;r++)n.push(t.blueprint[r])})(i,r),Zo(i,r,r[8])}function Ra(t,n){return t[13]?t[14][4]=n:t[13]=n,t[14]=n,n}function ol(t){for(;t;){t[2]|=64;const n=$o(t);if(E0(t)&&!n)return t;t=n}return null}function al(t,n,r){const i=n[10];i.begin&&i.begin();try{qi(t,n,t.template,r)}catch(o){throw fg(n,o),o}finally{i.end&&i.end()}}function cg(t){!function sl(t){for(let n=0;n<t.components.length;n++){const r=t.components[n],i=Iu(r),o=i[1];gb(o,i,o.template,r)}}(t[8])}function cl(t,n,r){iu(0),n(t,r)}const Ub=(()=>Promise.resolve(null))();function ug(t){return t[7]||(t[7]=[])}function lg(t){return t.cleanup||(t.cleanup=[])}function fg(t,n){const r=t[9],i=r?r.get(Ui,null):null;i&&i.handleError(n)}function pg(t,n,r,i,o){for(let s=0;s<r.length;){const a=r[s++],l=r[s++],v=n[a],P=t.data[a];null!==P.setInput?P.setInput(v,o,i,l):v[l]=o}}function Aa(t,n,r){let i=r?t.styles:null,o=r?t.classes:null,s=0;if(null!==n)for(let a=0;a<n.length;a++){const l=n[a];"number"==typeof l?s=l:1==s?o=Fc(o,l):2==s&&(i=Fc(i,l+": "+n[++a]+";"))}r?t.styles=i:t.stylesWithoutHost=i,r?t.classes=o:t.classesWithoutHost=o}const ul=new st("INJECTOR",-1);class hg{get(n,r=Bo){if(r===Bo){const i=new Error(`NullInjectorError: No provider for ${mt(n)}!`);throw i.name="NullInjectorError",i}return r}}const ll=new st("Set Injector scope."),es={},Gb={};let dl;function gg(){return void 0===dl&&(dl=new hg),dl}function mg(t,n=null,r=null,i){const o=vg(t,n,r,i);return o._resolveInjectorDefTypes(),o}function vg(t,n=null,r=null,i){return new Wb(t,r,n||gg(),i)}class Wb{constructor(n,r,i,o=null){this.parent=i,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const s=[];r&&or(r,l=>this.processProvider(l,n,r)),or([n],l=>this.processInjectorType(l,[],s)),this.records.set(ul,zi(void 0,this));const a=this.records.get(ll);this.scope=null!=a?a.value:null,this.source=o||("object"==typeof n?null:mt(n))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(n=>n.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(n,r=Bo,i=tt.Default){this.assertNotDestroyed();const o=Up(this),s=Fr(void 0);try{if(!(i&tt.SkipSelf)){let l=this.records.get(n);if(void 0===l){const v=function Qb(t){return"function"==typeof t||"object"==typeof t&&t instanceof st}(n)&&jc(n);l=v&&this.injectableDefInScope(v)?zi(fl(n),es):null,this.records.set(n,l)}if(null!=l)return this.hydrate(n,l)}return(i&tt.Self?gg():this.parent).get(n,r=i&tt.Optional&&r===Bo?null:r)}catch(a){if("NullInjectorError"===a.name){if((a[da]=a[da]||[]).unshift(mt(n)),o)throw a;return function AS(t,n,r,i){const o=t[da];throw n[jp]&&o.unshift(n[jp]),t.message=function IS(t,n,r,i=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.substr(2):t;let o=mt(n);if(Array.isArray(n))o=n.map(mt).join(" -> ");else if("object"==typeof n){let s=[];for(let a in n)if(n.hasOwnProperty(a)){let l=n[a];s.push(a+":"+("string"==typeof l?JSON.stringify(l):mt(l)))}o=`{${s.join(", ")}}`}return`${r}${i?"("+i+")":""}[${o}]: ${t.replace(SS,"\n  ")}`}("\n"+t.message,o,r,i),t.ngTokenPath=o,t[da]=null,t}(a,n,"R3InjectorError",this.source)}throw a}finally{Fr(s),Up(o)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(n=>this.get(n))}toString(){const n=[];return this.records.forEach((i,o)=>n.push(mt(o))),`R3Injector[${n.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new ht(205,"")}processInjectorType(n,r,i){if(!(n=it(n)))return!1;let o=Yf(n);const s=null==o&&n.ngModule||void 0,a=void 0===s?n:s,l=-1!==i.indexOf(a);if(void 0!==s&&(o=Yf(s)),null==o)return!1;if(null!=o.imports&&!l){let W;i.push(a);try{or(o.imports,X=>{this.processInjectorType(X,r,i)&&(void 0===W&&(W=[]),W.push(X))})}finally{}if(void 0!==W)for(let X=0;X<W.length;X++){const{ngModule:ue,providers:he}=W[X];or(he,Se=>this.processProvider(Se,ue,he||Et))}}this.injectorDefTypes.add(a);const v=ri(a)||(()=>new a);this.records.set(a,zi(v,es));const P=o.providers;if(null!=P&&!l){const W=n;or(P,X=>this.processProvider(X,W,P))}return void 0!==s&&void 0!==n.providers}processProvider(n,r,i){let o=Ji(n=it(n))?n:it(n&&n.provide);const s=function zb(t,n,r){return _g(t)?zi(void 0,t.useValue):zi(yg(t),es)}(n);if(Ji(n)||!0!==n.multi)this.records.get(o);else{let a=this.records.get(o);a||(a=zi(void 0,es,!0),a.factory=()=>vu(a.multi),this.records.set(o,a)),o=n,a.multi.push(n)}this.records.set(o,s)}hydrate(n,r){return r.value===es&&(r.value=Gb,r.value=r.factory()),"object"==typeof r.value&&r.value&&function Xb(t){return null!==t&&"object"==typeof t&&"function"==typeof t.ngOnDestroy}(r.value)&&this.onDestroy.add(r.value),r.value}injectableDefInScope(n){if(!n.providedIn)return!1;const r=it(n.providedIn);return"string"==typeof r?"any"===r||r===this.scope:this.injectorDefTypes.has(r)}}function fl(t){const n=jc(t),r=null!==n?n.factory:ri(t);if(null!==r)return r;if(t instanceof st)throw new ht(204,"");if(t instanceof Function)return function qb(t){const n=t.length;if(n>0)throw function Uo(t,n){const r=[];for(let i=0;i<t;i++)r.push(n);return r}(n,"?"),new ht(204,"");const r=function a0(t){const n=t&&(t[Hs]||t[Kf]);if(n){const r=function c0(t){if(t.hasOwnProperty("name"))return t.name;const n=(""+t).match(/^function\s*([^\s(]+)/);return null===n?"":n[1]}(t);return console.warn(`DEPRECATED: DI is instantiating a token "${r}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${r}" class.`),n}return null}(t);return null!==r?()=>r.factory(t):()=>new t}(t);throw new ht(204,"")}function yg(t,n,r){let i;if(Ji(t)){const o=it(t);return ri(o)||fl(o)}if(_g(t))i=()=>it(t.useValue);else if(function Yb(t){return!(!t||!t.useFactory)}(t))i=()=>t.useFactory(...vu(t.deps||[]));else if(function Jb(t){return!(!t||!t.useExisting)}(t))i=()=>qe(it(t.useExisting));else{const o=it(t&&(t.useClass||t.provide));if(!function $b(t){return!!t.deps}(t))return ri(o)||fl(o);i=()=>new o(...vu(t.deps))}return i}function zi(t,n,r=!1){return{factory:t,value:n,multi:r?[]:void 0}}function _g(t){return null!==t&&"object"==typeof t&&CS in t}function Ji(t){return"function"==typeof t}let Xt=(()=>{class t{static create(r,i){var o;if(Array.isArray(r))return mg({name:""},i,r,"");{const s=null!==(o=r.name)&&void 0!==o?o:"";return mg({name:s},r.parent,r.providers,s)}}}return t.THROW_IF_NOT_FOUND=Bo,t.NULL=new hg,t.\u0275prov=nt({token:t,providedIn:"any",factory:()=>qe(ul)}),t.__NG_ELEMENT_ID__=-1,t})();function sC(t,n){ea(Iu(t)[1],Gt())}function St(t){let n=function Ng(t){return Object.getPrototypeOf(t.prototype).constructor}(t.type),r=!0;const i=[t];for(;n;){let o;if(qn(t))o=n.\u0275cmp||n.\u0275dir;else{if(n.\u0275cmp)throw new ht(903,"");o=n.\u0275dir}if(o){if(r){i.push(o);const a=t;a.inputs=gl(t.inputs),a.declaredInputs=gl(t.declaredInputs),a.outputs=gl(t.outputs);const l=o.hostBindings;l&&lC(t,l);const v=o.viewQuery,P=o.contentQueries;if(v&&cC(t,v),P&&uC(t,P),xc(t.inputs,o.inputs),xc(t.declaredInputs,o.declaredInputs),xc(t.outputs,o.outputs),qn(o)&&o.data.animation){const W=t.data;W.animation=(W.animation||[]).concat(o.data.animation)}}const s=o.features;if(s)for(let a=0;a<s.length;a++){const l=s[a];l&&l.ngInherit&&l(t),l===St&&(r=!1)}}n=Object.getPrototypeOf(n)}!function aC(t){let n=0,r=null;for(let i=t.length-1;i>=0;i--){const o=t[i];o.hostVars=n+=o.hostVars,o.hostAttrs=ia(o.hostAttrs,r=ia(r,o.hostAttrs))}}(i)}function gl(t){return t===bi?{}:t===Et?[]:t}function cC(t,n){const r=t.viewQuery;t.viewQuery=r?(i,o)=>{n(i,o),r(i,o)}:n}function uC(t,n){const r=t.contentQueries;t.contentQueries=r?(i,o,s)=>{n(i,o,s),r(i,o,s)}:n}function lC(t,n){const r=t.hostBindings;t.hostBindings=r?(i,o)=>{n(i,o),r(i,o)}:n}let Ia=null;function Yi(){if(!Ia){const t=vt.Symbol;if(t&&t.iterator)Ia=t.iterator;else{const n=Object.getOwnPropertyNames(Map.prototype);for(let r=0;r<n.length;++r){const i=n[r];"entries"!==i&&"size"!==i&&Map.prototype[i]===Map.prototype.entries&&(Ia=i)}}}return Ia}function ts(t){return!!ml(t)&&(Array.isArray(t)||!(t instanceof Map)&&Yi()in t)}function ml(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function nn(t,n,r){return!Object.is(t[n],r)&&(t[n]=r,!0)}function Me(t,n=tt.Default){const r=Ne();return null===r?qe(t,n):Dp(Gt(),r,it(t),n)}function Sl(){throw new Error("invalid")}function si(t,n,r){const i=Ne();return nn(i,function wi(){return Qe.lFrame.bindingIndex++}(),n)&&function An(t,n,r,i,o,s,a,l){const v=xn(n,r);let W,P=n.inputs;!l&&null!=P&&(W=P[i])?(pg(t,r,W,i,o),Js(n)&&function Eb(t,n){const r=Cn(n,t);16&r[2]||(r[2]|=64)}(r,n.index)):3&n.type&&(i=function _b(t){return"class"===t?"className":"for"===t?"htmlFor":"formaction"===t?"formAction":"innerHtml"===t?"innerHTML":"readonly"===t?"readOnly":"tabindex"===t?"tabIndex":t}(i),o=null!=a?a(o,n.value||"",i):o,Mt(s)?s.setProperty(v,i,o):au(i)||(v.setProperty?v.setProperty(i,o):v[i]=o))}(gt(),function Pt(){const t=Qe.lFrame;return Xc(t.tView,t.selectedIndex)}(),i,t,n,i[11],r,!1),si}function bl(t,n,r,i,o){const a=o?"class":"style";pg(t,r,n.inputs[a],a,i)}function ai(t,n,r,i){const o=Ne(),s=gt(),a=20+t,l=o[11],v=o[a]=ku(l,n,function $0(){return Qe.lFrame.currentNamespace}()),P=s.firstCreatePass?function jC(t,n,r,i,o,s,a){const l=n.consts,P=Gi(n,t,2,o,Ur(l,s));return nl(n,r,P,Ur(l,a)),null!==P.attrs&&Aa(P,P.attrs,!1),null!==P.mergedAttrs&&Aa(P,P.mergedAttrs,!0),null!==n.queries&&n.queries.elementStart(n,P),P}(a,s,o,0,n,r,i):s.data[a];ir(P,!0);const W=P.mergedAttrs;null!==W&&ra(l,v,W);const X=P.classes;null!==X&&Bu(l,v,X);const ue=P.styles;null!==ue&&Oh(l,v,ue),64!=(64&P.flags)&&ya(s,o,v,P),0===function P0(){return Qe.lFrame.elementDepthCount}()&&tn(v,o),function L0(){Qe.lFrame.elementDepthCount++}(),Ys(P)&&(el(s,o,P),function Kh(t,n,r){if(zc(n)){const o=n.directiveEnd;for(let s=n.directiveStart;s<o;s++){const a=t.data[s];a.contentQueries&&a.contentQueries(1,r[s],s)}}}(s,P,o)),null!==i&&tl(o,P)}function ci(){let t=Gt();eu()?function tu(){Qe.lFrame.isParent=!1}():(t=t.parent,ir(t,!1));const n=t;!function k0(){Qe.lFrame.elementDepthCount--}();const r=gt();r.firstCreatePass&&(ea(r,t),zc(t)&&r.queries.elementEnd(t)),null!=n.classesWithoutHost&&function tS(t){return 0!=(16&t.flags)}(n)&&bl(r,n,Ne(),n.classesWithoutHost,!0),null!=n.stylesWithoutHost&&function nS(t){return 0!=(32&t.flags)}(n)&&bl(r,n,Ne(),n.stylesWithoutHost,!1)}function oo(t,n,r,i){ai(t,n,r,i),ci()}function rs(t){return!!t&&"function"==typeof t.then}const Cl=function em(t){return!!t&&"function"==typeof t.subscribe};function un(t,n,r,i){const o=Ne(),s=gt(),a=Gt();return function nm(t,n,r,i,o,s,a,l){const v=Ys(i),W=t.firstCreatePass&&lg(t),X=n[8],ue=ug(n);let he=!0;if(3&i.type||l){const De=xn(i,n),Oe=l?l(De):De,Ie=ue.length,He=l?Ke=>l(Vt(Ke[i.index])):i.index;if(Mt(r)){let Ke=null;if(!l&&v&&(Ke=function GC(t,n,r,i){const o=t.cleanup;if(null!=o)for(let s=0;s<o.length-1;s+=2){const a=o[s];if(a===r&&o[s+1]===i){const l=n[7],v=o[s+2];return l.length>v?l[v]:null}"string"==typeof a&&(s+=2)}return null}(t,n,o,i.index)),null!==Ke)(Ke.__ngLastListenerFn__||Ke).__ngNextListenerFn__=s,Ke.__ngLastListenerFn__=s,he=!1;else{s=Tl(i,n,X,s,!1);const pt=r.listen(Oe,o,s);ue.push(s,pt),W&&W.push(o,He,Ie,Ie+1)}}else s=Tl(i,n,X,s,!0),Oe.addEventListener(o,s,a),ue.push(s),W&&W.push(o,He,Ie,a)}else s=Tl(i,n,X,s,!1);const Se=i.outputs;let we;if(he&&null!==Se&&(we=Se[o])){const De=we.length;if(De)for(let Oe=0;Oe<De;Oe+=2){const Mn=n[we[Oe]][we[Oe+1]].subscribe(s),_i=ue.length;ue.push(s,Mn),W&&W.push(o,i.index,_i,-(_i+1))}}}(s,o,o[11],a,t,n,!!r,i),un}function rm(t,n,r,i){try{return!1!==r(i)}catch(o){return fg(t,o),!1}}function Tl(t,n,r,i,o){return function s(a){if(a===Function)return i;const l=2&t.flags?Cn(t.index,n):n;0==(32&n[2])&&ol(l);let v=rm(n,0,i,a),P=s.__ngNextListenerFn__;for(;P;)v=rm(n,0,P,a)&&v,P=P.__ngNextListenerFn__;return o&&!1===v&&(a.preventDefault(),a.returnValue=!1),v}}function pm(t,n,r,i,o){const s=t[r+1],a=null===n;let l=i?Jn(s):Ar(s),v=!1;for(;0!==l&&(!1===v||a);){const W=t[l+1];$C(t[l],n)&&(v=!0,t[l+1]=i?Wu(W):Hu(W)),l=i?Jn(W):Ar(W)}v&&(t[r+1]=i?Hu(s):Wu(s))}function $C(t,n){return null===t||null==n||(Array.isArray(t)?t[1]:t)===n||!(!Array.isArray(t)||"string"!=typeof n)&&xi(t,n)>=0}function Oa(t,n){return function Kn(t,n,r,i){const o=Ne(),s=gt(),a=function Rr(t){const n=Qe.lFrame,r=n.bindingIndex;return n.bindingIndex=n.bindingIndex+t,r}(2);s.firstUpdatePass&&function bm(t,n,r,i){const o=t.data;if(null===o[r+1]){const s=o[an()],a=function Sm(t,n){return n>=t.expandoStartIndex}(t,r);(function Am(t,n){return 0!=(t.flags&(n?16:32))})(s,i)&&null===n&&!a&&(n=!1),n=function oT(t,n,r,i){const o=function ru(t){const n=Qe.lFrame.currentDirectiveIndex;return-1===n?null:t[n]}(t);let s=i?n.residualClasses:n.residualStyles;if(null===o)0===(i?n.classBindings:n.styleBindings)&&(r=is(r=Al(null,t,n,r,i),n.attrs,i),s=null);else{const a=n.directiveStylingLast;if(-1===a||t[a]!==o)if(r=Al(o,t,n,r,i),null===s){let v=function sT(t,n,r){const i=r?n.classBindings:n.styleBindings;if(0!==Ar(i))return t[Jn(i)]}(t,n,i);void 0!==v&&Array.isArray(v)&&(v=Al(null,t,n,v[1],i),v=is(v,n.attrs,i),function aT(t,n,r,i){t[Jn(r?n.classBindings:n.styleBindings)]=i}(t,n,i,v))}else s=function cT(t,n,r){let i;const o=n.directiveEnd;for(let s=1+n.directiveStylingLast;s<o;s++)i=is(i,t[s].hostAttrs,r);return is(i,n.attrs,r)}(t,n,i)}return void 0!==s&&(i?n.residualClasses=s:n.residualStyles=s),r}(o,s,n,i),function YC(t,n,r,i,o,s){let a=s?n.classBindings:n.styleBindings,l=Jn(a),v=Ar(a);t[i]=r;let W,P=!1;if(Array.isArray(r)){const X=r;W=X[1],(null===W||xi(X,W)>0)&&(P=!0)}else W=r;if(o)if(0!==v){const ue=Jn(t[l+1]);t[i+1]=Sa(ue,l),0!==ue&&(t[ue+1]=Gu(t[ue+1],i)),t[l+1]=function nb(t,n){return 131071&t|n<<17}(t[l+1],i)}else t[i+1]=Sa(l,0),0!==l&&(t[l+1]=Gu(t[l+1],i)),l=i;else t[i+1]=Sa(v,0),0===l?l=i:t[v+1]=Gu(t[v+1],i),v=i;P&&(t[i+1]=Hu(t[i+1])),pm(t,W,i,!0),pm(t,W,i,!1),function KC(t,n,r,i,o){const s=o?t.residualClasses:t.residualStyles;null!=s&&"string"==typeof n&&xi(s,n)>=0&&(r[i+1]=Wu(r[i+1]))}(n,W,t,i,s),a=Sa(l,v),s?n.classBindings=a:n.styleBindings=a}(o,s,n,r,a,i)}}(s,t,a,i),n!==et&&nn(o,a,n)&&function Tm(t,n,r,i,o,s,a,l){if(!(3&n.type))return;const v=t.data,P=v[l+1];Na(function jh(t){return 1==(1&t)}(P)?Rm(v,n,r,o,Ar(P),a):void 0)||(Na(s)||function Vh(t){return 2==(2&t)}(P)&&(s=Rm(v,null,r,o,l,a)),function W2(t,n,r,i,o){const s=Mt(t);if(n)o?s?t.addClass(r,i):r.classList.add(i):s?t.removeClass(r,i):r.classList.remove(i);else{let a=-1===i.indexOf("-")?void 0:Rn.DashCase;if(null==o)s?t.removeStyle(r,i,a):r.style.removeProperty(i);else{const l="string"==typeof o&&o.endsWith("!important");l&&(o=o.slice(0,-10),a|=Rn.Important),s?t.setStyle(r,i,o,a):r.style.setProperty(i,o,l?"important":"")}}}(i,a,function Ks(t,n){return Vt(n[t])}(an(),r),o,s))}(s,s.data[an()],o,o[11],t,o[a+1]=function dT(t,n){return null==t||("string"==typeof n?t+=n:"object"==typeof t&&(t=mt(function Gr(t){return t instanceof class Kp{constructor(n){this.changingThisBreaksApplicationSecurity=n}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}?t.changingThisBreaksApplicationSecurity:t}(t)))),t}(n,r),i,a)}(t,n,null,!0),Oa}function Al(t,n,r,i,o){let s=null;const a=r.directiveEnd;let l=r.directiveStylingLast;for(-1===l?l=r.directiveStart:l++;l<a&&(s=n[l],i=is(i,s.hostAttrs,o),s!==t);)l++;return null!==t&&(r.directiveStylingLast=l),i}function is(t,n,r){const i=r?1:2;let o=-1;if(null!==n)for(let s=0;s<n.length;s++){const a=n[s];"number"==typeof a?o=a:o===i&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),Tn(t,a,!!r||n[++s]))}return void 0===t?null:t}function Rm(t,n,r,i,o,s){const a=null===n;let l;for(;o>0;){const v=t[o],P=Array.isArray(v),W=P?v[1]:v,X=null===W;let ue=r[o+1];ue===et&&(ue=X?Et:void 0);let he=X?hu(ue,i):W===i?ue:void 0;if(P&&!Na(he)&&(he=hu(v,i)),Na(he)&&(l=he,a))return l;const Se=t[o+1];o=a?Jn(Se):Ar(Se)}if(null!==n){let v=s?n.residualClasses:n.residualStyles;null!=v&&(l=hu(v,i))}return l}function Na(t){return void 0!==t}function os(t,n=""){const r=Ne(),i=gt(),o=t+20,s=i.firstCreatePass?Gi(i,o,1,n,null):i.data[o],a=r[o]=function Lu(t,n){return Mt(t)?t.createText(n):t.createTextNode(n)}(r[11],n);ya(i,r,a,s),ir(s,!1)}const ui=void 0;var NT=["en",[["a","p"],["AM","PM"],ui],[["AM","PM"],ui,ui],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],ui,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],ui,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",ui,"{1} 'at' {0}",ui],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function OT(t){const r=Math.floor(Math.abs(t)),i=t.toString().replace(/^[^.]*\.?/,"").length;return 1===r&&0===i?1:5}];let ao={};function Ym(t){return t in ao||(ao[t]=vt.ng&&vt.ng.common&&vt.ng.common.locales&&vt.ng.common.locales[t]),ao[t]}var Ue=(()=>((Ue=Ue||{})[Ue.LocaleId=0]="LocaleId",Ue[Ue.DayPeriodsFormat=1]="DayPeriodsFormat",Ue[Ue.DayPeriodsStandalone=2]="DayPeriodsStandalone",Ue[Ue.DaysFormat=3]="DaysFormat",Ue[Ue.DaysStandalone=4]="DaysStandalone",Ue[Ue.MonthsFormat=5]="MonthsFormat",Ue[Ue.MonthsStandalone=6]="MonthsStandalone",Ue[Ue.Eras=7]="Eras",Ue[Ue.FirstDayOfWeek=8]="FirstDayOfWeek",Ue[Ue.WeekendRange=9]="WeekendRange",Ue[Ue.DateFormat=10]="DateFormat",Ue[Ue.TimeFormat=11]="TimeFormat",Ue[Ue.DateTimeFormat=12]="DateTimeFormat",Ue[Ue.NumberSymbols=13]="NumberSymbols",Ue[Ue.NumberFormats=14]="NumberFormats",Ue[Ue.CurrencyCode=15]="CurrencyCode",Ue[Ue.CurrencySymbol=16]="CurrencySymbol",Ue[Ue.CurrencyName=17]="CurrencyName",Ue[Ue.Currencies=18]="Currencies",Ue[Ue.Directionality=19]="Directionality",Ue[Ue.PluralCase=20]="PluralCase",Ue[Ue.ExtraData=21]="ExtraData",Ue))();const Ma="en-US";let Km=Ma;function Ol(t,n,r,i,o){if(t=it(t),Array.isArray(t))for(let s=0;s<t.length;s++)Ol(t[s],n,r,i,o);else{const s=gt(),a=Ne();let l=Ji(t)?t:it(t.provide),v=yg(t);const P=Gt(),W=1048575&P.providerIndexes,X=P.directiveStart,ue=P.providerIndexes>>20;if(Ji(t)||!t.multi){const he=new Po(v,o,Me),Se=Ml(l,n,o?W:W+ue,X);-1===Se?(aa(ko(P,a),s,l),Nl(s,t,n.length),n.push(l),P.directiveStart++,P.directiveEnd++,o&&(P.providerIndexes+=1048576),r.push(he),a.push(he)):(r[Se]=he,a[Se]=he)}else{const he=Ml(l,n,W+ue,X),Se=Ml(l,n,W,W+ue),we=he>=0&&r[he],De=Se>=0&&r[Se];if(o&&!De||!o&&!we){aa(ko(P,a),s,l);const Oe=function OR(t,n,r,i,o){const s=new Po(t,r,Me);return s.multi=[],s.index=n,s.componentProviders=0,_1(s,o,i&&!r),s}(o?DR:wR,r.length,o,i,v);!o&&De&&(r[Se].providerFactory=Oe),Nl(s,t,n.length,0),n.push(l),P.directiveStart++,P.directiveEnd++,o&&(P.providerIndexes+=1048576),r.push(Oe),a.push(Oe)}else Nl(s,t,he>-1?he:Se,_1(r[o?Se:he],v,!o&&i));!o&&i&&De&&r[Se].componentProviders++}}}function Nl(t,n,r,i){const o=Ji(n),s=function Kb(t){return!!t.useClass}(n);if(o||s){const v=(s?it(n.useClass):n).prototype.ngOnDestroy;if(v){const P=t.destroyHooks||(t.destroyHooks=[]);if(!o&&n.multi){const W=P.indexOf(r);-1===W?P.push(r,[i,v]):P[W+1].push(i,v)}else P.push(r,v)}}}function _1(t,n,r){return r&&t.componentProviders++,t.multi.push(n)-1}function Ml(t,n,r,i){for(let o=r;o<i;o++)if(n[o]===t)return o;return-1}function wR(t,n,r,i){return Pl(this.multi,[])}function DR(t,n,r,i){const o=this.multi;let s;if(this.providerFactory){const a=this.providerFactory.componentProviders,l=xo(r,r[1],this.providerFactory.index,i);s=l.slice(0,a),Pl(o,s);for(let v=a;v<l.length;v++)s.push(l[v])}else s=[],Pl(o,s);return s}function Pl(t,n){for(let r=0;r<t.length;r++)n.push((0,t[r])());return n}function Dt(t,n=[]){return r=>{r.providersResolver=(i,o)=>function IR(t,n,r){const i=gt();if(i.firstCreatePass){const o=qn(t);Ol(r,i.data,i.blueprint,o,!0),Ol(n,i.data,i.blueprint,o,!1)}}(i,o?o(t):t,n)}}class E1{}class PR{resolveComponentFactory(n){throw function MR(t){const n=Error(`No component factory found for ${mt(t)}. Did you add it to @NgModule.entryComponents?`);return n.ngComponent=t,n}(n)}}let uo=(()=>{class t{}return t.NULL=new PR,t})();function LR(){return lo(Gt(),Ne())}function lo(t,n){return new In(xn(t,n))}let In=(()=>{class t{constructor(r){this.nativeElement=r}}return t.__NG_ELEMENT_ID__=LR,t})();class b1{}let wr=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>function FR(){const t=Ne(),r=Cn(Gt().index,t);return function xR(t){return t[11]}(rr(r)?r:t)}(),t})(),VR=(()=>{class t{}return t.\u0275prov=nt({token:t,providedIn:"root",factory:()=>null}),t})();class ls{constructor(n){this.full=n,this.major=n.split(".")[0],this.minor=n.split(".")[1],this.patch=n.split(".").slice(2).join(".")}}const jR=new ls("13.1.3"),Ll={};function Fa(t,n,r,i,o=!1){for(;null!==r;){const s=n[r.index];if(null!==s&&i.push(Vt(s)),Wn(s))for(let l=10;l<s.length;l++){const v=s[l],P=v[1].firstChild;null!==P&&Fa(v[1],v,P,i)}const a=r.type;if(8&a)Fa(t,n,r.child,i);else if(32&a){const l=Nu(r,n);let v;for(;v=l();)i.push(v)}else if(16&a){const l=Ih(n,r);if(Array.isArray(l))i.push(...l);else{const v=$o(n[16]);Fa(v[1],v,l,i,!0)}}r=o?r.projectionNext:r.next}return i}class ds{constructor(n,r){this._lView=n,this._cdRefInjectingView=r,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const n=this._lView,r=n[1];return Fa(r,n,r.firstChild,[])}get context(){return this._lView[8]}set context(n){this._lView[8]=n}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const n=this._lView[3];if(Wn(n)){const r=n[8],i=r?r.indexOf(this):-1;i>-1&&(xu(n,i),ua(r,i))}this._attachedToViewContainer=!1}yh(this._lView[1],this._lView)}onDestroy(n){!function Zh(t,n,r,i){const o=ug(n);null===r?o.push(i):(o.push(r),t.firstCreatePass&&lg(t).push(i,o.length-1))}(this._lView[1],this._lView,null,n)}markForCheck(){ol(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){al(this._lView[1],this._lView,this.context)}checkNoChanges(){!function Vb(t,n,r){Xs(!0);try{al(t,n,r)}finally{Xs(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new ht(902,"");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function L2(t,n){Xo(t,n,n[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(n){if(this._attachedToViewContainer)throw new ht(902,"");this._appRef=n}}class UR extends ds{constructor(n){super(n),this._view=n}detectChanges(){cg(this._view)}checkNoChanges(){!function jb(t){Xs(!0);try{cg(t)}finally{Xs(!1)}}(this._view)}get context(){return null}}class C1 extends uo{constructor(n){super(),this.ngModule=n}resolveComponentFactory(n){const r=Zt(n);return new kl(r,this.ngModule)}}function T1(t){const n=[];for(let r in t)t.hasOwnProperty(r)&&n.push({propName:t[r],templateName:r});return n}const HR=new st("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>lh});class kl extends E1{constructor(n,r){super(),this.componentDef=n,this.ngModule=r,this.componentType=n.type,this.selector=function eb(t){return t.map(Z2).join(",")}(n.selectors),this.ngContentSelectors=n.ngContentSelectors?n.ngContentSelectors:[],this.isBoundToModule=!!r}get inputs(){return T1(this.componentDef.inputs)}get outputs(){return T1(this.componentDef.outputs)}create(n,r,i,o){const s=(o=o||this.ngModule)?function GR(t,n){return{get:(r,i,o)=>{const s=t.get(r,Ll,o);return s!==Ll||i===Ll?s:n.get(r,i,o)}}}(n,o.injector):n,a=s.get(b1,cp),l=s.get(VR,null),v=a.createRenderer(null,this.componentDef),P=this.componentDef.selectors[0][0]||"div",W=i?function Qh(t,n,r){if(Mt(t))return t.selectRootElement(n,r===nr.ShadowDom);let i="string"==typeof n?t.querySelector(n):n;return i.textContent="",i}(v,i,this.componentDef.encapsulation):ku(a.createRenderer(null,this.componentDef),P,function BR(t){const n=t.toLowerCase();return"svg"===n?"http://www.w3.org/2000/svg":"math"===n?"http://www.w3.org/1998/MathML/":null}(P)),X=this.componentDef.onPush?576:528,ue=function Og(t,n){return{components:[],scheduler:t||lh,clean:Ub,playerHandler:n||null,flags:0}}(),he=Ta(0,null,null,1,0,null,null,null,null,null),Se=Qo(null,he,ue,X,null,null,a,v,l,s);let we,De;Qs(Se);try{const Oe=function wg(t,n,r,i,o,s){const a=r[1];r[20]=t;const v=Gi(a,20,2,"#host",null),P=v.mergedAttrs=n.hostAttrs;null!==P&&(Aa(v,P,!0),null!==t&&(ra(o,t,P),null!==v.classes&&Bu(o,t,v.classes),null!==v.styles&&Oh(o,t,v.styles)));const W=i.createRenderer(t,n),X=Qo(r,$h(n),null,n.onPush?64:16,r[20],v,i,W,s||null,null);return a.firstCreatePass&&(aa(ko(v,r),a,n.type),ig(a,v),og(v,r.length,1)),Ra(r,X),r[20]=X}(W,this.componentDef,Se,a,v);if(W)if(i)ra(v,W,["ng-version",jR.full]);else{const{attrs:Ie,classes:He}=function tb(t){const n=[],r=[];let i=1,o=2;for(;i<t.length;){let s=t[i];if("string"==typeof s)2===o?""!==s&&n.push(s,t[++i]):8===o&&r.push(s);else{if(!zn(o))break;o=s}i++}return{attrs:n,classes:r}}(this.componentDef.selectors[0]);Ie&&ra(v,W,Ie),He&&He.length>0&&Bu(v,W,He.join(" "))}if(De=Xc(he,20),void 0!==r){const Ie=De.projection=[];for(let He=0;He<this.ngContentSelectors.length;He++){const Ke=r[He];Ie.push(null!=Ke?Array.from(Ke):null)}}we=function Dg(t,n,r,i,o){const s=r[1],a=function bb(t,n,r){const i=Gt();t.firstCreatePass&&(r.providersResolver&&r.providersResolver(r),sg(t,i,n,Wi(t,n,1,null),r));const o=xo(n,t,i.directiveStart,i);tn(o,n);const s=xn(i,n);return s&&tn(s,n),o}(s,r,n);if(i.components.push(a),t[8]=a,o&&o.forEach(v=>v(a,n)),n.contentQueries){const v=Gt();n.contentQueries(1,a,v.directiveStart)}const l=Gt();return!s.firstCreatePass||null===n.hostBindings&&null===n.hostAttrs||(Br(l.index),ng(r[1],l,0,l.directiveStart,l.directiveEnd,n),rg(n,a)),a}(Oe,this.componentDef,Se,ue,[sC]),Zo(he,Se,null)}finally{Zs()}return new qR(this.componentType,we,lo(De,Se),Se,De)}}class qR extends class NR{}{constructor(n,r,i,o,s){super(),this.location=i,this._rootLView=o,this._tNode=s,this.instance=r,this.hostView=this.changeDetectorRef=new UR(o),this.componentType=n}get injector(){return new Ni(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(n){this.hostView.onDestroy(n)}}class Dr{}class R1{}const fo=new Map;class w1 extends Dr{constructor(n,r){super(),this._parent=r,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new C1(this);const i=Pn(n);this._bootstrapComponents=cr(i.bootstrap),this._r3Injector=vg(n,r,[{provide:Dr,useValue:this},{provide:uo,useValue:this.componentFactoryResolver}],mt(n)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(n)}get(n,r=Xt.THROW_IF_NOT_FOUND,i=tt.Default){return n===Xt||n===Dr||n===ul?this:this._r3Injector.get(n,r,i)}destroy(){const n=this._r3Injector;!n.destroyed&&n.destroy(),this.destroyCbs.forEach(r=>r()),this.destroyCbs=null}onDestroy(n){this.destroyCbs.push(n)}}class xl extends R1{constructor(n){super(),this.moduleType=n,null!==Pn(n)&&function JR(t){const n=new Set;!function r(i){const o=Pn(i,!0),s=o.id;null!==s&&(function A1(t,n,r){if(n&&n!==r)throw new Error(`Duplicate module registered for ${t} - ${mt(n)} vs ${mt(n.name)}`)}(s,fo.get(s),i),fo.set(s,i));const a=cr(o.imports);for(const l of a)n.has(l)||(n.add(l),r(l))}(t)}(n)}create(n){return new w1(this.moduleType,n)}}function Fl(t){return n=>{setTimeout(t,void 0,n)}}const kt=class dA extends ce{constructor(n=!1){super(),this.__isAsync=n}emit(n){super.next(n)}subscribe(n,r,i){var o,s,a;let l=n,v=r||(()=>null),P=i;if(n&&"object"==typeof n){const X=n;l=null===(o=X.next)||void 0===o?void 0:o.bind(X),v=null===(s=X.error)||void 0===s?void 0:s.bind(X),P=null===(a=X.complete)||void 0===a?void 0:a.bind(X)}this.__isAsync&&(v=Fl(v),l&&(l=Fl(l)),P&&(P=Fl(P)));const W=super.subscribe({next:l,error:v,complete:P});return n instanceof D&&n.add(W),W}};Symbol;let Or=(()=>{class t{}return t.__NG_ELEMENT_ID__=gA,t})();const pA=Or,hA=class extends pA{constructor(n,r,i){super(),this._declarationLView=n,this._declarationTContainer=r,this.elementRef=i}createEmbeddedView(n){const r=this._declarationTContainer.tViews,i=Qo(this._declarationLView,r,n,16,null,r.declTNode,null,null,null,null);i[17]=this._declarationLView[this._declarationTContainer.index];const s=this._declarationLView[19];return null!==s&&(i[19]=s.createEmbeddedView(r)),Zo(r,i,n),new ds(i)}};function gA(){return function Va(t,n){return 4&t.type?new hA(n,t,lo(t,n)):null}(Gt(),Ne())}let Xn=(()=>{class t{}return t.__NG_ELEMENT_ID__=mA,t})();function mA(){return function x1(t,n){let r;const i=n[t.index];if(Wn(i))r=i;else{let o;if(8&t.type)o=Vt(i);else{const s=n[11];o=s.createComment("");const a=xn(t,n);ii(s,va(s,a),o,function B2(t,n){return Mt(t)?t.nextSibling(n):n.nextSibling}(s,a),!1)}n[t.index]=r=ag(i,n,o,t),Ra(n,r)}return new L1(r,t,n)}(Gt(),Ne())}const vA=Xn,L1=class extends vA{constructor(n,r,i){super(),this._lContainer=n,this._hostTNode=r,this._hostLView=i}get element(){return lo(this._hostTNode,this._hostLView)}get injector(){return new Ni(this._hostTNode,this._hostLView)}get parentInjector(){const n=sa(this._hostTNode,this._hostLView);if(Tp(n)){const r=Oi(n,this._hostLView),i=Di(n);return new Ni(r[1].data[i+8],r)}return new Ni(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(n){const r=k1(this._lContainer);return null!==r&&r[n]||null}get length(){return this._lContainer.length-10}createEmbeddedView(n,r,i){const o=n.createEmbeddedView(r||{});return this.insert(o,i),o}createComponent(n,r,i,o,s){const a=n&&!function jo(t){return"function"==typeof t}(n);let l;if(a)l=r;else{const X=r||{};l=X.index,i=X.injector,o=X.projectableNodes,s=X.ngModuleRef}const v=a?n:new kl(Zt(n)),P=i||this.parentInjector;if(!s&&null==v.ngModule&&P){const X=P.get(Dr,null);X&&(s=X)}const W=v.create(P,o,void 0,s);return this.insert(W.hostView,l),W}insert(n,r){const i=n._lView,o=i[1];if(function M0(t){return Wn(t[3])}(i)){const W=this.indexOf(n);if(-1!==W)this.detach(W);else{const X=i[3],ue=new L1(X,X[6],X[3]);ue.detach(ue.indexOf(n))}}const s=this._adjustIndex(r),a=this._lContainer;!function x2(t,n,r,i){const o=10+i,s=r.length;i>0&&(r[o-1][4]=n),i<s-10?(n[4]=r[o],Lp(r,10+i,n)):(r.push(n),n[4]=null),n[3]=r;const a=n[17];null!==a&&r!==a&&function F2(t,n){const r=t[9];n[16]!==n[3][3][16]&&(t[2]=!0),null===r?t[9]=[n]:r.push(n)}(a,n);const l=n[19];null!==l&&l.insertView(t),n[2]|=128}(o,i,a,s);const l=ju(s,a),v=i[11],P=va(v,a[7]);return null!==P&&function P2(t,n,r,i,o,s){i[0]=o,i[6]=n,Xo(t,i,r,1,o,s)}(o,a[6],v,i,P,l),n.attachToViewContainerRef(),Lp(jl(a),s,n),n}move(n,r){return this.insert(n,r)}indexOf(n){const r=k1(this._lContainer);return null!==r?r.indexOf(n):-1}remove(n){const r=this._adjustIndex(n,-1),i=xu(this._lContainer,r);i&&(ua(jl(this._lContainer),r),yh(i[1],i))}detach(n){const r=this._adjustIndex(n,-1),i=xu(this._lContainer,r);return i&&null!=ua(jl(this._lContainer),r)?new ds(i):null}_adjustIndex(n,r=0){return null==n?this.length+r:n}};function k1(t){return t[8]}function jl(t){return t[8]||(t[8]=[])}function Ba(...t){}const Ha=new st("Application Initializer");let ho=(()=>{class t{constructor(r){this.appInits=r,this.resolve=Ba,this.reject=Ba,this.initialized=!1,this.done=!1,this.donePromise=new Promise((i,o)=>{this.resolve=i,this.reject=o})}runInitializers(){if(this.initialized)return;const r=[],i=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let o=0;o<this.appInits.length;o++){const s=this.appInits[o]();if(rs(s))r.push(s);else if(Cl(s)){const a=new Promise((l,v)=>{s.subscribe({complete:l,error:v})});r.push(a)}}Promise.all(r).then(()=>{i()}).catch(o=>{this.reject(o)}),0===r.length&&i(),this.initialized=!0}}return t.\u0275fac=function(r){return new(r||t)(qe(Ha,8))},t.\u0275prov=nt({token:t,factory:t.\u0275fac}),t})();const gs=new st("AppId"),qA={provide:gs,useFactory:function WA(){return`${Zl()}${Zl()}${Zl()}`},deps:[]};function Zl(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const iv=new st("Platform Initializer"),Ga=new st("Platform ID"),ov=new st("appBootstrapListener");let sv=(()=>{class t{log(r){console.log(r)}warn(r){console.warn(r)}}return t.\u0275fac=function(r){return new(r||t)},t.\u0275prov=nt({token:t,factory:t.\u0275fac}),t})();const zr=new st("LocaleId"),av=new st("DefaultCurrencyCode");class zA{constructor(n,r){this.ngModuleFactory=n,this.componentFactories=r}}let Wa=(()=>{class t{compileModuleSync(r){return new xl(r)}compileModuleAsync(r){return Promise.resolve(this.compileModuleSync(r))}compileModuleAndAllComponentsSync(r){const i=this.compileModuleSync(r),s=cr(Pn(r).declarations).reduce((a,l)=>{const v=Zt(l);return v&&a.push(new kl(v)),a},[]);return new zA(i,s)}compileModuleAndAllComponentsAsync(r){return Promise.resolve(this.compileModuleAndAllComponentsSync(r))}clearCache(){}clearCacheFor(r){}getModuleId(r){}}return t.\u0275fac=function(r){return new(r||t)},t.\u0275prov=nt({token:t,factory:t.\u0275fac}),t})();const YA=(()=>Promise.resolve(0))();function ed(t){"undefined"==typeof Zone?YA.then(()=>{t&&t.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",t)}class zt{constructor({enableLongStackTrace:n=!1,shouldCoalesceEventChangeDetection:r=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new kt(!1),this.onMicrotaskEmpty=new kt(!1),this.onStable=new kt(!1),this.onError=new kt(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const o=this;o._nesting=0,o._outer=o._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(o._inner=o._inner.fork(new Zone.TaskTrackingZoneSpec)),n&&Zone.longStackTraceZoneSpec&&(o._inner=o._inner.fork(Zone.longStackTraceZoneSpec)),o.shouldCoalesceEventChangeDetection=!i&&r,o.shouldCoalesceRunChangeDetection=i,o.lastRequestAnimationFrameId=-1,o.nativeRequestAnimationFrame=function KA(){let t=vt.requestAnimationFrame,n=vt.cancelAnimationFrame;if("undefined"!=typeof Zone&&t&&n){const r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r);const i=n[Zone.__symbol__("OriginalDelegate")];i&&(n=i)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:n}}().nativeRequestAnimationFrame,function QA(t){const n=()=>{!function XA(t){t.isCheckStableRunning||-1!==t.lastRequestAnimationFrameId||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(vt,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,nd(t),t.isCheckStableRunning=!0,td(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),nd(t))}(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(r,i,o,s,a,l)=>{try{return cv(t),r.invokeTask(o,s,a,l)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||t.shouldCoalesceRunChangeDetection)&&n(),uv(t)}},onInvoke:(r,i,o,s,a,l,v)=>{try{return cv(t),r.invoke(o,s,a,l,v)}finally{t.shouldCoalesceRunChangeDetection&&n(),uv(t)}},onHasTask:(r,i,o,s)=>{r.hasTask(o,s),i===o&&("microTask"==s.change?(t._hasPendingMicrotasks=s.microTask,nd(t),td(t)):"macroTask"==s.change&&(t.hasPendingMacrotasks=s.macroTask))},onHandleError:(r,i,o,s)=>(r.handleError(o,s),t.runOutsideAngular(()=>t.onError.emit(s)),!1)})}(o)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!zt.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(zt.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(n,r,i){return this._inner.run(n,r,i)}runTask(n,r,i,o){const s=this._inner,a=s.scheduleEventTask("NgZoneEvent: "+o,n,$A,Ba,Ba);try{return s.runTask(a,r,i)}finally{s.cancelTask(a)}}runGuarded(n,r,i){return this._inner.runGuarded(n,r,i)}runOutsideAngular(n){return this._outer.run(n)}}const $A={};function td(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function nd(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&-1!==t.lastRequestAnimationFrameId)}function cv(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function uv(t){t._nesting--,td(t)}class ZA{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new kt,this.onMicrotaskEmpty=new kt,this.onStable=new kt,this.onError=new kt}run(n,r,i){return n.apply(r,i)}runGuarded(n,r,i){return n.apply(r,i)}runOutsideAngular(n){return n()}runTask(n,r,i,o){return n.apply(r,i)}}let rd=(()=>{class t{constructor(r){this._ngZone=r,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),r.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{zt.assertNotInAngularZone(),ed(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())ed(()=>{for(;0!==this._callbacks.length;){let r=this._callbacks.pop();clearTimeout(r.timeoutId),r.doneCb(this._didWork)}this._didWork=!1});else{let r=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(r)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(r=>({source:r.source,creationLocation:r.creationLocation,data:r.data})):[]}addCallback(r,i,o){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(a=>a.timeoutId!==s),r(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:r,timeoutId:s,updateCb:o})}whenStable(r,i,o){if(o&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(r,i,o),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(r,i,o){return[]}}return t.\u0275fac=function(r){return new(r||t)(qe(zt))},t.\u0275prov=nt({token:t,factory:t.\u0275fac}),t})(),lv=(()=>{class t{constructor(){this._applications=new Map,id.addToWindow(this)}registerApplication(r,i){this._applications.set(r,i)}unregisterApplication(r){this._applications.delete(r)}unregisterAllApplications(){this._applications.clear()}getTestability(r){return this._applications.get(r)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(r,i=!0){return id.findTestabilityInTree(this,r,i)}}return t.\u0275fac=function(r){return new(r||t)},t.\u0275prov=nt({token:t,factory:t.\u0275fac}),t})();class eI{addToWindow(n){}findTestabilityInTree(n,r,i){return null}}let Qn,id=new eI;const dv=new st("AllowMultipleToken");class fv{constructor(n,r){this.name=n,this.token=r}}function pv(t,n,r=[]){const i=`Platform: ${n}`,o=new st(i);return(s=[])=>{let a=hv();if(!a||a.injector.get(dv,!1))if(t)t(r.concat(s).concat({provide:o,useValue:!0}));else{const l=r.concat(s).concat({provide:o,useValue:!0},{provide:ll,useValue:"platform"});!function iI(t){if(Qn&&!Qn.destroyed&&!Qn.injector.get(dv,!1))throw new ht(400,"");Qn=t.get(gv);const n=t.get(iv,null);n&&n.forEach(r=>r())}(Xt.create({providers:l,name:i}))}return function oI(t){const n=hv();if(!n)throw new ht(401,"");return n}()}}function hv(){return Qn&&!Qn.destroyed?Qn:null}let gv=(()=>{class t{constructor(r){this._injector=r,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(r,i){const l=function sI(t,n){let r;return r="noop"===t?new ZA:("zone.js"===t?void 0:t)||new zt({enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!!(null==n?void 0:n.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==n?void 0:n.ngZoneRunCoalescing)}),r}(i?i.ngZone:void 0,{ngZoneEventCoalescing:i&&i.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:i&&i.ngZoneRunCoalescing||!1}),v=[{provide:zt,useValue:l}];return l.run(()=>{const P=Xt.create({providers:v,parent:this.injector,name:r.moduleType.name}),W=r.create(P),X=W.injector.get(Ui,null);if(!X)throw new ht(402,"");return l.runOutsideAngular(()=>{const ue=l.onError.subscribe({next:he=>{X.handleError(he)}});W.onDestroy(()=>{od(this._modules,W),ue.unsubscribe()})}),function aI(t,n,r){try{const i=r();return rs(i)?i.catch(o=>{throw n.runOutsideAngular(()=>t.handleError(o)),o}):i}catch(i){throw n.runOutsideAngular(()=>t.handleError(i)),i}}(X,l,()=>{const ue=W.injector.get(ho);return ue.runInitializers(),ue.donePromise.then(()=>(function xT(t){_n(t,"Expected localeId to be defined"),"string"==typeof t&&(Km=t.toLowerCase().replace(/_/g,"-"))}(W.injector.get(zr,Ma)||Ma),this._moduleDoBootstrap(W),W))})})}bootstrapModule(r,i=[]){const o=mv({},i);return function nI(t,n,r){const i=new xl(r);return Promise.resolve(i)}(0,0,r).then(s=>this.bootstrapModuleFactory(s,o))}_moduleDoBootstrap(r){const i=r.injector.get(ms);if(r._bootstrapComponents.length>0)r._bootstrapComponents.forEach(o=>i.bootstrap(o));else{if(!r.instance.ngDoBootstrap)throw new ht(403,"");r.instance.ngDoBootstrap(i)}this._modules.push(r)}onDestroy(r){this._destroyListeners.push(r)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new ht(404,"");this._modules.slice().forEach(r=>r.destroy()),this._destroyListeners.forEach(r=>r()),this._destroyed=!0}get destroyed(){return this._destroyed}}return t.\u0275fac=function(r){return new(r||t)(qe(Xt))},t.\u0275prov=nt({token:t,factory:t.\u0275fac}),t})();function mv(t,n){return Array.isArray(n)?n.reduce(mv,t):Object.assign(Object.assign({},t),n)}let ms=(()=>{class t{constructor(r,i,o,s,a){this._zone=r,this._injector=i,this._exceptionHandler=o,this._componentFactoryResolver=s,this._initStatus=a,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const l=new d(P=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{P.next(this._stable),P.complete()})}),v=new d(P=>{let W;this._zone.runOutsideAngular(()=>{W=this._zone.onStable.subscribe(()=>{zt.assertNotInAngularZone(),ed(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,P.next(!0))})})});const X=this._zone.onUnstable.subscribe(()=>{zt.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{P.next(!1)}))});return()=>{W.unsubscribe(),X.unsubscribe()}});this.isStable=function ZE(...t){const n=Ao(t),r=function zE(t,n){return"number"==typeof Lc(t)?t.pop():n}(t,1/0),i=t;return i.length?1===i.length?Nt(i[0]):Ro(r)(Kt(i,n)):Sr}(l,v.pipe(function e0(t={}){const{connector:n=(()=>new ce),resetOnError:r=!0,resetOnComplete:i=!0,resetOnRefCountZero:o=!0}=t;return s=>{let a=null,l=null,v=null,P=0,W=!1,X=!1;const ue=()=>{null==l||l.unsubscribe(),l=null},he=()=>{ue(),a=v=null,W=X=!1},Se=()=>{const we=a;he(),null==we||we.unsubscribe()};return V((we,De)=>{P++,!X&&!W&&ue();const Oe=v=null!=v?v:n();De.add(()=>{P--,0===P&&!X&&!W&&(l=kc(Se,o))}),Oe.subscribe(De),a||(a=new Y({next:Ie=>Oe.next(Ie),error:Ie=>{X=!0,ue(),l=kc(he,r,Ie),Oe.error(Ie)},complete:()=>{W=!0,ue(),l=kc(he,i),Oe.complete()}}),Kt(we).subscribe(a))})(s)}}()))}bootstrap(r,i){if(!this._initStatus.done)throw new ht(405,"");let o;o=r instanceof E1?r:this._componentFactoryResolver.resolveComponentFactory(r),this.componentTypes.push(o.componentType);const s=function rI(t){return t.isBoundToModule}(o)?void 0:this._injector.get(Dr),l=o.create(Xt.NULL,[],i||o.selector,s),v=l.location.nativeElement,P=l.injector.get(rd,null),W=P&&l.injector.get(lv);return P&&W&&W.registerApplication(v,P),l.onDestroy(()=>{this.detachView(l.hostView),od(this.components,l),W&&W.unregisterApplication(v)}),this._loadComponent(l),l}tick(){if(this._runningTick)throw new ht(101,"");try{this._runningTick=!0;for(let r of this._views)r.detectChanges()}catch(r){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(r))}finally{this._runningTick=!1}}attachView(r){const i=r;this._views.push(i),i.attachToAppRef(this)}detachView(r){const i=r;od(this._views,i),i.detachFromAppRef()}_loadComponent(r){this.attachView(r.hostView),this.tick(),this.components.push(r),this._injector.get(ov,[]).concat(this._bootstrapListeners).forEach(o=>o(r))}ngOnDestroy(){this._views.slice().forEach(r=>r.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return t.\u0275fac=function(r){return new(r||t)(qe(zt),qe(Xt),qe(Ui),qe(uo),qe(ho))},t.\u0275prov=nt({token:t,factory:t.\u0275fac}),t})();function od(t,n){const r=t.indexOf(n);r>-1&&t.splice(r,1)}let yv=!0,sd=(()=>{class t{}return t.__NG_ELEMENT_ID__=lI,t})();function lI(t){return function dI(t,n,r){if(Js(t)&&!r){const i=Cn(t.index,n);return new ds(i,i)}return 47&t.type?new ds(n[16],n):null}(Gt(),Ne(),16==(16&t))}class Rv{constructor(){}supports(n){return ts(n)}create(n){return new vI(n)}}const mI=(t,n)=>n;class vI{constructor(n){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=n||mI}forEachItem(n){let r;for(r=this._itHead;null!==r;r=r._next)n(r)}forEachOperation(n){let r=this._itHead,i=this._removalsHead,o=0,s=null;for(;r||i;){const a=!i||r&&r.currentIndex<Iv(i,o,s)?r:i,l=Iv(a,o,s),v=a.currentIndex;if(a===i)o--,i=i._nextRemoved;else if(r=r._next,null==a.previousIndex)o++;else{s||(s=[]);const P=l-o,W=v-o;if(P!=W){for(let ue=0;ue<P;ue++){const he=ue<s.length?s[ue]:s[ue]=0,Se=he+ue;W<=Se&&Se<P&&(s[ue]=he+1)}s[a.previousIndex]=W-P}}l!==v&&n(a,l,v)}}forEachPreviousItem(n){let r;for(r=this._previousItHead;null!==r;r=r._nextPrevious)n(r)}forEachAddedItem(n){let r;for(r=this._additionsHead;null!==r;r=r._nextAdded)n(r)}forEachMovedItem(n){let r;for(r=this._movesHead;null!==r;r=r._nextMoved)n(r)}forEachRemovedItem(n){let r;for(r=this._removalsHead;null!==r;r=r._nextRemoved)n(r)}forEachIdentityChange(n){let r;for(r=this._identityChangesHead;null!==r;r=r._nextIdentityChange)n(r)}diff(n){if(null==n&&(n=[]),!ts(n))throw new ht(900,"");return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let o,s,a,r=this._itHead,i=!1;if(Array.isArray(n)){this.length=n.length;for(let l=0;l<this.length;l++)s=n[l],a=this._trackByFn(l,s),null!==r&&Object.is(r.trackById,a)?(i&&(r=this._verifyReinsertion(r,s,a,l)),Object.is(r.item,s)||this._addIdentityChange(r,s)):(r=this._mismatch(r,s,a,l),i=!0),r=r._next}else o=0,function mC(t,n){if(Array.isArray(t))for(let r=0;r<t.length;r++)n(t[r]);else{const r=t[Yi()]();let i;for(;!(i=r.next()).done;)n(i.value)}}(n,l=>{a=this._trackByFn(o,l),null!==r&&Object.is(r.trackById,a)?(i&&(r=this._verifyReinsertion(r,l,a,o)),Object.is(r.item,l)||this._addIdentityChange(r,l)):(r=this._mismatch(r,l,a,o),i=!0),r=r._next,o++}),this.length=o;return this._truncate(r),this.collection=n,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let n;for(n=this._previousItHead=this._itHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._additionsHead;null!==n;n=n._nextAdded)n.previousIndex=n.currentIndex;for(this._additionsHead=this._additionsTail=null,n=this._movesHead;null!==n;n=n._nextMoved)n.previousIndex=n.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(n,r,i,o){let s;return null===n?s=this._itTail:(s=n._prev,this._remove(n)),null!==(n=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(n.item,r)||this._addIdentityChange(n,r),this._reinsertAfter(n,s,o)):null!==(n=null===this._linkedRecords?null:this._linkedRecords.get(i,o))?(Object.is(n.item,r)||this._addIdentityChange(n,r),this._moveAfter(n,s,o)):n=this._addAfter(new yI(r,i),s,o),n}_verifyReinsertion(n,r,i,o){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==s?n=this._reinsertAfter(s,n._prev,o):n.currentIndex!=o&&(n.currentIndex=o,this._addToMoves(n,o)),n}_truncate(n){for(;null!==n;){const r=n._next;this._addToRemovals(this._unlink(n)),n=r}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(n,r,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(n);const o=n._prevRemoved,s=n._nextRemoved;return null===o?this._removalsHead=s:o._nextRemoved=s,null===s?this._removalsTail=o:s._prevRemoved=o,this._insertAfter(n,r,i),this._addToMoves(n,i),n}_moveAfter(n,r,i){return this._unlink(n),this._insertAfter(n,r,i),this._addToMoves(n,i),n}_addAfter(n,r,i){return this._insertAfter(n,r,i),this._additionsTail=null===this._additionsTail?this._additionsHead=n:this._additionsTail._nextAdded=n,n}_insertAfter(n,r,i){const o=null===r?this._itHead:r._next;return n._next=o,n._prev=r,null===o?this._itTail=n:o._prev=n,null===r?this._itHead=n:r._next=n,null===this._linkedRecords&&(this._linkedRecords=new Av),this._linkedRecords.put(n),n.currentIndex=i,n}_remove(n){return this._addToRemovals(this._unlink(n))}_unlink(n){null!==this._linkedRecords&&this._linkedRecords.remove(n);const r=n._prev,i=n._next;return null===r?this._itHead=i:r._next=i,null===i?this._itTail=r:i._prev=r,n}_addToMoves(n,r){return n.previousIndex===r||(this._movesTail=null===this._movesTail?this._movesHead=n:this._movesTail._nextMoved=n),n}_addToRemovals(n){return null===this._unlinkedRecords&&(this._unlinkedRecords=new Av),this._unlinkedRecords.put(n),n.currentIndex=null,n._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=n,n._prevRemoved=null):(n._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=n),n}_addIdentityChange(n,r){return n.item=r,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=n:this._identityChangesTail._nextIdentityChange=n,n}}class yI{constructor(n,r){this.item=n,this.trackById=r,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class _I{constructor(){this._head=null,this._tail=null}add(n){null===this._head?(this._head=this._tail=n,n._nextDup=null,n._prevDup=null):(this._tail._nextDup=n,n._prevDup=this._tail,n._nextDup=null,this._tail=n)}get(n,r){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===r||r<=i.currentIndex)&&Object.is(i.trackById,n))return i;return null}remove(n){const r=n._prevDup,i=n._nextDup;return null===r?this._head=i:r._nextDup=i,null===i?this._tail=r:i._prevDup=r,null===this._head}}class Av{constructor(){this.map=new Map}put(n){const r=n.trackById;let i=this.map.get(r);i||(i=new _I,this.map.set(r,i)),i.add(n)}get(n,r){const o=this.map.get(n);return o?o.get(n,r):null}remove(n){const r=n.trackById;return this.map.get(r).remove(n)&&this.map.delete(r),n}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function Iv(t,n,r){const i=t.previousIndex;if(null===i)return i;let o=0;return r&&i<r.length&&(o=r[i]),i+n+o}class wv{constructor(){}supports(n){return n instanceof Map||ml(n)}create(){return new EI}}class EI{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(n){let r;for(r=this._mapHead;null!==r;r=r._next)n(r)}forEachPreviousItem(n){let r;for(r=this._previousMapHead;null!==r;r=r._nextPrevious)n(r)}forEachChangedItem(n){let r;for(r=this._changesHead;null!==r;r=r._nextChanged)n(r)}forEachAddedItem(n){let r;for(r=this._additionsHead;null!==r;r=r._nextAdded)n(r)}forEachRemovedItem(n){let r;for(r=this._removalsHead;null!==r;r=r._nextRemoved)n(r)}diff(n){if(n){if(!(n instanceof Map||ml(n)))throw new ht(900,"")}else n=new Map;return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let r=this._mapHead;if(this._appendAfter=null,this._forEach(n,(i,o)=>{if(r&&r.key===o)this._maybeAddToChanges(r,i),this._appendAfter=r,r=r._next;else{const s=this._getOrCreateRecordForKey(o,i);r=this._insertBeforeOrAppend(r,s)}}),r){r._prev&&(r._prev._next=null),this._removalsHead=r;for(let i=r;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(n,r){if(n){const i=n._prev;return r._next=n,r._prev=i,n._prev=r,i&&(i._next=r),n===this._mapHead&&(this._mapHead=r),this._appendAfter=n,n}return this._appendAfter?(this._appendAfter._next=r,r._prev=this._appendAfter):this._mapHead=r,this._appendAfter=r,null}_getOrCreateRecordForKey(n,r){if(this._records.has(n)){const o=this._records.get(n);this._maybeAddToChanges(o,r);const s=o._prev,a=o._next;return s&&(s._next=a),a&&(a._prev=s),o._next=null,o._prev=null,o}const i=new SI(n);return this._records.set(n,i),i.currentValue=r,this._addToAdditions(i),i}_reset(){if(this.isDirty){let n;for(this._previousMapHead=this._mapHead,n=this._previousMapHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._changesHead;null!==n;n=n._nextChanged)n.previousValue=n.currentValue;for(n=this._additionsHead;null!=n;n=n._nextAdded)n.previousValue=n.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(n,r){Object.is(r,n.currentValue)||(n.previousValue=n.currentValue,n.currentValue=r,this._addToChanges(n))}_addToAdditions(n){null===this._additionsHead?this._additionsHead=this._additionsTail=n:(this._additionsTail._nextAdded=n,this._additionsTail=n)}_addToChanges(n){null===this._changesHead?this._changesHead=this._changesTail=n:(this._changesTail._nextChanged=n,this._changesTail=n)}_forEach(n,r){n instanceof Map?n.forEach(r):Object.keys(n).forEach(i=>r(n[i],i))}}class SI{constructor(n){this.key=n,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function Dv(){return new vs([new Rv])}let vs=(()=>{class t{constructor(r){this.factories=r}static create(r,i){if(null!=i){const o=i.factories.slice();r=r.concat(o)}return new t(r)}static extend(r){return{provide:t,useFactory:i=>t.create(r,i||Dv()),deps:[[t,new Fi,new sr]]}}find(r){const i=this.factories.find(o=>o.supports(r));if(null!=i)return i;throw new ht(901,"")}}return t.\u0275prov=nt({token:t,providedIn:"root",factory:Dv}),t})();function Ov(){return new go([new wv])}let go=(()=>{class t{constructor(r){this.factories=r}static create(r,i){if(i){const o=i.factories.slice();r=r.concat(o)}return new t(r)}static extend(r){return{provide:t,useFactory:i=>t.create(r,i||Ov()),deps:[[t,new Fi,new sr]]}}find(r){const i=this.factories.find(s=>s.supports(r));if(i)return i;throw new ht(901,"")}}return t.\u0275prov=nt({token:t,providedIn:"root",factory:Ov}),t})();const bI=[new wv],TI=new vs([new Rv]),RI=new go(bI),AI=pv(null,"core",[{provide:Ga,useValue:"unknown"},{provide:gv,deps:[Xt]},{provide:lv,deps:[]},{provide:sv,deps:[]}]),NI=[{provide:ms,useClass:ms,deps:[zt,Xt,Ui,uo,ho]},{provide:HR,deps:[zt],useFactory:function MI(t){let n=[];return t.onStable.subscribe(()=>{for(;n.length;)n.pop()()}),function(r){n.push(r)}}},{provide:ho,useClass:ho,deps:[[new sr,Ha]]},{provide:Wa,useClass:Wa,deps:[]},qA,{provide:vs,useFactory:function II(){return TI},deps:[]},{provide:go,useFactory:function wI(){return RI},deps:[]},{provide:zr,useFactory:function DI(t){return t||function OI(){return"undefined"!=typeof $localize&&$localize.locale||Ma}()},deps:[[new Wo(zr),new sr,new Fi]]},{provide:av,useValue:"USD"}];let PI=(()=>{class t{constructor(r){}}return t.\u0275fac=function(r){return new(r||t)(qe(ms))},t.\u0275mod=En({type:t}),t.\u0275inj=pn({providers:NI}),t})(),za=null;function hr(){return za}const wn=new st("DocumentToken");let di=(()=>{class t{historyGo(r){throw new Error("Not implemented")}}return t.\u0275fac=function(r){return new(r||t)},t.\u0275prov=nt({token:t,factory:function(){return function FI(){return qe(Nv)}()},providedIn:"platform"}),t})();const VI=new st("Location Initialized");let Nv=(()=>{class t extends di{constructor(r){super(),this._doc=r,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return hr().getBaseHref(this._doc)}onPopState(r){const i=hr().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",r,!1),()=>i.removeEventListener("popstate",r)}onHashChange(r){const i=hr().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",r,!1),()=>i.removeEventListener("hashchange",r)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(r){this.location.pathname=r}pushState(r,i,o){Mv()?this._history.pushState(r,i,o):this.location.hash=o}replaceState(r,i,o){Mv()?this._history.replaceState(r,i,o):this.location.hash=o}forward(){this._history.forward()}back(){this._history.back()}historyGo(r=0){this._history.go(r)}getState(){return this._history.state}}return t.\u0275fac=function(r){return new(r||t)(qe(wn))},t.\u0275prov=nt({token:t,factory:function(){return function jI(){return new Nv(qe(wn))}()},providedIn:"platform"}),t})();function Mv(){return!!window.history.pushState}function dd(t,n){if(0==t.length)return n;if(0==n.length)return t;let r=0;return t.endsWith("/")&&r++,n.startsWith("/")&&r++,2==r?t+n.substring(1):1==r?t+n:t+"/"+n}function Pv(t){const n=t.match(/#|\?|$/),r=n&&n.index||t.length;return t.slice(0,r-("/"===t[r-1]?1:0))+t.slice(r)}function Nr(t){return t&&"?"!==t[0]?"?"+t:t}let mo=(()=>{class t{historyGo(r){throw new Error("Not implemented")}}return t.\u0275fac=function(r){return new(r||t)},t.\u0275prov=nt({token:t,factory:function(){return function UI(t){const n=qe(wn).location;return new Lv(qe(di),n&&n.origin||"")}()},providedIn:"root"}),t})();const fd=new st("appBaseHref");let Lv=(()=>{class t extends mo{constructor(r,i){if(super(),this._platformLocation=r,this._removeListenerFns=[],null==i&&(i=this._platformLocation.getBaseHrefFromDOM()),null==i)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=i}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}prepareExternalUrl(r){return dd(this._baseHref,r)}path(r=!1){const i=this._platformLocation.pathname+Nr(this._platformLocation.search),o=this._platformLocation.hash;return o&&r?`${i}${o}`:i}pushState(r,i,o,s){const a=this.prepareExternalUrl(o+Nr(s));this._platformLocation.pushState(r,i,a)}replaceState(r,i,o,s){const a=this.prepareExternalUrl(o+Nr(s));this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(r=0){var i,o;null===(o=(i=this._platformLocation).historyGo)||void 0===o||o.call(i,r)}}return t.\u0275fac=function(r){return new(r||t)(qe(di),qe(fd,8))},t.\u0275prov=nt({token:t,factory:t.\u0275fac}),t})(),BI=(()=>{class t extends mo{constructor(r,i){super(),this._platformLocation=r,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}path(r=!1){let i=this._platformLocation.hash;return null==i&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(r){const i=dd(this._baseHref,r);return i.length>0?"#"+i:i}pushState(r,i,o,s){let a=this.prepareExternalUrl(o+Nr(s));0==a.length&&(a=this._platformLocation.pathname),this._platformLocation.pushState(r,i,a)}replaceState(r,i,o,s){let a=this.prepareExternalUrl(o+Nr(s));0==a.length&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(r=0){var i,o;null===(o=(i=this._platformLocation).historyGo)||void 0===o||o.call(i,r)}}return t.\u0275fac=function(r){return new(r||t)(qe(di),qe(fd,8))},t.\u0275prov=nt({token:t,factory:t.\u0275fac}),t})(),pd=(()=>{class t{constructor(r,i){this._subject=new kt,this._urlChangeListeners=[],this._platformStrategy=r;const o=this._platformStrategy.getBaseHref();this._platformLocation=i,this._baseHref=Pv(kv(o)),this._platformStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}path(r=!1){return this.normalize(this._platformStrategy.path(r))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(r,i=""){return this.path()==this.normalize(r+Nr(i))}normalize(r){return t.stripTrailingSlash(function GI(t,n){return t&&n.startsWith(t)?n.substring(t.length):n}(this._baseHref,kv(r)))}prepareExternalUrl(r){return r&&"/"!==r[0]&&(r="/"+r),this._platformStrategy.prepareExternalUrl(r)}go(r,i="",o=null){this._platformStrategy.pushState(o,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+Nr(i)),o)}replaceState(r,i="",o=null){this._platformStrategy.replaceState(o,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+Nr(i)),o)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(r=0){var i,o;null===(o=(i=this._platformStrategy).historyGo)||void 0===o||o.call(i,r)}onUrlChange(r){this._urlChangeListeners.push(r),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}))}_notifyUrlChangeListeners(r="",i){this._urlChangeListeners.forEach(o=>o(r,i))}subscribe(r,i,o){return this._subject.subscribe({next:r,error:i,complete:o})}}return t.normalizeQueryParams=Nr,t.joinWithSlash=dd,t.stripTrailingSlash=Pv,t.\u0275fac=function(r){return new(r||t)(qe(mo),qe(di))},t.\u0275prov=nt({token:t,factory:function(){return function HI(){return new pd(qe(mo),qe(di))}()},providedIn:"root"}),t})();function kv(t){return t.replace(/\/index.html$/,"")}var Ut=(()=>((Ut=Ut||{})[Ut.Zero=0]="Zero",Ut[Ut.One=1]="One",Ut[Ut.Two=2]="Two",Ut[Ut.Few=3]="Few",Ut[Ut.Many=4]="Many",Ut[Ut.Other=5]="Other",Ut))();const $I=function Jm(t){return function ln(t){const n=function MT(t){return t.toLowerCase().replace(/_/g,"-")}(t);let r=Ym(n);if(r)return r;const i=n.split("-")[0];if(r=Ym(i),r)return r;if("en"===i)return NT;throw new Error(`Missing locale data for the locale "${t}".`)}(t)[Ue.PluralCase]};class nc{}let Rw=(()=>{class t extends nc{constructor(r){super(),this.locale=r}getPluralCategory(r,i){switch($I(i||this.locale)(r)){case Ut.Zero:return"zero";case Ut.One:return"one";case Ut.Two:return"two";case Ut.Few:return"few";case Ut.Many:return"many";default:return"other"}}}return t.\u0275fac=function(r){return new(r||t)(qe(zr))},t.\u0275prov=nt({token:t,factory:t.\u0275fac}),t})();function Wv(t,n){n=encodeURIComponent(n);for(const r of t.split(";")){const i=r.indexOf("="),[o,s]=-1==i?[r,""]:[r.slice(0,i),r.slice(i+1)];if(o.trim()===n)return decodeURIComponent(s)}return null}class ww{constructor(n,r,i,o){this.$implicit=n,this.ngForOf=r,this.index=i,this.count=o}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let qv=(()=>{class t{constructor(r,i,o){this._viewContainer=r,this._template=i,this._differs=o,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(r){this._ngForOf=r,this._ngForOfDirty=!0}set ngForTrackBy(r){this._trackByFn=r}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(r){r&&(this._template=r)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const r=this._ngForOf;!this._differ&&r&&(this._differ=this._differs.find(r).create(this.ngForTrackBy))}if(this._differ){const r=this._differ.diff(this._ngForOf);r&&this._applyChanges(r)}}_applyChanges(r){const i=this._viewContainer;r.forEachOperation((o,s,a)=>{if(null==o.previousIndex)i.createEmbeddedView(this._template,new ww(o.item,this._ngForOf,-1,-1),null===a?void 0:a);else if(null==a)i.remove(null===s?void 0:s);else if(null!==s){const l=i.get(s);i.move(l,a),zv(l,o)}});for(let o=0,s=i.length;o<s;o++){const l=i.get(o).context;l.index=o,l.count=s,l.ngForOf=this._ngForOf}r.forEachIdentityChange(o=>{zv(i.get(o.currentIndex),o)})}static ngTemplateContextGuard(r,i){return!0}}return t.\u0275fac=function(r){return new(r||t)(Me(Xn),Me(Or),Me(vs))},t.\u0275dir=Xe({type:t,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),t})();function zv(t,n){t.context.$implicit=n.item}let rD=(()=>{class t{}return t.\u0275fac=function(r){return new(r||t)},t.\u0275mod=En({type:t}),t.\u0275inj=pn({providers:[{provide:nc,useClass:Rw}]}),t})();let aD=(()=>{class t{}return t.\u0275prov=nt({token:t,providedIn:"root",factory:()=>new cD(qe(wn),window)}),t})();class cD{constructor(n,r){this.document=n,this.window=r,this.offset=()=>[0,0]}setOffset(n){this.offset=Array.isArray(n)?()=>n:n}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(n){this.supportsScrolling()&&this.window.scrollTo(n[0],n[1])}scrollToAnchor(n){if(!this.supportsScrolling())return;const r=function uD(t,n){const r=t.getElementById(n)||t.getElementsByName(n)[0];if(r)return r;if("function"==typeof t.createTreeWalker&&t.body&&(t.body.createShadowRoot||t.body.attachShadow)){const i=t.createTreeWalker(t.body,NodeFilter.SHOW_ELEMENT);let o=i.currentNode;for(;o;){const s=o.shadowRoot;if(s){const a=s.getElementById(n)||s.querySelector(`[name="${n}"]`);if(a)return a}o=i.nextNode()}}return null}(this.document,n);r&&(this.scrollToElement(r),this.attemptFocus(r))}setHistoryScrollRestoration(n){if(this.supportScrollRestoration()){const r=this.window.history;r&&r.scrollRestoration&&(r.scrollRestoration=n)}}scrollToElement(n){const r=n.getBoundingClientRect(),i=r.left+this.window.pageXOffset,o=r.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(i-s[0],o-s[1])}attemptFocus(n){return n.focus(),this.document.activeElement===n}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const n=Xv(this.window.history)||Xv(Object.getPrototypeOf(this.window.history));return!(!n||!n.writable&&!n.set)}catch(n){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(n){return!1}}}function Xv(t){return Object.getOwnPropertyDescriptor(t,"scrollRestoration")}class Qv{}class Ad extends class lD extends class xI{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function kI(t){za||(za=t)}(new Ad)}onAndCancel(n,r,i){return n.addEventListener(r,i,!1),()=>{n.removeEventListener(r,i,!1)}}dispatchEvent(n,r){n.dispatchEvent(r)}remove(n){n.parentNode&&n.parentNode.removeChild(n)}createElement(n,r){return(r=r||this.getDefaultDocument()).createElement(n)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(n){return n.nodeType===Node.ELEMENT_NODE}isShadowRoot(n){return n instanceof DocumentFragment}getGlobalEventTarget(n,r){return"window"===r?window:"document"===r?n:"body"===r?n.body:null}getBaseHref(n){const r=function dD(){return Es=Es||document.querySelector("base"),Es?Es.getAttribute("href"):null}();return null==r?null:function fD(t){rc=rc||document.createElement("a"),rc.setAttribute("href",t);const n=rc.pathname;return"/"===n.charAt(0)?n:`/${n}`}(r)}resetBaseElement(){Es=null}getUserAgent(){return window.navigator.userAgent}getCookie(n){return Wv(document.cookie,n)}}let rc,Es=null;const Zv=new st("TRANSITION_ID"),hD=[{provide:Ha,useFactory:function pD(t,n,r){return()=>{r.get(ho).donePromise.then(()=>{const i=hr(),o=n.querySelectorAll(`style[ng-transition="${t}"]`);for(let s=0;s<o.length;s++)i.remove(o[s])})}},deps:[Zv,wn,Xt],multi:!0}];class Id{static init(){!function tI(t){id=t}(new Id)}addToWindow(n){vt.getAngularTestability=(i,o=!0)=>{const s=n.findTestabilityInTree(i,o);if(null==s)throw new Error("Could not find testability for element.");return s},vt.getAllAngularTestabilities=()=>n.getAllTestabilities(),vt.getAllAngularRootElements=()=>n.getAllRootElements(),vt.frameworkStabilizers||(vt.frameworkStabilizers=[]),vt.frameworkStabilizers.push(i=>{const o=vt.getAllAngularTestabilities();let s=o.length,a=!1;const l=function(v){a=a||v,s--,0==s&&i(a)};o.forEach(function(v){v.whenStable(l)})})}findTestabilityInTree(n,r,i){if(null==r)return null;const o=n.getTestability(r);return null!=o?o:i?hr().isShadowRoot(r)?this.findTestabilityInTree(n,r.host,!0):this.findTestabilityInTree(n,r.parentElement,!0):null}}let gD=(()=>{class t{build(){return new XMLHttpRequest}}return t.\u0275fac=function(r){return new(r||t)},t.\u0275prov=nt({token:t,factory:t.\u0275fac}),t})();const ic=new st("EventManagerPlugins");let oc=(()=>{class t{constructor(r,i){this._zone=i,this._eventNameToPlugin=new Map,r.forEach(o=>o.manager=this),this._plugins=r.slice().reverse()}addEventListener(r,i,o){return this._findPluginFor(i).addEventListener(r,i,o)}addGlobalEventListener(r,i,o){return this._findPluginFor(i).addGlobalEventListener(r,i,o)}getZone(){return this._zone}_findPluginFor(r){const i=this._eventNameToPlugin.get(r);if(i)return i;const o=this._plugins;for(let s=0;s<o.length;s++){const a=o[s];if(a.supports(r))return this._eventNameToPlugin.set(r,a),a}throw new Error(`No event manager plugin found for event ${r}`)}}return t.\u0275fac=function(r){return new(r||t)(qe(ic),qe(zt))},t.\u0275prov=nt({token:t,factory:t.\u0275fac}),t})();class ey{constructor(n){this._doc=n}addGlobalEventListener(n,r,i){const o=hr().getGlobalEventTarget(this._doc,n);if(!o)throw new Error(`Unsupported event target ${o} for event ${r}`);return this.addEventListener(o,r,i)}}let ty=(()=>{class t{constructor(){this._stylesSet=new Set}addStyles(r){const i=new Set;r.forEach(o=>{this._stylesSet.has(o)||(this._stylesSet.add(o),i.add(o))}),this.onStylesAdded(i)}onStylesAdded(r){}getAllStyles(){return Array.from(this._stylesSet)}}return t.\u0275fac=function(r){return new(r||t)},t.\u0275prov=nt({token:t,factory:t.\u0275fac}),t})(),Ss=(()=>{class t extends ty{constructor(r){super(),this._doc=r,this._hostNodes=new Map,this._hostNodes.set(r.head,[])}_addStylesToHost(r,i,o){r.forEach(s=>{const a=this._doc.createElement("style");a.textContent=s,o.push(i.appendChild(a))})}addHost(r){const i=[];this._addStylesToHost(this._stylesSet,r,i),this._hostNodes.set(r,i)}removeHost(r){const i=this._hostNodes.get(r);i&&i.forEach(ny),this._hostNodes.delete(r)}onStylesAdded(r){this._hostNodes.forEach((i,o)=>{this._addStylesToHost(r,o,i)})}ngOnDestroy(){this._hostNodes.forEach(r=>r.forEach(ny))}}return t.\u0275fac=function(r){return new(r||t)(qe(wn))},t.\u0275prov=nt({token:t,factory:t.\u0275fac}),t})();function ny(t){hr().remove(t)}const wd={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},Dd=/%COMP%/g;function sc(t,n,r){for(let i=0;i<n.length;i++){let o=n[i];Array.isArray(o)?sc(t,o,r):(o=o.replace(Dd,t),r.push(o))}return r}function oy(t){return n=>{if("__ngUnwrap__"===n)return t;!1===t(n)&&(n.preventDefault(),n.returnValue=!1)}}let Od=(()=>{class t{constructor(r,i,o){this.eventManager=r,this.sharedStylesHost=i,this.appId=o,this.rendererByCompId=new Map,this.defaultRenderer=new Nd(r)}createRenderer(r,i){if(!r||!i)return this.defaultRenderer;switch(i.encapsulation){case nr.Emulated:{let o=this.rendererByCompId.get(i.id);return o||(o=new SD(this.eventManager,this.sharedStylesHost,i,this.appId),this.rendererByCompId.set(i.id,o)),o.applyToHost(r),o}case 1:case nr.ShadowDom:return new bD(this.eventManager,this.sharedStylesHost,r,i);default:if(!this.rendererByCompId.has(i.id)){const o=sc(i.id,i.styles,[]);this.sharedStylesHost.addStyles(o),this.rendererByCompId.set(i.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return t.\u0275fac=function(r){return new(r||t)(qe(oc),qe(Ss),qe(gs))},t.\u0275prov=nt({token:t,factory:t.\u0275fac}),t})();class Nd{constructor(n){this.eventManager=n,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(n,r){return r?document.createElementNS(wd[r]||r,n):document.createElement(n)}createComment(n){return document.createComment(n)}createText(n){return document.createTextNode(n)}appendChild(n,r){n.appendChild(r)}insertBefore(n,r,i){n&&n.insertBefore(r,i)}removeChild(n,r){n&&n.removeChild(r)}selectRootElement(n,r){let i="string"==typeof n?document.querySelector(n):n;if(!i)throw new Error(`The selector "${n}" did not match any elements`);return r||(i.textContent=""),i}parentNode(n){return n.parentNode}nextSibling(n){return n.nextSibling}setAttribute(n,r,i,o){if(o){r=o+":"+r;const s=wd[o];s?n.setAttributeNS(s,r,i):n.setAttribute(r,i)}else n.setAttribute(r,i)}removeAttribute(n,r,i){if(i){const o=wd[i];o?n.removeAttributeNS(o,r):n.removeAttribute(`${i}:${r}`)}else n.removeAttribute(r)}addClass(n,r){n.classList.add(r)}removeClass(n,r){n.classList.remove(r)}setStyle(n,r,i,o){o&(Rn.DashCase|Rn.Important)?n.style.setProperty(r,i,o&Rn.Important?"important":""):n.style[r]=i}removeStyle(n,r,i){i&Rn.DashCase?n.style.removeProperty(r):n.style[r]=""}setProperty(n,r,i){n[r]=i}setValue(n,r){n.nodeValue=r}listen(n,r,i){return"string"==typeof n?this.eventManager.addGlobalEventListener(n,r,oy(i)):this.eventManager.addEventListener(n,r,oy(i))}}class SD extends Nd{constructor(n,r,i,o){super(n),this.component=i;const s=sc(o+"-"+i.id,i.styles,[]);r.addStyles(s),this.contentAttr=function yD(t){return"_ngcontent-%COMP%".replace(Dd,t)}(o+"-"+i.id),this.hostAttr=function _D(t){return"_nghost-%COMP%".replace(Dd,t)}(o+"-"+i.id)}applyToHost(n){super.setAttribute(n,this.hostAttr,"")}createElement(n,r){const i=super.createElement(n,r);return super.setAttribute(i,this.contentAttr,""),i}}class bD extends Nd{constructor(n,r,i,o){super(n),this.sharedStylesHost=r,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=sc(o.id,o.styles,[]);for(let a=0;a<s.length;a++){const l=document.createElement("style");l.textContent=s[a],this.shadowRoot.appendChild(l)}}nodeOrShadowRoot(n){return n===this.hostEl?this.shadowRoot:n}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(n,r){return super.appendChild(this.nodeOrShadowRoot(n),r)}insertBefore(n,r,i){return super.insertBefore(this.nodeOrShadowRoot(n),r,i)}removeChild(n,r){return super.removeChild(this.nodeOrShadowRoot(n),r)}parentNode(n){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(n)))}}let CD=(()=>{class t extends ey{constructor(r){super(r)}supports(r){return!0}addEventListener(r,i,o){return r.addEventListener(i,o,!1),()=>this.removeEventListener(r,i,o)}removeEventListener(r,i,o){return r.removeEventListener(i,o)}}return t.\u0275fac=function(r){return new(r||t)(qe(wn))},t.\u0275prov=nt({token:t,factory:t.\u0275fac}),t})();const ay=["alt","control","meta","shift"],RD={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},cy={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},AD={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let ID=(()=>{class t extends ey{constructor(r){super(r)}supports(r){return null!=t.parseEventName(r)}addEventListener(r,i,o){const s=t.parseEventName(i),a=t.eventCallback(s.fullKey,o,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>hr().onAndCancel(r,s.domEventName,a))}static parseEventName(r){const i=r.toLowerCase().split("."),o=i.shift();if(0===i.length||"keydown"!==o&&"keyup"!==o)return null;const s=t._normalizeKey(i.pop());let a="";if(ay.forEach(v=>{const P=i.indexOf(v);P>-1&&(i.splice(P,1),a+=v+".")}),a+=s,0!=i.length||0===s.length)return null;const l={};return l.domEventName=o,l.fullKey=a,l}static getEventFullKey(r){let i="",o=function wD(t){let n=t.key;if(null==n){if(n=t.keyIdentifier,null==n)return"Unidentified";n.startsWith("U+")&&(n=String.fromCharCode(parseInt(n.substring(2),16)),3===t.location&&cy.hasOwnProperty(n)&&(n=cy[n]))}return RD[n]||n}(r);return o=o.toLowerCase()," "===o?o="space":"."===o&&(o="dot"),ay.forEach(s=>{s!=o&&AD[s](r)&&(i+=s+".")}),i+=o,i}static eventCallback(r,i,o){return s=>{t.getEventFullKey(s)===r&&o.runGuarded(()=>i(s))}}static _normalizeKey(r){return"esc"===r?"escape":r}}return t.\u0275fac=function(r){return new(r||t)(qe(wn))},t.\u0275prov=nt({token:t,factory:t.\u0275fac}),t})();const MD=pv(AI,"browser",[{provide:Ga,useValue:"browser"},{provide:iv,useValue:function DD(){Ad.makeCurrent(),Id.init()},multi:!0},{provide:wn,useFactory:function ND(){return function w0(t){Kc=t}(document),document},deps:[]}]),PD=[{provide:ll,useValue:"root"},{provide:Ui,useFactory:function OD(){return new Ui},deps:[]},{provide:ic,useClass:CD,multi:!0,deps:[wn,zt,Ga]},{provide:ic,useClass:ID,multi:!0,deps:[wn]},{provide:Od,useClass:Od,deps:[oc,Ss,gs]},{provide:b1,useExisting:Od},{provide:ty,useExisting:Ss},{provide:Ss,useClass:Ss,deps:[wn]},{provide:rd,useClass:rd,deps:[zt]},{provide:oc,useClass:oc,deps:[ic,zt]},{provide:Qv,useClass:gD,deps:[]}];let LD=(()=>{class t{constructor(r){if(r)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(r){return{ngModule:t,providers:[{provide:gs,useValue:r.appId},{provide:Zv,useExisting:gs},hD]}}}return t.\u0275fac=function(r){return new(r||t)(qe(t,12))},t.\u0275mod=En({type:t}),t.\u0275inj=pn({providers:PD,imports:[rD,PI]}),t})();"undefined"!=typeof window&&window;const dy_agora_appId="9e17cc4e397e4d288d27abc2824354ae";var qD=x(293);class Dn{constructor(n){this.config=n,this.audioDevices=[],this.videoDevices=[],this.AgoraRTC=Dn.AgoraRTC,this.checkSystemRequirements()?this.collectDevices():this.AgoraRTC.Logger.error("Web RTC is not supported in this browser")}checkSystemRequirements(){return this.AgoraRTC.checkSystemRequirements()}createClient(n,r=!0,i,o){return this.client=this.AgoraRTC.createClient(n),r&&this.init(this.config.AppID,i,o),this.client}createStream(n){if(!n.microphoneId&&this.audioDevices&&this.audioDevices.length&&(n.microphoneId=this.audioDevices[0].deviceId),!n.cameraId&&this.videoDevices&&this.videoDevices.length){const r=this.videoDevices[0].deviceId;n.cameraId=n.cameraId||r}return this.AgoraRTC.createStream(n)}init(n,r,i){this.client.init(n,r,i)}collectDevices(){this.AgoraRTC.getDevices(n=>{const r=n.filter(o=>"audioinput"===o.kind&&"default"!==o.deviceId),i=n.filter(o=>"videoinput"===o.kind&&"default"!==o.deviceId);this.audioDevices=r,this.videoDevices=i})}}Dn.\u0275fac=function(n){return new(n||Dn)(qe("config"))},Dn.\u0275prov=nt({token:Dn,factory:Dn.\u0275fac,providedIn:"root"}),Dn.AgoraRTC=qD,Dn.ngInjectableDef=nt({factory:function(){return new Dn(qe("config"))},token:Dn,providedIn:"root"});let zD=(()=>{class t{static forRoot(r){return{ngModule:t,providers:[Dn,{provide:"config",useValue:r}]}}}return t.\u0275fac=function(r){return new(r||t)},t.\u0275mod=En({type:t}),t.\u0275inj=pn({}),t})();const yt={RELAY_OK:0,SERVER_ERROR_RESPONSE:1,SERVER_NO_RESPONSE:2,NO_RESOURCE_AVAILABLE:3,FAILED_JOIN_SRC:4,FAILED_JOIN_DEST:5,FAILED_PACKET_RECEIVED_FROM_SRC:6,FAILED_PACKET_SENT_TO_DEST:7,SERVER_CONNECTION_LOST:8,INTERNAL_ERROR:9,SRC_TOKEN_EXPIRED:10,DEST_TOKEN_EXPIRED:11,RELAY_ALREADY_START:12,RELAY_NOT_START:13};yt[yt.RELAY_OK]="RELAY_OK",yt[yt.SERVER_ERROR_RESPONSE]="SERVER_ERROR_RESPONSE",yt[yt.SERVER_NO_RESPONSE]="SERVER_NO_RESPONSE",yt[yt.NO_RESOURCE_AVAILABLE]="NO_RESOURCE_AVAILABLE",yt[yt.FAILED_JOIN_SRC]="FAILED_JOIN_SRC",yt[yt.FAILED_JOIN_DEST]="FAILED_JOIN_DEST",yt[yt.FAILED_PACKET_RECEIVED_FROM_SRC]="FAILED_PACKET_RECEIVED_FROM_SRC",yt[yt.FAILED_PACKET_SENT_TO_DEST]="FAILED_PACKET_SENT_TO_DEST",yt[yt.SERVER_CONNECTION_LOST]="SERVER_CONNECTION_LOST",yt[yt.INTERNAL_ERROR]="INTERNAL_ERROR",yt[yt.SRC_TOKEN_EXPIRED]="SRC_TOKEN_EXPIRED",yt[yt.DEST_TOKEN_EXPIRED]="DEST_TOKEN_EXPIRED",yt[yt.RELAY_ALREADY_START]="RELAY_ALREADY_START",yt[yt.RELAY_NOT_START]="RELAY_NOT_START";const gr={Debug:0,Info:1,Warning:2,Error:3,None:4};gr[gr.Debug]="Debug",gr[gr.Info]="Info",gr[gr.Warning]="Warning",gr[gr.Error]="Error",gr[gr.None]="None";function rt(...t){return Kt(t,Ao(t))}class tr extends ce{constructor(n){super(),this._value=n}get value(){return this.getValue()}_subscribe(n){const r=super._subscribe(n);return!r.closed&&n.next(this._value),r}getValue(){const{hasError:n,thrownError:r,_value:i}=this;if(n)throw r;return this._throwIfClosed(),i}next(n){super.next(this._value=n)}}const{isArray:JD}=Array,{getPrototypeOf:YD,prototype:KD,keys:$D}=Object;function py(t){if(1===t.length){const n=t[0];if(JD(n))return{args:n,keys:null};if(function XD(t){return t&&"object"==typeof t&&YD(t)===KD}(n)){const r=$D(n);return{args:r.map(i=>n[i]),keys:r}}}return{args:t,keys:null}}const{isArray:QD}=Array;function hy(t){return pe(n=>function ZD(t,n){return QD(n)?t(...n):t(n)}(t,n))}function gy(t,n){return t.reduce((r,i,o)=>(r[i]=n[o],r),{})}function my(t,n,r){t?Er(r,t,n):n()}const ac=C(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function Pd(...t){return function nO(){return Ro(1)}()(Kt(t,Ao(t)))}function vy(t){return new d(n=>{Nt(t()).subscribe(n)})}function yy(){return V((t,n)=>{let r=null;t._refCount++;const i=new q(n,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount)return void(r=null);const o=t._connection,s=r;r=null,o&&(!s||o===s)&&o.unsubscribe(),n.unsubscribe()});t.subscribe(i),i.closed||(r=t.connect())})}class rO extends d{constructor(n,r){super(),this.source=n,this.subjectFactory=r,this._subject=null,this._refCount=0,this._connection=null,U(n)&&(this.lift=n.lift)}_subscribe(n){return this.getSubject().subscribe(n)}getSubject(){const n=this._subject;return(!n||n.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:n}=this;this._subject=this._connection=null,null==n||n.unsubscribe()}connect(){let n=this._connection;if(!n){n=this._connection=new D;const r=this.getSubject();n.add(this.source.subscribe(new q(r,void 0,()=>{this._teardown(),r.complete()},i=>{this._teardown(),r.error(i)},()=>this._teardown()))),n.closed&&(this._connection=null,n=D.EMPTY)}return n}refCount(){return yy()(this)}}function fi(t,n){return V((r,i)=>{let o=null,s=0,a=!1;const l=()=>a&&!o&&i.complete();r.subscribe(new q(i,v=>{null==o||o.unsubscribe();let P=0;const W=s++;Nt(t(v,W)).subscribe(o=new q(i,X=>i.next(n?n(v,X,W,P++):X),()=>{o=null,l()}))},()=>{a=!0,l()}))})}function oO(t,n,r,i,o){return(s,a)=>{let l=r,v=n,P=0;s.subscribe(new q(a,W=>{const X=P++;v=l?t(v,W,X):(l=!0,W),i&&a.next(v)},o&&(()=>{l&&a.next(v),a.complete()})))}}function _y(t,n){return V(oO(t,n,arguments.length>=2,!0))}function pi(t,n){return V((r,i)=>{let o=0;r.subscribe(new q(i,s=>t.call(n,s,o++)&&i.next(s)))})}function Yr(t){return V((n,r)=>{let s,i=null,o=!1;i=n.subscribe(new q(r,void 0,void 0,a=>{s=Nt(t(a,Yr(t)(n))),i?(i.unsubscribe(),i=null,s.subscribe(r)):o=!0})),o&&(i.unsubscribe(),i=null,s.subscribe(r))})}function yo(t,n){return I(n)?Yt(t,n,1):Yt(t,1)}function Ld(t){return t<=0?()=>Sr:V((n,r)=>{let i=[];n.subscribe(new q(r,o=>{i.push(o),t<i.length&&i.shift()},()=>{for(const o of i)r.next(o);r.complete()},void 0,()=>{i=null}))})}function Ey(t=sO){return V((n,r)=>{let i=!1;n.subscribe(new q(r,o=>{i=!0,r.next(o)},()=>i?r.complete():r.error(t())))})}function sO(){return new ac}function Sy(t){return V((n,r)=>{let i=!1;n.subscribe(new q(r,o=>{i=!0,r.next(o)},()=>{i||r.next(t),r.complete()}))})}function _o(t,n){const r=arguments.length>=2;return i=>i.pipe(t?pi((o,s)=>t(o,s,i)):S,Us(1),r?Sy(n):Ey(()=>new ac))}function On(t,n,r){const i=I(t)||n||r?{next:t,error:n,complete:r}:t;return i?V((o,s)=>{var a;null===(a=i.subscribe)||void 0===a||a.call(i);let l=!0;o.subscribe(new q(s,v=>{var P;null===(P=i.next)||void 0===P||P.call(i,v),s.next(v)},()=>{var v;l=!1,null===(v=i.complete)||void 0===v||v.call(i),s.complete()},v=>{var P;l=!1,null===(P=i.error)||void 0===P||P.call(i,v),s.error(v)},()=>{var v,P;l&&(null===(v=i.unsubscribe)||void 0===v||v.call(i)),null===(P=i.finalize)||void 0===P||P.call(i)}))}):S}class Pr{constructor(n,r){this.id=n,this.url=r}}class kd extends Pr{constructor(n,r,i="imperative",o=null){super(n,r),this.navigationTrigger=i,this.restoredState=o}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class bs extends Pr{constructor(n,r,i){super(n,r),this.urlAfterRedirects=i}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class by extends Pr{constructor(n,r,i){super(n,r),this.reason=i}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class uO extends Pr{constructor(n,r,i){super(n,r),this.error=i}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class lO extends Pr{constructor(n,r,i,o){super(n,r),this.urlAfterRedirects=i,this.state=o}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class dO extends Pr{constructor(n,r,i,o){super(n,r),this.urlAfterRedirects=i,this.state=o}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class fO extends Pr{constructor(n,r,i,o,s){super(n,r),this.urlAfterRedirects=i,this.state=o,this.shouldActivate=s}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class pO extends Pr{constructor(n,r,i,o){super(n,r),this.urlAfterRedirects=i,this.state=o}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class hO extends Pr{constructor(n,r,i,o){super(n,r),this.urlAfterRedirects=i,this.state=o}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Cy{constructor(n){this.route=n}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Ty{constructor(n){this.route=n}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class gO{constructor(n){this.snapshot=n}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class mO{constructor(n){this.snapshot=n}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class vO{constructor(n){this.snapshot=n}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class yO{constructor(n){this.snapshot=n}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Ry{constructor(n,r,i){this.routerEvent=n,this.position=r,this.anchor=i}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const lt="primary";class _O{constructor(n){this.params=n||{}}has(n){return Object.prototype.hasOwnProperty.call(this.params,n)}get(n){if(this.has(n)){const r=this.params[n];return Array.isArray(r)?r[0]:r}return null}getAll(n){if(this.has(n)){const r=this.params[n];return Array.isArray(r)?r:[r]}return[]}get keys(){return Object.keys(this.params)}}function Eo(t){return new _O(t)}const Ay="ngNavigationCancelingError";function xd(t){const n=Error("NavigationCancelingError: "+t);return n[Ay]=!0,n}function SO(t,n,r){const i=r.path.split("/");if(i.length>t.length||"full"===r.pathMatch&&(n.hasChildren()||i.length<t.length))return null;const o={};for(let s=0;s<i.length;s++){const a=i[s],l=t[s];if(a.startsWith(":"))o[a.substring(1)]=l;else if(a!==l.path)return null}return{consumed:t.slice(0,i.length),posParams:o}}function mr(t,n){const r=t?Object.keys(t):void 0,i=n?Object.keys(n):void 0;if(!r||!i||r.length!=i.length)return!1;let o;for(let s=0;s<r.length;s++)if(o=r[s],!Iy(t[o],n[o]))return!1;return!0}function Iy(t,n){if(Array.isArray(t)&&Array.isArray(n)){if(t.length!==n.length)return!1;const r=[...t].sort(),i=[...n].sort();return r.every((o,s)=>i[s]===o)}return t===n}function wy(t){return Array.prototype.concat.apply([],t)}function Dy(t){return t.length>0?t[t.length-1]:null}function Qt(t,n){for(const r in t)t.hasOwnProperty(r)&&n(t[r],r)}function vr(t){return Cl(t)?t:rs(t)?Kt(Promise.resolve(t)):rt(t)}const TO={exact:function My(t,n,r){if(!gi(t.segments,n.segments)||!cc(t.segments,n.segments,r)||t.numberOfChildren!==n.numberOfChildren)return!1;for(const i in n.children)if(!t.children[i]||!My(t.children[i],n.children[i],r))return!1;return!0},subset:Py},Oy={exact:function RO(t,n){return mr(t,n)},subset:function AO(t,n){return Object.keys(n).length<=Object.keys(t).length&&Object.keys(n).every(r=>Iy(t[r],n[r]))},ignored:()=>!0};function Ny(t,n,r){return TO[r.paths](t.root,n.root,r.matrixParams)&&Oy[r.queryParams](t.queryParams,n.queryParams)&&!("exact"===r.fragment&&t.fragment!==n.fragment)}function Py(t,n,r){return Ly(t,n,n.segments,r)}function Ly(t,n,r,i){if(t.segments.length>r.length){const o=t.segments.slice(0,r.length);return!(!gi(o,r)||n.hasChildren()||!cc(o,r,i))}if(t.segments.length===r.length){if(!gi(t.segments,r)||!cc(t.segments,r,i))return!1;for(const o in n.children)if(!t.children[o]||!Py(t.children[o],n.children[o],i))return!1;return!0}{const o=r.slice(0,t.segments.length),s=r.slice(t.segments.length);return!!(gi(t.segments,o)&&cc(t.segments,o,i)&&t.children[lt])&&Ly(t.children[lt],n,s,i)}}function cc(t,n,r){return n.every((i,o)=>Oy[r](t[o].parameters,i.parameters))}class hi{constructor(n,r,i){this.root=n,this.queryParams=r,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Eo(this.queryParams)),this._queryParamMap}toString(){return DO.serialize(this)}}class ft{constructor(n,r){this.segments=n,this.children=r,this.parent=null,Qt(r,(i,o)=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return uc(this)}}class Cs{constructor(n,r){this.path=n,this.parameters=r}get parameterMap(){return this._parameterMap||(this._parameterMap=Eo(this.parameters)),this._parameterMap}toString(){return jy(this)}}function gi(t,n){return t.length===n.length&&t.every((r,i)=>r.path===n[i].path)}class ky{}class xy{parse(n){const r=new VO(n);return new hi(r.parseRootSegment(),r.parseQueryParams(),r.parseFragment())}serialize(n){const r=`/${Ts(n.root,!0)}`,i=function MO(t){const n=Object.keys(t).map(r=>{const i=t[r];return Array.isArray(i)?i.map(o=>`${lc(r)}=${lc(o)}`).join("&"):`${lc(r)}=${lc(i)}`}).filter(r=>!!r);return n.length?`?${n.join("&")}`:""}(n.queryParams);return`${r}${i}${"string"==typeof n.fragment?`#${function OO(t){return encodeURI(t)}(n.fragment)}`:""}`}}const DO=new xy;function uc(t){return t.segments.map(n=>jy(n)).join("/")}function Ts(t,n){if(!t.hasChildren())return uc(t);if(n){const r=t.children[lt]?Ts(t.children[lt],!1):"",i=[];return Qt(t.children,(o,s)=>{s!==lt&&i.push(`${s}:${Ts(o,!1)}`)}),i.length>0?`${r}(${i.join("//")})`:r}{const r=function wO(t,n){let r=[];return Qt(t.children,(i,o)=>{o===lt&&(r=r.concat(n(i,o)))}),Qt(t.children,(i,o)=>{o!==lt&&(r=r.concat(n(i,o)))}),r}(t,(i,o)=>o===lt?[Ts(t.children[lt],!1)]:[`${o}:${Ts(i,!1)}`]);return 1===Object.keys(t.children).length&&null!=t.children[lt]?`${uc(t)}/${r[0]}`:`${uc(t)}/(${r.join("//")})`}}function Fy(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function lc(t){return Fy(t).replace(/%3B/gi,";")}function Fd(t){return Fy(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function dc(t){return decodeURIComponent(t)}function Vy(t){return dc(t.replace(/\+/g,"%20"))}function jy(t){return`${Fd(t.path)}${function NO(t){return Object.keys(t).map(n=>`;${Fd(n)}=${Fd(t[n])}`).join("")}(t.parameters)}`}const PO=/^[^\/()?;=#]+/;function fc(t){const n=t.match(PO);return n?n[0]:""}const LO=/^[^=?&#]+/,xO=/^[^&#]+/;class VO{constructor(n){this.url=n,this.remaining=n}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new ft([],{}):new ft([],this.parseChildren())}parseQueryParams(){const n={};if(this.consumeOptional("?"))do{this.parseQueryParam(n)}while(this.consumeOptional("&"));return n}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const n=[];for(this.peekStartsWith("(")||n.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),n.push(this.parseSegment());let r={};this.peekStartsWith("/(")&&(this.capture("/"),r=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(n.length>0||Object.keys(r).length>0)&&(i[lt]=new ft(n,r)),i}parseSegment(){const n=fc(this.remaining);if(""===n&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(n),new Cs(dc(n),this.parseMatrixParams())}parseMatrixParams(){const n={};for(;this.consumeOptional(";");)this.parseParam(n);return n}parseParam(n){const r=fc(this.remaining);if(!r)return;this.capture(r);let i="";if(this.consumeOptional("=")){const o=fc(this.remaining);o&&(i=o,this.capture(i))}n[dc(r)]=dc(i)}parseQueryParam(n){const r=function kO(t){const n=t.match(LO);return n?n[0]:""}(this.remaining);if(!r)return;this.capture(r);let i="";if(this.consumeOptional("=")){const a=function FO(t){const n=t.match(xO);return n?n[0]:""}(this.remaining);a&&(i=a,this.capture(i))}const o=Vy(r),s=Vy(i);if(n.hasOwnProperty(o)){let a=n[o];Array.isArray(a)||(a=[a],n[o]=a),a.push(s)}else n[o]=s}parseParens(n){const r={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=fc(this.remaining),o=this.remaining[i.length];if("/"!==o&&")"!==o&&";"!==o)throw new Error(`Cannot parse url '${this.url}'`);let s;i.indexOf(":")>-1?(s=i.substr(0,i.indexOf(":")),this.capture(s),this.capture(":")):n&&(s=lt);const a=this.parseChildren();r[s]=1===Object.keys(a).length?a[lt]:new ft([],a),this.consumeOptional("//")}return r}peekStartsWith(n){return this.remaining.startsWith(n)}consumeOptional(n){return!!this.peekStartsWith(n)&&(this.remaining=this.remaining.substring(n.length),!0)}capture(n){if(!this.consumeOptional(n))throw new Error(`Expected "${n}".`)}}class Uy{constructor(n){this._root=n}get root(){return this._root.value}parent(n){const r=this.pathFromRoot(n);return r.length>1?r[r.length-2]:null}children(n){const r=Vd(n,this._root);return r?r.children.map(i=>i.value):[]}firstChild(n){const r=Vd(n,this._root);return r&&r.children.length>0?r.children[0].value:null}siblings(n){const r=jd(n,this._root);return r.length<2?[]:r[r.length-2].children.map(o=>o.value).filter(o=>o!==n)}pathFromRoot(n){return jd(n,this._root).map(r=>r.value)}}function Vd(t,n){if(t===n.value)return n;for(const r of n.children){const i=Vd(t,r);if(i)return i}return null}function jd(t,n){if(t===n.value)return[n];for(const r of n.children){const i=jd(t,r);if(i.length)return i.unshift(n),i}return[]}class Lr{constructor(n,r){this.value=n,this.children=r}toString(){return`TreeNode(${this.value})`}}function So(t){const n={};return t&&t.children.forEach(r=>n[r.value.outlet]=r),n}class By extends Uy{constructor(n,r){super(n),this.snapshot=r,Ud(this,n)}toString(){return this.snapshot.toString()}}function Hy(t,n){const r=function jO(t,n){const a=new pc([],{},{},"",{},lt,n,null,t.root,-1,{});return new Wy("",new Lr(a,[]))}(t,n),i=new tr([new Cs("",{})]),o=new tr({}),s=new tr({}),a=new tr({}),l=new tr(""),v=new bo(i,o,a,l,s,lt,n,r.root);return v.snapshot=r.root,new By(new Lr(v,[]),r)}class bo{constructor(n,r,i,o,s,a,l,v){this.url=n,this.params=r,this.queryParams=i,this.fragment=o,this.data=s,this.outlet=a,this.component=l,this._futureSnapshot=v}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(pe(n=>Eo(n)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(pe(n=>Eo(n)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Gy(t,n="emptyOnly"){const r=t.pathFromRoot;let i=0;if("always"!==n)for(i=r.length-1;i>=1;){const o=r[i],s=r[i-1];if(o.routeConfig&&""===o.routeConfig.path)i--;else{if(s.component)break;i--}}return function UO(t){return t.reduce((n,r)=>({params:Object.assign(Object.assign({},n.params),r.params),data:Object.assign(Object.assign({},n.data),r.data),resolve:Object.assign(Object.assign({},n.resolve),r._resolvedData)}),{params:{},data:{},resolve:{}})}(r.slice(i))}class pc{constructor(n,r,i,o,s,a,l,v,P,W,X){this.url=n,this.params=r,this.queryParams=i,this.fragment=o,this.data=s,this.outlet=a,this.component=l,this.routeConfig=v,this._urlSegment=P,this._lastPathIndex=W,this._resolve=X}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Eo(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Eo(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class Wy extends Uy{constructor(n,r){super(r),this.url=n,Ud(this,r)}toString(){return qy(this._root)}}function Ud(t,n){n.value._routerState=t,n.children.forEach(r=>Ud(t,r))}function qy(t){const n=t.children.length>0?` { ${t.children.map(qy).join(", ")} } `:"";return`${t.value}${n}`}function Bd(t){if(t.snapshot){const n=t.snapshot,r=t._futureSnapshot;t.snapshot=r,mr(n.queryParams,r.queryParams)||t.queryParams.next(r.queryParams),n.fragment!==r.fragment&&t.fragment.next(r.fragment),mr(n.params,r.params)||t.params.next(r.params),function bO(t,n){if(t.length!==n.length)return!1;for(let r=0;r<t.length;++r)if(!mr(t[r],n[r]))return!1;return!0}(n.url,r.url)||t.url.next(r.url),mr(n.data,r.data)||t.data.next(r.data)}else t.snapshot=t._futureSnapshot,t.data.next(t._futureSnapshot.data)}function Hd(t,n){const r=mr(t.params,n.params)&&function IO(t,n){return gi(t,n)&&t.every((r,i)=>mr(r.parameters,n[i].parameters))}(t.url,n.url);return r&&!(!t.parent!=!n.parent)&&(!t.parent||Hd(t.parent,n.parent))}function Rs(t,n,r){if(r&&t.shouldReuseRoute(n.value,r.value.snapshot)){const i=r.value;i._futureSnapshot=n.value;const o=function HO(t,n,r){return n.children.map(i=>{for(const o of r.children)if(t.shouldReuseRoute(i.value,o.value.snapshot))return Rs(t,i,o);return Rs(t,i)})}(t,n,r);return new Lr(i,o)}{if(t.shouldAttach(n.value)){const s=t.retrieve(n.value);if(null!==s){const a=s.route;return a.value._futureSnapshot=n.value,a.children=n.children.map(l=>Rs(t,l)),a}}const i=function GO(t){return new bo(new tr(t.url),new tr(t.params),new tr(t.queryParams),new tr(t.fragment),new tr(t.data),t.outlet,t.component,t)}(n.value),o=n.children.map(s=>Rs(t,s));return new Lr(i,o)}}function hc(t){return"object"==typeof t&&null!=t&&!t.outlets&&!t.segmentPath}function As(t){return"object"==typeof t&&null!=t&&t.outlets}function Gd(t,n,r,i,o){let s={};return i&&Qt(i,(a,l)=>{s[l]=Array.isArray(a)?a.map(v=>`${v}`):`${a}`}),new hi(r.root===t?n:zy(r.root,t,n),s,o)}function zy(t,n,r){const i={};return Qt(t.children,(o,s)=>{i[s]=o===n?r:zy(o,n,r)}),new ft(t.segments,i)}class Jy{constructor(n,r,i){if(this.isAbsolute=n,this.numberOfDoubleDots=r,this.commands=i,n&&i.length>0&&hc(i[0]))throw new Error("Root segment cannot have matrix parameters");const o=i.find(As);if(o&&o!==Dy(i))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Wd{constructor(n,r,i){this.segmentGroup=n,this.processChildren=r,this.index=i}}function Yy(t,n,r){if(t||(t=new ft([],{})),0===t.segments.length&&t.hasChildren())return gc(t,n,r);const i=function KO(t,n,r){let i=0,o=n;const s={match:!1,pathIndex:0,commandIndex:0};for(;o<t.segments.length;){if(i>=r.length)return s;const a=t.segments[o],l=r[i];if(As(l))break;const v=`${l}`,P=i<r.length-1?r[i+1]:null;if(o>0&&void 0===v)break;if(v&&P&&"object"==typeof P&&void 0===P.outlets){if(!$y(v,P,a))return s;i+=2}else{if(!$y(v,{},a))return s;i++}o++}return{match:!0,pathIndex:o,commandIndex:i}}(t,n,r),o=r.slice(i.commandIndex);if(i.match&&i.pathIndex<t.segments.length){const s=new ft(t.segments.slice(0,i.pathIndex),{});return s.children[lt]=new ft(t.segments.slice(i.pathIndex),t.children),gc(s,0,o)}return i.match&&0===o.length?new ft(t.segments,{}):i.match&&!t.hasChildren()?qd(t,n,r):i.match?gc(t,0,o):qd(t,n,r)}function gc(t,n,r){if(0===r.length)return new ft(t.segments,{});{const i=function YO(t){return As(t[0])?t[0].outlets:{[lt]:t}}(r),o={};return Qt(i,(s,a)=>{"string"==typeof s&&(s=[s]),null!==s&&(o[a]=Yy(t.children[a],n,s))}),Qt(t.children,(s,a)=>{void 0===i[a]&&(o[a]=s)}),new ft(t.segments,o)}}function qd(t,n,r){const i=t.segments.slice(0,n);let o=0;for(;o<r.length;){const s=r[o];if(As(s)){const v=$O(s.outlets);return new ft(i,v)}if(0===o&&hc(r[0])){i.push(new Cs(t.segments[n].path,Ky(r[0]))),o++;continue}const a=As(s)?s.outlets[lt]:`${s}`,l=o<r.length-1?r[o+1]:null;a&&l&&hc(l)?(i.push(new Cs(a,Ky(l))),o+=2):(i.push(new Cs(a,{})),o++)}return new ft(i,{})}function $O(t){const n={};return Qt(t,(r,i)=>{"string"==typeof r&&(r=[r]),null!==r&&(n[i]=qd(new ft([],{}),0,r))}),n}function Ky(t){const n={};return Qt(t,(r,i)=>n[i]=`${r}`),n}function $y(t,n,r){return t==r.path&&mr(n,r.parameters)}class QO{constructor(n,r,i,o){this.routeReuseStrategy=n,this.futureState=r,this.currState=i,this.forwardEvent=o}activate(n){const r=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(r,i,n),Bd(this.futureState.root),this.activateChildRoutes(r,i,n)}deactivateChildRoutes(n,r,i){const o=So(r);n.children.forEach(s=>{const a=s.value.outlet;this.deactivateRoutes(s,o[a],i),delete o[a]}),Qt(o,(s,a)=>{this.deactivateRouteAndItsChildren(s,i)})}deactivateRoutes(n,r,i){const o=n.value,s=r?r.value:null;if(o===s)if(o.component){const a=i.getContext(o.outlet);a&&this.deactivateChildRoutes(n,r,a.children)}else this.deactivateChildRoutes(n,r,i);else s&&this.deactivateRouteAndItsChildren(r,i)}deactivateRouteAndItsChildren(n,r){n.value.component&&this.routeReuseStrategy.shouldDetach(n.value.snapshot)?this.detachAndStoreRouteSubtree(n,r):this.deactivateRouteAndOutlet(n,r)}detachAndStoreRouteSubtree(n,r){const i=r.getContext(n.value.outlet),o=i&&n.value.component?i.children:r,s=So(n);for(const a of Object.keys(s))this.deactivateRouteAndItsChildren(s[a],o);if(i&&i.outlet){const a=i.outlet.detach(),l=i.children.onOutletDeactivated();this.routeReuseStrategy.store(n.value.snapshot,{componentRef:a,route:n,contexts:l})}}deactivateRouteAndOutlet(n,r){const i=r.getContext(n.value.outlet),o=i&&n.value.component?i.children:r,s=So(n);for(const a of Object.keys(s))this.deactivateRouteAndItsChildren(s[a],o);i&&i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated(),i.attachRef=null,i.resolver=null,i.route=null)}activateChildRoutes(n,r,i){const o=So(r);n.children.forEach(s=>{this.activateRoutes(s,o[s.value.outlet],i),this.forwardEvent(new yO(s.value.snapshot))}),n.children.length&&this.forwardEvent(new mO(n.value.snapshot))}activateRoutes(n,r,i){const o=n.value,s=r?r.value:null;if(Bd(o),o===s)if(o.component){const a=i.getOrCreateContext(o.outlet);this.activateChildRoutes(n,r,a.children)}else this.activateChildRoutes(n,r,i);else if(o.component){const a=i.getOrCreateContext(o.outlet);if(this.routeReuseStrategy.shouldAttach(o.snapshot)){const l=this.routeReuseStrategy.retrieve(o.snapshot);this.routeReuseStrategy.store(o.snapshot,null),a.children.onOutletReAttached(l.contexts),a.attachRef=l.componentRef,a.route=l.route.value,a.outlet&&a.outlet.attach(l.componentRef,l.route.value),Bd(l.route.value),this.activateChildRoutes(n,null,a.children)}else{const l=function ZO(t){for(let n=t.parent;n;n=n.parent){const r=n.routeConfig;if(r&&r._loadedConfig)return r._loadedConfig;if(r&&r.component)return null}return null}(o.snapshot),v=l?l.module.componentFactoryResolver:null;a.attachRef=null,a.route=o,a.resolver=v,a.outlet&&a.outlet.activateWith(o,v),this.activateChildRoutes(n,null,a.children)}}else this.activateChildRoutes(n,null,i)}}class zd{constructor(n,r){this.routes=n,this.module=r}}function Kr(t){return"function"==typeof t}function mi(t){return t instanceof hi}const Is=Symbol("INITIAL_VALUE");function ws(){return fi(t=>function eO(...t){const n=Ao(t),r=Hf(t),{args:i,keys:o}=py(t);if(0===i.length)return Kt([],n);const s=new d(function tO(t,n,r=S){return i=>{my(n,()=>{const{length:o}=t,s=new Array(o);let a=o,l=o;for(let v=0;v<o;v++)my(n,()=>{const P=Kt(t[v],n);let W=!1;P.subscribe(new q(i,X=>{s[v]=X,W||(W=!0,l--),l||i.next(r(s.slice()))},()=>{--a||i.complete()}))},i)},i)}}(i,n,o?a=>gy(o,a):S));return r?s.pipe(hy(r)):s}(t.map(n=>n.pipe(Us(1),function iO(...t){const n=Ao(t);return V((r,i)=>{(n?Pd(t,r,n):Pd(t,r)).subscribe(i)})}(Is)))).pipe(_y((n,r)=>{let i=!1;return r.reduce((o,s,a)=>o!==Is?o:(s===Is&&(i=!0),i||!1!==s&&a!==r.length-1&&!mi(s)?o:s),n)},Is),pi(n=>n!==Is),pe(n=>mi(n)?n:!0===n),Us(1)))}class oN{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new Ds,this.attachRef=null}}class Ds{constructor(){this.contexts=new Map}onChildOutletCreated(n,r){const i=this.getOrCreateContext(n);i.outlet=r,this.contexts.set(n,i)}onChildOutletDestroyed(n){const r=this.getContext(n);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){const n=this.contexts;return this.contexts=new Map,n}onOutletReAttached(n){this.contexts=n}getOrCreateContext(n){let r=this.getContext(n);return r||(r=new oN,this.contexts.set(n,r)),r}getContext(n){return this.contexts.get(n)||null}}let Jd=(()=>{class t{constructor(r,i,o,s,a){this.parentContexts=r,this.location=i,this.resolver=o,this.changeDetector=a,this.activated=null,this._activatedRoute=null,this.activateEvents=new kt,this.deactivateEvents=new kt,this.attachEvents=new kt,this.detachEvents=new kt,this.name=s||lt,r.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const r=this.parentContexts.getContext(this.name);r&&r.route&&(r.attachRef?this.attach(r.attachRef,r.route):this.activateWith(r.route,r.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const r=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(r.instance),r}attach(r,i){this.activated=r,this._activatedRoute=i,this.location.insert(r.hostView),this.attachEvents.emit(r.instance)}deactivate(){if(this.activated){const r=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(r)}}activateWith(r,i){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=r;const a=(i=i||this.resolver).resolveComponentFactory(r._futureSnapshot.routeConfig.component),l=this.parentContexts.getOrCreateContext(this.name).children,v=new sN(r,l,this.location.injector);this.activated=this.location.createComponent(a,this.location.length,v),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return t.\u0275fac=function(r){return new(r||t)(Me(Ds),Me(Xn),Me(uo),function Fo(t){return function sS(t,n){if("class"===n)return t.classes;if("style"===n)return t.styles;const r=t.attrs;if(r){const i=r.length;let o=0;for(;o<i;){const s=r[o];if(bp(s))break;if(0===s)o+=2;else if("number"==typeof s)for(o++;o<i&&"string"==typeof r[o];)o++;else{if(s===n)return r[o+1];o+=2}}}return null}(Gt(),t)}("name"),Me(sd))},t.\u0275dir=Xe({type:t,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"]}),t})();class sN{constructor(n,r,i){this.route=n,this.childContexts=r,this.parent=i}get(n,r){return n===bo?this.route:n===Ds?this.childContexts:this.parent.get(n,r)}}let Xy=(()=>{class t{}return t.\u0275fac=function(r){return new(r||t)},t.\u0275cmp=wo({type:t,selectors:[["ng-component"]],decls:1,vars:0,template:function(r,i){1&r&&oo(0,"router-outlet")},directives:[Jd],encapsulation:2}),t})();function Qy(t,n=""){for(let r=0;r<t.length;r++){const i=t[r];aN(i,cN(n,i))}}function aN(t,n){t.children&&Qy(t.children,n)}function cN(t,n){return n?t||n.path?t&&!n.path?`${t}/`:!t&&n.path?n.path:`${t}/${n.path}`:"":t}function Yd(t){const n=t.children&&t.children.map(Yd),r=n?Object.assign(Object.assign({},t),{children:n}):Object.assign({},t);return!r.component&&(n||r.loadChildren)&&r.outlet&&r.outlet!==lt&&(r.component=Xy),r}function Bn(t){return t.outlet||lt}function Zy(t,n){const r=t.filter(i=>Bn(i)===n);return r.push(...t.filter(i=>Bn(i)!==n)),r}const e_={matched:!1,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};function mc(t,n,r){var i;if(""===n.path)return"full"===n.pathMatch&&(t.hasChildren()||r.length>0)?Object.assign({},e_):{matched:!0,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};const s=(n.matcher||SO)(r,t,n);if(!s)return Object.assign({},e_);const a={};Qt(s.posParams,(v,P)=>{a[P]=v.path});const l=s.consumed.length>0?Object.assign(Object.assign({},a),s.consumed[s.consumed.length-1].parameters):a;return{matched:!0,consumedSegments:s.consumed,lastChild:s.consumed.length,parameters:l,positionalParamSegments:null!==(i=s.posParams)&&void 0!==i?i:{}}}function vc(t,n,r,i,o="corrected"){if(r.length>0&&function dN(t,n,r){return r.some(i=>yc(t,n,i)&&Bn(i)!==lt)}(t,r,i)){const a=new ft(n,function lN(t,n,r,i){const o={};o[lt]=i,i._sourceSegment=t,i._segmentIndexShift=n.length;for(const s of r)if(""===s.path&&Bn(s)!==lt){const a=new ft([],{});a._sourceSegment=t,a._segmentIndexShift=n.length,o[Bn(s)]=a}return o}(t,n,i,new ft(r,t.children)));return a._sourceSegment=t,a._segmentIndexShift=n.length,{segmentGroup:a,slicedSegments:[]}}if(0===r.length&&function fN(t,n,r){return r.some(i=>yc(t,n,i))}(t,r,i)){const a=new ft(t.segments,function uN(t,n,r,i,o,s){const a={};for(const l of i)if(yc(t,r,l)&&!o[Bn(l)]){const v=new ft([],{});v._sourceSegment=t,v._segmentIndexShift="legacy"===s?t.segments.length:n.length,a[Bn(l)]=v}return Object.assign(Object.assign({},o),a)}(t,n,r,i,t.children,o));return a._sourceSegment=t,a._segmentIndexShift=n.length,{segmentGroup:a,slicedSegments:r}}const s=new ft(t.segments,t.children);return s._sourceSegment=t,s._segmentIndexShift=n.length,{segmentGroup:s,slicedSegments:r}}function yc(t,n,r){return(!(t.hasChildren()||n.length>0)||"full"!==r.pathMatch)&&""===r.path}function t_(t,n,r,i){return!!(Bn(t)===i||i!==lt&&yc(n,r,t))&&("**"===t.path||mc(n,t,r).matched)}function n_(t,n,r){return 0===n.length&&!t.children[r]}class Os{constructor(n){this.segmentGroup=n||null}}class r_{constructor(n){this.urlTree=n}}function _c(t){return new d(n=>n.error(new Os(t)))}function i_(t){return new d(n=>n.error(new r_(t)))}function pN(t){return new d(n=>n.error(new Error(`Only absolute redirects can have named outlets. redirectTo: '${t}'`)))}class mN{constructor(n,r,i,o,s){this.configLoader=r,this.urlSerializer=i,this.urlTree=o,this.config=s,this.allowRedirects=!0,this.ngModule=n.get(Dr)}apply(){const n=vc(this.urlTree.root,[],[],this.config).segmentGroup,r=new ft(n.segments,n.children);return this.expandSegmentGroup(this.ngModule,this.config,r,lt).pipe(pe(s=>this.createUrlTree(Kd(s),this.urlTree.queryParams,this.urlTree.fragment))).pipe(Yr(s=>{if(s instanceof r_)return this.allowRedirects=!1,this.match(s.urlTree);throw s instanceof Os?this.noMatchError(s):s}))}match(n){return this.expandSegmentGroup(this.ngModule,this.config,n.root,lt).pipe(pe(o=>this.createUrlTree(Kd(o),n.queryParams,n.fragment))).pipe(Yr(o=>{throw o instanceof Os?this.noMatchError(o):o}))}noMatchError(n){return new Error(`Cannot match any routes. URL Segment: '${n.segmentGroup}'`)}createUrlTree(n,r,i){const o=n.segments.length>0?new ft([],{[lt]:n}):n;return new hi(o,r,i)}expandSegmentGroup(n,r,i,o){return 0===i.segments.length&&i.hasChildren()?this.expandChildren(n,r,i).pipe(pe(s=>new ft([],s))):this.expandSegment(n,i,r,i.segments,o,!0)}expandChildren(n,r,i){const o=[];for(const s of Object.keys(i.children))"primary"===s?o.unshift(s):o.push(s);return Kt(o).pipe(yo(s=>{const a=i.children[s],l=Zy(r,s);return this.expandSegmentGroup(n,l,a,s).pipe(pe(v=>({segment:v,outlet:s})))}),_y((s,a)=>(s[a.outlet]=a.segment,s),{}),function aO(t,n){const r=arguments.length>=2;return i=>i.pipe(t?pi((o,s)=>t(o,s,i)):S,Ld(1),r?Sy(n):Ey(()=>new ac))}())}expandSegment(n,r,i,o,s,a){return Kt(i).pipe(yo(l=>this.expandSegmentAgainstRoute(n,r,i,l,o,s,a).pipe(Yr(P=>{if(P instanceof Os)return rt(null);throw P}))),_o(l=>!!l),Yr((l,v)=>{if(l instanceof ac||"EmptyError"===l.name){if(n_(r,o,s))return rt(new ft([],{}));throw new Os(r)}throw l}))}expandSegmentAgainstRoute(n,r,i,o,s,a,l){return t_(o,r,s,a)?void 0===o.redirectTo?this.matchSegmentAgainstRoute(n,r,o,s,a):l&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(n,r,i,o,s,a):_c(r):_c(r)}expandSegmentAgainstRouteUsingRedirect(n,r,i,o,s,a){return"**"===o.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(n,i,o,a):this.expandRegularSegmentAgainstRouteUsingRedirect(n,r,i,o,s,a)}expandWildCardWithParamsAgainstRouteUsingRedirect(n,r,i,o){const s=this.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?i_(s):this.lineralizeSegments(i,s).pipe(Yt(a=>{const l=new ft(a,{});return this.expandSegment(n,l,r,a,o,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(n,r,i,o,s,a){const{matched:l,consumedSegments:v,lastChild:P,positionalParamSegments:W}=mc(r,o,s);if(!l)return _c(r);const X=this.applyRedirectCommands(v,o.redirectTo,W);return o.redirectTo.startsWith("/")?i_(X):this.lineralizeSegments(o,X).pipe(Yt(ue=>this.expandSegment(n,r,i,ue.concat(s.slice(P)),a,!1)))}matchSegmentAgainstRoute(n,r,i,o,s){if("**"===i.path)return i.loadChildren?(i._loadedConfig?rt(i._loadedConfig):this.configLoader.load(n.injector,i)).pipe(pe(ue=>(i._loadedConfig=ue,new ft(o,{})))):rt(new ft(o,{}));const{matched:a,consumedSegments:l,lastChild:v}=mc(r,i,o);if(!a)return _c(r);const P=o.slice(v);return this.getChildConfig(n,i,o).pipe(Yt(X=>{const ue=X.module,he=X.routes,{segmentGroup:Se,slicedSegments:we}=vc(r,l,P,he),De=new ft(Se.segments,Se.children);if(0===we.length&&De.hasChildren())return this.expandChildren(ue,he,De).pipe(pe(Ke=>new ft(l,Ke)));if(0===he.length&&0===we.length)return rt(new ft(l,{}));const Oe=Bn(i)===s;return this.expandSegment(ue,De,he,we,Oe?lt:s,!0).pipe(pe(He=>new ft(l.concat(He.segments),He.children)))}))}getChildConfig(n,r,i){return r.children?rt(new zd(r.children,n)):r.loadChildren?void 0!==r._loadedConfig?rt(r._loadedConfig):this.runCanLoadGuards(n.injector,r,i).pipe(Yt(o=>o?this.configLoader.load(n.injector,r).pipe(pe(s=>(r._loadedConfig=s,s))):function hN(t){return new d(n=>n.error(xd(`Cannot load children because the guard of the route "path: '${t.path}'" returned false`)))}(r))):rt(new zd([],n))}runCanLoadGuards(n,r,i){const o=r.canLoad;return o&&0!==o.length?rt(o.map(a=>{const l=n.get(a);let v;if(function tN(t){return t&&Kr(t.canLoad)}(l))v=l.canLoad(r,i);else{if(!Kr(l))throw new Error("Invalid CanLoad guard");v=l(r,i)}return vr(v)})).pipe(ws(),On(a=>{if(!mi(a))return;const l=xd(`Redirecting to "${this.urlSerializer.serialize(a)}"`);throw l.url=a,l}),pe(a=>!0===a)):rt(!0)}lineralizeSegments(n,r){let i=[],o=r.root;for(;;){if(i=i.concat(o.segments),0===o.numberOfChildren)return rt(i);if(o.numberOfChildren>1||!o.children[lt])return pN(n.redirectTo);o=o.children[lt]}}applyRedirectCommands(n,r,i){return this.applyRedirectCreatreUrlTree(r,this.urlSerializer.parse(r),n,i)}applyRedirectCreatreUrlTree(n,r,i,o){const s=this.createSegmentGroup(n,r.root,i,o);return new hi(s,this.createQueryParams(r.queryParams,this.urlTree.queryParams),r.fragment)}createQueryParams(n,r){const i={};return Qt(n,(o,s)=>{if("string"==typeof o&&o.startsWith(":")){const l=o.substring(1);i[s]=r[l]}else i[s]=o}),i}createSegmentGroup(n,r,i,o){const s=this.createSegments(n,r.segments,i,o);let a={};return Qt(r.children,(l,v)=>{a[v]=this.createSegmentGroup(n,l,i,o)}),new ft(s,a)}createSegments(n,r,i,o){return r.map(s=>s.path.startsWith(":")?this.findPosParam(n,s,o):this.findOrReturn(s,i))}findPosParam(n,r,i){const o=i[r.path.substring(1)];if(!o)throw new Error(`Cannot redirect to '${n}'. Cannot find '${r.path}'.`);return o}findOrReturn(n,r){let i=0;for(const o of r){if(o.path===n.path)return r.splice(i),o;i++}return n}}function Kd(t){const n={};for(const i of Object.keys(t.children)){const s=Kd(t.children[i]);(s.segments.length>0||s.hasChildren())&&(n[i]=s)}return function vN(t){if(1===t.numberOfChildren&&t.children[lt]){const n=t.children[lt];return new ft(t.segments.concat(n.segments),n.children)}return t}(new ft(t.segments,n))}class o_{constructor(n){this.path=n,this.route=this.path[this.path.length-1]}}class Ec{constructor(n,r){this.component=n,this.route=r}}function _N(t,n,r){const i=t._root;return Ns(i,n?n._root:null,r,[i.value])}function Sc(t,n,r){const i=function SN(t){if(!t)return null;for(let n=t.parent;n;n=n.parent){const r=n.routeConfig;if(r&&r._loadedConfig)return r._loadedConfig}return null}(n);return(i?i.module.injector:r).get(t)}function Ns(t,n,r,i,o={canDeactivateChecks:[],canActivateChecks:[]}){const s=So(n);return t.children.forEach(a=>{(function bN(t,n,r,i,o={canDeactivateChecks:[],canActivateChecks:[]}){const s=t.value,a=n?n.value:null,l=r?r.getContext(t.value.outlet):null;if(a&&s.routeConfig===a.routeConfig){const v=function CN(t,n,r){if("function"==typeof r)return r(t,n);switch(r){case"pathParamsChange":return!gi(t.url,n.url);case"pathParamsOrQueryParamsChange":return!gi(t.url,n.url)||!mr(t.queryParams,n.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Hd(t,n)||!mr(t.queryParams,n.queryParams);default:return!Hd(t,n)}}(a,s,s.routeConfig.runGuardsAndResolvers);v?o.canActivateChecks.push(new o_(i)):(s.data=a.data,s._resolvedData=a._resolvedData),Ns(t,n,s.component?l?l.children:null:r,i,o),v&&l&&l.outlet&&l.outlet.isActivated&&o.canDeactivateChecks.push(new Ec(l.outlet.component,a))}else a&&Ms(n,l,o),o.canActivateChecks.push(new o_(i)),Ns(t,null,s.component?l?l.children:null:r,i,o)})(a,s[a.value.outlet],r,i.concat([a.value]),o),delete s[a.value.outlet]}),Qt(s,(a,l)=>Ms(a,r.getContext(l),o)),o}function Ms(t,n,r){const i=So(t),o=t.value;Qt(i,(s,a)=>{Ms(s,o.component?n?n.children.getContext(a):null:n,r)}),r.canDeactivateChecks.push(new Ec(o.component&&n&&n.outlet&&n.outlet.isActivated?n.outlet.component:null,o))}class MN{}function s_(t){return new d(n=>n.error(t))}class LN{constructor(n,r,i,o,s,a){this.rootComponentType=n,this.config=r,this.urlTree=i,this.url=o,this.paramsInheritanceStrategy=s,this.relativeLinkResolution=a}recognize(){const n=vc(this.urlTree.root,[],[],this.config.filter(a=>void 0===a.redirectTo),this.relativeLinkResolution).segmentGroup,r=this.processSegmentGroup(this.config,n,lt);if(null===r)return null;const i=new pc([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},lt,this.rootComponentType,null,this.urlTree.root,-1,{}),o=new Lr(i,r),s=new Wy(this.url,o);return this.inheritParamsAndData(s._root),s}inheritParamsAndData(n){const r=n.value,i=Gy(r,this.paramsInheritanceStrategy);r.params=Object.freeze(i.params),r.data=Object.freeze(i.data),n.children.forEach(o=>this.inheritParamsAndData(o))}processSegmentGroup(n,r,i){return 0===r.segments.length&&r.hasChildren()?this.processChildren(n,r):this.processSegment(n,r,r.segments,i)}processChildren(n,r){const i=[];for(const s of Object.keys(r.children)){const a=r.children[s],l=Zy(n,s),v=this.processSegmentGroup(l,a,s);if(null===v)return null;i.push(...v)}const o=a_(i);return function kN(t){t.sort((n,r)=>n.value.outlet===lt?-1:r.value.outlet===lt?1:n.value.outlet.localeCompare(r.value.outlet))}(o),o}processSegment(n,r,i,o){for(const s of n){const a=this.processSegmentAgainstRoute(s,r,i,o);if(null!==a)return a}return n_(r,i,o)?[]:null}processSegmentAgainstRoute(n,r,i,o){if(n.redirectTo||!t_(n,r,i,o))return null;let s,a=[],l=[];if("**"===n.path){const he=i.length>0?Dy(i).parameters:{};s=new pc(i,he,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,l_(n),Bn(n),n.component,n,c_(r),u_(r)+i.length,d_(n))}else{const he=mc(r,n,i);if(!he.matched)return null;a=he.consumedSegments,l=i.slice(he.lastChild),s=new pc(a,he.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,l_(n),Bn(n),n.component,n,c_(r),u_(r)+a.length,d_(n))}const v=function xN(t){return t.children?t.children:t.loadChildren?t._loadedConfig.routes:[]}(n),{segmentGroup:P,slicedSegments:W}=vc(r,a,l,v.filter(he=>void 0===he.redirectTo),this.relativeLinkResolution);if(0===W.length&&P.hasChildren()){const he=this.processChildren(v,P);return null===he?null:[new Lr(s,he)]}if(0===v.length&&0===W.length)return[new Lr(s,[])];const X=Bn(n)===o,ue=this.processSegment(v,P,W,X?lt:o);return null===ue?null:[new Lr(s,ue)]}}function FN(t){const n=t.value.routeConfig;return n&&""===n.path&&void 0===n.redirectTo}function a_(t){const n=[],r=new Set;for(const i of t){if(!FN(i)){n.push(i);continue}const o=n.find(s=>i.value.routeConfig===s.value.routeConfig);void 0!==o?(o.children.push(...i.children),r.add(o)):n.push(i)}for(const i of r){const o=a_(i.children);n.push(new Lr(i.value,o))}return n.filter(i=>!r.has(i))}function c_(t){let n=t;for(;n._sourceSegment;)n=n._sourceSegment;return n}function u_(t){let n=t,r=n._segmentIndexShift?n._segmentIndexShift:0;for(;n._sourceSegment;)n=n._sourceSegment,r+=n._segmentIndexShift?n._segmentIndexShift:0;return r-1}function l_(t){return t.data||{}}function d_(t){return t.resolve||{}}function $d(t){return fi(n=>{const r=t(n);return r?Kt(r).pipe(pe(()=>n)):rt(n)})}class qN extends class WN{shouldDetach(n){return!1}store(n,r){}shouldAttach(n){return!1}retrieve(n){return null}shouldReuseRoute(n,r){return n.routeConfig===r.routeConfig}}{}const Xd=new st("ROUTES");class f_{constructor(n,r,i,o){this.injector=n,this.compiler=r,this.onLoadStartListener=i,this.onLoadEndListener=o}load(n,r){if(r._loader$)return r._loader$;this.onLoadStartListener&&this.onLoadStartListener(r);const o=this.loadModuleFactory(r.loadChildren).pipe(pe(s=>{this.onLoadEndListener&&this.onLoadEndListener(r);const a=s.create(n);return new zd(wy(a.injector.get(Xd,void 0,tt.Self|tt.Optional)).map(Yd),a)}),Yr(s=>{throw r._loader$=void 0,s}));return r._loader$=new rO(o,()=>new ce).pipe(yy()),r._loader$}loadModuleFactory(n){return vr(n()).pipe(Yt(r=>r instanceof R1?rt(r):Kt(this.compiler.compileModuleAsync(r))))}}class JN{shouldProcessUrl(n){return!0}extract(n){return n}merge(n,r){return n}}function YN(t){throw t}function KN(t,n,r){return n.parse("/")}function p_(t,n){return rt(null)}const $N={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},XN={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Nn=(()=>{class t{constructor(r,i,o,s,a,l,v){this.rootComponentType=r,this.urlSerializer=i,this.rootContexts=o,this.location=s,this.config=v,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new ce,this.errorHandler=YN,this.malformedUriErrorHandler=KN,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:p_,afterPreactivation:p_},this.urlHandlingStrategy=new JN,this.routeReuseStrategy=new qN,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=a.get(Dr),this.console=a.get(sv);const X=a.get(zt);this.isNgZoneEnabled=X instanceof zt&&zt.isInAngularZone(),this.resetConfig(v),this.currentUrlTree=function CO(){return new hi(new ft([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new f_(a,l,ue=>this.triggerEvent(new Cy(ue)),ue=>this.triggerEvent(new Ty(ue))),this.routerState=Hy(this.currentUrlTree,this.rootComponentType),this.transitions=new tr({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){var r;return null===(r=this.location.getState())||void 0===r?void 0:r.\u0275routerPageId}setupNavigations(r){const i=this.events;return r.pipe(pi(o=>0!==o.id),pe(o=>Object.assign(Object.assign({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),fi(o=>{let s=!1,a=!1;return rt(o).pipe(On(l=>{this.currentNavigation={id:l.id,initialUrl:l.currentRawUrl,extractedUrl:l.extractedUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),fi(l=>{const v=this.browserUrlTree.toString(),P=!this.navigated||l.extractedUrl.toString()!==v||v!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||P)&&this.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return bc(l.source)&&(this.browserUrlTree=l.extractedUrl),rt(l).pipe(fi(X=>{const ue=this.transitions.getValue();return i.next(new kd(X.id,this.serializeUrl(X.extractedUrl),X.source,X.restoredState)),ue!==this.transitions.getValue()?Sr:Promise.resolve(X)}),function yN(t,n,r,i){return fi(o=>function gN(t,n,r,i,o){return new mN(t,n,r,i,o).apply()}(t,n,r,o.extractedUrl,i).pipe(pe(s=>Object.assign(Object.assign({},o),{urlAfterRedirects:s}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),On(X=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:X.urlAfterRedirects})}),function VN(t,n,r,i,o){return Yt(s=>function PN(t,n,r,i,o="emptyOnly",s="legacy"){try{const a=new LN(t,n,r,i,o,s).recognize();return null===a?s_(new MN):rt(a)}catch(a){return s_(a)}}(t,n,s.urlAfterRedirects,r(s.urlAfterRedirects),i,o).pipe(pe(a=>Object.assign(Object.assign({},s),{targetSnapshot:a}))))}(this.rootComponentType,this.config,X=>this.serializeUrl(X),this.paramsInheritanceStrategy,this.relativeLinkResolution),On(X=>{if("eager"===this.urlUpdateStrategy){if(!X.extras.skipLocationChange){const he=this.urlHandlingStrategy.merge(X.urlAfterRedirects,X.rawUrl);this.setBrowserUrl(he,X)}this.browserUrlTree=X.urlAfterRedirects}const ue=new lO(X.id,this.serializeUrl(X.extractedUrl),this.serializeUrl(X.urlAfterRedirects),X.targetSnapshot);i.next(ue)}));if(P&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:ue,extractedUrl:he,source:Se,restoredState:we,extras:De}=l,Oe=new kd(ue,this.serializeUrl(he),Se,we);i.next(Oe);const Ie=Hy(he,this.rootComponentType).snapshot;return rt(Object.assign(Object.assign({},l),{targetSnapshot:Ie,urlAfterRedirects:he,extras:Object.assign(Object.assign({},De),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=l.rawUrl,l.resolve(null),Sr}),$d(l=>{const{targetSnapshot:v,id:P,extractedUrl:W,rawUrl:X,extras:{skipLocationChange:ue,replaceUrl:he}}=l;return this.hooks.beforePreactivation(v,{navigationId:P,appliedUrlTree:W,rawUrlTree:X,skipLocationChange:!!ue,replaceUrl:!!he})}),On(l=>{const v=new dO(l.id,this.serializeUrl(l.extractedUrl),this.serializeUrl(l.urlAfterRedirects),l.targetSnapshot);this.triggerEvent(v)}),pe(l=>Object.assign(Object.assign({},l),{guards:_N(l.targetSnapshot,l.currentSnapshot,this.rootContexts)})),function TN(t,n){return Yt(r=>{const{targetSnapshot:i,currentSnapshot:o,guards:{canActivateChecks:s,canDeactivateChecks:a}}=r;return 0===a.length&&0===s.length?rt(Object.assign(Object.assign({},r),{guardsResult:!0})):function RN(t,n,r,i){return Kt(t).pipe(Yt(o=>function NN(t,n,r,i,o){const s=n&&n.routeConfig?n.routeConfig.canDeactivate:null;return s&&0!==s.length?rt(s.map(l=>{const v=Sc(l,n,o);let P;if(function iN(t){return t&&Kr(t.canDeactivate)}(v))P=vr(v.canDeactivate(t,n,r,i));else{if(!Kr(v))throw new Error("Invalid CanDeactivate guard");P=vr(v(t,n,r,i))}return P.pipe(_o())})).pipe(ws()):rt(!0)}(o.component,o.route,r,n,i)),_o(o=>!0!==o,!0))}(a,i,o,t).pipe(Yt(l=>l&&function eN(t){return"boolean"==typeof t}(l)?function AN(t,n,r,i){return Kt(n).pipe(yo(o=>Pd(function wN(t,n){return null!==t&&n&&n(new gO(t)),rt(!0)}(o.route.parent,i),function IN(t,n){return null!==t&&n&&n(new vO(t)),rt(!0)}(o.route,i),function ON(t,n,r){const i=n[n.length-1],s=n.slice(0,n.length-1).reverse().map(a=>function EN(t){const n=t.routeConfig?t.routeConfig.canActivateChild:null;return n&&0!==n.length?{node:t,guards:n}:null}(a)).filter(a=>null!==a).map(a=>vy(()=>rt(a.guards.map(v=>{const P=Sc(v,a.node,r);let W;if(function rN(t){return t&&Kr(t.canActivateChild)}(P))W=vr(P.canActivateChild(i,t));else{if(!Kr(P))throw new Error("Invalid CanActivateChild guard");W=vr(P(i,t))}return W.pipe(_o())})).pipe(ws())));return rt(s).pipe(ws())}(t,o.path,r),function DN(t,n,r){const i=n.routeConfig?n.routeConfig.canActivate:null;if(!i||0===i.length)return rt(!0);const o=i.map(s=>vy(()=>{const a=Sc(s,n,r);let l;if(function nN(t){return t&&Kr(t.canActivate)}(a))l=vr(a.canActivate(n,t));else{if(!Kr(a))throw new Error("Invalid CanActivate guard");l=vr(a(n,t))}return l.pipe(_o())}));return rt(o).pipe(ws())}(t,o.route,r))),_o(o=>!0!==o,!0))}(i,s,t,n):rt(l)),pe(l=>Object.assign(Object.assign({},r),{guardsResult:l})))})}(this.ngModule.injector,l=>this.triggerEvent(l)),On(l=>{if(mi(l.guardsResult)){const P=xd(`Redirecting to "${this.serializeUrl(l.guardsResult)}"`);throw P.url=l.guardsResult,P}const v=new fO(l.id,this.serializeUrl(l.extractedUrl),this.serializeUrl(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.triggerEvent(v)}),pi(l=>!!l.guardsResult||(this.restoreHistory(l),this.cancelNavigationTransition(l,""),!1)),$d(l=>{if(l.guards.canActivateChecks.length)return rt(l).pipe(On(v=>{const P=new pO(v.id,this.serializeUrl(v.extractedUrl),this.serializeUrl(v.urlAfterRedirects),v.targetSnapshot);this.triggerEvent(P)}),fi(v=>{let P=!1;return rt(v).pipe(function jN(t,n){return Yt(r=>{const{targetSnapshot:i,guards:{canActivateChecks:o}}=r;if(!o.length)return rt(r);let s=0;return Kt(o).pipe(yo(a=>function UN(t,n,r,i){return function BN(t,n,r,i){const o=Object.keys(t);if(0===o.length)return rt({});const s={};return Kt(o).pipe(Yt(a=>function HN(t,n,r,i){const o=Sc(t,n,i);return vr(o.resolve?o.resolve(n,r):o(n,r))}(t[a],n,r,i).pipe(On(l=>{s[a]=l}))),Ld(1),Yt(()=>Object.keys(s).length===o.length?rt(s):Sr))}(t._resolve,t,n,i).pipe(pe(s=>(t._resolvedData=s,t.data=Object.assign(Object.assign({},t.data),Gy(t,r).resolve),null)))}(a.route,i,t,n)),On(()=>s++),Ld(1),Yt(a=>s===o.length?rt(r):Sr))})}(this.paramsInheritanceStrategy,this.ngModule.injector),On({next:()=>P=!0,complete:()=>{P||(this.restoreHistory(v),this.cancelNavigationTransition(v,"At least one route resolver didn't emit any value."))}}))}),On(v=>{const P=new hO(v.id,this.serializeUrl(v.extractedUrl),this.serializeUrl(v.urlAfterRedirects),v.targetSnapshot);this.triggerEvent(P)}))}),$d(l=>{const{targetSnapshot:v,id:P,extractedUrl:W,rawUrl:X,extras:{skipLocationChange:ue,replaceUrl:he}}=l;return this.hooks.afterPreactivation(v,{navigationId:P,appliedUrlTree:W,rawUrlTree:X,skipLocationChange:!!ue,replaceUrl:!!he})}),pe(l=>{const v=function BO(t,n,r){const i=Rs(t,n._root,r?r._root:void 0);return new By(i,n)}(this.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return Object.assign(Object.assign({},l),{targetRouterState:v})}),On(l=>{this.currentUrlTree=l.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(l.urlAfterRedirects,l.rawUrl),this.routerState=l.targetRouterState,"deferred"===this.urlUpdateStrategy&&(l.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,l),this.browserUrlTree=l.urlAfterRedirects)}),((t,n,r)=>pe(i=>(new QO(n,i.targetRouterState,i.currentRouterState,r).activate(t),i)))(this.rootContexts,this.routeReuseStrategy,l=>this.triggerEvent(l)),On({next(){s=!0},complete(){s=!0}}),function cO(t){return V((n,r)=>{try{n.subscribe(r)}finally{r.add(t)}})}(()=>{var l;s||a||this.cancelNavigationTransition(o,`Navigation ID ${o.id} is not equal to the current navigation id ${this.navigationId}`),(null===(l=this.currentNavigation)||void 0===l?void 0:l.id)===o.id&&(this.currentNavigation=null)}),Yr(l=>{if(a=!0,function EO(t){return t&&t[Ay]}(l)){const v=mi(l.url);v||(this.navigated=!0,this.restoreHistory(o,!0));const P=new by(o.id,this.serializeUrl(o.extractedUrl),l.message);i.next(P),v?setTimeout(()=>{const W=this.urlHandlingStrategy.merge(l.url,this.rawUrlTree),X={skipLocationChange:o.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||bc(o.source)};this.scheduleNavigation(W,"imperative",null,X,{resolve:o.resolve,reject:o.reject,promise:o.promise})},0):o.resolve(!1)}else{this.restoreHistory(o,!0);const v=new uO(o.id,this.serializeUrl(o.extractedUrl),l);i.next(v);try{o.resolve(this.errorHandler(l))}catch(P){o.reject(P)}}return Sr}))}))}resetRootComponentType(r){this.rootComponentType=r,this.routerState.root.component=this.rootComponentType}setTransition(r){this.transitions.next(Object.assign(Object.assign({},this.transitions.value),r))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(r=>{const i="popstate"===r.type?"popstate":"hashchange";"popstate"===i&&setTimeout(()=>{var o;const s={replaceUrl:!0},a=(null===(o=r.state)||void 0===o?void 0:o.navigationId)?r.state:null;if(a){const v=Object.assign({},a);delete v.navigationId,delete v.\u0275routerPageId,0!==Object.keys(v).length&&(s.state=v)}const l=this.parseUrl(r.url);this.scheduleNavigation(l,i,a,s)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(r){this.events.next(r)}resetConfig(r){Qy(r),this.config=r.map(Yd),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(r,i={}){const{relativeTo:o,queryParams:s,fragment:a,queryParamsHandling:l,preserveFragment:v}=i,P=o||this.routerState.root,W=v?this.currentUrlTree.fragment:a;let X=null;switch(l){case"merge":X=Object.assign(Object.assign({},this.currentUrlTree.queryParams),s);break;case"preserve":X=this.currentUrlTree.queryParams;break;default:X=s||null}return null!==X&&(X=this.removeEmptyProps(X)),function WO(t,n,r,i,o){if(0===r.length)return Gd(n.root,n.root,n,i,o);const s=function qO(t){if("string"==typeof t[0]&&1===t.length&&"/"===t[0])return new Jy(!0,0,t);let n=0,r=!1;const i=t.reduce((o,s,a)=>{if("object"==typeof s&&null!=s){if(s.outlets){const l={};return Qt(s.outlets,(v,P)=>{l[P]="string"==typeof v?v.split("/"):v}),[...o,{outlets:l}]}if(s.segmentPath)return[...o,s.segmentPath]}return"string"!=typeof s?[...o,s]:0===a?(s.split("/").forEach((l,v)=>{0==v&&"."===l||(0==v&&""===l?r=!0:".."===l?n++:""!=l&&o.push(l))}),o):[...o,s]},[]);return new Jy(r,n,i)}(r);if(s.toRoot())return Gd(n.root,new ft([],{}),n,i,o);const a=function zO(t,n,r){if(t.isAbsolute)return new Wd(n.root,!0,0);if(-1===r.snapshot._lastPathIndex){const s=r.snapshot._urlSegment;return new Wd(s,s===n.root,0)}const i=hc(t.commands[0])?0:1;return function JO(t,n,r){let i=t,o=n,s=r;for(;s>o;){if(s-=o,i=i.parent,!i)throw new Error("Invalid number of '../'");o=i.segments.length}return new Wd(i,!1,o-s)}(r.snapshot._urlSegment,r.snapshot._lastPathIndex+i,t.numberOfDoubleDots)}(s,n,t),l=a.processChildren?gc(a.segmentGroup,a.index,s.commands):Yy(a.segmentGroup,a.index,s.commands);return Gd(a.segmentGroup,l,n,i,o)}(P,this.currentUrlTree,r,X,null!=W?W:null)}navigateByUrl(r,i={skipLocationChange:!1}){const o=mi(r)?r:this.parseUrl(r),s=this.urlHandlingStrategy.merge(o,this.rawUrlTree);return this.scheduleNavigation(s,"imperative",null,i)}navigate(r,i={skipLocationChange:!1}){return function QN(t){for(let n=0;n<t.length;n++){const r=t[n];if(null==r)throw new Error(`The requested path contains ${r} segment at index ${n}`)}}(r),this.navigateByUrl(this.createUrlTree(r,i),i)}serializeUrl(r){return this.urlSerializer.serialize(r)}parseUrl(r){let i;try{i=this.urlSerializer.parse(r)}catch(o){i=this.malformedUriErrorHandler(o,this.urlSerializer,r)}return i}isActive(r,i){let o;if(o=!0===i?Object.assign({},$N):!1===i?Object.assign({},XN):i,mi(r))return Ny(this.currentUrlTree,r,o);const s=this.parseUrl(r);return Ny(this.currentUrlTree,s,o)}removeEmptyProps(r){return Object.keys(r).reduce((i,o)=>{const s=r[o];return null!=s&&(i[o]=s),i},{})}processNavigations(){this.navigations.subscribe(r=>{this.navigated=!0,this.lastSuccessfulId=r.id,this.currentPageId=r.targetPageId,this.events.next(new bs(r.id,this.serializeUrl(r.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,r.resolve(!0)},r=>{this.console.warn(`Unhandled Navigation Error: ${r}`)})}scheduleNavigation(r,i,o,s,a){var l,v,P;if(this.disposed)return Promise.resolve(!1);const W=this.transitions.value,X=bc(i)&&W&&!bc(W.source),ue=W.rawUrl.toString()===r.toString(),he=W.id===(null===(l=this.currentNavigation)||void 0===l?void 0:l.id);if(X&&ue&&he)return Promise.resolve(!0);let we,De,Oe;a?(we=a.resolve,De=a.reject,Oe=a.promise):Oe=new Promise((Ke,pt)=>{we=Ke,De=pt});const Ie=++this.navigationId;let He;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(o=this.location.getState()),He=o&&o.\u0275routerPageId?o.\u0275routerPageId:s.replaceUrl||s.skipLocationChange?null!==(v=this.browserPageId)&&void 0!==v?v:0:(null!==(P=this.browserPageId)&&void 0!==P?P:0)+1):He=0,this.setTransition({id:Ie,targetPageId:He,source:i,restoredState:o,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:r,extras:s,resolve:we,reject:De,promise:Oe,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),Oe.catch(Ke=>Promise.reject(Ke))}setBrowserUrl(r,i){const o=this.urlSerializer.serialize(r),s=Object.assign(Object.assign({},i.extras.state),this.generateNgRouterState(i.id,i.targetPageId));this.location.isCurrentPathEqualTo(o)||i.extras.replaceUrl?this.location.replaceState(o,"",s):this.location.go(o,"",s)}restoreHistory(r,i=!1){var o,s;if("computed"===this.canceledNavigationResolution){const a=this.currentPageId-r.targetPageId;"popstate"!==r.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(o=this.currentNavigation)||void 0===o?void 0:o.finalUrl)||0===a?this.currentUrlTree===(null===(s=this.currentNavigation)||void 0===s?void 0:s.finalUrl)&&0===a&&(this.resetState(r),this.browserUrlTree=r.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(a)}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(r),this.resetUrlToCurrentUrlTree())}resetState(r){this.routerState=r.currentRouterState,this.currentUrlTree=r.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,r.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(r,i){const o=new by(r.id,this.serializeUrl(r.extractedUrl),i);this.triggerEvent(o),r.resolve(!1)}generateNgRouterState(r,i){return"computed"===this.canceledNavigationResolution?{navigationId:r,\u0275routerPageId:i}:{navigationId:r}}}return t.\u0275fac=function(r){Sl()},t.\u0275prov=nt({token:t,factory:t.\u0275fac}),t})();function bc(t){return"imperative"!==t}class h_{}class g_{preload(n,r){return rt(null)}}let m_=(()=>{class t{constructor(r,i,o,s){this.router=r,this.injector=o,this.preloadingStrategy=s,this.loader=new f_(o,i,v=>r.triggerEvent(new Cy(v)),v=>r.triggerEvent(new Ty(v)))}setUpPreloading(){this.subscription=this.router.events.pipe(pi(r=>r instanceof bs),yo(()=>this.preload())).subscribe(()=>{})}preload(){const r=this.injector.get(Dr);return this.processRoutes(r,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(r,i){const o=[];for(const s of i)if(s.loadChildren&&!s.canLoad&&s._loadedConfig){const a=s._loadedConfig;o.push(this.processRoutes(a.module,a.routes))}else s.loadChildren&&!s.canLoad?o.push(this.preloadConfig(r,s)):s.children&&o.push(this.processRoutes(r,s.children));return Kt(o).pipe(Ro(),pe(s=>{}))}preloadConfig(r,i){return this.preloadingStrategy.preload(i,()=>(i._loadedConfig?rt(i._loadedConfig):this.loader.load(r.injector,i)).pipe(Yt(s=>(i._loadedConfig=s,this.processRoutes(s.module,s.routes)))))}}return t.\u0275fac=function(r){return new(r||t)(qe(Nn),qe(Wa),qe(Xt),qe(h_))},t.\u0275prov=nt({token:t,factory:t.\u0275fac}),t})(),ef=(()=>{class t{constructor(r,i,o={}){this.router=r,this.viewportScroller=i,this.options=o,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},o.scrollPositionRestoration=o.scrollPositionRestoration||"disabled",o.anchorScrolling=o.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(r=>{r instanceof kd?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=r.navigationTrigger,this.restoredId=r.restoredState?r.restoredState.navigationId:0):r instanceof bs&&(this.lastId=r.id,this.scheduleScrollEvent(r,this.router.parseUrl(r.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(r=>{r instanceof Ry&&(r.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(r.position):r.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(r.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(r,i){this.router.triggerEvent(new Ry(r,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return t.\u0275fac=function(r){Sl()},t.\u0275prov=nt({token:t,factory:t.\u0275fac}),t})();const vi=new st("ROUTER_CONFIGURATION"),v_=new st("ROUTER_FORROOT_GUARD"),nM=[pd,{provide:ky,useClass:xy},{provide:Nn,useFactory:function aM(t,n,r,i,o,s,a={},l,v){const P=new Nn(null,t,n,r,i,o,wy(s));return l&&(P.urlHandlingStrategy=l),v&&(P.routeReuseStrategy=v),function cM(t,n){t.errorHandler&&(n.errorHandler=t.errorHandler),t.malformedUriErrorHandler&&(n.malformedUriErrorHandler=t.malformedUriErrorHandler),t.onSameUrlNavigation&&(n.onSameUrlNavigation=t.onSameUrlNavigation),t.paramsInheritanceStrategy&&(n.paramsInheritanceStrategy=t.paramsInheritanceStrategy),t.relativeLinkResolution&&(n.relativeLinkResolution=t.relativeLinkResolution),t.urlUpdateStrategy&&(n.urlUpdateStrategy=t.urlUpdateStrategy),t.canceledNavigationResolution&&(n.canceledNavigationResolution=t.canceledNavigationResolution)}(a,P),a.enableTracing&&P.events.subscribe(W=>{var X,ue;null===(X=console.group)||void 0===X||X.call(console,`Router Event: ${W.constructor.name}`),console.log(W.toString()),console.log(W),null===(ue=console.groupEnd)||void 0===ue||ue.call(console)}),P},deps:[ky,Ds,pd,Xt,Wa,Xd,vi,[class zN{},new sr],[class GN{},new sr]]},Ds,{provide:bo,useFactory:function uM(t){return t.routerState.root},deps:[Nn]},m_,g_,class tM{preload(n,r){return r().pipe(Yr(()=>rt(null)))}},{provide:vi,useValue:{enableTracing:!1}}];function rM(){return new fv("Router",Nn)}let y_=(()=>{class t{constructor(r,i){}static forRoot(r,i){return{ngModule:t,providers:[nM,__(r),{provide:v_,useFactory:sM,deps:[[Nn,new sr,new Fi]]},{provide:vi,useValue:i||{}},{provide:mo,useFactory:oM,deps:[di,[new Wo(fd),new sr],vi]},{provide:ef,useFactory:iM,deps:[Nn,aD,vi]},{provide:h_,useExisting:i&&i.preloadingStrategy?i.preloadingStrategy:g_},{provide:fv,multi:!0,useFactory:rM},[tf,{provide:Ha,multi:!0,useFactory:lM,deps:[tf]},{provide:E_,useFactory:dM,deps:[tf]},{provide:ov,multi:!0,useExisting:E_}]]}}static forChild(r){return{ngModule:t,providers:[__(r)]}}}return t.\u0275fac=function(r){return new(r||t)(qe(v_,8),qe(Nn,8))},t.\u0275mod=En({type:t}),t.\u0275inj=pn({}),t})();function iM(t,n,r){return r.scrollOffset&&n.setOffset(r.scrollOffset),new ef(t,n,r)}function oM(t,n,r={}){return r.useHash?new BI(t,n):new Lv(t,n)}function sM(t){return"guarded"}function __(t){return[{provide:dS,multi:!0,useValue:t},{provide:Xd,multi:!0,useValue:t}]}let tf=(()=>{class t{constructor(r){this.injector=r,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new ce}appInitializer(){return this.injector.get(VI,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let i=null;const o=new Promise(l=>i=l),s=this.injector.get(Nn),a=this.injector.get(vi);return"disabled"===a.initialNavigation?(s.setUpLocationChangeListener(),i(!0)):"enabled"===a.initialNavigation||"enabledBlocking"===a.initialNavigation?(s.hooks.afterPreactivation=()=>this.initNavigation?rt(null):(this.initNavigation=!0,i(!0),this.resultOfPreactivationDone),s.initialNavigation()):i(!0),o})}bootstrapListener(r){const i=this.injector.get(vi),o=this.injector.get(m_),s=this.injector.get(ef),a=this.injector.get(Nn),l=this.injector.get(ms);r===l.components[0]&&(("enabledNonBlocking"===i.initialNavigation||void 0===i.initialNavigation)&&a.initialNavigation(),o.setUpPreloading(),s.init(),a.resetRootComponentType(l.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return t.\u0275fac=function(r){return new(r||t)(qe(Xt))},t.\u0275prov=nt({token:t,factory:t.\u0275fac}),t})();function lM(t){return t.appInitializer.bind(t)}function dM(t){return t.bootstrapListener.bind(t)}const E_=new st("Router Initializer"),pM=[];let hM=(()=>{class t{}return t.\u0275fac=function(r){return new(r||t)},t.\u0275mod=En({type:t}),t.\u0275inj=pn({imports:[[y_.forRoot(pM)],y_]}),t})();class S_{}class b_{}class kr{constructor(n){this.normalizedNames=new Map,this.lazyUpdate=null,n?this.lazyInit="string"==typeof n?()=>{this.headers=new Map,n.split("\n").forEach(r=>{const i=r.indexOf(":");if(i>0){const o=r.slice(0,i),s=o.toLowerCase(),a=r.slice(i+1).trim();this.maybeSetNormalizedName(o,s),this.headers.has(s)?this.headers.get(s).push(a):this.headers.set(s,[a])}})}:()=>{this.headers=new Map,Object.keys(n).forEach(r=>{let i=n[r];const o=r.toLowerCase();"string"==typeof i&&(i=[i]),i.length>0&&(this.headers.set(o,i),this.maybeSetNormalizedName(r,o))})}:this.headers=new Map}has(n){return this.init(),this.headers.has(n.toLowerCase())}get(n){this.init();const r=this.headers.get(n.toLowerCase());return r&&r.length>0?r[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(n){return this.init(),this.headers.get(n.toLowerCase())||null}append(n,r){return this.clone({name:n,value:r,op:"a"})}set(n,r){return this.clone({name:n,value:r,op:"s"})}delete(n,r){return this.clone({name:n,value:r,op:"d"})}maybeSetNormalizedName(n,r){this.normalizedNames.has(r)||this.normalizedNames.set(r,n)}init(){this.lazyInit&&(this.lazyInit instanceof kr?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(n=>this.applyUpdate(n)),this.lazyUpdate=null))}copyFrom(n){n.init(),Array.from(n.headers.keys()).forEach(r=>{this.headers.set(r,n.headers.get(r)),this.normalizedNames.set(r,n.normalizedNames.get(r))})}clone(n){const r=new kr;return r.lazyInit=this.lazyInit&&this.lazyInit instanceof kr?this.lazyInit:this,r.lazyUpdate=(this.lazyUpdate||[]).concat([n]),r}applyUpdate(n){const r=n.name.toLowerCase();switch(n.op){case"a":case"s":let i=n.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(n.name,r);const o=("a"===n.op?this.headers.get(r):void 0)||[];o.push(...i),this.headers.set(r,o);break;case"d":const s=n.value;if(s){let a=this.headers.get(r);if(!a)return;a=a.filter(l=>-1===s.indexOf(l)),0===a.length?(this.headers.delete(r),this.normalizedNames.delete(r)):this.headers.set(r,a)}else this.headers.delete(r),this.normalizedNames.delete(r)}}forEach(n){this.init(),Array.from(this.normalizedNames.keys()).forEach(r=>n(this.normalizedNames.get(r),this.headers.get(r)))}}class gM{encodeKey(n){return C_(n)}encodeValue(n){return C_(n)}decodeKey(n){return decodeURIComponent(n)}decodeValue(n){return decodeURIComponent(n)}}const vM=/%(\d[a-f0-9])/gi,yM={40:"@","3A":":",24:"$","2C":",","3B":";","2B":"+","3D":"=","3F":"?","2F":"/"};function C_(t){return encodeURIComponent(t).replace(vM,(n,r)=>{var i;return null!==(i=yM[r])&&void 0!==i?i:n})}function T_(t){return`${t}`}class xr{constructor(n={}){if(this.updates=null,this.cloneFrom=null,this.encoder=n.encoder||new gM,n.fromString){if(n.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function mM(t,n){const r=new Map;return t.length>0&&t.replace(/^\?/,"").split("&").forEach(o=>{const s=o.indexOf("="),[a,l]=-1==s?[n.decodeKey(o),""]:[n.decodeKey(o.slice(0,s)),n.decodeValue(o.slice(s+1))],v=r.get(a)||[];v.push(l),r.set(a,v)}),r}(n.fromString,this.encoder)}else n.fromObject?(this.map=new Map,Object.keys(n.fromObject).forEach(r=>{const i=n.fromObject[r];this.map.set(r,Array.isArray(i)?i:[i])})):this.map=null}has(n){return this.init(),this.map.has(n)}get(n){this.init();const r=this.map.get(n);return r?r[0]:null}getAll(n){return this.init(),this.map.get(n)||null}keys(){return this.init(),Array.from(this.map.keys())}append(n,r){return this.clone({param:n,value:r,op:"a"})}appendAll(n){const r=[];return Object.keys(n).forEach(i=>{const o=n[i];Array.isArray(o)?o.forEach(s=>{r.push({param:i,value:s,op:"a"})}):r.push({param:i,value:o,op:"a"})}),this.clone(r)}set(n,r){return this.clone({param:n,value:r,op:"s"})}delete(n,r){return this.clone({param:n,value:r,op:"d"})}toString(){return this.init(),this.keys().map(n=>{const r=this.encoder.encodeKey(n);return this.map.get(n).map(i=>r+"="+this.encoder.encodeValue(i)).join("&")}).filter(n=>""!==n).join("&")}clone(n){const r=new xr({encoder:this.encoder});return r.cloneFrom=this.cloneFrom||this,r.updates=(this.updates||[]).concat(n),r}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(n=>this.map.set(n,this.cloneFrom.map.get(n))),this.updates.forEach(n=>{switch(n.op){case"a":case"s":const r=("a"===n.op?this.map.get(n.param):void 0)||[];r.push(T_(n.value)),this.map.set(n.param,r);break;case"d":if(void 0===n.value){this.map.delete(n.param);break}{let i=this.map.get(n.param)||[];const o=i.indexOf(T_(n.value));-1!==o&&i.splice(o,1),i.length>0?this.map.set(n.param,i):this.map.delete(n.param)}}}),this.cloneFrom=this.updates=null)}}class _M{constructor(){this.map=new Map}set(n,r){return this.map.set(n,r),this}get(n){return this.map.has(n)||this.map.set(n,n.defaultValue()),this.map.get(n)}delete(n){return this.map.delete(n),this}has(n){return this.map.has(n)}keys(){return this.map.keys()}}function R_(t){return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer}function A_(t){return"undefined"!=typeof Blob&&t instanceof Blob}function I_(t){return"undefined"!=typeof FormData&&t instanceof FormData}class Ps{constructor(n,r,i,o){let s;if(this.url=r,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=n.toUpperCase(),function EM(t){switch(t){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||o?(this.body=void 0!==i?i:null,s=o):s=i,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params)),this.headers||(this.headers=new kr),this.context||(this.context=new _M),this.params){const a=this.params.toString();if(0===a.length)this.urlWithParams=r;else{const l=r.indexOf("?");this.urlWithParams=r+(-1===l?"?":l<r.length-1?"&":"")+a}}else this.params=new xr,this.urlWithParams=r}serializeBody(){return null===this.body?null:R_(this.body)||A_(this.body)||I_(this.body)||function SM(t){return"undefined"!=typeof URLSearchParams&&t instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof xr?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||I_(this.body)?null:A_(this.body)?this.body.type||null:R_(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof xr?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(n={}){var r;const i=n.method||this.method,o=n.url||this.url,s=n.responseType||this.responseType,a=void 0!==n.body?n.body:this.body,l=void 0!==n.withCredentials?n.withCredentials:this.withCredentials,v=void 0!==n.reportProgress?n.reportProgress:this.reportProgress;let P=n.headers||this.headers,W=n.params||this.params;const X=null!==(r=n.context)&&void 0!==r?r:this.context;return void 0!==n.setHeaders&&(P=Object.keys(n.setHeaders).reduce((ue,he)=>ue.set(he,n.setHeaders[he]),P)),n.setParams&&(W=Object.keys(n.setParams).reduce((ue,he)=>ue.set(he,n.setParams[he]),W)),new Ps(i,o,a,{params:W,headers:P,context:X,reportProgress:v,responseType:s,withCredentials:l})}}var Ht=(()=>((Ht=Ht||{})[Ht.Sent=0]="Sent",Ht[Ht.UploadProgress=1]="UploadProgress",Ht[Ht.ResponseHeader=2]="ResponseHeader",Ht[Ht.DownloadProgress=3]="DownloadProgress",Ht[Ht.Response=4]="Response",Ht[Ht.User=5]="User",Ht))();class nf{constructor(n,r=200,i="OK"){this.headers=n.headers||new kr,this.status=void 0!==n.status?n.status:r,this.statusText=n.statusText||i,this.url=n.url||null,this.ok=this.status>=200&&this.status<300}}class rf extends nf{constructor(n={}){super(n),this.type=Ht.ResponseHeader}clone(n={}){return new rf({headers:n.headers||this.headers,status:void 0!==n.status?n.status:this.status,statusText:n.statusText||this.statusText,url:n.url||this.url||void 0})}}class Cc extends nf{constructor(n={}){super(n),this.type=Ht.Response,this.body=void 0!==n.body?n.body:null}clone(n={}){return new Cc({body:void 0!==n.body?n.body:this.body,headers:n.headers||this.headers,status:void 0!==n.status?n.status:this.status,statusText:n.statusText||this.statusText,url:n.url||this.url||void 0})}}class w_ extends nf{constructor(n){super(n,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${n.url||"(unknown url)"}`:`Http failure response for ${n.url||"(unknown url)"}: ${n.status} ${n.statusText}`,this.error=n.error||null}}function of(t,n){return{body:n,headers:t.headers,context:t.context,observe:t.observe,params:t.params,reportProgress:t.reportProgress,responseType:t.responseType,withCredentials:t.withCredentials}}let D_=(()=>{class t{constructor(r){this.handler=r}request(r,i,o={}){let s;if(r instanceof Ps)s=r;else{let v,P;v=o.headers instanceof kr?o.headers:new kr(o.headers),o.params&&(P=o.params instanceof xr?o.params:new xr({fromObject:o.params})),s=new Ps(r,i,void 0!==o.body?o.body:null,{headers:v,context:o.context,params:P,reportProgress:o.reportProgress,responseType:o.responseType||"json",withCredentials:o.withCredentials})}const a=rt(s).pipe(yo(v=>this.handler.handle(v)));if(r instanceof Ps||"events"===o.observe)return a;const l=a.pipe(pi(v=>v instanceof Cc));switch(o.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return l.pipe(pe(v=>{if(null!==v.body&&!(v.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return v.body}));case"blob":return l.pipe(pe(v=>{if(null!==v.body&&!(v.body instanceof Blob))throw new Error("Response is not a Blob.");return v.body}));case"text":return l.pipe(pe(v=>{if(null!==v.body&&"string"!=typeof v.body)throw new Error("Response is not a string.");return v.body}));default:return l.pipe(pe(v=>v.body))}case"response":return l;default:throw new Error(`Unreachable: unhandled observe type ${o.observe}}`)}}delete(r,i={}){return this.request("DELETE",r,i)}get(r,i={}){return this.request("GET",r,i)}head(r,i={}){return this.request("HEAD",r,i)}jsonp(r,i){return this.request("JSONP",r,{params:(new xr).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(r,i={}){return this.request("OPTIONS",r,i)}patch(r,i,o={}){return this.request("PATCH",r,of(o,i))}post(r,i,o={}){return this.request("POST",r,of(o,i))}put(r,i,o={}){return this.request("PUT",r,of(o,i))}}return t.\u0275fac=function(r){return new(r||t)(qe(S_))},t.\u0275prov=nt({token:t,factory:t.\u0275fac}),t})();class O_{constructor(n,r){this.next=n,this.interceptor=r}handle(n){return this.interceptor.intercept(n,this.next)}}const N_=new st("HTTP_INTERCEPTORS");let bM=(()=>{class t{intercept(r,i){return i.handle(r)}}return t.\u0275fac=function(r){return new(r||t)},t.\u0275prov=nt({token:t,factory:t.\u0275fac}),t})();const CM=/^\)\]\}',?\n/;let M_=(()=>{class t{constructor(r){this.xhrFactory=r}handle(r){if("JSONP"===r.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new d(i=>{const o=this.xhrFactory.build();if(o.open(r.method,r.urlWithParams),r.withCredentials&&(o.withCredentials=!0),r.headers.forEach((he,Se)=>o.setRequestHeader(he,Se.join(","))),r.headers.has("Accept")||o.setRequestHeader("Accept","application/json, text/plain, */*"),!r.headers.has("Content-Type")){const he=r.detectContentTypeHeader();null!==he&&o.setRequestHeader("Content-Type",he)}if(r.responseType){const he=r.responseType.toLowerCase();o.responseType="json"!==he?he:"text"}const s=r.serializeBody();let a=null;const l=()=>{if(null!==a)return a;const he=1223===o.status?204:o.status,Se=o.statusText||"OK",we=new kr(o.getAllResponseHeaders()),De=function TM(t){return"responseURL"in t&&t.responseURL?t.responseURL:/^X-Request-URL:/m.test(t.getAllResponseHeaders())?t.getResponseHeader("X-Request-URL"):null}(o)||r.url;return a=new rf({headers:we,status:he,statusText:Se,url:De}),a},v=()=>{let{headers:he,status:Se,statusText:we,url:De}=l(),Oe=null;204!==Se&&(Oe=void 0===o.response?o.responseText:o.response),0===Se&&(Se=Oe?200:0);let Ie=Se>=200&&Se<300;if("json"===r.responseType&&"string"==typeof Oe){const He=Oe;Oe=Oe.replace(CM,"");try{Oe=""!==Oe?JSON.parse(Oe):null}catch(Ke){Oe=He,Ie&&(Ie=!1,Oe={error:Ke,text:Oe})}}Ie?(i.next(new Cc({body:Oe,headers:he,status:Se,statusText:we,url:De||void 0})),i.complete()):i.error(new w_({error:Oe,headers:he,status:Se,statusText:we,url:De||void 0}))},P=he=>{const{url:Se}=l(),we=new w_({error:he,status:o.status||0,statusText:o.statusText||"Unknown Error",url:Se||void 0});i.error(we)};let W=!1;const X=he=>{W||(i.next(l()),W=!0);let Se={type:Ht.DownloadProgress,loaded:he.loaded};he.lengthComputable&&(Se.total=he.total),"text"===r.responseType&&!!o.responseText&&(Se.partialText=o.responseText),i.next(Se)},ue=he=>{let Se={type:Ht.UploadProgress,loaded:he.loaded};he.lengthComputable&&(Se.total=he.total),i.next(Se)};return o.addEventListener("load",v),o.addEventListener("error",P),o.addEventListener("timeout",P),o.addEventListener("abort",P),r.reportProgress&&(o.addEventListener("progress",X),null!==s&&o.upload&&o.upload.addEventListener("progress",ue)),o.send(s),i.next({type:Ht.Sent}),()=>{o.removeEventListener("error",P),o.removeEventListener("abort",P),o.removeEventListener("load",v),o.removeEventListener("timeout",P),r.reportProgress&&(o.removeEventListener("progress",X),null!==s&&o.upload&&o.upload.removeEventListener("progress",ue)),o.readyState!==o.DONE&&o.abort()}})}}return t.\u0275fac=function(r){return new(r||t)(qe(Qv))},t.\u0275prov=nt({token:t,factory:t.\u0275fac}),t})();const sf=new st("XSRF_COOKIE_NAME"),af=new st("XSRF_HEADER_NAME");class P_{}let RM=(()=>{class t{constructor(r,i,o){this.doc=r,this.platform=i,this.cookieName=o,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const r=this.doc.cookie||"";return r!==this.lastCookieString&&(this.parseCount++,this.lastToken=Wv(r,this.cookieName),this.lastCookieString=r),this.lastToken}}return t.\u0275fac=function(r){return new(r||t)(qe(wn),qe(Ga),qe(sf))},t.\u0275prov=nt({token:t,factory:t.\u0275fac}),t})(),cf=(()=>{class t{constructor(r,i){this.tokenService=r,this.headerName=i}intercept(r,i){const o=r.url.toLowerCase();if("GET"===r.method||"HEAD"===r.method||o.startsWith("http://")||o.startsWith("https://"))return i.handle(r);const s=this.tokenService.getToken();return null!==s&&!r.headers.has(this.headerName)&&(r=r.clone({headers:r.headers.set(this.headerName,s)})),i.handle(r)}}return t.\u0275fac=function(r){return new(r||t)(qe(P_),qe(af))},t.\u0275prov=nt({token:t,factory:t.\u0275fac}),t})(),AM=(()=>{class t{constructor(r,i){this.backend=r,this.injector=i,this.chain=null}handle(r){if(null===this.chain){const i=this.injector.get(N_,[]);this.chain=i.reduceRight((o,s)=>new O_(o,s),this.backend)}return this.chain.handle(r)}}return t.\u0275fac=function(r){return new(r||t)(qe(b_),qe(Xt))},t.\u0275prov=nt({token:t,factory:t.\u0275fac}),t})(),IM=(()=>{class t{static disable(){return{ngModule:t,providers:[{provide:cf,useClass:bM}]}}static withOptions(r={}){return{ngModule:t,providers:[r.cookieName?{provide:sf,useValue:r.cookieName}:[],r.headerName?{provide:af,useValue:r.headerName}:[]]}}}return t.\u0275fac=function(r){return new(r||t)},t.\u0275mod=En({type:t}),t.\u0275inj=pn({providers:[cf,{provide:N_,useExisting:cf,multi:!0},{provide:P_,useClass:RM},{provide:sf,useValue:"XSRF-TOKEN"},{provide:af,useValue:"X-XSRF-TOKEN"}]}),t})(),wM=(()=>{class t{}return t.\u0275fac=function(r){return new(r||t)},t.\u0275mod=En({type:t}),t.\u0275inj=pn({providers:[D_,{provide:S_,useClass:AM},M_,{provide:b_,useExisting:M_}],imports:[[IM.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),t})(),L_=(()=>{class t{constructor(r,i){this._renderer=r,this._elementRef=i,this.onChange=o=>{},this.onTouched=()=>{}}setProperty(r,i){this._renderer.setProperty(this._elementRef.nativeElement,r,i)}registerOnTouched(r){this.onTouched=r}registerOnChange(r){this.onChange=r}setDisabledState(r){this.setProperty("disabled",r)}}return t.\u0275fac=function(r){return new(r||t)(Me(wr),Me(In))},t.\u0275dir=Xe({type:t}),t})(),yi=(()=>{class t extends L_{}return t.\u0275fac=function(){let n;return function(i){return(n||(n=mn(t)))(i||t)}}(),t.\u0275dir=Xe({type:t,features:[St]}),t})();const yr=new st("NgValueAccessor"),NM={provide:yr,useExisting:Ct(()=>uf),multi:!0},PM=new st("CompositionEventMode");let uf=(()=>{class t extends L_{constructor(r,i,o){super(r,i),this._compositionMode=o,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function MM(){const t=hr()?hr().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}())}writeValue(r){this.setProperty("value",null==r?"":r)}_handleInput(r){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(r)}_compositionStart(){this._composing=!0}_compositionEnd(r){this._composing=!1,this._compositionMode&&this.onChange(r)}}return t.\u0275fac=function(r){return new(r||t)(Me(wr),Me(In),Me(PM,8))},t.\u0275dir=Xe({type:t,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,i){1&r&&un("input",function(s){return i._handleInput(s.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(s){return i._compositionEnd(s.target.value)})},features:[Dt([NM]),St]}),t})();const rn=new st("NgValidators"),Xr=new st("NgAsyncValidators");function q_(t){return null!=t}function z_(t){const n=rs(t)?Kt(t):t;return Cl(n),n}function J_(t){let n={};return t.forEach(r=>{n=null!=r?Object.assign(Object.assign({},n),r):n}),0===Object.keys(n).length?null:n}function Y_(t,n){return n.map(r=>r(t))}function K_(t){return t.map(n=>function kM(t){return!t.validate}(n)?n:r=>n.validate(r))}function lf(t){return null!=t?function $_(t){if(!t)return null;const n=t.filter(q_);return 0==n.length?null:function(r){return J_(Y_(r,n))}}(K_(t)):null}function df(t){return null!=t?function X_(t){if(!t)return null;const n=t.filter(q_);return 0==n.length?null:function(r){return function DM(...t){const n=Hf(t),{args:r,keys:i}=py(t),o=new d(s=>{const{length:a}=r;if(!a)return void s.complete();const l=new Array(a);let v=a,P=a;for(let W=0;W<a;W++){let X=!1;Nt(r[W]).subscribe(new q(s,ue=>{X||(X=!0,P--),l[W]=ue},()=>v--,void 0,()=>{(!v||!X)&&(P||s.next(i?gy(i,l):l),s.complete())}))}});return n?o.pipe(hy(n)):o}(Y_(r,n).map(z_)).pipe(pe(J_))}}(K_(t)):null}function Q_(t,n){return null===t?[n]:Array.isArray(t)?[...t,n]:[t,n]}function ff(t){return t?Array.isArray(t)?t:[t]:[]}function Tc(t,n){return Array.isArray(t)?t.includes(n):t===n}function tE(t,n){const r=ff(n);return ff(t).forEach(o=>{Tc(r,o)||r.push(o)}),r}function nE(t,n){return ff(n).filter(r=>!Tc(t,r))}class rE{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(n){this._rawValidators=n||[],this._composedValidatorFn=lf(this._rawValidators)}_setAsyncValidators(n){this._rawAsyncValidators=n||[],this._composedAsyncValidatorFn=df(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(n){this._onDestroyCallbacks.push(n)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(n=>n()),this._onDestroyCallbacks=[]}reset(n){this.control&&this.control.reset(n)}hasError(n,r){return!!this.control&&this.control.hasError(n,r)}getError(n,r){return this.control?this.control.getError(n,r):null}}class Qr extends rE{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class fn extends rE{get formDirective(){return null}get path(){return null}}let oE=(()=>{class t extends class iE{constructor(n){this._cd=n}is(n){var r,i,o;return"submitted"===n?!!(null===(r=this._cd)||void 0===r?void 0:r.submitted):!!(null===(o=null===(i=this._cd)||void 0===i?void 0:i.control)||void 0===o?void 0:o[n])}}{constructor(r){super(r)}}return t.\u0275fac=function(r){return new(r||t)(Me(Qr,2))},t.\u0275dir=Xe({type:t,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,i){2&r&&Oa("ng-untouched",i.is("untouched"))("ng-touched",i.is("touched"))("ng-pristine",i.is("pristine"))("ng-dirty",i.is("dirty"))("ng-valid",i.is("valid"))("ng-invalid",i.is("invalid"))("ng-pending",i.is("pending"))},features:[St]}),t})();function ks(t,n){(function gf(t,n){const r=function Z_(t){return t._rawValidators}(t);null!==n.validator?t.setValidators(Q_(r,n.validator)):"function"==typeof r&&t.setValidators([r]);const i=function eE(t){return t._rawAsyncValidators}(t);null!==n.asyncValidator?t.setAsyncValidators(Q_(i,n.asyncValidator)):"function"==typeof i&&t.setAsyncValidators([i]);const o=()=>t.updateValueAndValidity();wc(n._rawValidators,o),wc(n._rawAsyncValidators,o)})(t,n),n.valueAccessor.writeValue(t.value),function WM(t,n){n.valueAccessor.registerOnChange(r=>{t._pendingValue=r,t._pendingChange=!0,t._pendingDirty=!0,"change"===t.updateOn&&aE(t,n)})}(t,n),function zM(t,n){const r=(i,o)=>{n.valueAccessor.writeValue(i),o&&n.viewToModelUpdate(i)};t.registerOnChange(r),n._registerOnDestroy(()=>{t._unregisterOnChange(r)})}(t,n),function qM(t,n){n.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,"blur"===t.updateOn&&t._pendingChange&&aE(t,n),"submit"!==t.updateOn&&t.markAsTouched()})}(t,n),function GM(t,n){if(n.valueAccessor.setDisabledState){const r=i=>{n.valueAccessor.setDisabledState(i)};t.registerOnDisabledChange(r),n._registerOnDestroy(()=>{t._unregisterOnDisabledChange(r)})}}(t,n)}function wc(t,n){t.forEach(r=>{r.registerOnValidatorChange&&r.registerOnValidatorChange(n)})}function aE(t,n){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),n.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function Oc(t,n){const r=t.indexOf(n);r>-1&&t.splice(r,1)}const xs="VALID",Nc="INVALID",To="PENDING",Fs="DISABLED";function _f(t){return(Sf(t)?t.validators:t)||null}function lE(t){return Array.isArray(t)?lf(t):t||null}function Ef(t,n){return(Sf(n)?n.asyncValidators:t)||null}function dE(t){return Array.isArray(t)?df(t):t||null}function Sf(t){return null!=t&&!Array.isArray(t)&&"object"==typeof t}const bf=t=>t instanceof Tf;function pE(t){return(t=>t instanceof mE)(t)?t.value:t.getRawValue()}function hE(t,n){const r=bf(t),i=t.controls;if(!(r?Object.keys(i):i).length)throw new ht(1e3,"");if(!i[n])throw new ht(1001,"")}function gE(t,n){bf(t),t._forEachChild((i,o)=>{if(void 0===n[o])throw new ht(1002,"")})}class Cf{constructor(n,r){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=n,this._rawAsyncValidators=r,this._composedValidatorFn=lE(this._rawValidators),this._composedAsyncValidatorFn=dE(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(n){this._rawValidators=this._composedValidatorFn=n}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(n){this._rawAsyncValidators=this._composedAsyncValidatorFn=n}get parent(){return this._parent}get valid(){return this.status===xs}get invalid(){return this.status===Nc}get pending(){return this.status==To}get disabled(){return this.status===Fs}get enabled(){return this.status!==Fs}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(n){this._rawValidators=n,this._composedValidatorFn=lE(n)}setAsyncValidators(n){this._rawAsyncValidators=n,this._composedAsyncValidatorFn=dE(n)}addValidators(n){this.setValidators(tE(n,this._rawValidators))}addAsyncValidators(n){this.setAsyncValidators(tE(n,this._rawAsyncValidators))}removeValidators(n){this.setValidators(nE(n,this._rawValidators))}removeAsyncValidators(n){this.setAsyncValidators(nE(n,this._rawAsyncValidators))}hasValidator(n){return Tc(this._rawValidators,n)}hasAsyncValidator(n){return Tc(this._rawAsyncValidators,n)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(n={}){this.touched=!0,this._parent&&!n.onlySelf&&this._parent.markAsTouched(n)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(n=>n.markAllAsTouched())}markAsUntouched(n={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(r=>{r.markAsUntouched({onlySelf:!0})}),this._parent&&!n.onlySelf&&this._parent._updateTouched(n)}markAsDirty(n={}){this.pristine=!1,this._parent&&!n.onlySelf&&this._parent.markAsDirty(n)}markAsPristine(n={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(r=>{r.markAsPristine({onlySelf:!0})}),this._parent&&!n.onlySelf&&this._parent._updatePristine(n)}markAsPending(n={}){this.status=To,!1!==n.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!n.onlySelf&&this._parent.markAsPending(n)}disable(n={}){const r=this._parentMarkedDirty(n.onlySelf);this.status=Fs,this.errors=null,this._forEachChild(i=>{i.disable(Object.assign(Object.assign({},n),{onlySelf:!0}))}),this._updateValue(),!1!==n.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},n),{skipPristineCheck:r})),this._onDisabledChange.forEach(i=>i(!0))}enable(n={}){const r=this._parentMarkedDirty(n.onlySelf);this.status=xs,this._forEachChild(i=>{i.enable(Object.assign(Object.assign({},n),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},n),{skipPristineCheck:r})),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(n){this._parent&&!n.onlySelf&&(this._parent.updateValueAndValidity(n),n.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(n){this._parent=n}updateValueAndValidity(n={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===xs||this.status===To)&&this._runAsyncValidator(n.emitEvent)),!1!==n.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!n.onlySelf&&this._parent.updateValueAndValidity(n)}_updateTreeValidity(n={emitEvent:!0}){this._forEachChild(r=>r._updateTreeValidity(n)),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Fs:xs}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(n){if(this.asyncValidator){this.status=To,this._hasOwnPendingAsyncValidator=!0;const r=z_(this.asyncValidator(this));this._asyncValidationSubscription=r.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:n})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(n,r={}){this.errors=n,this._updateControlsErrors(!1!==r.emitEvent)}get(n){return function $M(t,n,r){if(null==n||(Array.isArray(n)||(n=n.split(r)),Array.isArray(n)&&0===n.length))return null;let i=t;return n.forEach(o=>{i=bf(i)?i.controls.hasOwnProperty(o)?i.controls[o]:null:(t=>t instanceof QM)(i)&&i.at(o)||null}),i}(this,n,".")}getError(n,r){const i=r?this.get(r):this;return i&&i.errors?i.errors[n]:null}hasError(n,r){return!!this.getError(n,r)}get root(){let n=this;for(;n._parent;)n=n._parent;return n}_updateControlsErrors(n){this.status=this._calculateStatus(),n&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(n)}_initObservables(){this.valueChanges=new kt,this.statusChanges=new kt}_calculateStatus(){return this._allControlsDisabled()?Fs:this.errors?Nc:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(To)?To:this._anyControlsHaveStatus(Nc)?Nc:xs}_anyControlsHaveStatus(n){return this._anyControls(r=>r.status===n)}_anyControlsDirty(){return this._anyControls(n=>n.dirty)}_anyControlsTouched(){return this._anyControls(n=>n.touched)}_updatePristine(n={}){this.pristine=!this._anyControlsDirty(),this._parent&&!n.onlySelf&&this._parent._updatePristine(n)}_updateTouched(n={}){this.touched=this._anyControlsTouched(),this._parent&&!n.onlySelf&&this._parent._updateTouched(n)}_isBoxedValue(n){return"object"==typeof n&&null!==n&&2===Object.keys(n).length&&"value"in n&&"disabled"in n}_registerOnCollectionChange(n){this._onCollectionChange=n}_setUpdateStrategy(n){Sf(n)&&null!=n.updateOn&&(this._updateOn=n.updateOn)}_parentMarkedDirty(n){return!n&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}class mE extends Cf{constructor(n=null,r,i){super(_f(r),Ef(i,r)),this._onChange=[],this._pendingChange=!1,this._applyFormState(n),this._setUpdateStrategy(r),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}setValue(n,r={}){this.value=this._pendingValue=n,this._onChange.length&&!1!==r.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==r.emitViewToModelChange)),this.updateValueAndValidity(r)}patchValue(n,r={}){this.setValue(n,r)}reset(n=null,r={}){this._applyFormState(n),this.markAsPristine(r),this.markAsUntouched(r),this.setValue(this.value,r),this._pendingChange=!1}_updateValue(){}_anyControls(n){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(n){this._onChange.push(n)}_unregisterOnChange(n){Oc(this._onChange,n)}registerOnDisabledChange(n){this._onDisabledChange.push(n)}_unregisterOnDisabledChange(n){Oc(this._onDisabledChange,n)}_forEachChild(n){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(n){this._isBoxedValue(n)?(this.value=this._pendingValue=n.value,n.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=n}}class Tf extends Cf{constructor(n,r,i){super(_f(r),Ef(i,r)),this.controls=n,this._initObservables(),this._setUpdateStrategy(r),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(n,r){return this.controls[n]?this.controls[n]:(this.controls[n]=r,r.setParent(this),r._registerOnCollectionChange(this._onCollectionChange),r)}addControl(n,r,i={}){this.registerControl(n,r),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(n,r={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}setControl(n,r,i={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],r&&this.registerControl(n,r),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(n){return this.controls.hasOwnProperty(n)&&this.controls[n].enabled}setValue(n,r={}){gE(this,n),Object.keys(n).forEach(i=>{hE(this,i),this.controls[i].setValue(n[i],{onlySelf:!0,emitEvent:r.emitEvent})}),this.updateValueAndValidity(r)}patchValue(n,r={}){null!=n&&(Object.keys(n).forEach(i=>{this.controls[i]&&this.controls[i].patchValue(n[i],{onlySelf:!0,emitEvent:r.emitEvent})}),this.updateValueAndValidity(r))}reset(n={},r={}){this._forEachChild((i,o)=>{i.reset(n[o],{onlySelf:!0,emitEvent:r.emitEvent})}),this._updatePristine(r),this._updateTouched(r),this.updateValueAndValidity(r)}getRawValue(){return this._reduceChildren({},(n,r,i)=>(n[i]=pE(r),n))}_syncPendingControls(){let n=this._reduceChildren(!1,(r,i)=>!!i._syncPendingControls()||r);return n&&this.updateValueAndValidity({onlySelf:!0}),n}_forEachChild(n){Object.keys(this.controls).forEach(r=>{const i=this.controls[r];i&&n(i,r)})}_setUpControls(){this._forEachChild(n=>{n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(n){for(const r of Object.keys(this.controls)){const i=this.controls[r];if(this.contains(r)&&n(i))return!0}return!1}_reduceValue(){return this._reduceChildren({},(n,r,i)=>((r.enabled||this.disabled)&&(n[i]=r.value),n))}_reduceChildren(n,r){let i=n;return this._forEachChild((o,s)=>{i=r(i,o,s)}),i}_allControlsDisabled(){for(const n of Object.keys(this.controls))if(this.controls[n].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}}class QM extends Cf{constructor(n,r,i){super(_f(r),Ef(i,r)),this.controls=n,this._initObservables(),this._setUpdateStrategy(r),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(n){return this.controls[n]}push(n,r={}){this.controls.push(n),this._registerControl(n),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}insert(n,r,i={}){this.controls.splice(n,0,r),this._registerControl(r),this.updateValueAndValidity({emitEvent:i.emitEvent})}removeAt(n,r={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),this.controls.splice(n,1),this.updateValueAndValidity({emitEvent:r.emitEvent})}setControl(n,r,i={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),this.controls.splice(n,1),r&&(this.controls.splice(n,0,r),this._registerControl(r)),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(n,r={}){gE(this,n),n.forEach((i,o)=>{hE(this,o),this.at(o).setValue(i,{onlySelf:!0,emitEvent:r.emitEvent})}),this.updateValueAndValidity(r)}patchValue(n,r={}){null!=n&&(n.forEach((i,o)=>{this.at(o)&&this.at(o).patchValue(i,{onlySelf:!0,emitEvent:r.emitEvent})}),this.updateValueAndValidity(r))}reset(n=[],r={}){this._forEachChild((i,o)=>{i.reset(n[o],{onlySelf:!0,emitEvent:r.emitEvent})}),this._updatePristine(r),this._updateTouched(r),this.updateValueAndValidity(r)}getRawValue(){return this.controls.map(n=>pE(n))}clear(n={}){this.controls.length<1||(this._forEachChild(r=>r._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:n.emitEvent}))}_syncPendingControls(){let n=this.controls.reduce((r,i)=>!!i._syncPendingControls()||r,!1);return n&&this.updateValueAndValidity({onlySelf:!0}),n}_forEachChild(n){this.controls.forEach((r,i)=>{n(r,i)})}_updateValue(){this.value=this.controls.filter(n=>n.enabled||this.disabled).map(n=>n.value)}_anyControls(n){return this.controls.some(r=>r.enabled&&n(r))}_setUpControls(){this._forEachChild(n=>this._registerControl(n))}_allControlsDisabled(){for(const n of this.controls)if(n.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(n){n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange)}}const t3={provide:Qr,useExisting:Ct(()=>Af)},_E=(()=>Promise.resolve(null))();let Af=(()=>{class t extends Qr{constructor(r,i,o,s){super(),this.control=new mE,this._registered=!1,this.update=new kt,this._parent=r,this._setValidators(i),this._setAsyncValidators(o),this.valueAccessor=function vf(t,n){if(!n)return null;let r,i,o;return Array.isArray(n),n.forEach(s=>{s.constructor===uf?r=s:function KM(t){return Object.getPrototypeOf(t.constructor)===yi}(s)?i=s:o=s}),o||i||r||null}(0,s)}ngOnChanges(r){this._checkForErrors(),this._registered||this._setUpControl(),"isDisabled"in r&&this._updateDisabled(r),function mf(t,n){if(!t.hasOwnProperty("model"))return!1;const r=t.model;return!!r.isFirstChange()||!Object.is(n,r.currentValue)}(r,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._parent?function Ac(t,n){return[...n.path,t]}(this.name,this._parent):[this.name]}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(r){this.viewModel=r,this.update.emit(r)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){ks(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(r){_E.then(()=>{this.control.setValue(r,{emitViewToModelChange:!1})})}_updateDisabled(r){const i=r.isDisabled.currentValue,o=""===i||i&&"false"!==i;_E.then(()=>{o&&!this.control.disabled?this.control.disable():!o&&this.control.disabled&&this.control.enable()})}}return t.\u0275fac=function(r){return new(r||t)(Me(fn,9),Me(rn,10),Me(Xr,10),Me(yr,10))},t.\u0275dir=Xe({type:t,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Dt([t3]),St,bn]}),t})(),SE=(()=>{class t{}return t.\u0275fac=function(r){return new(r||t)},t.\u0275mod=En({type:t}),t.\u0275inj=pn({}),t})();const f3={provide:yr,useExisting:Ct(()=>Mc),multi:!0};function wE(t,n){return null==t?`${n}`:(n&&"object"==typeof n&&(n="Object"),`${t}: ${n}`.slice(0,50))}let Mc=(()=>{class t extends yi{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(r){this._compareWith=r}writeValue(r){this.value=r;const i=this._getOptionId(r);null==i&&this.setProperty("selectedIndex",-1);const o=wE(i,r);this.setProperty("value",o)}registerOnChange(r){this.onChange=i=>{this.value=this._getOptionValue(i),r(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(r){for(const i of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(i),r))return i;return null}_getOptionValue(r){const i=function p3(t){return t.split(":")[0]}(r);return this._optionMap.has(i)?this._optionMap.get(i):r}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=mn(t)))(i||t)}}(),t.\u0275dir=Xe({type:t,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(r,i){1&r&&un("change",function(s){return i.onChange(s.target.value)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[Dt([f3]),St]}),t})(),DE=(()=>{class t{constructor(r,i,o){this._element=r,this._renderer=i,this._select=o,this._select&&(this.id=this._select._registerOption())}set ngValue(r){null!=this._select&&(this._select._optionMap.set(this.id,r),this._setElementValue(wE(this.id,r)),this._select.writeValue(this._select.value))}set value(r){this._setElementValue(r),this._select&&this._select.writeValue(this._select.value)}_setElementValue(r){this._renderer.setProperty(this._element.nativeElement,"value",r)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return t.\u0275fac=function(r){return new(r||t)(Me(In),Me(wr),Me(Mc,9))},t.\u0275dir=Xe({type:t,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),t})();const h3={provide:yr,useExisting:Ct(()=>Of),multi:!0};function OE(t,n){return null==t?`${n}`:("string"==typeof n&&(n=`'${n}'`),n&&"object"==typeof n&&(n="Object"),`${t}: ${n}`.slice(0,50))}let Of=(()=>{class t extends yi{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(r){this._compareWith=r}writeValue(r){let i;if(this.value=r,Array.isArray(r)){const o=r.map(s=>this._getOptionId(s));i=(s,a)=>{s._setSelected(o.indexOf(a.toString())>-1)}}else i=(o,s)=>{o._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(r){this.onChange=i=>{const o=[],s=i.selectedOptions;if(void 0!==s){const a=s;for(let l=0;l<a.length;l++){const P=this._getOptionValue(a[l].value);o.push(P)}}else{const a=i.options;for(let l=0;l<a.length;l++){const v=a[l];if(v.selected){const P=this._getOptionValue(v.value);o.push(P)}}}this.value=o,r(o)}}_registerOption(r){const i=(this._idCounter++).toString();return this._optionMap.set(i,r),i}_getOptionId(r){for(const i of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(i)._value,r))return i;return null}_getOptionValue(r){const i=function g3(t){return t.split(":")[0]}(r);return this._optionMap.has(i)?this._optionMap.get(i)._value:r}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=mn(t)))(i||t)}}(),t.\u0275dir=Xe({type:t,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(r,i){1&r&&un("change",function(s){return i.onChange(s.target)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[Dt([h3]),St]}),t})(),NE=(()=>{class t{constructor(r,i,o){this._element=r,this._renderer=i,this._select=o,this._select&&(this.id=this._select._registerOption(this))}set ngValue(r){null!=this._select&&(this._value=r,this._setElementValue(OE(this.id,r)),this._select.writeValue(this._select.value))}set value(r){this._select?(this._value=r,this._setElementValue(OE(this.id,r)),this._select.writeValue(this._select.value)):this._setElementValue(r)}_setElementValue(r){this._renderer.setProperty(this._element.nativeElement,"value",r)}_setSelected(r){this._renderer.setProperty(this._element.nativeElement,"selected",r)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return t.\u0275fac=function(r){return new(r||t)(Me(In),Me(wr),Me(Of,9))},t.\u0275dir=Xe({type:t,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),t})(),T3=(()=>{class t{}return t.\u0275fac=function(r){return new(r||t)},t.\u0275mod=En({type:t}),t.\u0275inj=pn({imports:[[SE]]}),t})(),R3=(()=>{class t{}return t.\u0275fac=function(r){return new(r||t)},t.\u0275mod=En({type:t}),t.\u0275inj=pn({imports:[T3]}),t})();function A3(t,n){1&t&&oo(0,"div",5),2&t&&si("id",n.$implicit)}let I3=(()=>{class t{constructor(r,i){this.ngxAgoraService=r,this.http=i,this.title="agora-video",this.localCallId="agora_local",this.remoteCallId="agora_remote",this.remoteCalls=[],this.uid=Math.floor(100*Math.random()),this.privilegeExpiredTs=8400,this.role="subscriber"}ngOnInit(){let r=new xr;r=r.append("channelName","demo"),r=r.append("role","subscriber"),r=r.append("uid",this.uid.toString()),r=r.append("expiryTime",this.privilegeExpiredTs),this.http.get("http://localhost:8080/access-token",{params:r}).subscribe(i=>{this.tokenA=i.token,console.log("the http resp is !!!!",i.token,this.tokenA),console.log("Token With Integer Number Uid: ",this.tokenA),this.client=this.ngxAgoraService.createClient({mode:"live",codec:"vp8"}),this.assignClientHandlers(),"publisher"==this.role?(this.localStream=this.ngxAgoraService.createStream({streamID:this.uid,audio:!0,video:!0,screen:!1}),this.assignLocalStreamHandlers(),this.initLocalStream(()=>this.join(o=>this.publish(),o=>console.error(o)))):this.remotejoin(()=>this.join(o=>console.log("joined successfully"),o=>console.error(o)))})}remotejoin(r,i){this.client.join(this.tokenA,"demo",this.uid,r,i)}join(r,i){console.log("the token id in the join method is",this.tokenA),this.client.join(this.tokenA,"demo",this.uid,r,i)}publish(){this.client.publish(this.localStream,r=>console.log("Publish local stream error: "+r))}assignClientHandlers(){this.client.on("stream-published",r=>{console.log("Publish local stream successfully")}),this.client.on("error",r=>{console.log("Got error msg:",r.reason),"DYNAMIC_KEY_TIMEOUT"===r.reason&&this.client.renewChannelKey("",()=>console.log("Renewed the channel key successfully."),i=>console.error("Renew channel key failed: ",i))}),this.client.on("stream-added",r=>{this.client.subscribe(r.stream,{audio:!0,video:!0},o=>{console.log("Subscribe stream failed",o)})}),this.client.on("stream-subscribed",r=>{const i=r.stream;this.globalStream=i;const o=this.getRemoteId(i);this.remoteCalls.length||(this.remoteCalls.push(o),setTimeout(()=>i.play(o),1e3))}),this.client.on("stream-removed",r=>{const i=r.stream;i&&(i.stop(),this.remoteCalls=[],console.log(`Remote stream is removed ${i.getId()}`))}),this.client.on("peer-leave",r=>{const i=r.stream;i&&(i.stop(),this.remoteCalls=this.remoteCalls.filter(o=>o!==`${this.getRemoteId(i)}`),console.log(`${r.uid} left from this channel`))})}assignLocalStreamHandlers(){this.localStream.on("accessAllowed",()=>{console.log("accessAllowed")}),this.localStream.on("accessDenied",()=>{console.log("accessDenied")})}initLocalStream(r){this.localStream.init(()=>{this.localStream.play(this.localCallId),r&&r()},i=>console.error("getUserMedia failed",i))}getRemoteId(r){return`agora_remote-${r.getId()}`}leave(){this.globalStream&&(this.globalStream.close(),this.localStream.close(),this.remoteCalls=[],console.log(`Remote stream is removed ${this.globalStream.getId()}`))}}return t.\u0275fac=function(r){return new(r||t)(Me(Dn),Me(D_))},t.\u0275cmp=wo({type:t,selectors:[["app-root"]],decls:12,vars:4,consts:[[3,"ngModel","ngModelChange"],["select",""],["value","subscriber"],["value","publisher"],[1,"local",3,"id"],[1,"remote",3,"id"],["class","remote",3,"id",4,"ngFor","ngForOf"],[3,"click"]],template:function(r,i){1&r&&(ai(0,"select",0,1),un("ngModelChange",function(s){return i.role=s}),ai(2,"option",2),os(3,"viewer"),ci(),ai(4,"option",3),os(5,"host"),ci(),ci(),oo(6,"div",4),oo(7,"div",5),function Bg(t,n,r,i,o,s,a,l){const v=Ne(),P=gt(),W=t+20,X=P.firstCreatePass?function vC(t,n,r,i,o,s,a,l,v){const P=n.consts,W=Gi(n,t,4,a||null,Ur(P,l));nl(n,r,W,Ur(P,v)),ea(n,W);const X=W.tViews=Ta(2,W,i,o,s,n.directiveRegistry,n.pipeRegistry,null,n.schemas,P);return null!==n.queries&&(n.queries.template(n,W),X.queries=n.queries.embeddedTView(W)),W}(W,P,v,n,r,i,o,s,a):P.data[W];ir(X,!1);const ue=v[11].createComment("");ya(P,v,ue,X),tn(ue,v),Ra(v,v[W]=ag(ue,v,ue,X)),Ys(X)&&el(P,v,X),null!=a&&tl(v,X,l)}(8,A3,1,1,"div",6),ai(9,"button",7),un("click",function(){return i.leave()}),os(10,"leave"),ci(),oo(11,"router-outlet")),2&r&&(si("ngModel",i.role),Ea(6),si("id",i.localCallId),Ea(1),si("id",i.remoteCallId),Ea(1),si("ngForOf",i.remoteCalls))},directives:[Mc,oE,Af,DE,NE,qv,Jd],styles:[".local[_ngcontent-%COMP%]{position:fixed;right:1rem;bottom:1rem;width:20vw;height:20vh;border-radius:5px;overflow:hidden;z-index:1}.remote[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:53vw;height:70vh;margin-left:80px}"]}),t})(),w3=(()=>{class t{}return t.\u0275fac=function(r){return new(r||t)},t.\u0275mod=En({type:t,bootstrap:[I3]}),t.\u0275inj=pn({providers:[],imports:[[LD,wM,hM,R3,zD.forRoot({AppID:dy_agora_appId})]]}),t})();(function uI(){yv=!1})(),MD().bootstrapModule(w3).catch(t=>console.error(t))},293:module=>{var ee;window,ee=function(){return function(se){var ee={};function x(I){if(ee[I])return ee[I].exports;var C=ee[I]={i:I,l:!1,exports:{}};return se[I].call(C.exports,C,C.exports,x),C.l=!0,C.exports}return x.m=se,x.c=ee,x.d=function(I,C,w){x.o(I,C)||Object.defineProperty(I,C,{enumerable:!0,get:w})},x.r=function(I){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(I,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(I,"__esModule",{value:!0})},x.t=function(I,C){if(1&C&&(I=x(I)),8&C||4&C&&"object"==typeof I&&I&&I.__esModule)return I;var w=Object.create(null);if(x.r(w),Object.defineProperty(w,"default",{enumerable:!0,value:I}),2&C&&"string"!=typeof I)for(var b in I)x.d(w,b,function(D){return I[D]}.bind(null,b));return w},x.n=function(I){var C=I&&I.__esModule?function(){return I.default}:function(){return I};return x.d(C,"a",C),C},x.o=function(I,C){return Object.prototype.hasOwnProperty.call(I,C)},x.p="",x(x.s=96)}([function(se,ee,x){"use strict";x.r(ee);var I,C=x(11),w=x.n(C),b=function(){var U=new Date;return U.toTimeString().split(" ")[0]+":"+U.getMilliseconds()},D=x(14),m=x(2),R=x(1),f=x(48),g=x.n(f),y=x(49),M=x.n(y),j=new Array(32).fill(void 0);function A(U){return j[U]}j.push(void 0,null,!0,!1);var E=j.length;function F(U){var q,V=A(U);return(q=U)<36||(j[q]=E,E=q),V}var N=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});N.decode();var H=null;function O(){return null!==H&&H.buffer===I.memory.buffer||(H=new Uint8Array(I.memory.buffer)),H}function J(U,V){return N.decode(O().subarray(U,U+V))}function te(U){E===j.length&&j.push(j.length+1);var V=E;return E=j[V],j[V]=U,V}var Y=0,ne=new TextEncoder("utf-8"),G="function"==typeof ne.encodeInto?function(U,V){return ne.encodeInto(U,V)}:function(U,V){var q=ne.encode(U);return V.set(q),{read:U.length,written:q.length}},_=null;function u(){return null!==_&&_.buffer===I.memory.buffer||(_=new Int32Array(I.memory.buffer)),_}var z,B=function(){function U(){g()(this,U)}return M()(U,[{key:"free",value:function(){var V=this.ptr;this.ptr=0,I.__wbg_signmanager_free(V)}},{key:"get_digest",value:function(V){return F(I.signmanager_get_digest(this.ptr,te(V)))}}],[{key:"__wrap",value:function(V){var q=Object.create(U.prototype);return q.ptr=V,q}},{key:"new",value:function(){var V=I.signmanager_new();return U.__wrap(V)}}]),U}(),S=!1,c=null,d=0,T="free",L=[],$=[],Z=0;(c?Promise.resolve(c):new Promise(function(U){S||I||function V(){var q={wbg:{}};q.wbg.__wbindgen_object_drop_ref=function(le){F(le)},q.wbg.__wbindgen_string_new=function(le,k){return te(J(le,k))},q.wbg.__wbindgen_string_get=function(le,k){var Ae=A(k),Ge="string"==typeof Ae?Ae:void 0,Ve=null==Ge?0:function(We,ie,h){if(void 0===h){var Q=ne.encode(We),ae=ie(Q.length);return O().subarray(ae,ae+Q.length).set(Q),Y=Q.length,ae}for(var fe=We.length,me=(ae=ie(fe),O()),K=0;K<fe;K++){var ge=We.charCodeAt(K);if(ge>127)break;me[ae+K]=ge}if(K!==fe){0!==K&&(We=We.slice(K)),ae=h(ae,fe,fe=K+3*We.length);var ve=O().subarray(ae+K,ae+fe);K+=G(We,ve).written}return Y=K,ae}(Ge,I.__wbindgen_malloc,I.__wbindgen_realloc),Fe=Y;u()[le/4+1]=Fe,u()[le/4+0]=Ve},q.wbg.__wbindgen_throw=function(le,k){throw new Error(J(le,k))};for(var pe=Uint8Array.from(atob("55ZBgM/2Bzm2JGhNn//ljJsSorhWUYE66a1Hf8O7pfQGR2zfol8qRP6CDhsi3iG7nFZu9stSyPq/qu2Rr2w8QkTGP6Gm2cg3J5qsQgq5bcHA9mDpGv/b24uEwsixZVl1eGkdV4SB/6ayw2v48hLmNA+w5UlnTCiWwerzESQPidpSUMbamXL3pU815EQm12GhhZ9aWzo568gdZvXevBc/WHfFKQSuTgWva4e4eSmW7UxpH8sY4HlDsCTMu0WwEB8B95XsZwOp3GLgfOQmJBw036DgIKU+XGn4KpIEq77WE/h6R7sZKsFUp+u+2cDnW7IPNe7xfd9areFo0EUh0/9K9CqxUkLqMB5hlgS1fwQHRzKPhQ7gALyc6HwMCPooS0M1NrzjdfH3vUn0PeQ1GBlnrnXgiu8TunfHg5TcbBfPEbxbyiiow1Np+VEBlHNh00PiAWyu024NHaPbDGfMtzu4WF02fgkh8Pxb7bCSpCZndjTytQgAzfZxk2bbe6NoHHFnsviqYzHVpxoPEk7icHRWcZC28d2muthq673KCMQay1fJcPqSTuYhWUZS5eylIguT33lP+TBbOWQI8KtCzBN5FzqILfKzRkzrJ3L192BUF8SILdwmriv10HU9ZlQAyQA1VdegnzOl/dYk2GGsB3724y7w/7aJLHJzEfwrfIzFd5CoAft7ct+zQW2G4Wm2kpoz6uJfgrNyykQgwCO6pkPy1ADrBUuJon9ySjhgcFru6AKa99wTlIhzBw3FKFt9Aa1/1KWWy7W1wAIGzRTs/7rLXRkKFjNqGVXBdoVNTpHFtfEFsuX0X98ISr0Bennlx0h2Yl/CGNb5Kc7i3bio1XJHX24avcMsEAwfdfskCki4/dkStn7QC97YJC3z+7gD84IiEEeGcnn7gHJyeALr0ssbqDUcKqxEyheyFs9FToJziLB+eYw6nMQLmYTrQyrg3b+3YBdgx7pzNEDSyz3tmaPaikwcLSyB/Igo6U/oP/fS2TZLtmN03m4iS76YrDJAgI+2W1GboabuixVcLdxm6SQ4CzUnHSPl1knhcGhW/+OcKa53tB5j5C4wEpiENv6T9PUu4K0YwtEAqFbd/eN2wVAYCKn/nlVA8uiESxCfgs0411mRFk4i1pixJLPP5AFPG9QFZnj6X19TqmhmIhl8D6Q1rOvPCqPZV/z04HjayX4qPzPzP/5NVilN/sHhQe7ulriGmU/3rj5QEuiOymsL7EdCQMc/4mXDPdVrDBfbt6dnv11oLYGmqOP1oSBj02FtsmYrMn9pRg7HJoCh86jAnzuOYn4tGnQ4gw/89sb64NAXcoIbTIjyiHBAQCCK2Yn4I/fNF10rkQlvSvkpqLG2eYpJmpWrcouNDEUtJFR607oNraLdmUKyLc1g7SNpS+ofp1FL6rua/HFSrb5kTF2Vcy2gl+6MACbFRChKoP/un7IbYJuOima/JWFZcs/MXokIx+ijuqjMtVKaYRTzNI5ncPa2y/EXTNdUUFpMhbE7sa39Uoh6Hci/viXy2KFTNbiw+BkWOPnyOr04LjIYKlJ8ud/KvjuvNUGQOHJvj6tpZJxj97tr0OrgZCAxSHGU5JQfqEd/U0QfzGM8Wh3zdsnd9LhoIIRJAtyA2PmjwJk4zTxeYlgwPqAVTU3+9bA1QD+jLZZ3Ffk3MRq+Ar2RT8YN6ASR4bItt3omBj0LJe0zeGY3OzfhljL6LA1m4+IUp+CzeWo0aEjnvRk3iCJeajgdC+NUGB5qh8PWKtBeC58woavnRjvRNphXS4b9M7Aymcfq26B2YY2lS+wLf763OnGJlVdV/srgyAUJJZjarxom4zrYy23kLFB8zFzWuwSMue5Xm1YWape91JGDuRLIctrJWU47/XfLm6Zgei4xOwq1RcjikGuaZtDwcFg9aKtO+JOGJsCjy9AiPnmt+rmdX83GsT3KtTETnLv6ZQcnGtmt4H8AjFgGYePdQc40cj8VAOV8NCLspyW5w63b3g37GXJrzjm9Fym3fh27psjo5RuTs7XCSrNENxKm9jCcXPqWxyuXJSn6dhdWnw5SAnUjixXviWS4HsnYjw4Xt4cSwkqCB9naLstVXt5D2HgG4fzHFNHvnETft0mrhU81IBDTSyNFdDvFEX8cifoc6FcNq7pzXlotl2ZS1FIzNXddZrdXpBNYZPV52gtCok6ePpUR/Y8jyJpE9P3q8dmFVivVGgmKTcBKMDDbzeOfl4MpOGBtBX/Lab/kzqG42sTyOyGUyOoFXYGMUWJ33GPI2KNa/mW8zVl+imshfbj7PiK1qRUn74KjAkH4wjKnu50AONYUaiveSdwnEc1zCjZSJ3dmBKSxhWAcO2PdHBg5m9+JCiPGCVfK9dzoM8Bm7xx9noJiqt4hNiVa5di1Fd1JRN4rnd1DbKglKpAVSoqvJPxmuyH56TFE4BQjhfKbDMZezQJqx+KXDiW1JWGeDYaPVBWPYeZX6STIzC/DjS7UFlqoKgGGAGP17x8wmMRE6O/axG5jDzloCGxCmrymT0ZGCh4g54O1iDYUtmJr7Bo1d+H9RQj2Y10BxcMkLFTIZVjm9e3vtIbeRx0OdXE1Ou37J/WeJZyPXn1fszvp/KonCqVnt862LrxfoB/0sF5gk4Y/f6LVneU5hun9/V1OVre9XrnDBhcVaQa9Ye6gs8sHW9HCNchaFbkUpxSiyxVEFZIlbejbjSPFlkYOLhtQHduwZWRHWA9akqykJNG3PKvOZAaJG5nWQq8+e4K0JF/AXTKIIr4J7zDt8ZR4xb9T2gxjl1nfqzidMRIY5B4rkw0oetta+j8rqkFpTEGA+hU/tw7bDtpkPYvCguwncnCjwULNFT9I9jXx3H4Ws3WWMCit29F7kGq2Ka+rU/MjnuP0lsXkoB1rr8LawHH5gaf8rajq/BhKrGTIfjDiZG5qz+L7SZBZsMSZZ9pM1QhKju+GTD9iC+9HlhfXMtj94gz8U4h7eGXziEO7lo7LwLL6/DVMrGbkv68JYUYhGz2yBm/8cbQEh5vhakbhmpv1K6XYM9rzdsd9bwYcYt3cfKE3m+/NrUa42+RpJBdFg7cAmxsZ7/0TMyVw6Aqu2gzldb2ag4iLrPNEyW1ywaJ2DXMgPi/sjnDzhuo+vIUrc86j4ZLhT4GAN6uqwbnXq5UDzX7TfuB48oMvvE1sK5q6owkdWfklgnC6pSBpK7wl+e3kuvaYnGRGJJMBQuVgWL1awHrVtfOTsSE1vc0ZdG+a/Jbza6pHbyfi5L7FXJAGdQTk0EP3VT54+F7RZ/MJ9fj56aMxzhJRwQJ6df3cM26qSc5bW/zP3PFXypTOBwzCvVtwGQzkGvDW7XGwgLbTNHDpQXOd2BQ5Zd9bjQqGg+S+kIqWZVZCqVLfyFPF9bEOHfPepL6nRDJUD2l5uRnXqeTvidaSIoqS1Fbc6mLPtYnbp6uuts6Qo8TbMzFuI7NuaPuKnQIyVu7vUGJ8jg1uVOjlMNKdVtLPr9/ZEKVZVj7lsFA+nm3zRjjr1DRKhr/wY1CI1iXKVTeQZ0i2PSnN99j4iVTSwNAYQLWWD+KyZ/xRLVxmZQPuSkLeKBRAkavxjWnIFQb1dn72wMSUdcB9cNCNJNdyTkrl44MRR+pUuiVrTAnTlzL33X32eEYwT+vn564yxFJLUDyIMNjJ0nx+GreKSOglI2et0kAwRHKYFclH9GVTiVlB0TWeUJGD+7JYogF7BizjTGyPOUEWQCguIEmtC4fHD5461T80Z3Mp7rhNTI+Cswuknr9hrIZmpRyFSrSrP8R4S1Cf34Tu4RNrDxpofVK9nGTklZPsYM6eiP29Lx264fsX9oLdYhq7vCwcrRMJ1a5d0QHXUYRV5IqTFBoUSpxkQ6IHHL8ckM4NCzwk8K0CA3pj5Jp2a9wZjfKq7R/eukzQFuhMxV2qgHf2E3t7/SA8N7sMvsmF0p3J96QRE3rA85ekH1q8nrBVujlIqahmL0Qto3+JxdqAfnKMCblQGSKVWZgWLMm82MG/9pjhdkMzG7C2GRLGMty2y8NhX1pZWHNbLOmvaC424LNz/Nl5tkPv7fVbCT2ItB+/dx3ZhVhmgSLd1zL+2PsNFmj7VGBruTttezlo1mDKErjY27nTswjf2fY/Uq8lPcVAgRpJM+m7jS/8dk8cdl7fkY7Tuj4TfiSe0tiNSoJgZwom4+9haoBQ65AifaB7pUiTc0MAXCvG+nDydkRIbKx5fL6gAlyMAnBbQf+Qh1naLfzzwLVTP0EEyoenW2W1zKqfMql5rwGlyCB9mSa2s25yHf4SDSBlgEVMJtplpRgegZvDakpWDKgx3UR4W7yKW+RD7bd7rEa/GQmA/q0RYAOIaXfO/2CgEUPtNhPS2uqy29lBYFPPv5SHQ0t/jRxQLBpe09ateAWKypt9TWS7Z5gynOePS5M2NC16AhF0Xz6s7DUjtI0xNho9Y6GK16J5V8HqHypV/OAz7+VBzTaiR57XGH4r62GoAiJqfWOM7okzKCeeSBnOIKPHtwgM0SQbvCvv7rmS6ZAacu4BbXZ5R9gOhdR9H3bi7lWLBNnqqLPIy0k6m4XBhtl40B6z/5AcJxjtKfwvIExl7VsQRqbW8gpPMsmJZfSp3uC35g1AkP+BJlju3RVoFZNo3JR18A5uc60NGD4zvzIdGTAOth4ZAZx0ZGQItHuNcLz/0CiavJdkjD65h4avf1vf7LFZ1uogJz6vLK3uDisXIBIGkXOlIpxTdjjjTQt6Khy50bYbXsG9JBrSUGhsBWpeRUnq2cZWOifhfueY95gFIDAu37oKR3FQ1YxGMg3UMq+L2VN2rtqodelSHof8SyYZVQWs7L0bjtgolId1tAAjHI7J1/+JIRXeUBjjaGGQAU+az9XFfiqn+VRAGG8JDdP/WmEqjhYpcy00LIBIBzCF9I9mbXCv8IX9fhPlI5NqWGO/v0ikpfn+hb5U16FcPYsx+xLb4la6nSbvrTDP5MthPyeLIIY7ZE/rNU4ajgPmI0/3RvD7WtEbo8UGPjnev55N2ELuFpEPzkNu9MzXqq8K0cWxk4lT2DQPi3rDO8x8i5jX7wWQi8e0neCMb0SUO67zRfaekZONGfaFl47LByciUuy5dhqxMPokhTE2WbzxqCyt/s2TqG66R0ocYHmzv9f7tJ+TES8NFyzL3fhNoZoW5IxWNE+stYWutd3LPwa7HKhhRAbl5uCEbEGjrUzTXwbzG0qvpmNtpnYnmKjzTaSAFNCxfw9edcjaxCiRKKIDd6GS/eDsGBgTvJexDfwGmVWm9jadZhee9jRFiZFtL6m7sY1oQa8F9ycxSuPANXCqWkApcaEfQLkt1yyfeRs5yC5O/6XGJ4TEtJmCTPJFRr95au20STIPgkoEF1mzZ+5ZRtWKUYuWJVZDwcA/lTy6oYp0/d0LGPRUXnXRm0qtIXQVdnoVhKZPeWACt9rujRL57MEDi2kHtfV/ucu+k03bN0fQlbalUJ0faY99GC6L8MO8MXTSmqDAxNSpqpIFPhgHgAg0YK/GZhlQjbQXE4tMDEDO9obNfp4W6m8fdznMesSSRINBG5FDf//DkT9pSRQsIdSg4VK7W7j2d2jsQUIyjJmbd/2zCTaqh0Yq0cH6mS/5g/cq3eGOiJbaCNo6oVwGURzXVAeVaGIfJFhd2A59sVp+rVfe1f8B6bVbCLIKgGUgpUokO0vTg6ouAxXGQKtveMhhBT83ukPIRZ02+qF1kvM+nNCVy8uzrB0+W9QIKbMio2m/7zW78xd5Tf9itocpLbRuNC5cuS/GyRGXw6fzFzjM1UITlQ5dlvoyYxuvb7ol4S1MyhkfMNZbif6/xic0wB3uSScez3oFTRbCHBd0cbJL3cLwfQjCBpGBrRVC7174qW4XWnw0eYGSSzTVSEDOlMaTUIGJO+s7/z8JxaZprcEsoB4+vt9/+uwtM/iyqLVPidu8ZTh+F1rsEWKwZhDAg/giVc6VzRq+DJCrhn81b/LYlLJOdgoAjID2VnwgU+mQhCL6KhgIqqiVraD25UIYEqxMcZ1aRcZvHa8x5gh5onPtsVcl53Xek9BOYqkyj64acX921zwqoY0lmNA81NE7BzVts3cwWDZ4Dk6uuzwtfJuJc7vVS+fdVDEg3ATwC9oG5/Vb1swTyzTsl2V4m+93bSQo5STFG5AruTDWTym6Lxtt4OrAeIVgdoyTJL+keHiHTNiL0/nO5oYwftSQK1aYBuA0e12t/FVN+LsCk0L/hfCCcke89LuP4d46qnFo3NLpHb+NFrvekXVT4GiZgMW2H0orIY0TpS15wlxVUaGCUo7YSN0yWDRU5+p41dCOs5/vXq1do7K+Byjj35/mPlQ+VEDqqF7OIBQrXfHgCXYPy8ye3Ih3io+tYA6nK0/2clIERrpA0AMHKLTGEO7q/IzIcOCwYN9W/ISH4v4uk9MhzNu7Fg2IPCq5CQF1GLuzQu+wNv2h94NIA2UJydawv5X2bHkZjv+kB/WQCYjxUNEU8ssUdxDZstpv2qNAHmI6BMD84olxMiwFdK5J80zc9x7de/cz3ZNIkkGIpMCZJqKKkaLVo1MLnR/h/hQeUvfqJmvkPeIre3EjnliNkKJKL0KNaupHzY7Eoztaj0cNOhJ5dxIRB2is3kLcSK1FZswRJR0B5OXX+Q4UlFIrhR10lIge3Fg5DnaGoZoOyFaaHztrdF251JubDsCZRDSWA0y6ysykO+h4jhXtuWF7D5Wp7B4Hx3EQvKsmPPZYcLevowjlWghHbRBEhwPI3bzjhNWXlqtym5ObYAeYxuHyvyYue2X4651f7Om3+m8KT7Y/JqLWXwgayCdzxHuJidti1ITuf/oXzeCfTRbG5ytXlDk/epX061W6BO074jI7nV518OkYtRJDnPqdDFAf0uWcATfk0h17+gP7GHjy0Rc0Ive9XmvA6gCkoMjNjMEA7GQ3xy7e12DzfNpIfND7GKKojMifTrvkDXrfa3o4wNYktY6/VlBdHtrcH9F7uMWICej/BjZXVX83WFGcVHx3nOXxSL59kE9bSmHc3Xp8iDbPuSG5GIRp3fTFHnmTzzGedl6al2gUbGFKtkC0jFNtKTk2rr8LEObiGgfCoSpTWknvAYDQBoj93s0KiRNPOqgY++Xka2cQiDwqUsLl8/i57YC/V6sy5/NvhViRRZgCzcyjNHGzZsYA5YMtUntyfC1gNFP7cL3AwVA+326NJI7MQJoxTqcHL/YhntsnYTR5R6GVVvFYIlW8Nv9qn3daoGXMz0MoAsXpCzbiHZ0XWkfw2qlJkmZjgQtMAEhHXNgokGRPfOprmtlvNZaNlGB1EjQTVX1Y4tCyJFZhdhID4CowB23uQF16NifyxH+DGnQrnxeklnG7UQV2BRVdr6ZEKZYv7Gj+PbpojzAskvbdtaFsataqPrLDoejjc6ZfPA5zA0iYcCvcNjzuy9SuT0uG8NWMTLv2OsImL++PQV1sifUENAwi4O3yBvzTy4J77B7mMBpjCYGXAyjFGFZL4eAazSmvZ8thJ0FFW+keLHL+ft1dQBKmXY6JatelGebcIC/PyLBHdfX9bRcauGg4xEO7mMl8AjlcPMczkPniNQpiQFqcDJYrFGoxMV2hskxMn0bRQT8Ajc6w6sQYkGl0CQUImPrGfie9dsk4mrCLMIFOqcm0WT8O8AiREEGmooBTO7WI0qk506NsV7ffvc0rVJERJKcyRyCmFZdTSn/SrBfjV7SXT3pQlgluoY4FBUCDDkzwBgjkrE1oFUA3ls+xVP10w5jjBIMwKBSQqRVAEDXw+Dyj+jH3ila8czULWsCKhWd4qGsMFN7++OGBAz9eXHjAO9m++mTXF6qiyG35Q+61yjYQKsBrjR4NNexrwVGqBwAZA6cr5mp8AhoyzPomJ6TLfWEJjEeRI3QsX5oQkNuyF7u650QFka+VjFeNRY6ALklleTW9I0v4ABKDCXTGkjv80vqVNk+FTL0bJK7ndSjjMJD7OBFIEywBPJFrxTdyzocmxEgG0zu1VDgsQuXITYCx1RRty89A/F+CdSAlbMlIkptCC0GrF/jFS8PAU+6TNV1eBqJrCr9BgH1mth8FtdfE7druR+xyZKn5idfUKzGW6ACGF4M61IRoSs9o6xmaj3dnAVQvFWUsMcR6MI3xTKJNyMxkhXhhvT0IxialnG7i/BBzXfMXYh5jl4BXzCSNlxU4+aboEgIDr48/+pfj8J3WcNccFfzV6eiX05qkNktmafoBcxrEsrM8WQV0VVSRybQyXPOqJ1yndwBI6BOGO9oGxGDAd+HcKaZlptCMJsR1Cp3m7F9HpBFSu/NYVj+WSDY7jWSFBlTBSCFyyPEUn8S9NmBVa+mwGVsz0Q+fxe23w1w6wVO7sVnZqRpmXJeXg72QFkl7Qda1lBzn/FW+rRwLvFxCsuad67Wmzab1RJdzPGsuq8AzW6tL+JiwW/VPUSBbBmV1+EjqQ28x1u9W5Eoy7zhsU8NT87CtNbZ0lPEpsoWMewxC80kPanfWPrQXmixWDXXz7uf1kBTr1J/iYuls7fUsyAChXjKcKOaCF4ySqkhMTGmjNqYiG5joBUi/SZpWvgxk28pyIPhf28YULINiqmbWPBKuTCLFruV7JfRgGM87XfNEFc7tgnYx503k/0UXJfpmjx6wKbKcvV5fqrctx+OrIn++TxRxSKlTScEIwd2vG5mg/p5wsQDpiD+X91XbkReKLB25Jvp/IJaJh715RXqBzwCwlY3URonyy+oZoTD8Ym8XMMv/dMllh0LCFZkZFn2gYcLG9iO+I5S/GyxwjajQLQtwH7o+n50vimC+ES8ePOpPDwlu4oG8KhS7NL/OTdIWPIHbSa6/9DfjOq9W66EpaK57R78PpEzVNLkTP2L6lllqDT6SDhIDIvQS3SQbxG96khXgvW/rME+tiXFXi+BC0udi9keyGlc3sLBN3CP3QXzswhBGTxvz2LmRMkU3rLuSkYR1Gzr7vj1VxTN1y1iciA0DswsPZ38eB6X10Uzk6HZqjzBK+EJ5osJJJ/s3b0MFRIWYlM15TPm1uzeOk1zQ96quClQLEZbpxmV/eAduIotXUYQZjWAkTulBJt7kw9uEnLo7OpZrf8k+0ZQP0agcOTLbfrekHji86Mxr7rTwve82mePKoAkkEthE45VI+f1VqpyWNW1kbBbVVfuatKt6MEKqyTUyxSFGHk81kY7CxkgMNexiikN0+IeiUNsfuktjfOAiMfDhbTe4rtxSEPvO4CCUGaktA58TGnSO8rHdCicmGkNrwWsnXgUWjhp8bllNcnQN10TbwxYPAwQKW/JJiYQadr4THXO+vWudiq3I47vqmEM/Ab3Dlq11Q7RmRWntYOEyESbTI8PZYwbtsmjcSwBtTAIHQ5h3I633h3FpOkT2c0PlMjzj0Q/OuqaTVt639fowVppqvSlNcK5KupBnrxfKHQK+SoKSuaO8PNMkYkbcEAc9F0I4uzPfRVP/q5QkvJVsVoJ8BEWW/q1+kivHEMQfb+J2NfJjSTG+WhjHjL8eqi7FgfVewxwmqG9IOnTkwDjAHUaJMIyhVkadW/+GQjLyNP4zyHcLAdWcB5zQ2kc/blAx2RKfG+ON3RfC+iQ5Th7V2i5abkoy0pjfyOwTjIvaq9slSCtoNGBZggBDOiWwau0CX4NAIThFyqu9VWCLr8TsqhQZvQP+xrywovGs6A079U7YBjhEXyQw4Q3rbQY1EQnxTPXNlHfn9vQnuhsJnzx6PZrCqry8fidPz2U1scmAMVPHxa/injIf+hDziEU02xWm9ou67OgebktON9V6wwVotoNOzVNJhiDBlHbktBwOjX1BlJHybLox5y/7NhR7uc8f85O6xdxueabhwtJjYcBzac56v6RbuI9IRvPzOnNbltj8Hh0ftwwhWyHAyiEat0oDSEVZ925jmxJKAqTo4/uHnkozgMDsnkzXPXBDJ1sDTawXy23mXuTJOYV6ZVWrervMaGGGQpgQjAnfP7KPZro+OKt/MpnoM0NeGQgIFAiH7dU7Nl1QbcMiwO6/5nIosJtrFB8w1kpqb6OjI9BgZHG1nzTMGA++HNrl4WQNcq3SajD4C9utQYAu/fETPFMMJeCDwHRCnPuRAlqJ5t0E5h3Wlh1Nw57LQ36kDjC3lS9w0a89eI8ym6BzEA25Cdz3LQAyz94Fvjqp7MyHrpm3PzmsV/tbSLF9NJBjFmzWPQ8Tfgvj3fi8dg78tXvEatqtUhLxsNp2VCU6IzSqafxWw93+Wk47skJv5qxM+tv7CrpYKvWLEylJNEXlh7GHm9UenNf2/szZOl+54P4ZWksh1r6+rphL68QYhmqW7DqKVrc2rjzPYcvFDmKtCGL/F62i3riMV9z+LoLnuVaMn4dtpNNFmQEQ4uEhDfLYU4x8G2OHCz7gnxLCa4zE4CFo9m/+ECmdzziVumHM/P00/BESH2rxUYMBL8/9NRG5fiskFJr4AO0qNUKUCgTRgEiFsTbGXtP4DTTzc8ZAmfNJuJQE5Kp7W7U7QZnBXKepfSHkYTEqgOhqo95Jw9i56kYGt4BWwX50mC27CCW92SVMl4tbUEhBDSB36zgztz5Zts0563Kjc34B+6ZUnMIk+BiQNvqSkZHnk3rHNSaYthO72IWLIxij0hcv7n228yc82FsQLK9jmptjY6estDfH3OSMaAj+poCLKwRFXvXWb6jwM9mG4nu1yug0Cc4L89w4EYek6dnV17VBfIxB2dmFFQdp0kqx3BM9gdMAr0KS7WLOSf3cn5eDItDLP2UW7MWaIR+GJ0EGcEL3ejBdu0to6vDh04JcRMNU55usmSn3jp74myzWE3azMIT96wr39F62c3G/ldGskbqTIMTk3gMg61vNBQ0cJSIxVdcgNb3xFDowwVyIqYz54F8Rqg0uQE4FIiUGZxJhND/AWhkukqIqLLZEpxj07kPBN6Zb2pWht/X5JrC8yJzPlvFhfJndQ4jcgjFyhvymr/a17uxTKHpKNWDEoL4nNa9/Prf7TYRw6Gyo6vcwYcUHk17SMb9aEdVnx24msNCDEKbj0OVzRaA3gFJeXZPObqJKvWqFlavGpxXnP+4ZYTl0Dmcri6vMdwX687ApG+ygiGHZDwNzU68F4JMPQ9JB45vLkCsE2w50QNP1kJZlI56dVGzfK1MyRqP4J6VshesfOT4hzR6MYq373IoONlLvENdYXN6pTxo5eRzQkwk2tZ1zmZqczCytqTEhpweKcBCCZ/FhizgLm8/x5ScBlO0wEXHZm90mpmL1gR/J2CUnz3wDU99YFFKqm01AZ8q2S5Fnh81CbD687c7K2OjWlZgdvEJA9M0JT3eKdIRd9GCx6g1TO5PWTE8OOphUDKdazyYnmMqFhFxfJ//cWJTsgYbol2a7Ob/Q69Fy3kb9K7aZLzH+Kl/uCzWnqTOrQonVL7LTFPr7wbTaepfAl5zSgMInjrGXY+Gspw+fCNgEU1zyC0Suum6VFyHBjdKWft7strrOXqOSQwxsYXp4F013mN9gZyu4Hc84A4dzIHN5UNXmxNn+vPjS82JM6klySWB9pLCzLBUgXiMDllaG6fT2PSBv/b+yaruyWBVcpsOKuEaQ37W3A3t9YFRcgB5rFMDjwOn3c0lfsg+5V+dBX2EmWLTSelNZkeq67CFnxaKtnlsAJRPBqYvoWVZcJKn0zSelrO2TwnailO7zgAHaMRmQYbXo9beBs16JWf7V8LjYGS/DYUKTTE1zKECC/pK1EKf6mxIgmV+mJ+Mc8h04qep+okIIEXaN351J3N0VUk7cEEaOLE1rFF3W4vqRcodPfbLqINF6QtTsfny1+O46J5ahlamZEyxglZtpjEkKd9yKDsgwnzqoAPN5o76IsI+FRaBc8u1qLBWxpKU615chTVegNFR5V4o1T2JGwVkueD6CjAhOplPnRyv8sauMnMy2wEMARR6AmCQ8S5ebL0nCEqjSztMoUyAEjQ6FDYqkGweu48DkBR5HjwlBloKVawYcDezxKBH8WWnMpJKZj1Ol+OHMmg5iq9xDswLx0iTNkujgatOkeRU0c/GmSSH+7GTTMLQJdj51l3EkojjEwWOjw8XBOm88GqC4bWPEE+U/5XYtZNJG/X4FYjgIvVd69RYVbMEMfPSKJ825e3XQ6RBesp/G+lkMk4VIxRakyUBPLO1u0UYnNG9ExAnPdOO0OfFvcPOL9rBJO8bR+q9Lp9/i+fH32KkaNR2WgoxQY3FY+rS2NUvtCOgZAaF9vny16WG/3zeUtRP9V28PcGivAHAwwCcRk0D0iohjAfgL/EKXJkr8gIFqbNq7lXUFRKqMbpBa182ol77SqJq1M5setGUJuSBKqYBYKdDZv3XdT/u6J5aKKkLvA5ez6PuWX0RT7kELSKDKfg9w9nwSmMmJHjbnr0blM2WvpiirR/nLid6SRN9+5KoLUb+pLw3QzD8JlS3X2q0m4BNRxfltr5KWqryOuuGDt6IOHSE8/zqGXMiTqgrUOfDH58NoWe0te4mFc1GxswvhZXWJZmaWaMJo2SBnuXa7+jIfFbnhNH74Z6jygwcqXsldYfI/Zh8BZbqTh2I7Hu44dilfbX8Uh18NVB3phRnTwpUonKquUs/iZXRnDFjtEmKg2YRQm2CP1FWRb/B92HqJlHT7Hs/Tpl3RrlxvkoskpNlW53/6Ujse0fkHLNeUm97TlDsaRXpfZkR1uWMTwhPv4oYM2Bv941R+c7nQ0yBdFNVQpZRkpejmIfjFrdQUA7DPwR69aq6Pzmk3IXarIMKG6R4MBdkB3j3HWxohnZLWpaNy/BMxS+84e4vPPfO/7+nLWVZsdpUY/nGDkQts0NGnRpZK/lW60tmncMoTepY5fMbow1GyKhqSXLbOZkz59l8DG9v9ZHPwA1roKz3MW/j2tN/U+lPQVYXTa6h1ePQkSWR2bp9OHmCCvT6s8v9PVG2ufK7dkbpY500gNx7fdArzH3yCjY33Fa5TbOuybLNdW8juJyJtikDn+5jMnMzIWP/+v12XkaXj195xk6eOKuvA5zeKk1i1PrSnmWA46Ca2ldgNqJ0rvLqM9X2EPn/QuMjLnLg0iVJ4H4r5S2PgpGdSdfVoiX/rBAq6yVDc30v8DOUae4oquSM0YDCIafLQ+hvEmB5b/f+QsTFtAR0zIVWeLyYbmrx3g9gHhVRfelCz9/exh19AGsyXcwuSaBiCzQIoctYvyhhkdCsC/cdZDce/1Fav35JQt+RJFAjiMRQhCdE4eS3SmfsREHe9LZa0ElOLhxxvs5uS/SnMYssyK9FxiucRjjOqfaIp2N8CmuNJqg3WvtMk+MlbAYeji9K94rx6U7nj9L1TGhVcAyz+Gb4sib21AW94HRzWbTrRKEkx5+KLE69Vc+8Cj1Vu2GkZ1AA2E4kaJ2aTjsEL2C0srAINXRAjnxwI3p5ED0NRYn9sT1iY9GPBJwhhd6WXEJ/Z44D0rufaDOA8dUj1SIqywRs2b7SjYcCYS8eefkwdWlpN0DvnecdwHVc3TqyCcUy7K2PMS2l2KZHzZfLCTCPaPq/NVc/Nlc5hVJoFvnNUpKWZcTsxVeHfH1mnELREECq9YES9v6FcvONCxXLQmf0k3S2dyNmsxbvlXM0u7lSqkx81md0rad3E33PPuPpDGM9UiBhSeJn3Sejmx+LdLCiZYcVxow59nCqrUmXGAbsR4O7wVQzyHdL6DX5s8k5BjHXlONz0PaIqS89xMhkYetMw6w7JZ5c/oJBH2jdZPbS6KbR0RpEe16BATLzU4QiHybxArrjBM8MKKP8Zz6MVbg/d8yb76U8nQzCK4Eqa5ombBm7/6xo2dR9O/ByfcU6qDu+efdLFAP4LiCr6C3aihDPjigUYuy0voLuX3Flevl7xXRtRZ4Vc48j2tgA7tK0wqv4OjLwCzZJn9lYIQuScQBEFMBjA6Vj8FTp4h3OphB6g0uA13nTnVLmKQ+zfELl+6znWX5nCWvbwak0t3q4qwWK3MAPKE2vqDEeCsFKvmJ2Ws+VOqnrA+ekCk9jaszBsZd71InADWijT4SHnyVmc55dv5ivXl1fED4vwNrxbiZHWeGinS3ImcoDAT1vGiLpP/D3NaiIPq9A2h5DT5SgaCVCh0JKu7DKsHjW9ZAACRxHgTSo5jrVWUJfGKweg2auQuittVidB+JaCdwYd0x9oJ4jyI5UygrB9Nzi2gbLVcCnpu+1ytsiWCbJb1Xxas8FhG/EX86taG6flZZauhaGnpRyfBB5ojGdsdPBVHEtb8R951oaNTvKXK7CddSeWaeOi2FIDPEhWhAk19RzuR9wSKEwvvi8nQFz649+fUlBMuDL7VmUBSsC1ExWwqY+uSdNKowEkpsBb+/KpWl6oGxymyR/e4uKjipBJrVPXg0nE2j6HL2JbCHNh01lV+/+6FUglhV8GTypzdvdfhYc7t0ZYtkyH/17wDakU7r1GAdUIXXmtxamhK2FdelBa4BPryblCC9gJG9htJue9LMrNS7mM6gbRA1xSFnWNsziDuGZeS3Dcu4bjsWaIebrgNnxpl/pLGxV5EtkFwDeh8fPyfPU8CZAM/Ljk3+Vi7jUtNZmZM8+f7d4wlUIkTHiAULRUKu0ODFIeyk20BiqLB7vvAT342SIDP+z5FPaa6Tjyqh/AsX2jFhbeIXKxDMb8fid0jHAWk6JKhswbtvtP6bDz+lYjvXIPwV1Y+nyft2uM8c1aUxmDHAUmZnJBvZXT43mxjXDHP05R1/dKfoExcgcYzv3wO5mazi7ugS01z6oUmByKtfQ6fA2+MQynPCoDHcp1eDtag/E3HQpHMWAgGkNh9wWR5Y48YG0W4CgvOrngI111j/x+MIuH5xFlVkxqptSjW+hnVbt9qxtXndEH5RtnxWfd9eP+kli/x3LU1WGsZVAkVElXD274LBGK0bMveEUbj/6EpnocEnvRSlglpE4GiAO5S4JdYb4uYd6oeK8vuZvTQaWMS3dEIJ2ssCxWz8DqYmc/b38ynz0DWCCeF1gCyipaLG2Kq9wqfHz3S6m7CS+H42nmDYAz2dYcx77M8purGOS5tQ4aykJXIDQBwHjIGSU+52M+1OV53rp4B3JbIXecQWEjfk9gkVoz8T6HJbIhFgm3quNMk+cIyRHlj/BdURXY8o7H7dBQfsdpLJhAsxS/1JtMkY8JoP4YdyOxzJY5x/+A9scOTXvPVoQAMqgmP899s6GvRtzNFGXLX7VHSnUj7VPO8K1qxaS/a/6v/YhRlUtNgnqnth3Jo/DKbdhdPn6HgB9YjU5GuN1uPyUXZJDZYfFwMfdqNPVoI8d1csoHMK5tquGoK060mIwBHMk3pFGqBosajr9g/5kBPrrtuIIEPFZnaAKSCQqLdeQq2B6Bs8WxD8+DfzGJ2nu0Xeb58spPoiHZAVV+I5lRUseUE0IA4E844UzFYADNYcLBW3zsP7aWzLnUZoQPuIDR3FX3bkM5mCunvXaPSi4PRkKnItEv8/OYiq8RSKQcaTwxX9YgdNbgPuXLwb5ARofv0Zj3WpHhNnlTq2Qu/lwvM3PUaqv8L7kpFqQR9aRaXfFanbLgbyxJ2kAx9oA1kRMyH3JXI06oQhRiZQ1LtWz+QKKxme0zAgI2q6/dmYApsA7WGeBae5+Y3eqkqDjXyS7Q+LzYgrM3EiqGHsibaKZKgFecxpGiMLXY5+kkuDKBdMkj2Bd8uTKI+aTWpu97gNp78fm891zYuT68sIEzE5JggpWjlWFSpzYayxvnOxJ3JYK/q8WbCy14KhtCFhdLOxCEAvyqXN3K+oP52ZzdxHiCAac5LX2TO5CTmkxp6zCT5JZDIBgnnmQU8GBowEvogfPni17fE1sljd55P2C4mWCNDr8l3hMH+4zpyZqp3iFbJx20nGtU+9LJozl0OxNrk/c0C9chEe+k4vUECnUaXbS8JqdnymqbZ1SCI+4+1BYMW4nzYKDLaqL3Nm08C/Ug7zNg2BuwhWepXrkqaRX58LCWLPDQyUzn369E1drtekeuNcI4SgdmyQZ/7xhXZ6sOKg9G/HEiJQsriRQThvHz4BhaFaXic4nlrz4LhUthGBLbnnB6tufJizYx4c6b2rY1E63pLDA8QdZsTOD7euNMku1a0T2nNQ9rOPBYPDyksaP+EmKTvqcgRycKMtzhHh37mAqVERuzIIMs/zXE9jGBpJBBWb8KCPZne6Sxw0+UFlY6/VeXJUHunHXY1csfc40Tw95XrkpLzxqX/LrsaYM7Y0UQ/Qe6PTjMQUXDseSMhYwHTXCohySQ+1fIjz/yjZWRFI1/a4d9eQzWLoGjz8O8ldPhzhpWFwwlaR0T1gpMP3VeHvDOx4RJocHJOSRQ+H4/nHJsiuXWDKowYZZW8Jk9vUiw2jExedn7glAsC/bgN1NrgIp1y+y3tmLd2V9x7yKVC+QK6MOFq19dlQflj350qUavBULMCTn0BvCRQY4q6VjniU6XHISUsaApCVoQeevAOuCUFcnwWfK+44XDo1qSpPF1wcnbH7N9aO+AzD212PgFlGkXlaQ3Gbfz9XIUMjulgGUREelr6IX+tR2K9H/yep959z5WLXlZ81Z8HCIV8CyU0JKYzkIeFqf6o2ywb2O73oRi7i8F6Vcn2zU1VWZpLfSXgTNkRtqM7r5s13UimLWtAVZs97rLcMRlwXzYp98ZnKvQLj/dpKn8nfNnU9V2Bp90frlQedeKt6zd4mPR53FKQ1J4r95n1G8ph0XG37DC9b185sWbnoyC4Q1iUvyy5IOxBrIqbqn/JSUWzdrlOiZGDJrU5IGuzUl5TaupUTIgFeLfT6uh0gIEJ5nZQ/8XjB0mmEZxTvocrU/BFoOaUvV/N48W3W/aQu5nR3KwsSByfSDAEq6qBqTVTkZtkaAd/1Rie2jkdRlZvxFMu0MGnLc0SHPII8eOz/bjfIhSQhAb38dSRcFmfRb+fpDrDHeazED6EHNayy0kESoRG+XFbJa6xWB6OlbwHVDwdO9Ka7bIOqLRHpZjwXmv/2DR9nu+2xwxE39cBHq/7Vv99HcvH8ZJeGmgHr8mBKQmOCTkvLkxf5k4FrqZuNpaRNhCB3puFuF5d2nnQbhgAaANLMCYAiGsJhX2bFM/r3BGhR/dkGPXeBQUJ4tTARQnVqA07mW/42Dv2k7Wa7hWU/wv7FTIWLwWyHX0Vqdg4BHrlJ7zh+b+T6fH+W3d53LS5rkXK5GIctMIttK+osfGYIvOD0BkkXBJR0EYUmteToIxpoaMVKZmCRC2BbmBLdUTIZiI1kVYKYnq9Q5xMGODu+6vCT2ofvYE0pmGbQ9Ln6wnBDYZUD/BL9rmiPn3n28Zs33OsHUQcLp2vjUEV5sOBLO2ScyescGu0N58y1q1NSNJuXCzI4fu4RWJtSIn3P3+9eAsMo/2NupFeaf70/usLGd2Z0F27EjLoIj+nmJ4/Q5edPFhVNpPURQrUzPALNNzEvx3e82rDtPpbZjugv7Abm2q2vMGwz5W+hGH0hkCzXdZhPFbLk0sR5vVhScLgAPdZIVZIjTuzwIKVuWmvpMr7Gwxgiglpy8ecfOAZcCpXRzG6lNuRB64D4G9AWD9vQi/crWV4Xq5VjJnRjQc3g4bJe+MmksjEctghn27n5i5PHZvW/gM0BsXzo8Pou6yOLnp49dGXpK/oLAbOdOel9h+kDqEtZunvsXa9EFomdl0QbDvk+H58SjszCVqVOXSgDpOdZjXWfZpFL6S/fd1Lq8FQS3LklgiNhdvE5GzgSO8uq3gtj8I2o+JzucnrUSrtoxa6IejmVQLGzF3rSCy3fdhBPhZnDdgctC89dRJ+PTfW4ga5WWAyaWspzFg5251FoByB8LUbD3AxhvV6M1ARNXRJ4NhPe2j9WOlu5I2KmCMGvGP5CbHAyZk3YhiuIdtDgOvre9Cz0yOWvHH5FpZQzqzyHE5XkTTFMU2JhG1nvne9SCi9zNvPnGj9h/bQXgpue78rpogXJl8oDSfMwz9fp4ocyOxEV1JCEslSsRvodEzPbUsMUYWDERNzR6f45Ku6EmW3qdD48dcFQtc9rr2wF3o85edZ/2SY0BSkOdQX1ahwPVBP554Q1Z4lbd0d/vrRCO5k3QBWOb3iML0vI4MRkiKwqt735Q2fkq0Xl1pI3nk4ll51cSEHOrFTctkxwLOiQl6HJh2q3iqHFmtOCSo0A4YLl+mllolm7FLpe/79gMoe7A5cbFPCbX9Z3GhI43FgBbWoq8pwaIoDlklRimVauOx355pv7v26P0MLrgiqWTOxJaIGO/UhHf7GSOm0r1O5m1sPYYn1bathmEkYfrQLiEWQ2/3IjunsIxgAmi6t4JsxalYxE4YyvD59EpzvswOjZUvSgkHwPZonVtaiMTLXnV3p0dKpCSSz38Kv8QbNFzqLbwbBBRUHw/nHSxNipNm5vtjfkuf06jWRwkctgu8wZqKwS/7IcGnFtmwnbJFPhpGcyV9GVFzCCG+TOeNgAWxOUPgmtLdD8JawVVDV+e3iR8kHuaZXIknncI/3uFnblTd2P/OdWvxl+9CXbqJb1CS8osg2fg/qaA9KvM3FQoZQ79JRZC/Upm90ABPCGzksTWJ7Xy9VHpnPZCgGzAVbJhmurq8tm24BjBvnm1GOKfotvCqXyIXFE1bYTRS1WtzgZrGWgR/oOUDnNgDPXqUfTmyFPfNCD9MX22hvuBans/Kl1DustiTunl9Kravj0NG1Ds5nkTqlQSYOfhgvRIowimmWAYWma55eqvaQL9GvHmuH/hIVB/tiN6s7yOW2iahReL8dNddIbMJ6BLVguJ4n1dnquV3ZNqi6V0H/Vn00j0cE80ERsZTgsHPJ0eUjxYik+eDtaEHnyAsYeR2AjRcGw=="),function(le){return le.charCodeAt(0)}),oe=new Uint8Array([177,156,215,89,13,111,230,1]),de=new Uint8Array(pe.length),ye=new Uint8Array(256),Te=0;Te<256;Te++)ye[Te]=Te;var Ce=0;for(Te=0;Te<256;Te++){var Ee=[ye[Ce=(Ce+ye[Te]+oe[Te%oe.length])%256],ye[Te]];ye[Te]=Ee[0],ye[Ce]=Ee[1]}Te=0,Ce=0;for(var Le=0;Le<0+pe.length;Le++){var p=[ye[Ce=(Ce+ye[Te=(Te+1)%256])%256],ye[Te]];ye[Te]=p[0],ye[Ce]=p[1],Le>=0&&(de[Le-0]=pe[Le-0]^ye[(ye[Te]+ye[Ce])%256])}return S=!0,new Promise(function(le){var k,Ae;(k=de.buffer,Ae=q,WebAssembly.instantiate(k,Ae)).then(function(k){S=!1,I=k.instance.exports,V.__wbindgen_wasm_module=k.module,le()})})}().then(function(){c=B.new(),U(c)})})).then(function(U){z=U});var ce=!0;setInterval(function(){Object(m.getParameter)("UPLOAD_LOG")&&re.info("console log upload")},9e5);var re=function(){var U,V,q,pe,oe,de,ye=null,Te=["DEBUG","INFO","WARNING","ERROR","NONE"],Re=0,Ee=function(p,le){if(Object(m.getParameter)("UPLOAD_LOG"))try{le=Array.prototype.slice.call(le);var k="";if(le.forEach(function(Ae){"object"===w()(Ae)&&(Ae=JSON.stringify(Ae)),k=k+Ae+" "}),L.push({payload:k,log_level:p}),ce)return;"free"===T&&function Ae(Ge){T="uploading",setTimeout(function(){!function(p,le,k){var Ae={};Array.isArray(p)||(p=[p]),p=p.map(function(Fe){return{log_item_id:d++,log_level:Fe.log_level,payload_str:Fe.payload}}),Ae={timestamp:Date.now(),sdk_version:m.VERSION,process_id:Object(R.getProcessId)(),payload:JSON.stringify(p)},z?Ae.hash=z.get_digest("".concat(Ae.payload).concat(Ae.process_id).concat(Ae.timestamp)):k&&k();try{var Ge=ye,Ve=ye||"https://".concat(Object(m.getParameter)("LOG_UPLOAD_SERVER"),"/upload/v2");Object(D.post)(Ve,Ae,function(Fe){"OK"===Fe?le&&le():k&&k()},function(Fe){k&&k()},Ge?{withCredentials:!0}:{withCredentials:!0,"Cache-Control":"no-cache, no-store",Pragma:"no-cache",Expires:"0"})}catch(Fe){k&&k()}}(Ge,function(){Z=0,0!==L.length?($=L.splice(0,L.length<10?L.length:10),Ae($)):T="free"},function(){setTimeout(function(){Ae($)},Z++<2?200:1e4)})},3e3)}($=L.splice(0,L.length<10?L.length:10))}catch(Ae){}};V=function(){for(var p=[0],le=0;le<arguments.length;le++)p.push(arguments[le]);U.apply(this,p)},q=function(){for(var p=[1],le=0;le<arguments.length;le++)p.push(arguments[le]);U.apply(this,p)},pe=function(){for(var p=[2],le=0;le<arguments.length;le++)p.push(arguments[le]);U.apply(this,p)},oe=function(){for(var p=[3],le=0;le<arguments.length;le++)p.push(arguments[le]);U.apply(this,p)};var Le={};return de=function(p){Le[p]||(pe.apply(void 0,arguments),Le[p]=!0)},{DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4,stopWaitJoin:function(){ce=!1},enableLogUpload:function(){Object(m.setParameter)("UPLOAD_LOG",!0)},disableLogUpload:function(){Object(m.setParameter)("UPLOAD_LOG",!1)},setProxyServer:function(p){ye=p?"https://".concat(p,"/ls/?h=").concat(Object(m.getParameter)("LOG_UPLOAD_SERVER"),"&p=443&d=upload/v2"):"https://".concat(Object(m.getParameter)("LOG_UPLOAD_SERVER"),"/upload/v2")},setLogLevel:function(p){p>4?p=4:p<0&&(p=0),Re=p},log:U=function(){var p=arguments[0],le=arguments;if(le[0]=b()+" Agora-SDK ["+(Te[p]||"DEFAULT")+"]:",Ee(p,le),!(p<Re))switch(p){case 0:case 1:case 3:console.log.apply(console,le);break;case 2:console.warn.apply(console,le);break;default:return void console.log.apply(console,le)}},debug:V,info:q,warning:pe,deprecate:de,error:oe}}();ee.default=re},function(se,ee,x){"use strict";x.r(ee),x.d(ee,"report",function(){return _}),x.d(ee,"SESSION_INIT",function(){return F}),x.d(ee,"JOIN_CHOOSE_SERVER",function(){return N}),x.d(ee,"JOIN_GATEWAY",function(){return H}),x.d(ee,"PUBLISH",function(){return O}),x.d(ee,"SUBSCRIBE",function(){return J}),x.d(ee,"getProcessId",function(){return G});var I=x(46),C=x.n(I),w=x(7),b=x.n(w),D=x(2),m=x(0),R=x(14),f=x(28),g=x.n(f),y=x(47);function M(u,B){var S=Object.keys(u);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(u);B&&(c=c.filter(function(z){return Object.getOwnPropertyDescriptor(u,z).enumerable})),S.push.apply(S,c)}return S}function j(u){for(var B=1;B<arguments.length;B++){var S=null!=arguments[B]?arguments[B]:{};B%2?M(Object(S),!0).forEach(function(c){C()(u,c,S[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(u,Object.getOwnPropertyDescriptors(S)):M(Object(S)).forEach(function(c){Object.defineProperty(u,c,Object.getOwnPropertyDescriptor(S,c))})}return u}var A,E,F="session_init",N="join_choose_server",H="join_gateway",O="publish",J="subscribe",te=new(x.n(y).a),Y={eventType:null,sid:null,lts:null,success:null,cname:null,uid:null,peer:null,cid:null,elapse:null,extend:null,vid:0},ne=null,G=function(){return ne||(ne="process-"+g()(),m.default.info("processId: "+ne)),ne},_=(E=0,(A={list:{},setProxyServer:function(u){te.setProxy(u),A.proxyServerURL=u},getUrl:function(){return A.proxyServerURL?"https://".concat(A.proxyServerURL,"/rs/?h=").concat(Object(D.getParameter)("EVENT_REPORT_DOMAIN"),"&p=6443&d=events/message"):"https://".concat(Object(D.getParameter)("EVENT_REPORT_DOMAIN"),":6443/events/message")},getBackUrl:function(){return A.proxyServerURL?"https://".concat(A.proxyServerURL,"/rs/?h=").concat(Object(D.getParameter)("EVENT_REPORT_BACKUP_DOMAIN"),"&p=6443&d=events/message"):"https://".concat(Object(D.getParameter)("EVENT_REPORT_BACKUP_DOMAIN"),":6443/events/message")},getSessionStartTime:function(u){return A.list[u]?A.list[u].startTime:(m.default.DEBUG("[getSessionStartTime]: session ".concat(u," no exit")),0)},sessionInit:function(u,B){var S=b()({},Y);S.startTime=+new Date,S.sid=u,S.cname=B.cname,A.list[u]=S;var c=b()({},{willUploadConsoleLog:Object(D.getParameter)("UPLOAD_LOG"),areaVersion:"global"},B.extend),z=b()({},S);z.eventType=F,z.appid=B.appid,z.browser=navigator.userAgent,z.build=D.BUILD,z.lts=+new Date,z.elapse=z.lts-z.startTime,z.extend=JSON.stringify(c),z.mode=B.mode,z.process=G(),z.success=B.succ,z.version=D.VERSION,delete z.startTime,A.send({type:"Session",data:z}),A._flushInvokeReport(u)},joinChooseServer2:function(u,B,S){if(A.list[u]){A.list[u].uid||(B.uid&&(A.list[u].uid=parseInt(B.uid)),B.cid&&(A.list[u].cid=parseInt(B.cid)),B.vid&&(A.list[u].vid=parseInt(B.vid)));var c=b()({},A.list[u]);c.eventType=N;var z=B.lts;c.lts=Date.now(),c.eventElapse=c.lts-z,c.chooseServerAddr=B.csAddr,c.errorCode=B.ec,c.elapse=c.lts-c.startTime,c.success=B.succ,c.chooseServerIp=B.chooseServerIp||"",c.chooseServerAddrList=JSON.stringify(B.serverList),delete c.startTime,A.send({type:"JoinChooseServer",data:c})}},joinChooseServer:function(u,B,S){if(A.list[u]){S&&(B.uid&&(A.list[u].uid=parseInt(B.uid)),B.cid&&(A.list[u].cid=parseInt(B.cid)),B.vid&&(A.list[u].vid=parseInt(B.vid)));var c=b()({},A.list[u]);c.eventType=N;var z=B.lts;c.lts=Date.now(),c.eventElapse=c.lts-z,c.chooseServerAddr=B.csAddr,c.errorCode=B.ec,c.elapse=c.lts-c.startTime,c.success=B.succ,c.chooseServerIp=B.chooseServerIp||"",c.chooseServerAddrList=JSON.stringify(B.serverList),delete c.startTime,A.send({type:"JoinChooseServer",data:c})}},reqUserAccount:function(u,B){B.vid&&(A.list[u].vid=parseInt(B.vid));var S=b()({},A.list[u]),c=B.lts;S.eventType="req_user_account",S.lts=Date.now(),S.success=B.success,S.serverAddress=B.serverAddress,S.stringUid=B.stringUid,S.uid=B.uid,S.errorCode=B.errorCode,S.elapse=S.lts-S.startTime,S.eventElapse=S.lts-c,S.extend="string"==typeof B.extend?B.extend:JSON.stringify(B.extend),delete S.startTime,A.send({type:"ReqUserAccount",data:S})},joinGateway:function(u,B){B.vid&&(A.list[u].vid=parseInt(B.vid)),B.uid&&(A.list[u].uid=parseInt(B.uid));var S=b()({},A.list[u]),c=B.lts;S.eventType=H,S.firstSuccess=B.firstSuccess,S.lts=Date.now(),S.gatewayAddr=B.addr,S.success=B.succ,S.errorCode=B.ec,S.elapse=S.lts-S.startTime,S.eventElapse=S.lts-c,delete S.startTime,A.send({type:"JoinGateway",data:S})},publish:function(u,B){var S=b()({},A.list[u]);S.eventType=O;var c=B.lts;S.lts=Date.now(),S.eventElapse=S.lts-c,S.elapse=S.lts-S.startTime,S.success=B.succ,S.errorCode=B.ec,S.audio=B.audio,S.video=B.video,S.screenshare=B.screenshare,S.publishRequestid=B.publishRequestid,S.p2pid=B.p2pid,B.videoName&&(S.videoName=B.videoName),B.audioName&&(S.audioName=B.audioName),B.screenName&&(S.screenName=B.screenName),delete S.startTime,A.send({type:"Publish",data:S}),A._flushInvokeReport(u)},subscribe:function(u,B){var S=b()({},A.list[u]);S.eventType=J;var c=B.lts;S.lts=Date.now(),S.eventElapse=S.lts-c,S.elapse=S.lts-S.startTime,S.errorCode=B.ec,S.success=B.succ,S.subscribeRequestid=B.subscribeRequestid,S.p2pid=B.p2pid,isFinite(B.peerid)?S.peer=B.peerid:S.peerSuid=""+B.peerid,"boolean"==typeof B.video&&(S.video=B.video),"boolean"==typeof B.audio&&(S.audio=B.audio),delete S.startTime,A.send({type:"Subscribe",data:S}),A._flushInvokeReport(u)},firstRemoteFrame:function(u,B){var S=b()({},A.list[u]);S.eventType="first_remote_frame";var c=B.lts;S.lts=Date.now(),S.eventElapse=S.lts-c,S.elapse=S.lts-S.startTime,S.width=B.width,S.height=B.height,S.success=B.succ,S.errorCode=B.ec,isFinite(B.peerid)?S.peer=B.peerid:S.peerSuid=""+B.peerid,delete S.startTime,A.send({type:"FirstFrame",data:S})},firstVideoReceived:function(u,B){var S=b()({},A.list[u]);S.eventType="first_video_received",S.lts=Date.now(),S.peer=B.peerid,S.uid=B.uid,S.elapse=B.elapse,S.subscribeElapse=B.subscribeElapse,S.subscribeRequestid=B.subscribeRequestid,S.p2pid=B.p2pid,A.send({type:"FirstVideoReceived",data:S})},firstAudioReceived:function(u,B){var S=b()({},A.list[u]);S.eventType="first_audio_received",S.lts=Date.now(),S.peer=B.peerid,S.uid=B.uid,S.elapse=B.elapse,S.subscribeElapse=B.subscribeElapse,S.subscribeRequestid=B.subscribeRequestid,S.p2pid=B.p2pid,A.send({type:"FirstAudioReceived",data:S})},firstVideoDecode:function(u,B){var S=b()({},A.list[u]);S.eventType="first_video_decode",S.lts=Date.now(),S.peer=B.peerid,S.uid=B.uid,S.elapse=B.elapse,S.videowidth=B.width,S.videoheight=B.height,S.subscribeElapse=B.subscribeElapse,S.subscribeRequestid=B.subscribeRequestid,S.p2pid=B.p2pid,A.send({type:"FirstVideoDecode",data:S})},firstAudioDecode:function(u,B){var S=b()({},A.list[u]);S.eventType="first_audio_decode",S.lts=Date.now(),S.uid=B.uid,S.peer=B.peerid,S.elapse=B.elapse,S.subscribeElapse=B.subscribeElapse,S.subscribeRequestid=B.subscribeRequestid,S.p2pid=B.p2pid,A.send({type:"FirstAudioDecode",data:S})},onAddAudioStream:function(u,B){var S=b()({},A.list[u]);S.eventType="on_add_audio_stream",S.lts=Date.now(),S.uid=B.uid,S.peer=B.peerid,A.send({type:"OnAddAudioStream",data:S})},onAddVideoStream:function(u,B){var S=b()({},A.list[u]);S.eventType="on_add_video_stream",S.lts=Date.now(),S.uid=B.uid,S.peer=B.peerid,A.send({type:"OnAddVideoStream",data:S})},onUpdateStream:function(u,B){var S=b()({},A.list[u]);S.eventType="on_update_stream",S.lts=Date.now(),S.uid=B.uid,S.peer=B.peerid,S.audio=B.audio,S.video=B.video,A.send({type:"OnUpdateStream",data:S})},onRemoveStream:function(u,B){var S=b()({},A.list[u]);S.eventType="on_remove_stream",S.lts=Date.now(),S.uid=B.uid,S.peer=B.peerid,A.send({type:"OnRemoveStream",data:S})},streamSwitch:function(u,B){var S=b()({},A.list[u]);S.eventType="stream_switch",S.lts=Date.now(),S.isDual=B.isdual,S.elapse=S.lts-S.startTime,S.success=S.succ,delete S.startTime,A.send({type:"StreamSwitch",data:S})},audioSendingStopped:function(u,B){var S=b()({},A.list[u]);S.eventType="audio_sending_stopped",S.lts=Date.now(),S.elapse=S.lts-S.startTime,S.reason=B.reason,S.success=B.succ,delete S.startTime,A.send({type:"AudioSendingStopped",data:S})},videoSendingStopped:function(u,B){var S=b()({},A.list[u]);S.eventType="video_sending_stopped",S.lts=Date.now(),S.elapse=S.lts-S.startTime,S.reson=B.reason,S.success=B.succ,delete S.startTime,A.send({type:"VideoSendingStopped",data:S})},requestProxyAppCenter:function(u,B){var S=b()({},A.list[u]),c=B.lts;S.eventType="request_proxy_appcenter",S.lts=Date.now(),S.eventElapse=S.lts-c,S.elapse=S.lts-S.startTime,S.extend=B.extend+"",S.APAddr=B.APAddr,S.workerManagerList=B.workerManagerList,S.response=B.response,S.errorCode=B.ec,S.success=B.succ,delete S.startTime,A.send({type:"RequestProxyAppCenter",data:S})},requestProxyWorkerManager:function(u,B){var S=b()({},A.list[u]),c=B.lts;S.eventType="request_proxy_worker_manager",S.lts=Date.now(),S.eventElapse=S.lts-c,S.elapse=S.lts-S.startTime,S.extend=B.extend,S.workerManagerAddr=B.workerManagerAddr,S.response=B.response,S.errorCode=B.ec,S.success=B.succ,delete S.startTime,A.send({type:"RequestProxyWorkerManager",data:S})},requestWorkerEvent:function(u,B){var S=b()({},A.list[u]),c=S.startTime,z=Date.now();delete(S=j({},S,{},B,{elapse:z-c,lts:z,productType:"WebRTC"})).startTime,A.send({type:"WorkerEvent",data:S})},requestApWorkerEvent:function(u,B){var S=b()({},A.list[u]),c=S.startTime,z=Date.now();S=j({},S,{},B,{elapse:z-c,lts:z}),A.send({type:"APWorkerEvent",data:S})},sendCustomReportMessage:function(u,B,S){var c={type:"UserAnalytics",data:j({sid:u},B)},z=A.getUrl(),d=!!A.proxyServerURL;Object(R.post)(z,c,function(T){S&&S()},function(T){var L=A.getBackUrl();Object(R.post)(L,c,function($){S&&S()},function($){S&&S("Failed")},d?{timeout:Object(D.getParameter)("CUSTOMER_REPORT_TIMEOUT")}:{timeout:Object(D.getParameter)("CUSTOMER_REPORT_TIMEOUT"),"Cache-Control":"no-cache, no-store",Pragma:"no-cache",Expires:"0"})},d?{timeout:Object(D.getParameter)("CUSTOMER_REPORT_TIMEOUT")}:{timeout:Object(D.getParameter)("CUSTOMER_REPORT_TIMEOUT"),"Cache-Control":"no-cache, no-store",Pragma:"no-cache",Expires:"0"})},joinChannelTimeOut:function(u){A.send({type:"JoinChannelTimeout",data:j({},u)})},peerPublishStatus:function(u){A.send({type:"PeerPublishStatus",data:j({},u)})},joinWebProxyAP:function(u){A.send({type:"JoinWebProxyAP",data:j({},u)})},webSocketQuit:function(u){A.send({type:"WebSocketQuit",data:j({},u)})}}).reportApiInvoke=function(u,B){var S=B.tag,c=B.name,z=B.getStates,d=B.options,T=B.timeout,L=void 0===T?6e4:T,$=B.callback,Z=B.reportResult,ce=void 0===Z||Z,re=Date.now(),U=0,V=E++,q=function(){return j({tag:S,invokeId:V,sid:u,name:c,apiInvokeTime:re,options:d},z&&{states:(de=z(),Object.keys(de).reduce(function(ye,Te){var Re=ye;return null!=de[Te]&&(Re[Te]=de[Te]),Re},{}))});var de},pe=!!Object(D.getParameter)("SHOW_REPORT_INVOKER_LOG");pe&&m.default.info("".concat(c," start"));var oe=setTimeout(function(){_._sendApiInvoke(j({},q(),{error:"API_INVOKE_TIMEOUT",success:!1}))},L);return function(de,ye){if(clearTimeout(oe),++U>1&&(de="EXECUTOR_INVOKE_".concat(U)),de)return _._sendApiInvoke(j({},q(),{success:!1,error:de},z&&{states:z()})),pe&&m.default.info("".concat(c," onFailure"),de),$&&$(de);_._sendApiInvoke(j({},q(),{success:!0},ce&&{result:ye},{},z&&{states:z()})),pe&&m.default.info("".concat(c," onSuccess")),$&&$(null,ye)}},A._cachedItems=[],A._cacheInvokeReport=function(u){u.lts||(u.lts=Date.now()),A._cachedItems.push(u),A._cachedItems.length>50&&A._cachedItems.shift()},A._flushInvokeReport=function(u){if(A._cachedItems.length){var B=A._cachedItems;A._cachedItems=[],m.default.debug("Flush cached event reporting:",B.length),B.forEach(function(S,c){S.sid=u,setTimeout(function(){A._sendApiInvoke(S)},5e3+500*c)})}},A._sendApiInvoke=function(u){var B=u.tag,S=u.invokeId,c=u.sid,z=u.name,d=u.result,T=u.states,L=u.options,$=u.error,Z=u.success,ce=u.apiInvokeTime,re=u.lts,U=Object(D.getParameter)("NOT_REPORT_EVENT");if(!(B&&U instanceof Array&&-1!==U.indexOf(B)))if(A.list[c]){var V=A.list[c],q=V.startTime,pe=V.cname,oe=V.uid,de=V.cid,ye=(re=re||Date.now())-q,Te=re-ce,Re="";if(L)try{Re=JSON.stringify(L)}catch(Ee){Re=L.toString()}var Ce=j({invokeId:S,sid:c,cname:pe,cid:de,lts:re,uid:oe,success:Z,elapse:ye,apiName:z,execElapse:Te},void 0!==L&&{options:Re},{},void 0!==T&&{execStates:JSON.stringify(T)},{},void 0!==$&&{errorCode:JSON.stringify($)},{},void 0!==d&&{execResult:JSON.stringify(d)});A.send({type:"ApiInvoke",data:Ce})}else A._cacheInvokeReport(arguments[0])},A.sendCache=[],A.sendTimer=null,A.send=function(u){if(u.data){var B=u.data;A._lastLts&&A._lastLts>=B.lts&&(B.lts=A._lastLts+1),A._lastLts=B.lts}if(A.sendCache.push(u),null===A.sendTimer)return function S(){A.sendTimer=setTimeout(function(){if(0!==A.sendCache.length){var c=A.sendCache.splice(0,A.sendCache.length<10?A.sendCache.length:10);return te.sendReportList(c,A.list[c[0].data.sid].vid),S()}A.sendTimer=null},Object(D.getParameter)("EVENT_REPORT_SEND_INTERVAL"))}()},A)},function(se,ee,x){"use strict";Object.defineProperty(ee,"__esModule",{value:!0}),ee.BUILD="v3.6.9-0-g3107120",ee.VERSION="3.6.9";var I=0*Date.now()+11499+86604+5615+6547+846;ee.SUPPORT_RESOLUTION_LIST={"90p_1":[160,90,null,null,null,null],"120p_1":[160,120,15,15,30,65],"120p_3":[120,120,15,15,30,50],"120p_4":[212,120,null,null,null,null],"180p_1":[320,180,15,15,30,140],"180p_3":[180,180,15,15,30,100],"180p_4":[240,180,15,15,30,120],"240p_1":[320,240,15,15,40,200],"240p_3":[240,240,15,15,40,140],"240p_4":[424,240,15,15,40,220],"360p_1":[640,360,15,15,80,400],"360p_3":[360,360,15,15,80,260],"360p_4":[640,360,30,30,80,600],"360p_6":[360,360,30,30,80,400],"360p_7":[480,360,15,15,80,320],"360p_8":[480,360,30,30,80,490],"360p_9":[640,360,15,15,80,800],"360p_10":[640,360,24,24,80,800],"360p_11":[640,360,24,24,80,1e3],"480p_1":[640,480,15,15,100,500,1,5],"480p_2":[640,480,30,30,100,1e3,25,30],"480p_3":[480,480,15,15,100,400],"480p_4":[640,480,30,30,100,750],"480p_6":[480,480,30,30,100,600],"480p_8":[848,480,15,15,100,610],"480p_9":[848,480,30,30,100,930],"480p_10":[640,480,10,10,100,400],"720p_1":[1280,720,15,15,120,1130,1,5],"720p_2":[1280,720,30,30,120,2e3,25,30],"720p_3":[1280,720,30,30,120,1710],"720p_5":[960,720,15,15,120,910],"720p_6":[960,720,30,30,120,1380],"1080p_1":[1920,1080,15,15,120,2080,1,5],"1080p_2":[1920,1080,30,30,120,3e3,25,30],"1080p_3":[1920,1080,30,30,120,3150],"1080p_5":[1920,1080,60,60,120,4780],"1440p_1":[2560,1440,30,30,120,4850],"1440p_2":[2560,1440,60,60,120,7350],"4k_1":[3840,2160,30,30,120,8910],"4k_3":[3840,2160,60,60,120,13500]},ee.AUDIO_PROFILE_SETTINGS={speech_low_quality:[!1,!1,!0,!0],speech_standard:[!1,!1,!0,!1],music_standard:[!1,!1,!1,!1],standard_stereo:[!1,!0,!1,!1],high_quality:[!0,!1,!1,!1],high_quality_stereo:[!0,!0,!1,!1],default:[!1,!1,!1,!1]};var C={AREA_SETTING:["CHINA","GLOBAL"],WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io","webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io","webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-web-2.ap.sd-rtn.com","cds-ap-web-3.agora.io","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-web-2.ap.sd-rtn.com","sua-ap-web-3.agora.io","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-ap-web-1.agora.io","uap-web-2.ap.sd-rtn.com","uap-ap-web-3.agora.io","uap-web-4.ap.sd-rtn.com"],LOG_UPLOAD_SERVER:"logservice.agora.io",EVENT_REPORT_DOMAIN:"web-2.statscollector.sd-rtn.com",EVENT_REPORT_BACKUP_DOMAIN:"web-3.statscollector.sd-rtn.com",ENABLE_LIVE_SERVER_LIST:!1,LIVE_SERVER_LIST:[],ACCOUNT_REGISTER_RETRY_TIMEOUT:1,ACCOUNT_REGISTER_RETRY_RATIO:2,ACCOUNT_REGISTER_RETRY_TIMEOUT_MAX:6e4,ACCOUNT_REGISTER_RETRY_COUNT_MAX:1e5,AUDIO_CONTEXT:null,GATEWAY_DOMAINS:["edge.agora.io","edge.sd-rtn.com"],WEBCS_BACKUP_CONNECT_TIMEOUT:6e3,LIVESTREAMING_ALIGN:!0,HTTP_CONNECT_TIMEOUT:5e3,PLAYER_STATE_DEFER:2e3,SIGNAL_REQUEST_TIMEOUT:1e7,SIGNAL_REQUEST_WATCH_INTERVAL:1e3,REPORT_STATS:!0,REPORT_STATS_TIMEOUT:3e3,UPLOAD_LOG:!1,NOT_REPORT_EVENT:[],FILEPATH_LENMAX:255,SUBSCRIBE_TCC:!1,PING_PONG_TIME_OUT:10,DUALSTREAM_OPERATION_CHECK:!0,WEBSOCKET_TIMEOUT_MIN:1e4,EVENT_REPORT_SEND_INTERVAL:1e3,MEDIA_ELEMENT_EXISTS_DEPTH:3,CANDIDATE_TIMEOUT:2e3,SHIM_CANDIDATE:!1,LEAVE_MSG_TIMEOUT:2e3,TICKET_RENEW_TIMEOUT:828e5,LIVE_STREAMING_TIMEOUT:12e4,SHOW_REPORT_INVOKER_LOG:!1,STATS_FILTER:{transportId:!0,googTrackId:!0},FORCE_TURN:!1,TURN_ENABLE_TCP:!0,TURN_ENABLE_UDP:!0,FORCE_CHANGED_GATEWAY_FLAG:!1,JOIN_EXTEND:"",PUB_EXTEND:"",SUB_EXTEND:"",CHROME_NEW_STATS:!1,AP_BACKOFF_MAX_TIME:8,SET_DEFAULT_TURNSERVER:!0,TURN_SERVER_PASSWORD:I.toString(),PROXY_SERVER_TYPE2:"webnginx-proxy.agora.io",NGINX:"webrtc-cloud-proxy.sd-rtn.com",PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com","webrtc-cloud-proxy.agora.io"],CR:!0,CRL:10,CRI:6,CUSTOMER_REPORT_TIMEOUT:5e3,LIVE_STREAMING_ADDRESS:"",CHOOSE_SERVER_FRAGEMENT_LENGTH:4,PLAN:"plan-b"};ee.setParameter=function(w,b){return void 0!==C[w]&&(C[w]=b,!0)},ee.getParameter=function(w){return void 0!==C[w]?C[w]:null}},function(se,ee,x){"use strict";x.r(ee),x.d(ee,"checkValidObject",function(){return m}),x.d(ee,"checkValidString",function(){return R}),x.d(ee,"checkValidNumber",function(){return f}),x.d(ee,"checkValidArray",function(){return g}),x.d(ee,"checkValidFloatNumber",function(){return y}),x.d(ee,"checkValidBoolean",function(){return M}),x.d(ee,"checkValidEnum",function(){return D}),x.d(ee,"checkValidUID",function(){return j}),x.d(ee,"isValidString",function(){return A}),x.d(ee,"isValidNumber",function(){return E}),x.d(ee,"isValidBoolean",function(){return N}),x.d(ee,"isASCII",function(){return J}),x.d(ee,"isInteger",function(){return te}),x.d(ee,"isNumber",function(){return Y}),x.d(ee,"isString",function(){return ne}),x.d(ee,"isArray",function(){return G}),x.d(ee,"isEmpty",function(){return _}),x.d(ee,"isValidToken",function(){return H}),x.d(ee,"isValidChannelName",function(){return O});var I=x(11),C=x.n(I),w=x(10),b=x(0),D=function(u,B,S){for(var c=0;c<S.length;c++)if(u===S[c])return!0;throw new Error("".concat(B," can only be set as ").concat(JSON.stringify(S)))},m=function(u,B){if(!u)throw new Error("Invalid param: ".concat(B||"param"," cannot be empty"));if("object"!==C()(u))throw new Error("".concat(B||"This paramter"," is of the object type"));return!0},R=function(u,B,S,c,z){if(_(S)&&(S=1),c=c||255,_(z)&&(z=!0),_(u))throw new Error("".concat(B||"param"," cannot be empty"));if(!A(u,S,c,z))throw new Error("Invalid ".concat(B||"string param",": Length of the string: [").concat(S,",").concat(c,"].").concat(z?" ASCII characters only.":""))},f=function(u,B,S,c){if(_(S)&&(S=1),c=c||1e4,_(u))throw new Error("".concat(B||"param"," cannot be empty"));if(!E(u,S,c))throw new Error("Invalid ".concat(B||"number param",": The value range is [").concat(S,",").concat(c,"]. integer only"))},g=function(u,B){if(!Array.isArray(u))throw new Error("".concat(B," should be an array"))},y=function(u,B,S,c){if(null==u)throw new Error("".concat(B||"param"," cannot be null"));if(_(S)&&(S=0),c=c||1e4,_(u))throw new Error("".concat(B||"param"," cannot be empty"));if(!F(u,S,c))throw new Error("Invalid ".concat(B||"number param",": The value range is [").concat(S,",").concat(c,"]."))},M=function(u,B){if(_(u))throw new Error("".concat(B||"param"," cannot be empty"));if(!N(u))throw new Error("Invalid ".concat(B||"boolean param",": The value is of the boolean type."))},j=function(u){if(!Object(w.is32Uint)(u)&&!A(u,1,255))throw b.default.error("Invalid UID ".concat(u," ").concat(C()(u))),new Error("[String uid] Length of the string: [1,255]. ASCII characters only. [Number uid] The value range is [0,10000]")},A=function(u,B,S,c){return B||(B=0),S||(S=Number.MAX_SAFE_INTEGER),_(c)&&(c=!0),ne(u)&&(!c||J(u))&&u.length>=B&&u.length<=S},E=function(u,B,S){return te(u)&&u>=B&&u<=S},F=function(u,B,S){return Y(u)&&u>=B&&u<=S},N=function(u){return"boolean"==typeof u},H=function(u){return A(u,1,2047)},O=function(u){return ne(u)&&/^[a-zA-Z0-9 \!\#\$\%\&\(\)\+\-\:\;\<\=\.\>\?\@\[\]\^\_\{\}\|\~\,]{1,64}$/.test(u)},J=function(u){if("string"==typeof u){for(var B=0;B<u.length;B++){var S=u.charCodeAt(B);if(S<0||S>255)return!1}return!0}},te=function(u){return"number"==typeof u&&u%1==0},Y=function(u){return"number"==typeof u},ne=function(u){return"string"==typeof u},G=function(u){return u instanceof Array},_=function(u){return null==u}},function(se,ee,x){"use strict";x.r(ee),x.d(ee,"APErrorCode",function(){return I}),x.d(ee,"GatewayErrorCode",function(){return C}),x.d(ee,"StringUidErrorCode",function(){return w}),x.d(ee,"JOIN_GS_TRYNEXT_LIST",function(){return b}),x.d(ee,"JOIN_CS_RETRY_LIST",function(){return D}),x.d(ee,"JOIN_PROXY_RETRY_LIST",function(){return m}),x.d(ee,"INJECT_STREAM_STATUS",function(){return R}),x.d(ee,"WEBSOCKET_CLOSE_REASON",function(){return f});var I={1010100:"NO_FLAG_SET",1010101:"FLAG_SET_BUT_EMPTY",1010102:"INVALID_FALG_SET",2010005:"INVALID_VENDOR_KEY",2010007:"INVALID_CHANNEL_NAME",2010008:"INTERNAL_ERROR",2010009:"NO_AUTHORIZED",2010010:"DYNAMIC_KEY_TIMEOUT",2010011:"NO_ACTIVE_STATUS",2010013:"DYNAMIC_KEY_EXPIRED",2010014:"STATIC_USE_DYANMIC_KEY",2010015:"DYNAMIC_USE_STATIC_KEY",2010016:"USER_OVERLOAD",2010018:"FORBIDDEN_REGION",2010019:"CANNOT_MEET_AREA_DEMAND"},C={2e3:"ERR_NO_VOCS_AVAILABLE",2001:"ERR_NO_VOS_AVAILABLE",2002:"ERR_JOIN_CHANNEL_TIMEOUT",2003:"WARN_REPEAT_JOIN",2004:"ERR_JOIN_BY_MULTI_IP",2011:"ERR_NOT_JOINED",2012:"WARN_REPEAT_JOIN",2013:"ERR_INVALID_VENDOR_KEY",2014:"ERR_INVALID_CHANNEL_NAME",2015:"ERR_INVALID_STRINGUID",2016:"ERR_TOO_MANY_USERS",2017:"ERR_SET_CLIENT_ROLE_TIMEOUT",2018:"ERR_SET_CLIENT_ROLE_NO_PERMISSION",2019:"ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",2020:"ERR_PUBLISH_REQUEST_INVALID",2021:"ERR_SUBSCRIBE_REQUEST_INVALID",2022:"ERR_NOT_SUPPORTED_MESSAGE",2023:"ERR_ILLEAGAL_PLUGIN",2028:"ILLEGAL_AES_PASSWORD",101:"ERR_INVALID_VENDOR_KEY",102:"ERR_INVALID_CHANNEL_NAME",103:"WARN_NO_AVAILABLE_CHANNEL",104:"WARN_LOOKUP_CHANNEL_TIMEOUT",105:"WARN_LOOKUP_CHANNEL_REJECTED",106:"WARN_OPEN_CHANNEL_TIMEOUT",107:"WARN_OPEN_CHANNEL_REJECTED",108:"WARN_REQUEST_DEFERRED",109:"ERR_DYNAMIC_KEY_TIMEOUT",110:"ERR_NO_AUTHORIZED",111:"ERR_VOM_SERVICE_UNAVAILABLE",112:"ERR_NO_CHANNEL_AVAILABLE_CODE",113:"ERR_TOO_MANY_USERS",114:"ERR_MASTER_VOCS_UNAVAILABLE",115:"ERR_INTERNAL_ERROR",116:"ERR_NO_ACTIVE_STATUS",117:"ERR_INVALID_UID",118:"ERR_DYNAMIC_KEY_EXPIRED",119:"ERR_STATIC_USE_DYANMIC_KE",120:"ERR_DYNAMIC_USE_STATIC_KE",2:"K_TIMESTAMP_EXPIRED",3:"K_CHANNEL_PERMISSION_INVALID",4:"K_CERTIFICATE_INVALID",5:"K_CHANNEL_NAME_EMPTY",6:"K_CHANNEL_NOT_FOUND",7:"K_TICKET_INVALID",8:"K_CHANNEL_CONFLICTED",9:"K_SERVICE_NOT_READY",10:"K_SERVICE_TOO_HEAVY",14:"K_UID_BANNED",15:"K_IP_BANNED",16:"K_CHANNEL_BANNED"},w={1:"ERROR_ILLEAGAL_APPID",2:"ERROR_ILLEAGAL_UID",3:"INTERNAL_SERVER_ERROR"},b=["ERR_NO_VOCS_AVAILABLE","ERR_NO_VOS_AVAILABLE","ERR_JOIN_CHANNEL_TIMEOUT","WARN_LOOKUP_CHANNEL_TIMEOUT","WARN_OPEN_CHANNEL_TIMEOUT","ERR_VOM_SERVICE_UNAVAILABLE","ERR_TOO_MANY_USERS","ERR_MASTER_VOCS_UNAVAILABLE","ERR_INTERNAL_ERROR"],D=["NO_SERVICE_AVAILABLE"],m=["NO_SERVICE_AVAILABLE","REQUEST_PROXY_SERVER_FAILED","REQUEST_PROXY_SERVER_TIME_OUT"],R={INJECT_STREAM_STATUS_START_SUCCESS:0,INJECT_STREAM_STATUS_START_ALREADY_EXISTS:1,INJECT_STREAM_STATUS_START_UNAUTHORIZED:2,INJECT_STREAM_STATUS_START_TIMEDOUT:3,INJECT_STREAM_STATUS_START_FAILED:4,INJECT_STREAM_STATUS_STOP_SUCCESS:5,INJECT_STREAM_STATUS_STOP_NOT_FOUND:6,INJECT_STREAM_STATUS_STOP_UNAUTHORIZED:7,INJECT_STREAM_STATUS_STOP_TIMEDOUT:8,INJECT_STREAM_STATUS_STOP_FAILED:9,INJECT_STREAM_STATUS_BROKEN:10},f={WS_DISCONNECT:"WS_DISCONNECT"};ee.default={FAILED:"FAILED",INVALID_KEY:"INVALID_KEY",INVALID_CLIENT_MODE:"INVALID_CLIENT_MODE",INVALID_CLIENT_CODEC:"INVALID_CLIENT_CODEC",CLIENT_MODE_CODEC_MISMATCH:"CLIENT_MODE_CODEC_MISMATCH",WEB_API_NOT_SUPPORTED:"WEB_API_NOT_SUPPORTED",INVALID_PARAMETER:"INVALID_PARAMETER",NO_TRACK_IN_STREAM:"NO_TRACK_IN_STREAM",INVALID_OPERATION:"INVALID_OPERATION",INVALID_LOCAL_STREAM:"INVALID_LOCAL_STREAM",INVALID_REMOTE_STREAM:"INVALID_REMOTE_STREAM",INVALID_DYNAMIC_KEY:"INVALID_DYNAMIC_KEY",DYNAMIC_KEY_TIMEOUT:"DYNAMIC_KEY_TIMEOUT",NO_VOCS_AVAILABLE:"NO_VOCS_AVAILABLE",NO_VOS_AVAILABLE:"ERR_NO_VOS_AVAILABLE",JOIN_CHANNEL_TIMEOUT:"ERR_JOIN_CHANNEL_TIMEOUT",NO_AVAILABLE_CHANNEL:"NO_AVAILABLE_CHANNEL",LOOKUP_CHANNEL_TIMEOUT:"LOOKUP_CHANNEL_TIMEOUT",LOOKUP_CHANNEL_REJECTED:"LOOKUP_CHANNEL_REJECTED",OPEN_CHANNEL_TIMEOUT:"OPEN_CHANNEL_TIMEOUT",OPEN_CHANNEL_REJECTED:"OPEN_CHANNEL_REJECTED",REQUEST_DEFERRED:"REQUEST_DEFERRED",STREAM_ALREADY_PUBLISHED:"STREAM_ALREADY_PUBLISHED",STREAM_NOT_YET_PUBLISHED:"STREAM_NOT_YET_PUBLISHED",JOIN_TOO_FREQUENT:"JOIN_TOO_FREQUENT",SOCKET_ERROR:"SOCKET_ERROR",SOCKET_DISCONNECTED:"SOCKET_DISCONNECTED",PEERCONNECTION_FAILED:"PEERCONNECTION_FAILED",CONNECT_GATEWAY_ERROR:"CONNECT_GATEWAY_ERROR",SERVICE_NOT_AVAILABLE:"SERVICE_NOT_AVAILABLE",JOIN_CHANNEL_FAILED:"JOIN_CHANNEL_FAILED",PUBLISH_STREAM_FAILED:"PUBLISH_STREAM_FAILED",UNPUBLISH_STREAM_FAILED:"UNPUBLISH_STREAM_FAILED",SUBSCRIBE_STREAM_FAILED:"SUBSCRIBE_STREAM_FAILED",UNSUBSCRIBE_STREAM_FAILED:"UNSUBSCRIBE_STREAM_FAILED",NO_SUCH_REMOTE_STREAM:"NO_SUCH_REMOTE_STREAM",ERR_FAILED:"1",ERR_INVALID_VENDOR_KEY:"101",ERR_INVALID_CHANNEL_NAME:"102",WARN_NO_AVAILABLE_CHANNEL:"103",WARN_LOOKUP_CHANNEL_TIMEOUT:"104",WARN_LOOKUP_CHANNEL_REJECTED:"105",WARN_OPEN_CHANNEL_TIMEOUT:"106",WARN_OPEN_CHANNEL_REJECTED:"107",WARN_REQUEST_DEFERRED:"108",ERR_DYNAMIC_KEY_TIMEOUT:"109",ERR_INVALID_DYNAMIC_KEY:"110",ERR_NO_VOCS_AVAILABLE:"2000",ERR_NO_VOS_AVAILABLE:"2001",ERR_JOIN_CHANNEL_TIMEOUT:"2002",IOS_NOT_SUPPORT:"IOS_NOT_SUPPORT",WECHAT_NOT_SUPPORT:"WECHAT_NOT_SUPPORT",SHARING_SCREEN_NOT_SUPPORT:"SHARING_SCREEN_NOT_SUPPORT",STILL_ON_PUBLISHING:"STILL_ON_PUBLISHING",LOW_STREAM_ALREADY_PUBLISHED:"LOW_STREAM_ALREADY_PUBLISHED",LOW_STREAM_NOT_YET_PUBLISHED:"LOW_STREAM_ALREADY_PUBLISHED",HIGH_STREAM_NOT_VIDEO_TRACE:"HIGH_STREAM_NOT_VIDEO_TRACE",NOT_FIND_DEVICE_BY_LABEL:"NOT_FIND_DEVICE_BY_LABEL",ENABLE_DUALSTREAM_FAILED:"ENABLE_DUALSTREAM_FAILED",DISABLE_DUALSTREAM_FAILED:"DISABLE_DUALSTREAM_FAILED",PLAYER_NOT_FOUND:"PLAYER_NOT_FOUND",ELECTRON_NOT_SUPPORT_SHARING_SCREEN:"ELECTRON_NOT_SUPPORT_SHARING_SCREEN",BAD_ENVIRONMENT:"BAD_ENVIRONMENT",LOAD_AUDIO_FAILED:"LOAD_AUDIO_FAILED"}},function(se,ee,x){"use strict";x.r(ee),x.d(ee,"getBrowserInfo",function(){return N}),x.d(ee,"getBrowserVersion",function(){return y}),x.d(ee,"getBrowserOS",function(){return M}),x.d(ee,"isChrome",function(){return I}),x.d(ee,"isSafari",function(){return C}),x.d(ee,"isFireFox",function(){return b}),x.d(ee,"isOpera",function(){return D}),x.d(ee,"isEdge",function(){return w}),x.d(ee,"isQQBrowser",function(){return m}),x.d(ee,"isWeChatBrowser",function(){return R}),x.d(ee,"isLegacyChrome",function(){return A}),x.d(ee,"isSupportedPC",function(){return f}),x.d(ee,"isSupportedMobile",function(){return g}),x.d(ee,"getChromeKernelVersion",function(){return F}),x.d(ee,"isChromeKernel",function(){return j});var I=function(){var H=N();return H.name&&"Chrome"===H.name},C=function(){var H=N();return H.name&&"Safari"===H.name},w=function(){var H=N();return H.name&&"Edge"===H.name},b=function(){var H=N();return H.name&&"Firefox"===H.name},D=function(){var H=N();return H.name&&"OPR"===H.name},m=function(){var H=N();return H.name&&"QQBrowser"===H.name},R=function(){var H=N();return H.name&&"MicroMessenger"===H.name},f=function(){var H=M();return"Linux"===H||"Mac OS X"===H||"Mac OS"===H||-1!==H.indexOf("Windows")},g=function(){var H=M();return"Android"===H||"iOS"===H},y=function(){return N().version},M=function(){return N().os},j=function(){return!!navigator.userAgent.match(/chrome\/[\d]+/i)};function A(){return window.navigator.appVersion&&null!==window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)[1]<=35}var E,F=function(){var H=navigator.userAgent.match(/chrome\/[\d]+/i);return H&&H[0]&&H[0].split("/")[1]},N=(E=function(){var H,O=navigator.userAgent,J=O.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];"Chrome"===J[1]&&null!=(H=O.match(/(OPR(?=\/))\/?(\d+)/i))&&(J=H),"Safari"===J[1]&&null!=(H=O.match(/version\/(\d+)/i))&&(J[2]=H[1]),~O.toLowerCase().indexOf("qqbrowser")&&null!=(H=O.match(/(qqbrowser(?=\/))\/?(\d+)/i))&&(J=H),~O.toLowerCase().indexOf("micromessenger")&&null!=(H=O.match(/(micromessenger(?=\/))\/?(\d+)/i))&&(J=H),~O.toLowerCase().indexOf("edge")&&null!=(H=O.match(/(edge(?=\/))\/?(\d+)/i))&&(J=H),~O.toLowerCase().indexOf("trident")&&null!=(H=/\brv[ :]+(\d+)/g.exec(O)||[])&&(J=[null,"IE",H[1]]);var te=void 0,Y=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 3.11",r:/Win16/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}];for(var ne in Y){var G=Y[ne];if(G.r.test(navigator.userAgent)){te=G.s;break}}return{name:J[1],version:J[2],os:te}}(),function(){return E})},function(se,ee,x){"use strict";x.d(ee,"b",function(){return I}),x.d(ee,"a",function(){return C}),x.d(ee,"c",function(){return w}),x(0);var I=function(b,D,m){if(["End2EndDelay","TransportDelay","PacketLossRate","RecvLevel","RecvBitrate","CodecType","MuteState","TotalFreezeTime","TotalPlayDuration","RecordingLevel","SendLevel","SamplingRate","SendBitrate","CodecType","MuteState","End2EndDelay","TransportDelay","PacketLossRate","RecvBitrate","RecvResolutionWidth","RecvResolutionHeight","RenderResolutionHeight","RenderResolutionWidth","RenderFrameRate","TotalFreezeTime","TotalPlayDuration","TargetSendBitrate","SendFrameRate","SendFrameRate","SendBitrate","SendResolutionWidth","SendResolutionHeight","CaptureResolutionHeight","CaptureResolutionWidth","EncodeDelay","MuteState","TotalFreezeTime","TotalDuration","CaptureFrameRate","RTT","OutgoingAvailableBandwidth","Duration","UserCount","SendBytes","RecvBytes","SendBitrate","RecvBitrate","accessDelay","audioSendBytes","audioSendPackets","videoSendBytes","videoSendPackets","videoSendPacketsLost","videoSendFrameRate","audioSendPacketsLost","videoSendResolutionWidth","videoSendResolutionHeight","accessDelay","audioReceiveBytes","audioReceivePackets","audioReceivePacketsLost","videoReceiveBytes","videoReceivePackets","videoReceivePacketsLost","videoReceiveFrameRate","videoReceiveDecodeFrameRate","videoReceiveResolutionWidth","videoReceiveResolutionHeight","endToEndDelay","videoReceiveDelay","audioReceiveDelay","FirstFrameTime","VideoFreezeRate","AudioFreezeRate","RenderResolutionWidth","RenderResolutionHeight","VideoPublishDuration","AudioPublishDuration"].indexOf(D)>-1&&("string"==typeof m||isFinite(m)))return b[D]=""+m},C=function(b){var D={};return b.forEach(function(m){m.id&&m.type&&(-1===m.id.indexOf("send")&&-1===m.type.toLowerCase().indexOf("outbound")&&-1===m.id.indexOf("outbound_rtp")&&-1===m.id.indexOf("OutboundRTP")||("audio"===m.mediaType?(I(D,"audioSendBytes",m.bytesSent),I(D,"audioSendPackets",m.packetsSent),I(D,"audioSendPacketsLost",m.packetsLost)):(I(D,"videoSendBytes",m.bytesSent),I(D,"videoSendPackets",m.packetsSent),I(D,"videoSendPacketsLost",m.packetsLost),I(D,"videoSendFrameRate",m.googFrameRateSent),I(D,"videoSendResolutionWidth",m.googFrameWidthSent),I(D,"videoSendResolutionHeight",m.googFrameHeightSent))))}),D},w=function(b){var D={};return b.forEach(function(m){m.id&&m.type&&(-1===m.id.indexOf("recv")&&-1===m.type.toLowerCase().indexOf("inbound")&&-1===m.id.indexOf("inbound_rtp")&&-1===m.id.indexOf("inbound-rtp")&&-1===m.id.indexOf("InboundRTP")||("audio"===m.mediaType?(I(D,"audioReceiveBytes",m.bytesReceived),I(D,"audioReceivePackets",m.packetsReceived),I(D,"audioReceivePacketsLost",m.packetsLost)):(I(D,"videoReceiveBytes",m.bytesReceived),I(D,"videoReceivePacketsLost",m.packetsLost),I(D,"videoReceivePackets",m.packetsReceived),I(D,"videoReceiveFrameRate",m.googFrameRateReceived),I(D,"videoReceiveDecodeFrameRate",m.googFrameRateDecoded),I(D,"videoReceiveResolutionWidth",m.googFrameWidthReceived),I(D,"videoReceiveResolutionHeight",m.googFrameHeightReceived))))}),D}},function(se,ee){function x(){return se.exports=x=Object.assign||function(I){for(var C=1;C<arguments.length;C++){var w=arguments[C];for(var b in w)Object.prototype.hasOwnProperty.call(w,b)&&(I[b]=w[b])}return I},x.apply(this,arguments)}se.exports=x},function(se,ee,x){"use strict";x.d(ee,"b",function(){return C}),x.d(ee,"e",function(){return b}),x.d(ee,"a",function(){return D}),x.d(ee,"d",function(){return m}),x.d(ee,"c",function(){return R});var I=x(0),C=function(){var f={dispatcher:{}};return f.dispatcher.eventListeners={},f.addEventListener=function(g,y){void 0===f.dispatcher.eventListeners[g]&&(f.dispatcher.eventListeners[g]=[]),f.dispatcher.eventListeners[g].push(y)},f.hasListeners=function(g){return!(!f.dispatcher.eventListeners[g]||!f.dispatcher.eventListeners[g].length)},f.on=f.addEventListener,f.removeEventListener=function(g,y){var M;f.dispatcher.eventListeners[g]&&-1!==(M=f.dispatcher.eventListeners[g].indexOf(y))&&f.dispatcher.eventListeners[g].splice(M,1)},f.dispatchEvent=function(g){var y;for(y in f.dispatcher.eventListeners[g.type])if(f.dispatcher.eventListeners[g.type]&&f.dispatcher.eventListeners[g.type].hasOwnProperty(y)&&"function"==typeof f.dispatcher.eventListeners[g.type][y])try{f.dispatcher.eventListeners[g.type][y](g)}catch(M){I.default.debug("[".concat(f.clientId,"] Error in ").concat(g.type," event"),M)}},f.dispatchSocketEvent=function(g){var y;for(y in f.dispatcher.eventListeners[g.type])f.dispatcher.eventListeners[g.type]&&f.dispatcher.eventListeners[g.type].hasOwnProperty(y)&&"function"==typeof f.dispatcher.eventListeners[g.type][y]&&f.dispatcher.eventListeners[g.type][y](g.msg)},f},w=function(f){var g={};return g.type=f.type,g},b=function(f){var g=w(f);return g.stream=f.stream,g.reason=f.reason,g.msg=f.msg,g},D=function(f){var g=w(f);return g.uid=f.uid,g.attr=f.attr,g.stream=f.stream,g},m=function(f){var g=w(f);return g.msg=f.msg,g},R=function(f){var g=w(f);return g.url=f.url,g.uid=f.uid,g.status=f.status,g.reason=f.reason,g}},function(se,ee,x){"use strict";var I,C=this&&this.__extends||(I=function(Y,ne){return(I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(G,_){G.__proto__=_}||function(G,_){for(var u in _)_.hasOwnProperty(u)&&(G[u]=_[u])})(Y,ne)},function(Y,ne){function G(){this.constructor=Y}I(Y,ne),Y.prototype=null===ne?Object.create(ne):(G.prototype=ne.prototype,new G)}),w=this&&this.__awaiter||function(Y,ne,G,_){return new(G||(G=Promise))(function(u,B){function S(d){try{z(_.next(d))}catch(T){B(T)}}function c(d){try{z(_.throw(d))}catch(T){B(T)}}function z(d){var T;d.done?u(d.value):(T=d.value,T instanceof G?T:new G(function(L){L(T)})).then(S,c)}z((_=_.apply(Y,ne||[])).next())})},b=this&&this.__generator||function(Y,ne){var G,_,u,B,S={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]};return B={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(B[Symbol.iterator]=function(){return this}),B;function c(z){return function(d){return function(T){if(G)throw new TypeError("Generator is already executing.");for(;S;)try{if(G=1,_&&(u=2&T[0]?_.return:T[0]?_.throw||((u=_.return)&&u.call(_),0):_.next)&&!(u=u.call(_,T[1])).done)return u;switch(_=0,u&&(T=[2&T[0],u.value]),T[0]){case 0:case 1:u=T;break;case 4:return S.label++,{value:T[1],done:!1};case 5:S.label++,_=T[1],T=[0];continue;case 7:T=S.ops.pop(),S.trys.pop();continue;default:if(!((u=(u=S.trys).length>0&&u[u.length-1])||6!==T[0]&&2!==T[0])){S=0;continue}if(3===T[0]&&(!u||T[1]>u[0]&&T[1]<u[3])){S.label=T[1];break}if(6===T[0]&&S.label<u[1]){S.label=u[1],u=T;break}if(u&&S.label<u[2]){S.label=u[2],S.ops.push(T);break}u[2]&&S.ops.pop(),S.trys.pop();continue}T=ne.call(Y,S)}catch(L){T=[6,L],_=0}finally{G=u=0}if(5&T[0])throw T[1];return{value:T[0]?T[1]:void 0,done:!0}}([z,d])}}},D=this&&this.__importDefault||function(Y){return Y&&Y.__esModule?Y:{default:Y}};Object.defineProperty(ee,"__esModule",{value:!0});var m=D(x(69)),R=x(2),f=D(x(0)),g=x(3),y=x(14),M=x(10),j=function(Y){function ne(G,_){var u=Y.call(this)||this;return u._state=H.RELAY_STATE_IDLE,u._onStatus=function(B){f.default.debug("["+u.clientId+"] ChannelMediaStatus: "+JSON.stringify(B)),B&&B.command&&("onAudioPacketReceived"===B.command&&u.emit("event",N.PACKET_RECEIVED_AUDIO_FROM_SRC),"onVideoPacketReceived"===B.command&&u.emit("event",N.PACKET_RECEIVED_VIDEO_FROM_SRC),"onSrcTokenPrivilegeDidExpire"===B.command&&(u._state=H.RELAY_STATE_FAILURE,u.emit("state",H.RELAY_STATE_FAILURE,O.SRC_TOKEN_EXPIRED)),"onDestTokenPrivilegeDidExpire"===B.command&&(u._state=H.RELAY_STATE_FAILURE,u.emit("state",H.RELAY_STATE_FAILURE,O.DEST_TOKEN_EXPIRED,B.channelName?{came:B.channelName}:null)))},u._onClose=function(){return w(u,void 0,void 0,function(){var B;return b(this,function(S){switch(S.label){case 0:if(f.default.debug("["+this.clientId+"] ChannelMediaSocket onClose"),this.emit("event",N.NETWORK_DISCONNECTED),this.state=H.RELAY_STATE_IDLE,!this._prevChannelMediaConfig)return[3,4];S.label=1;case 1:return S.trys.push([1,3,,4]),[4,this.startChannelMediaRelay(this._prevChannelMediaConfig)];case 2:return S.sent(),[3,4];case 3:return(B=S.sent())instanceof te&&(B.message===E.WS_ABORT||B.message===E.AP_REQUEST_ABORT)?[2]:(this.emit("state",H.RELAY_STATE_FAILURE,O.SERVER_CONNECTION_LOST),[3,4]);case 4:return[2]}})})},u.token=G.appId,u.appId=G.appId,u.cname=G.cname,u.uid=G.uid,u.sid=G.sid,u.clientId=_,u}return C(ne,Y),Object.defineProperty(ne.prototype,"state",{get:function(){return this._state},set:function(G){var _=this._state;this._state=G,_!==G&&this.emit("state",G)},enumerable:!0,configurable:!0}),ne.prototype.startChannelMediaRelay=function(G){return w(this,void 0,void 0,function(){return b(this,function(_){switch(_.label){case 0:if(this.state!==H.RELAY_STATE_IDLE)throw new te(E.BAD_STATE);return this.state=H.RELAY_STATE_CONNECTING,[4,this._connect()];case 1:return _.sent(),f.default.debug("["+this.clientId+"] startChannelMediaRelay: connect success"),[4,this._sendStartRelayMessage(G)];case 2:return _.sent(),this._prevChannelMediaConfig=G,[2]}})})},ne.prototype.updateChannelMediaRelay=function(G){return w(this,void 0,void 0,function(){return b(this,function(_){switch(_.label){case 0:if(this.state!==H.RELAY_STATE_RUNNING)throw new te(E.BAD_STATE);return[4,this._sendUpdateMessage(G)];case 1:return _.sent(),this._prevChannelMediaConfig=G,[2]}})})},ne.prototype.stopChannelMediaRelay=function(){return w(this,void 0,void 0,function(){return b(this,function(G){switch(G.label){case 0:return[4,this._sendStopRelayMessage()];case 1:return G.sent(),f.default.debug("["+this.clientId+"] stopChannelMediaRelay: send stop message success"),this.state=H.RELAY_STATE_IDLE,this.dispose(),[2]}})})},ne.prototype.dispose=function(){f.default.debug("["+this.clientId+"] disposeChannelMediaRelay"),this.state=H.RELAY_STATE_IDLE,this.emit("dispose"),this._signal&&this._signal.dispose(),this._prevChannelMediaConfig=null,this.removeEvent()},ne.prototype._requestOneAP=function(G){var _=this;return new Promise(function(u,B){var S={command:"convergeAllocateEdge",sid:_.sid,appId:_.appId,token:"",ts:+new Date,version:R.VERSION,cname:_.cname,uid:_.uid+"",seq:1,requestId:1},c={service_name:"tele_channel",json_body:JSON.stringify(S)};y.post("https://"+G,c,function(d){var T=null,L=null;try{T=JSON.parse(d)}catch($){B(new te(E.AP_JSON_PARSE_ERROR,$))}0!==T.code&&B(new te(E.AP_REQUEST_ERROR,T));try{L=JSON.parse(T.json_body)}catch($){B(new te(E.AP_JSON_PARSE_ERROR,$))}200!==L.code&&B(new te(E.AP_REQUEST_ERROR,L)),L.servers?u(L.servers):B(new te(E.AP_JSON_PARSE_ERROR,L))},function(d){return B(d)},{"X-Packet-Service-Type":0,"X-Packet-URI":61})})},ne.prototype._requestAP=function(){var G=this,_=R.getParameter("UAP_AP");return new Promise(function(u,B){setTimeout(function(){B(new te(E.AP_REQUEST_TIMEOUT))},5e3),G.on("dispose",function(){B(new te(E.AP_REQUEST_ABORT))}),_.forEach(function(S){G._requestOneAP(S+="/api/v1").then(function(c){f.default.debug("["+G.clientId+"] startChannelMediaRelay request AP "+S+" success: "+JSON.stringify(c));var z=c[0],d="wss://"+z.address.replace(/\./g,"-")+".edge.agora.io:"+z.wss;u(d)}).catch(function(c){f.default.debug("["+G.clientId+"] startChannelMediaRelay request AP "+S+" failed: "+JSON.stringify(c))})})})},ne.prototype._connectWebsocket=function(G){return this._signal=new J(this.appId,this.cname,this.uid,this.sid),this._signal.connect(G)},ne.prototype._connect=function(){return w(this,void 0,void 0,function(){var G;return b(this,function(_){switch(_.label){case 0:return[4,this._requestAP()];case 1:return G=_.sent(),[4,this._connectWebsocket(G)];case 2:return _.sent(),this._signal.on("close",this._onClose.bind(this)),this._signal.on("status",this._onStatus.bind(this)),this.emit("event",N.NETWORK_CONNECTED),[2]}})})},ne.prototype._sendStartRelayMessage=function(G){return w(this,void 0,void 0,function(){var _,u,B,S,c,z;return b(this,function(d){switch(d.label){case 0:return this._checkSignal(),_=this._genMessage(F.StopPacketTransfer),[4,this._signal.request(_)];case 1:return d.sent(),[4,this._signal.waitStatus("Normal Quit")];case 2:return d.sent(),f.default.debug("["+this.clientId+"] startChannelMediaRelay: StopPacketTransfer success"),u=this._genMessage(F.SetSdkProfile,G),[4,this._signal.request(u)];case 3:return d.sent(),f.default.debug("["+this.clientId+"] startChannelMediaRelay: SetSdkProfile success"),B=this._genMessage(F.SetSourceChannel,G),[4,this._signal.request(B)];case 4:return d.sent(),[4,this._signal.waitStatus("SetSourceChannelStatus")];case 5:return d.sent(),this.emit("event",N.PACKET_JOINED_SRC_CHANNEL),f.default.debug("["+this.clientId+"] startChannelMediaRelay: SetSourceChannel success"),S=this._genMessage(F.SetSourceUserId,G),[4,this._signal.request(S)];case 6:return d.sent(),f.default.debug("["+this.clientId+"] startChannelMediaRelay: SetSourceUserId success"),c=this._genMessage(F.SetDestChannel,G),[4,this._signal.request(c)];case 7:return d.sent(),[4,this._signal.waitStatus("SetDestChannelStatus")];case 8:return d.sent(),this.emit("event",N.PACKET_JOINED_DEST_CHANNEL),f.default.debug("["+this.clientId+"] startChannelMediaRelay: SetDestChannel success"),z=this._genMessage(F.StartPacketTransfer,G),[4,this._signal.request(z)];case 9:return d.sent(),this.emit("event",N.PACKET_SENT_TO_DEST_CHANNEL),this.state=H.RELAY_STATE_RUNNING,f.default.debug("["+this.clientId+"] startChannelMediaRelay: StartPacketTransfer success"),[2]}})})},ne.prototype._sendReconnectMessage=function(G){return w(this,void 0,void 0,function(){var _;return b(this,function(u){switch(u.label){case 0:return this._checkSignal(),_=this._genMessage(F.Reconnect,G),[4,this._signal.request(_)];case 1:return u.sent(),[2]}})})},ne.prototype._sendUpdateMessage=function(G){return w(this,void 0,void 0,function(){var _;return b(this,function(u){switch(u.label){case 0:return this._checkSignal(),_=this._genMessage(F.UpdateDestChannel,G),[4,this._signal.request(_)];case 1:return u.sent(),this.emit("event",N.PACKET_UPDATE_DEST_CHANNEL),f.default.debug("["+this.clientId+"] sendUpdateMessage: UpdateDestChannel success"),[2]}})})},ne.prototype._sendStopRelayMessage=function(){return w(this,void 0,void 0,function(){var G;return b(this,function(_){switch(_.label){case 0:return this._checkSignal(),G=this._genMessage(F.StopPacketTransfer),[4,this._signal.request(G)];case 1:return _.sent(),f.default.debug("["+this.clientId+"] sendStopRelayMessage: StopPacketTransfer success"),[2]}})})},ne.prototype._genMessage=function(G,_){var u=this,B=[],S=[],c=[],z={appId:this.appId,cname:this.cname,uid:this.uid+"",sdkVersion:R.VERSION,sid:this.sid,ts:+new Date,requestId:0,seq:0,allocate:!0,clientRequest:{}},d=null;switch(G){case F.SetSdkProfile:return z.clientRequest={command:"SetSdkProfile",type:"multi_channel"},z;case F.SetSourceChannel:return d=_.getSrcChannelMediaInfo(),z.clientRequest={command:"SetSourceChannel",uid:d.uid+"",channelName:d.channelName,token:d.token||this.appId},z;case F.SetSourceUserId:return d=_.getSrcChannelMediaInfo(),z.clientRequest={command:"SetSourceUserId",uid:this.uid+""},z;case F.SetDestChannel:return _.getDestChannelMediaInfos().forEach(function(T){B.push(T.channelName),S.push(T.uid+""),c.push(T.token||u.appId)}),z.clientRequest={command:"SetDestChannel",channelName:B,uid:S,token:c},z;case F.StartPacketTransfer:return z.clientRequest={command:"StartPacketTransfer"},z;case F.Reconnect:return z.clientRequest={command:"Reconnect"},z;case F.StopPacketTransfer:return z.clientRequest={command:"StopPacketTransfer"},z;case F.UpdateDestChannel:return _.getDestChannelMediaInfos().forEach(function(T){B.push(T.channelName),S.push(T.uid+""),c.push(T.token||u.appId)}),z.clientRequest={command:"UpdateDestChannel",channelName:B,uid:S,token:c},z}},ne.prototype._checkSignal=function(){if(!this._signal||!this._signal.isConnect())throw new te(E.WS_DISCONNECTED)},ne}(m.default);ee.default=j;var A=function(){function Y(){this.destChannelMediaInfos=new Map}return Y.prototype.setSrcChannelInfo=function(ne){g.checkValidObject(ne,"srcInfo");var G=ne.uid,_=ne.channelName,u=ne.token;if(u&&!g.isValidToken(u))throw new Error("Invalid token in SrcChannelInfo");if(!g.isValidChannelName(_))throw new Error("Invalid channelName in SrcChannelInfo");if(!M.is32Uint(G))throw new Error("Invalid uid in SrcChannelInfo");this.srcChannelMediaInfo=ne},Y.prototype.setDestChannelInfo=function(ne,G){if(!g.isValidChannelName(ne))throw new Error("Invalid channelName in DestChannelInfo");g.checkValidObject(G,"destInfo");var _=G.uid,u=G.token,B=G.channelName;if(u&&!g.isValidToken(u))throw new Error("Invalid token in DestChannelInfo");if(!g.isValidChannelName(B))throw new Error("Invalid channelName in DestChannelInfo");if(!M.is32Uint(_))throw new Error("Invalid uid in DestChannelInfo");this.destChannelMediaInfos.set(ne,G)},Y.prototype.removeDestChannelInfo=function(ne){if(!g.isValidChannelName(ne))throw new Error("Invalid channelName when invoke removeDestChannelInfo");this.destChannelMediaInfos.delete(ne)},Y.prototype.getSrcChannelMediaInfo=function(){return this.srcChannelMediaInfo},Y.prototype.getDestChannelMediaInfos=function(){return this.destChannelMediaInfos},Y}();ee.ChannelMediaRelayConfiguration=A;var E,F,N,H,O,Y,J=function(Y){function ne(G,_,u,B){var S=Y.call(this)||this;return S._onOpen=function(){S.emit("open")},S._onClose=function(c){S.emit("close"),S.dispose()},S._onMessage=function(c){var z=JSON.parse(c.data);if(!z||"serverResponse"!==z.command||!z.requestId)return z&&"serverStatus"===z.command&&z.serverStatus&&z.serverStatus.command?(S.emit("status",z.serverStatus),void S.emit(z.serverStatus.command,z.serverStatus)):void 0;S.emit("req_"+z.requestId,z)},S._requestId=1,S.appId=G,S.cname=_,S.uid=u,S.sid=B,S}return C(ne,Y),ne.prototype.isConnect=function(){return this._ws&&this._ws.readyState===WebSocket.OPEN},ne.prototype.sendMessage=function(G){if(!this._ws||this._ws.readyState!==WebSocket.OPEN)throw new te(E.WS_DISCONNECTED);var _=this._requestId++;return G.requestId=_,G.seq=_,this._ws.send(JSON.stringify(G)),_},ne.prototype.waitStatus=function(G){var _=this;return new Promise(function(u,B){var S=window.setTimeout(function(){B(new te(E.WAIT_STATUS_TIMEOUT,G))},5e3);_.once(G,function(c){clearTimeout(S),c.state&&0!==c.state?B(new te(E.WAIT_STATUS_ERROR,G)):u()}),_.once("dispose",function(){clearTimeout(S),B(new te(E.WS_ABORT))})})},ne.prototype.request=function(G){var _=this;return new Promise(function(u,B){var S=_.sendMessage(G),c=window.setTimeout(function(){_.removeAllListeners("req_"+S),B(new te(E.REQUEST_TIMEOUT))},3e3);_.once("req_"+S,function(z){clearTimeout(c),z&&200===z.code?u(z):B(new te(E.REQUEST_FAILED,z))}),_.once("dispose",function(){clearTimeout(c),B(new te(E.WS_ABORT))})})},ne.prototype.connect=function(G){var _=this;return new Promise(function(u,B){_._ws=new WebSocket(G),_._ws.onopen=function(){_._onOpen(),_._prvUrl=G,_._ws.onmessage=_._onMessage,_._ws.onclose=_._onClose,_._startHeartBeatCheck(),u()},_._ws.onclose=function(S){_._ws=null,B(new te(E.CONNECT_FAILED,"websocket error code: "+S.code))},setTimeout(function(){_._ws&&_._ws.readyState!==WebSocket.OPEN&&(_._ws.onopen=null,_._ws.onclose=null,_._ws.close(),_._ws=null,B(new te(E.CONNECT_TIMEOUT)))},5e3),_.once("dispose",function(){B(new te(E.WS_ABORT))})})},ne.prototype.dispose=function(){this._clearHeartBeatCheck(),this.emit("dispose"),this.removeEvent(),this._ws&&(this._ws.onopen=null,this._ws.onclose=null,this._ws.onmessage=null,this._ws.close()),this._ws=null},ne.prototype._sendPing=function(G){if(!this._ws||this._ws.readyState!==WebSocket.OPEN)throw new te(E.WS_DISCONNECTED);var _=this._requestId++;return G.requestId=_,this._ws.send(JSON.stringify(G)),_},ne.prototype._startHeartBeatCheck=function(){var G=this;this._heartBeatTimer=window.setInterval(function(){G._sendPing({command:"ping",appId:G.appId,cname:G.cname,uid:G.uid+"",sid:G.sid,ts:+new Date,requestId:0})},3e3)},ne.prototype._clearHeartBeatCheck=function(){window.clearInterval(this._heartBeatTimer)},ne}(m.default),te=function(Y,ne,G){void 0===Y&&(Y=""),this.code=G,this.data=ne,this.message=Y};ee.ChannelMediaError=te,(Y=E=ee.CHANNEL_MEDIA_ERROR||(ee.CHANNEL_MEDIA_ERROR={})).CONNECT_FAILED="connect failed",Y.CONNECT_TIMEOUT="connect timeout",Y.WS_DISCONNECTED="websocket disconnected",Y.REQUEST_TIMEOUT="request timeout",Y.REQUEST_FAILED="request failed",Y.WAIT_STATUS_TIMEOUT="wait status timeout",Y.WAIT_STATUS_ERROR="wait status error",Y.BAD_STATE="bad state",Y.WS_ABORT="ws abort",Y.AP_REQUEST_TIMEOUT="AP request timeout",Y.AP_JSON_PARSE_ERROR="AP json parse error",Y.AP_REQUEST_ERROR="AP request error",Y.AP_REQUEST_ABORT="AP request abort",function(Y){Y[Y.SetSdkProfile=0]="SetSdkProfile",Y[Y.SetSourceChannel=1]="SetSourceChannel",Y[Y.SetSourceUserId=2]="SetSourceUserId",Y[Y.SetDestChannel=3]="SetDestChannel",Y[Y.StartPacketTransfer=4]="StartPacketTransfer",Y[Y.StopPacketTransfer=5]="StopPacketTransfer",Y[Y.UpdateDestChannel=6]="UpdateDestChannel",Y[Y.Reconnect=7]="Reconnect",Y[Y.SetVideoProfile=8]="SetVideoProfile"}(F||(F={})),function(Y){Y[Y.NETWORK_DISCONNECTED=0]="NETWORK_DISCONNECTED",Y[Y.NETWORK_CONNECTED=1]="NETWORK_CONNECTED",Y[Y.PACKET_JOINED_SRC_CHANNEL=2]="PACKET_JOINED_SRC_CHANNEL",Y[Y.PACKET_JOINED_DEST_CHANNEL=3]="PACKET_JOINED_DEST_CHANNEL",Y[Y.PACKET_SENT_TO_DEST_CHANNEL=4]="PACKET_SENT_TO_DEST_CHANNEL",Y[Y.PACKET_RECEIVED_VIDEO_FROM_SRC=5]="PACKET_RECEIVED_VIDEO_FROM_SRC",Y[Y.PACKET_RECEIVED_AUDIO_FROM_SRC=6]="PACKET_RECEIVED_AUDIO_FROM_SRC",Y[Y.PACKET_UPDATE_DEST_CHANNEL=7]="PACKET_UPDATE_DEST_CHANNEL",Y[Y.PACKET_UPDATE_DEST_CHANNEL_REFUSED=8]="PACKET_UPDATE_DEST_CHANNEL_REFUSED",Y[Y.PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE=9]="PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE"}(N=ee.CHANNEL_MEDIA_RELAY_EVENT||(ee.CHANNEL_MEDIA_RELAY_EVENT={})),function(Y){Y[Y.RELAY_STATE_IDLE=0]="RELAY_STATE_IDLE",Y[Y.RELAY_STATE_CONNECTING=1]="RELAY_STATE_CONNECTING",Y[Y.RELAY_STATE_RUNNING=2]="RELAY_STATE_RUNNING",Y[Y.RELAY_STATE_FAILURE=3]="RELAY_STATE_FAILURE"}(H=ee.CHANNEL_MEDIA_RELAY_STATE||(ee.CHANNEL_MEDIA_RELAY_STATE={})),function(Y){Y[Y.RELAY_OK=0]="RELAY_OK",Y[Y.SERVER_ERROR_RESPONSE=1]="SERVER_ERROR_RESPONSE",Y[Y.SERVER_NO_RESPONSE=2]="SERVER_NO_RESPONSE",Y[Y.NO_RESOURCE_AVAILABLE=3]="NO_RESOURCE_AVAILABLE",Y[Y.FAILED_JOIN_SRC=4]="FAILED_JOIN_SRC",Y[Y.FAILED_JOIN_DEST=5]="FAILED_JOIN_DEST",Y[Y.FAILED_PACKET_RECEIVED_FROM_SRC=6]="FAILED_PACKET_RECEIVED_FROM_SRC",Y[Y.FAILED_PACKET_SENT_TO_DEST=7]="FAILED_PACKET_SENT_TO_DEST",Y[Y.SERVER_CONNECTION_LOST=8]="SERVER_CONNECTION_LOST",Y[Y.INTERNAL_ERROR=9]="INTERNAL_ERROR",Y[Y.SRC_TOKEN_EXPIRED=10]="SRC_TOKEN_EXPIRED",Y[Y.DEST_TOKEN_EXPIRED=11]="DEST_TOKEN_EXPIRED",Y[Y.RELAY_ALREADY_START=12]="RELAY_ALREADY_START",Y[Y.RELAY_NOT_START=13]="RELAY_NOT_START",Y[Y.OPERATION_ABORT=14]="OPERATION_ABORT"}(O=ee.CHANNEL_MEDIA_RELAY_ERROR||(ee.CHANNEL_MEDIA_RELAY_ERROR={}))},function(se,ee,x){"use strict";x.r(ee),x.d(ee,"isLiveTranscodingValid",function(){return O}),x.d(ee,"generateSessionId",function(){return F}),x.d(ee,"audioLevelHelper",function(){return j}),x.d(ee,"vsResHack",function(){return N}),x.d(ee,"is32Uint",function(){return H}),x.d(ee,"safeCall",function(){return g}),x.d(ee,"random",function(){return te}),x.d(ee,"popBanTip",function(){return G}),x.d(ee,"lengthInUtf8Bytes",function(){return Y}),x.d(ee,"audioTimerLoop",function(){return ne}),x.d(ee,"generateId",function(){return E}),x.d(ee,"uint8ArrayToBase64",function(){return y}),x.d(ee,"base64ToUint8Array",function(){return M});var I=x(11),C=x.n(I),w=x(5),b=x(0),D=x(28),m=x.n(D),R=x(25),f=x(15),g=function(){var _=arguments[0];if("function"==typeof _){var u=Array.prototype.slice.call(arguments,1);_.apply(null,u)}},y=function(_){for(var u="",B=0;B<_.length;B+=1)u+=String.fromCharCode(_[B]);return window.btoa(u)},M=function(_){for(var u=window.atob(_),B=new Uint8Array(new ArrayBuffer(u.length)),S=0;S<u.length;S+=1)B[S]=u.charCodeAt(S);return B},j=function(_){return this.audioContext=Object(R.a)(),this.sourceNode=_.otWebkitAudioSource||this.audioContext.createMediaStreamSource(_),this.analyser=this.audioContext.createAnalyser(),this.timeDomainData=new Uint8Array(this.analyser.frequencyBinCount),this.sourceNode.connect(this.analyser),this.getAudioLevel=function(){if(this.analyser){this.analyser.getByteTimeDomainData(this.timeDomainData);for(var u=0,B=0;B<this.timeDomainData.length;B++)u=Math.max(u,Math.abs(this.timeDomainData[B]-128));return u/128}return b.default.warning("can't find analyser in audioLevelHelper"),0},this},A=1e4;function E(){return++A}function F(){return m()().replace(/-/g,"").toUpperCase()}var N=function(_,u,B){try{b.default.debug("start vsResHack",_);var S=document.createElement("video");S.setAttribute("autoplay",""),S.setAttribute("muted",""),S.muted=!0,S.setAttribute("playsinline",""),S.setAttribute("style","position: absolute; top: 0; left: 0; width:1px; high:1px;"),document.body.appendChild(S);var c=!1;S.addEventListener("playing",function(z){w.isFireFox()?S.videoWidth&&(c=!0,b.default.debug("[vsResHack] get stream resolution: ","".concat(S.videoWidth," x ").concat(S.videoHeight),_),u(S.videoWidth,S.videoHeight),S.srcObject=null,S.remove()):(c=!0,b.default.debug("[vsResHack] get stream resolution: ","".concat(S.videoWidth," x ").concat(S.videoHeight),_),u(S.videoWidth,S.videoHeight),S.srcObject=null,S.remove())}),Object(f.setSrcObject)(S,_),S.play().catch(function(){}),setTimeout(function(){!c&&S&&(u(S.videoWidth,S.videoHeight),S.srcObject=null,S.remove())},4e3)}catch(z){B(z)}},H=function(_){return"number"==typeof _&&0<=_&&_<=4294967295},O=function(_){var u=["lowLatency","userConfigExtraInfo","transcodingUsers"];for(var B in _)if("lowLatency"===B&&"boolean"!=typeof _[B]||"userConfigExtraInfo"===B&&"object"!==C()(_[B])||"transcodingUsers"===B&&!J(_[B])||!~u.indexOf(B)&&"number"!=typeof _[B])throw new Error("Param ["+B+"] is inValid");return!0},J=function(_){for(var u=0;u<_.length;u++)for(var B in _[u])if("number"!=typeof _[u][B])throw new Error("Param user["+u+"] - ["+B+"] is inValid");return!0},te=function(_){isNaN(_)&&(_=1e3);var u=+new Date,B=(u=(9301*u+49297)%233280)/233280;return Math.ceil(B*_)},Y=function(_){var u=encodeURIComponent(_).match(/%[89ABab]/g);return _.length+(u?u.length:0)},ne=function(_,u){var B=1/u,S=Object(R.a)(),c=S.createGain();c.gain.value=0,c.connect(S.destination);var z=!1;return function d(){var T=S.createOscillator();T.onended=d,T.connect(c),T.start(0),T.stop(S.currentTime+B),_(S.currentTime),z&&(T.onended=function(){})}(),function(){z=!0}},G=function(){if(!document.getElementById("agora-ban-tip")){var _=document.createElement("div");_.id="agora-ban-tip",_.style="position: absolute; width: 100%; height: 100%; display: flex; justify-content: center; align-items: center; color: #fff;",document.querySelector("body").prepend(_);var u=document.createElement("div");u.style="background: #000; width: 346px; height: 116px; z-index: 100000; opacity: 0.6; border-radius: 10px; box-shadow: 0 2px 4px #000;",_.append(u);var B=document.createElement("div");B.style="height: 76px; display: flex; justify-content: center; align-items: center;";var S=document.createElement("span");S.style="height: 28px; width: 28px; color: #000; text-align: center; line-height: 30px; background: #fff; border-radius: 50%; font-weight: 600; font-size: 20px;margin-right: 5px;",S.innerText="!";var c=document.createElement("span");c.innerText="This browser does not support webRTC",B.append(S),B.append(c);var z=document.createElement("div");z.style="height: 38px; display: flex; border-top: #fff 1px solid; justify-content: center; align-items: center;",z.innerText="OK",u.append(B),u.append(z),z.onclick=function(){var d=document.getElementById("agora-ban-tip");d.parentNode.removeChild(d)}}}},function(se,ee){function x(I){return se.exports=x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(C){return typeof C}:function(C){return C&&"function"==typeof Symbol&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C},x(I)}se.exports=x},function(se,ee,x){se.exports=x(64)},function(se,ee,x){"use strict";var I=x(12),C=x.n(I),w=x(17),b=x.n(w),D=x(11),m=x.n(D),R=x(32),f=x.n(R),g=x(7),y=x.n(g),M=x(22),j=x(8),A=function(U){U&&U.apply(this,[].slice.call(arguments,1))},E=x(0),F=x(1),N=x(10),H=x(14),O=x(2),J=function(U){var V=Object(j.b)(U);V.needReconnect=!0,V.isTimeout=!1,V.isInit=!0,V.sendbytes=0,V.recvbytes=0,V.startTime=Date.now(),V.lastMsgTime=null,V.clientId=U.clientId,V.hostIndex=0,V.requestID=0,V.host=U.host instanceof Array?U.host:[U.host],V.getSendBytes=function(){return V.sendbytes},V.getRecvBytes=function(){return V.recvbytes},V.getDuration=function(){return Math.ceil((Date.now()-V.startTime)/1e3)},V.getURL=function(){return V.connection.url},V.reconnect=function(){V.isInit=!0,V.creatConnection()},V.connectNext=function(){V.isInit=!0,++V.hostIndex,E.default.debug("["+V.clientId+"] Gateway length:"+V.host.length+" current index:"+V.hostIndex),V.hostIndex>=V.host.length?V.dispatchEvent(Object(j.d)({type:"recover"})):V.creatConnection()},V.replaceHost=function(oe){V.host=oe||V.host,V.hostIndex=0,V.creatConnection()},V.creatConnection=function(){V.needReconnect=!0,V.lts=(new Date).getTime(),V.connection=new WebSocket("wss://"+V.host[V.hostIndex]),V.connection.binaryType="arraybuffer",V.turnConfig={};var oe=U.proxyServerType;if(V.connection.url&&3!==oe&&4!==oe&&5!==oe){var de=V.connection.url.match(/wss\:\/\/([^:]+):(\d+)/),ye=V.host[V.hostIndex].split(":"),Te=V.connection.url.match(/h=([^:]+)&p=(\d+)/);de?(V.turnConfig.url=de[1],Object(O.getParameter)("TURN_ENABLE_TCP")&&(V.turnConfig.tcpport=parseInt(de[2])+30),Object(O.getParameter)("TURN_ENABLE_UDP")&&(V.turnConfig.udpport=parseInt(de[2])+30)):Te?(V.turnConfig.url=Te[1],Object(O.getParameter)("TURN_ENABLE_TCP")&&(V.turnConfig.tcpport=parseInt(Te[2])+30),Object(O.getParameter)("TURN_ENABLE_UDP")&&(V.turnConfig.udpport=parseInt(Te[2])+30)):ye&&(V.turnConfig.url=ye[0],Object(O.getParameter)("TURN_ENABLE_TCP")&&(V.turnConfig.tcpport=parseInt(ye[1])+30),Object(O.getParameter)("TURN_ENABLE_UDP")&&(V.turnConfig.udpport=parseInt(ye[1])+30))}V.connection.onopen=function(Re){V.needReconnect=!0,V.isTimeout=!1,V.isInit=!1,V.sendbytes=0,V.recvbytes=0,V.startTime=Date.now(),Object(H.resetHTTPByetsCount)(),clearTimeout(V.timeoutCheck),V.dispatchEvent(Object(j.d)({type:"onopen",event:Re,socket:V}))},V.connection.onmessage=function(Re){if(Re.data instanceof ArrayBuffer)V.dispatchEvent({type:"onBinaryData",data:Re.data});else{V.recvbytes+=Object(N.lengthInUtf8Bytes)(Re.data);var Ce=JSON.parse(Re.data);V.lastMsgTime=Date.now(),Ce.hasOwnProperty("_id")?V.dispatchEvent(Object(j.d)({type:Ce._id,msg:Ce})):Ce.hasOwnProperty("_type")&&V.dispatchSocketEvent(Object(j.d)({type:Ce._type,msg:Ce._message}))}},V.connection.onclose=function(Re){V.needReconnect?V.isTimeout||V.isInit?(E.default.debug("["+V.clientId+"] websockect connect timeout"),F.report.joinGateway(U.sid,{lts:V.lts,succ:!1,ec:"timeout",addr:V.connection.url}),V.connectNext()):(V.dispatchEvent(Object(j.d)({type:"disconnect",event:Re})),V.requests&&V.requests instanceof Array&&(V.requests.map(function(Ce){Ce.callback("REQUEST_ABORT")}),V.requests=[])):(E.default.debug("["+V.clientId+"] websockect closeed"),A(U.onFailure,Re),clearTimeout(V.timeoutCheck),V.dispatchEvent(Object(j.d)({type:"close",event:Re})),V.connection.onopen=void 0,V.connection.onclose=void 0,V.connection.onerror=void 0,V.connection.onmessage=void 0,V.connection=void 0)},V.connection.onerror=function(Re){},setTimeout(function(){V.connection&&V.connection.readyState!=WebSocket.OPEN&&(V.isTimeout=!0,V.connection.close())},5e3)},V.creatConnection(),V.sendMessage=function(oe,de){if(V.connection&&V.connection.readyState==WebSocket.OPEN){var ye=JSON.stringify(oe);V.sendbytes+=Object(N.lengthInUtf8Bytes)(ye),V.connection.send(ye)}else de({error:"Gateway not connected"})},V.disconnect=function(){V.needReconnect=!0,V.connection.close()},V.close=function(){V.needReconnect=!1,V.connection.onclose=void 0,V.connection.close(),clearInterval(V.requestTimer),V.requests&&V.requests instanceof Array&&(V.requests.map(function(oe){oe.callback("REQUEST_ABORT")}),V.requests=[])},V.sendSignalCommand=function(oe,de){oe._id="_request_"+V.requestID,V.requestID+=1,"publish_stats"!==oe._type&&"subscribe_stats"!==oe._type&&"publish_stats_low"!==oe._type&&V.on(oe._id,function(ye){ye.msg&&de&&de(ye.msg._result,ye.msg.message),delete V.dispatcher.eventListeners[oe._id]}),V.sendMessage(oe,function(ye){ye.reason="NOT_CONNECTED",de&&de(ye.reason,ye)})},V.requests=[];var q=function(oe){var de=V.requests.findIndex(function(Te){return Te.id===oe.type});if(de>=0)var ye=V.requests.splice(de,1)[0];ye&&V.dispatcher.eventListeners[oe.type]?(delete V.dispatcher.eventListeners[oe.type],oe.msg&&ye.callback&&ye.callback(oe.msg._result,oe.msg._message)):E.default.warning("Detached Response",oe.type,oe.msg)},pe=function(oe){var de=this,ye=V.requests.findIndex(function(Te){return Te.id===de.id});ye>=0&&(de=V.requests.splice(ye,1)[0]),de&&V.dispatcher.eventListeners[oe.type]?(delete V.dispatcher.eventListeners[oe.type],oe.reason="NOT_CONNECTED",de.callback&&de.callback(oe.reason,oe)):E.default.warning("handleSendError",de)};return V.sendRequest=function(oe,de){oe=y()({_id:"_request_"+V.requestID},oe),V.requestID+=1;var ye={id:oe._id,timeoutCounter:0,stalledAt:Date.now(),message:oe,callback:de};V.requests.push(ye),V.addEventListener(oe._id,q),V.sendMessage(oe,pe.bind(ye))},V.checkRequestTimeout=function(){for(var oe=Math.ceil(Object(O.getParameter)("SIGNAL_REQUEST_TIMEOUT")/Object(O.getParameter)("SIGNAL_REQUEST_WATCH_INTERVAL")),de=V.requests.length-1;de>=0;de--){var ye=V.requests[de];ye.timeoutCounter>=oe?(V.requests.splice(de,1),E.default.error("Request Timeout",ye.timeoutCounter,ye.message),ye.callback&&ye.callback("TIMEOUT")):ye.timeoutCounter++}},clearInterval(V.requestTimer),V.requestTimer=setInterval(V.checkRequestTimeout,Object(O.getParameter)("SIGNAL_REQUEST_WATCH_INTERVAL")),V.sendReport=function(oe){V.sendMessage(oe,function(){})},V},Y=x(23),ne=x(4),G=x(20),_=x(5),u={ERR_NO_VOCS_AVAILABLE:"tryNext",ERR_NO_VOS_AVAILABLE:"tryNext",ERR_JOIN_CHANNEL_TIMEOUT:"tryNext",WARN_REPEAT_JOIN:"quit",ERR_JOIN_BY_MULTI_IP:"recover",WARN_LOOKUP_CHANNEL_TIMEOUT:"tryNext",WARN_OPEN_CHANNEL_TIMEOUT:"tryNext",ERR_VOM_SERVICE_UNAVAILABLE:"tryNext",ERR_TOO_MANY_USERS:"tryNext",ERR_MASTER_VOCS_UNAVAILABLE:"tryNext",ERR_INTERNAL_ERROR:"tryNext",K_SERVICE_NOT_READY:"tryNext",K_SERVICE_TOO_HEAVY:"tryNext",notification_test_recover:"recover",notification_test_tryNext:"tryNext",notification_test_retry:"retry"},B={googActualEncBitrate:"A_aeb",googAvailableSendBandwidth:"A_asb",googRetransmitBitrate:"A_rb",googAvailableReceiveBandwidth:"A_arb",googTargetEncBitrate:"A_teb",googBucketDelay:"A_bd",googTransmitBitrate:"A_tb",googCodecName:"A_cn",bytesSent:"bytesSent",packetsLost:"packetsLost",packetsSent:"packetsSent",googAdaptationChanges:"A_ac",googAvgEncodeMs:"A_aem",googEncodeUsagePercent:"A_eup",googFirsReceived:"A_fr",googFrameHeightInput:"A_fhi",googFrameHeightSent:"A_fhs",googFrameRateInput:"A_fri",googFrameRateSent:"A_frs",googFrameWidthInput:"A_fwi",googFrameWidthSent:"A_fws",googNacksReceived:"A_nr",googPlisReceived:"A_pr",googRtt:"A_rtt",aecDivergentFilterFraction:"A_adff",audioInputLevel:"A_ail",googEchoCancellationReturnLoss:"A_ecrl",googEchoCancellationReturnLossEnhancement:"A_ecrle",googResidualEchoLikelihood:"A_rel",googResidualEchoLikelihoodRecentMax:"A_relrm",googTargetDelayMs:"A_tdm",bytesReceived:"bytesReceived",packetsReceived:"packetsReceived",googDecodeMs:"A_dm",googMaxDecodeMs:"A_mdm",googRenderDelayMs:"A_rdm",googFrameWidthReceived:"A_fwr",googFrameHeightReceived:"A_fhr",googFrameRateReceived:"A_frr",googFrameRateDecoded:"A_frd",googFrameRateOutput:"A_fro",googJitterBufferMs:"A_jbm",googCurrentDelayMs:"A_cdm",googMinPlayoutDelayMs:"A_mpdm",googNacksSent:"A_ns",googPlisSent:"A_ps",googFirsSent:"A_fs",audioOutputLevel:"A_aol",googAccelerateRate:"A_ar",googDecodingCNG:"A_dcng",googDecodingCTN:"A_dctn",googDecodingCTSG:"A_dctsg",googDecodingNormal:"A_dn",googDecodingPLC:"A_dplc",googDecodingPLCCNG:"A_dplccng",googExpandRate:"A_er",googJitterReceived:"A_jr",googPreemptiveExpandRate:"A_per",googPreferredJitterBufferMs:"A_pjbm",googSecondaryDecodedRate:"A_sdr",googSpeechExpandRate:"A_ser",uplink_fraction_lost:"B_ufl",uplink_cumulative_lost:"B_ucl",uplink_available_bandwidth:"B_uab",period_fir:"B_fir",access_delay:"B_acd",uplink_network_quality:"B_unq",downlink_network_quality:"B_dnq",pub_audio_lost_ratio_400ms:"B_palr4",pub_video_lost_ratio_400ms:"B_pvlr4",e2e_delay:"B_ed",audio_delay:"B_ad",video_delay:"B_vd",stream_type:"B_st",e2e_audio_lost_ratio_400ms:"B_ealr4",e2e_video_lost_ratio_400ms:"B_evlr4",downlink_estimate_bandwidth:"B_deb",peer_publish_audio_duration:"B_ppad",peer_publish_video_duration:"B_ppvd"},S={};for(var c in B){var z=B[c];S[z]&&E.default.error("Key Conflict: ".concat(z,": ").concat(B[z],"| ").concat(c)),S[z]=c}var d=function(U){return B[U]||U},T=function(U){return S[U]||U},L=x(9),$=x.n(L),Z=x(54),ce=function U(V){var h,Q,q=!1,pe=function(h){return{_type:"control",_message:h}},oe=function(h,Q){var ae={};return Object.keys(Q).forEach(function(fe){Object(O.getParameter)("STATS_FILTER")[fe]||(ae[d(fe)]=Q[fe])}),{_type:"subscribe_related_stats",_message:{stream_type:"high",stream_id:h,stats:ae}}},de=function(h){return{_type:"publish",_message:h}},ye=function(h,Q){var ae={};return Object.keys(Q).forEach(function(fe){Object(O.getParameter)("STATS_FILTER")[fe]||(ae[d(fe)]=Q[fe])}),{_type:"subscribe_stats",_message:{stream_id:h,stats:ae}}},Te=U.DISCONNECTED,Re=U.CONNECTING,Ce=U.CONNECTED,Ee=U.DISCONNECTING,Le=Te,p=Object(j.b)(V);Object.defineProperty(p,"state",{set:function(h){var Q=Le;Le=h,Object(G._setClientConnectionStateRecord)(p.clientId,h),h!==U.CONNECTED&&h!==U.DISCONNECTING&&(p.hasJoined=!1),Q!==h&&p.dispatchEvent({type:"connection-state-change",prevState:U.connetionStateMap[Q],curState:U.connetionStateMap[h]})},get:function(){return Le}}),p.socket=void 0,p.state=Te,p.mode=V.mode,p.role=V.role,p.codec=V.codec,p.config={},p.timers={},p.timer_counter={},p.localStreams={},p.remoteStreams={},p.remoteMuteState={},p.attemps=1,p.p2p_attemps=1,p.audioLevel={},p.activeSpeaker=void 0,p.reconnectMode="tryNext",p.rejoinAttempt=0,p.hasChangeBGPAddress=!1,p.traffic_stats={},p.clientId=V.clientId,p.pingpongCounter=0,p.hasInvokeLeave=!1,p.p2ps=new Map,p.liveStreams=new Map,p.injectLiveStreams=new Map,p.remoteStreamsInChannel=new Set,p.subscribeRequestId=new Map,p.publishRequestId=0,p.hasJoined=!1,p.isFirstSuccess=!0,p.peerPublishDurationMap=new Map,Q=A,(h=p).makeRequest=function(ae,fe,me){if(void 0===h.socket)return E.default.debug("[".concat(h.clientId,"] No socket available")),void Q(me,ne.default.INVALID_OPERATION);try{h.socket.emitRequest(ae,function(K,ge){var ve;"success"===K?"function"==typeof fe&&fe(ge):"function"==typeof me&&(ve=ge&&ge.error_code&&ne.GatewayErrorCode[ge.error_code]?ne.GatewayErrorCode[ge.error_code]:ge&&ge.error_str?ge.error_str:ge&&ge.error_code?"UNKNOW_ERROR_".concat(ge.error_code):K,me(ve,ge))})}catch(K){E.default.debug("[".concat(h.clientId,"] Socket emit message failed ").concat(JSON.stringify(ae))),E.default.debug("[".concat(h.clientId,"] "),K),Q(me,ne.default.SOCKET_ERROR)}},h.makeReport=function(ae){void 0===h.socket&&E.default.debug("[".concat(h.clientId,"] No socket available"));try{h.socket.emitReport(ae)}catch(fe){E.default.debug("[".concat(h.clientId,"] Socket emit report failed ").concat(JSON.stringify(ae)))}},p.inChannelInfo={joinAt:null,duration:0},p._sendMessage=function(h,Q){switch(h){case"SubscribeStats":p.makeReport(ye.apply(void 0,f()(Q)));break;case"SubscribeRelatedStats":p.makeReport(oe.apply(void 0,f()(Q)))}};var le=A;p.p2pCounter=Object(N.random)(1e5),p.generateP2PId=function(){return++p.p2pCounter},p.audioVolumeIndication={enabled:!1,sortedAudioVolumes:[],smooth:3,interval:2e3},p.remoteVideoStreamTypes={REMOTE_VIDEO_STREAM_HIGH:0,REMOTE_VIDEO_STREAM_LOW:1,REMOTE_VIDEO_STREAM_MEDIUM:2},p.streamFallbackTypes={STREAM_FALLBACK_OPTION_DISABLED:0,STREAM_FALLBACK_OPTION_VIDEO_STREAM_LOW:1,STREAM_FALLBACK_OPTION_AUDIO_ONLY:2},p.configPublisher=function(h){p.config=h},p.getGatewayInfo=function(h,Q){p.makeRequest({_type:"gateway_info"},h,Q)},p.setClientRole=function(h,Q){E.default.debug("[".concat(p.clientId,"] setClientRole to ").concat(h));var ae=F.report.reportApiInvoke(p.joinInfo.sid,{name:"_setClientRole",callback:Q});p.makeRequest({_type:"set_client_role",_message:{role:h}},function(){p.role=h,p.dispatchEvent({type:"client-role-changed",role:h}),ae&&ae(null,{role:h})},function(fe,me){if(me&&me.code&&(fe=ne.GatewayErrorCode[me.code]||"UNKNOW_ERROR_"+me.code),"ERR_SET_CLIENT_ROLE_ALREADY_IN_USE"===fe)return ae&&ae(null);E.default.error("set Client role error to "+h+": "+fe),ae&&ae(fe)})},p.join=function(h,Q,ae,fe){p.hasInvokeLeave=!1,h.useProxyServer&&(p.hasChangeBGPAddress=!0);var me=(new Date).getTime(),K=h.uid;if(p.inChannelInfo.joinAt&&(p.inChannelInfo.duration+=me-p.inChannelInfo.joinAt),p.inChannelInfo.joinAt=me,p.state!==Re)return E.default.error("[".concat(p.clientId,"] GatewayClient.join Failed: state "),p.state),fe&&fe(ne.default.INVALID_OPERATION),void F.report.joinGateway(h.sid,{lts:me,succ:!1,ec:ne.default.INVALID_OPERATION,addr:null});if(null!=K&&parseInt(K)!==K)return E.default.error("[".concat(p.clientId,"] Input uid is invalid")),p.state=Te,fe&&fe(ne.default.INVALID_PARAMETER),void F.report.joinGateway(h.sid,{lts:me,succ:!1,ec:ne.default.INVALID_PARAMETER,addr:null});var ge=re.register(p,{uid:K,cname:h&&h.cname});if(ge)return p.state=Te,fe&&fe(ge),void F.report.joinGateway(h.sid,{lts:me,succ:!1,ec:ge,addr:null});p.joinInfo=y()({},h),p.uid=K,p.key=Q,p.pingpongCounter=0,Ve(h,function(ve){if(h.useLocalAccessPoint)try{var be=p.socket.signal.connection.url.match(/wss\:\/\/([^:]+):(\d+)/)[1];Object(O.setParameter)("EVENT_REPORT_DOMAIN",be),Object(O.setParameter)("EVENT_REPORT_BACKUP_DOMAIN",be),Object(O.setParameter)("LOG_UPLOAD_SERVER","".concat(be,":6444"))}catch(_e){E.default.debug("[".concat(p.clientId,"] LocalAccessPoint error: ").concat(_e))}if(p.state===Ee||p.state===Te)return fe&&fe("LEAVE_BEFORE_JOIN_SUCCESS");p.state=Ce,E.default.debug("[".concat(p.clientId,"] Connected to gateway server")),clearInterval(p.pingTimer),p.pingTimer=setInterval(function(){var _e=Object(O.getParameter)("PING_PONG_TIME_OUT");if(++p.pingpongCounter>=_e){var Pe=Date.now();p.socket&&E.default.warning("PINGPONG Timeout. Last Socket Message: ".concat(Pe-p.socket.getLastMsgTime(),"ms")),p.socket&&p.socket.getLastMsgTime()&&Pe-p.socket.getLastMsgTime()>Object(O.getParameter)("WEBSOCKET_TIMEOUT_MIN")&&(p.pingpongCounter=0,p.socket.close(),p.socket.dispatchEvent(Object(j.d)({type:"disconnect",event:{msg:"PING_PONG_TIME_OUT"}})))}var ke=Date.now();p.makeRequest({_type:"ping"},function(){p.pingpongCounter=0;var xe=Date.now()-ke;Object(O.getParameter)("REPORT_STATS")&&p.makeRequest({_type:"ping_back",_message:{pingpongElapse:xe}})},function(xe,ze){"TIMEOUT"!==xe&&(E.default.error("Ping Error ".concat(xe," ").concat(JSON.stringify(ze))),ze&&ze.error_code&&p.socket&&p.socket.signal&&p.socket.signal.connection&&p.socket.signal.connection.readyState===WebSocket.OPEN&&(E.default.info("Disconnecting websocket connection"),p.socket.signal.connection.close()))})},3e3),function(_e,Pe){var ke=_e.role,xe=y()({},p.joinInfo.apResponse),ze={session_id:p.joinInfo.sid,app_id:V.appId,channel_key:p.key,channel_name:p.joinInfo.cname,sdk_version:O.VERSION,browser:navigator.userAgent,process_id:Object(F.getProcessId)(),mode:p.mode,codec:p.codec,role:ke,has_changed_gateway:Object(O.getParameter)("FORCE_CHANGED_GATEWAY_FLAG")||p.hasChangeBGPAddress,ap_response:xe,optionalInfo:p.joinInfo.optionalInfo,extend:Object(O.getParameter)("JOIN_EXTEND"),details:{}};if(p.joinInfo.hasOwnProperty("stringUid")&&(ze.string_uid=p.joinInfo.stringUid),p.socket&&p.socket.signal&&p.socket.signal&&(xe.addresses&&xe.addresses[p.socket.signal.hostIndex]&&(ze.ap_response.ticket=xe.addresses[p.socket.signal.hostIndex].ticket,delete xe.addresses),Object(O.getParameter)("SET_DEFAULT_TURNSERVER")&&p.socket.signal.turnConfig)){var Be={username:p.joinInfo.uid.toString(),credential:p.joinInfo.token,forceturn:Object(O.getParameter)("FORCE_TURN")};Be.url=p.socket.signal.turnConfig.url,p.socket.signal.turnConfig.tcpport&&(Be.tcpport=""+p.socket.signal.turnConfig.tcpport),p.socket.signal.turnConfig.udpport&&(Be.udpport=""+p.socket.signal.turnConfig.udpport),p.joinInfo.turnServers.find(function(ct){if(ct.url===Be.url)return!0})||p.joinInfo.turnServers.push(Be)}3===p.joinInfo.proxyServerType&&(ze.plugin="web_cloud_proxy",ze.details.cservice_map="1"),p.joinInfo.aesmode&&p.joinInfo.aespassword?(ze.aes_mode=p.joinInfo.aesmode,ze.aes_encrypt=!0,p.joinInfo.aes_salt&&(ze.aes_salt=p.joinInfo.aes_salt),Object(Z.encryptRSA)(p.joinInfo.aespassword).then(function(ct){ze.aes_secret=ct,p.dispatchEvent({type:"join-message-hook",joinMessage:ze}),Pe(null,{_type:"join",_message:ze})}).catch(function(ct){E.default.error("[".concat(p.clientId,"] encrypt password failed "),ct),Pe("ENCRYPT_PASSWORD_FAILED")})):(p.dispatchEvent({type:"join-message-hook",joinMessage:ze}),Pe(null,{_type:"join",_message:ze}))}({role:p.role},function(_e,Pe){if(_e)return fe&&fe(_e);p.makeRequest(Pe,function(ke){if(F.report.joinGateway(h.sid,{lts:me,succ:!0,ec:null,vid:h.vid,uid:h.uid,addr:p.socket.getURL(),firstSuccess:p.isFirstSuccess}),p.joinSuccessLts=Date.now(),p.isFirstSuccess=!1,p.rejoinAttempt=0,p.hasJoined=!0,ae&&ae(ke.uid),!0===ke.return_vosip||!0===Object(O.getParameter)("ENABLE_LIVE_SERVER_LIST")){var xe=null;try{xe=p.socket.signal.connection.url}catch(ze){E.default.debug("[".concat(p.clientId,"] Can not get gateway ip: ").concat(ze))}xe?Object(O.setParameter)("LIVE_SERVER_LIST",[xe]):Object(O.setParameter)("LIVE_SERVER_LIST",[])}p.dispatchEvent({type:"join"}),clearInterval(p.timers.trafficStats),p.timers.trafficStats=setInterval(function(){p.makeRequest({_type:"traffic_stats"},function(ze){var Be={};for(var ct in ze)Be[T(ct)]=ze[ct];if(Be.peer_delay&&Be.peer_delay.length){var Je=[];Be.peer_delay.forEach(function(Nt){var _r={};for(var Ei in Nt)_r[T(Ei)]=Nt[Ei];Je.push(_r)}),Be.peer_delay=Je}p.traffic_stats=Be,p.traffic_stats.timestamp=Date.now();var At=p.localStreams[K]||p.localStreams[p.joinInfo.stringUid];At&&(At.traffic_stats={access_delay:Be.access_delay}),Be.peer_delay&&Be.peer_delay.forEach(function(Nt){var _r=p.remoteStreams[Nt.peer_uid];_r&&(_r.traffic_stats={access_delay:Be.access_delay,e2e_delay:Nt.e2e_delay,audio_delay:Nt.audio_delay,video_delay:Nt.video_delay})}),p.dispatchEvent({type:"after-getTrafficStats",trafficStats:Be})})},3e3)},function(ke,xe){if(E.default.error("[".concat(p.clientId,"] User join failed [").concat(ke,"]")),"ERR_JOIN_BY_MULTI_IP"===ke){try{F.report.joinGateway(h.sid,{lts:me,succ:!1,ec:"ERR_JOIN_BY_MULTI_IP",addr:p.socket.getURL()})}catch(ze){}return p.dispatchEvent({type:"onMultiIP",option:xe.option})}u[ke]&&p.rejoinAttempt<4?p._doWithAction(u[ke],ae,fe):fe&&fe(ke),F.report.joinGateway(h.sid,{lts:me,succ:!1,ec:ke,addr:p.socket&&p.socket.getURL()})})})},function(ve){E.default.error("[".concat(p.clientId,"] User join failed [").concat(ve,"]")),fe&&fe(ve),F.report.joinGateway(h.sid,{lts:me,succ:!1,ec:ve,addr:p.socket.getURL()})}),this.remoteMuteState={},p.resetAudioVolumeIndication()},p.leave=function(h,Q){var ae=re.unregister(p);switch(ae&&E.default.debug("[".concat(p.clientId,"] "),ae),p.p2ps.clear(),p.state){case Te:return E.default.debug("[".concat(p.clientId,"] Client Already in DISCONNECTED status")),void le(h);case Ee:return E.default.debug("[".concat(p.clientId,"] Client Already in DISCONNECTING status")),void le(Q,ne.default.INVALID_OPERATION);case Re:return p.socket&&p.socket.close(),p.socket=void 0,E.default.info("[".concat(p.clientId,"] Client connecting, Leave channel success")),p.state=Te,h&&h()}for(var fe in p.state=Ee,p.channelMediaConfig&&(p.channelMediaRelayController&&p.channelMediaRelayController.dispose(),p.channelMediaRelayController=null),clearInterval(p.pingTimer),p.timers)p.timers.hasOwnProperty(fe)&&clearInterval(p.timers[fe]);for(var fe in p.inChannelInfo.joinAt&&(p.inChannelInfo.duration+=Date.now()-p.inChannelInfo.joinAt,p.inChannelInfo.joinAt=null),p.hasJoined?p.makeRequest({_type:"leave"},function(ge){p.socket.close(),p.socket=void 0,E.default.info("[".concat(p.clientId,"] Leave channel success")),p.state=Te,h&&h(ge)},function(ge){"TIMEOUT"!==ge&&"REQUEST_ABORT"!==ge&&(E.default.error("[".concat(p.clientId,"] Leave Channel Failed"),ge),p.state=Ce,Q&&Q(ge))}):(p.socket&&(p.socket.close(),p.socket=void 0),E.default.info("[".concat(p.clientId,"] Leave channel before joined")),p.state=Te,h&&h()),p.localStreams)if(p.localStreams.hasOwnProperty(fe)){var me=p.localStreams[fe];delete p.localStreams[fe],void 0!==me.pc&&(me.pc.close(),me.pc=void 0)}ie()},p.publish=function(h,Q,ae,fe){var me=(new Date).getTime(),K=!1;if(h.publishLTS=me,"object"!==m()(h)||null===h)return E.default.error("[".concat(p.clientId,"] Invalid local stream")),fe&&fe(ne.default.INVALID_LOCAL_STREAM),void F.report.publish(p.joinInfo.sid,{lts:me,succ:!1,audio:!1,video:!1,screenshare:!1,audioName:"",videoName:"",screenName:"",ec:ne.default.INVALID_LOCAL_STREAM});if(!h.stream&&void 0===h.url)return E.default.error("[".concat(p.clientId,"] Invalid local media stream")),fe&&fe(ne.default.INVALID_LOCAL_STREAM),void F.report.publish(p.joinInfo.sid,{lts:me,succ:!1,audio:!1,video:!1,screenshare:!1,audioName:"",videoName:"",screenName:"",ec:ne.default.INVALID_LOCAL_STREAM});if(p.state!==Ce)return E.default.error("[".concat(p.clientId,"] User is not in the session")),fe&&fe(ne.default.INVALID_OPERATION),void F.report.publish(p.joinInfo.sid,{lts:me,succ:!1,audio:h.hasAudio(),video:h.hasVideo(),screenshare:h.hasScreen(),audioName:h.hasAudio()&&h.audioName,videoName:h.hasVideo()&&h.videoName,screenName:h.hasScreen()&&h.screenName,ec:ne.default.INVALID_OPERATION});var ge=h.getAttributes()||{};if(h.local&&void 0===p.localStreams[h.getId()]&&(h.hasAudio()||h.hasVideo()||h.hasScreen())){var ve=p.generateP2PId();if(p.p2ps.set(ve,h),h.p2pId=ve,void 0!==h.url)Fe(de({state:"url",audio:h.hasAudio(),video:h.hasVideo(),attributes:h.getAttributes()}),function(_e,Pe){"success"===_e?(h.getUserId()!==Pe&&h.setUserId(Pe),p.localStreams[Pe]=h,h.onClose=function(){p.unpublish(h)}):E.default.error("[".concat(p.clientId,"] Publish local stream failed"),_e)});else{p.localStreams[h.getId()]=h,h.connectionSpec={callback:function(_e){_e||fe&&fe("CANNOT_GET_OFFER"),"motion"===h.optimizationMode&&h.pc.setRtpSenderParameters("maintain-framerate"),"detail"===h.optimizationMode&&h.pc.setRtpSenderParameters("maintain-resolution"),p.makeRequest(de({state:"offer",stream_type:1==Q.streamType?"low":"high",p2p_id:ve,sdp:_e,audio:h.audio||h.screenAudio,video:h.screen||h.video,screen:h.screen,attributes:h.getAttributes(),dtx:h.DTX,hq:h.highQuality,lq:h.lowQuality,stereo:h.stereo,speech:h.speech,codec:p.codec,extend:Object(O.getParameter)("PUB_EXTEND")}),function(Pe){h.getUserId()!==Pe.uid&&h.setUserId(Pe.uid),E.default.info("[".concat(p.clientId,"] Local stream published with uid"),Pe.uid),h.onClose=function(){p.unpublish(h)},h._onAudioUnmute=function(){p.makeReport(pe({action:"unmute_local_audio",stream_id:h.getId()}))},h._onVideoUnmute=function(){p.makeReport(pe({action:"unmute_local_video",stream_id:h.getId()}))},h._onAudioMute=function(){p.makeReport(pe({action:"mute_local_audio",stream_id:h.getId()}))},h._onVideoMute=function(){p.makeReport(pe({action:"mute_local_video",stream_id:h.getId()}))},h.getId()===h.getUserId()&&(h.isAudioOn()||h.hasAudio()&&(E.default.debug("[".concat(p.clientId,"] local stream audio mute")),h._onAudioMute()),h.isVideoOn()||(h.hasVideo()||h.hasScreen())&&(E.default.debug("[".concat(p.clientId,"] local stream video mute")),h._onVideoMute())),h.pc.oniceconnectionstatechange=function(ke){if("failed"===ke){if(null!=p.timers[h.getId()]&&(clearInterval(p.timers[h.getId()]),clearInterval(p.timers[h.getId()]+"_RelatedStats")),E.default.error("[".concat(p.clientId,"] Publisher connection is lost -- streamId: ").concat(h.getId(),", p2pId: ").concat(ve)),p.p2ps.delete(ve),E.default.debug("[".concat(p.clientId,"] publish p2p failed: "),p.p2ps),!K)return K=!0,F.report.publish(p.joinInfo.sid,{lts:me,succ:!1,audio:h.hasAudio(),video:h.hasVideo(),screenshare:h.hasScreen(),audioName:h.hasAudio()&&h.audioName,videoName:h.hasVideo()&&h.videoName,screenName:h.hasScreen()&&h.screenName,ec:ne.default.PEERCONNECTION_FAILED,publishRequestid:p.publishRequestId||0,p2pid:ve}),p.dispatchEvent(Object(j.a)({type:"pubP2PLost",stream:h})),fe&&fe(ne.default.PEERCONNECTION_FAILED);p.dispatchEvent(Object(j.a)({type:"pubP2PLost",stream:h}))}else if("connected"===ke&&(E.default.debug("[".concat(p.clientId,"] publish p2p connected: "),p.p2ps),h.getId()===h.getUserId()&&(h._isAudioMuted()?p.makeReport(pe({action:"mute_local_audio",stream_id:h.getId()})):p.makeReport(pe({action:"unmute_local_audio",stream_id:h.getId()})),h._isVideoMuted()?p.makeReport(pe({action:"mute_local_video",stream_id:h.getId()})):p.makeReport(pe({action:"unmute_local_video",stream_id:h.getId()}))),!K))return K=!0,F.report.publish(p.joinInfo.sid,{lts:me,succ:!0,audio:h.hasAudio(),video:h.hasVideo(),screenshare:h.hasScreen(),audioName:h.hasAudio()&&h.audioName,videoName:h.hasVideo()&&h.videoName,screenName:h.hasScreen()&&h.screenName,ec:null,publishRequestid:p.publishRequestId||0,p2pid:ve}),ae&&ae()},h.pc.processSignalingMessage(Pe.sdp)},function(Pe,ke){E.default.error("Publish Failed: ".concat(Pe)),F.report.publish(p.joinInfo.sid,{lts:me,succ:!1,audio:h.hasAudio(),video:h.hasVideo(),screenshare:h.hasScreen(),audioName:h.hasAudio()&&h.audioName,videoName:h.hasVideo()&&h.videoName,screenName:h.hasScreen()&&h.screenName,ec:Pe,publishRequestid:p.publishRequestId||0,p2pid:ve}),"TIMEOUT"!=Pe&&(p.processPublishFailure(h),fe&&fe(Pe))})},audio:h.hasAudio(),video:h.hasVideo(),screen:h.hasScreen(),optimizationMode:h.optimizationMode,isSubscriber:!1,stunServerUrl:p.stunServerUrl,turnServers:p.joinInfo.turnServers,maxAudioBW:ge.maxAudioBW,minVideoBW:ge.minVideoBW,maxVideoBW:ge.maxVideoBW,mode:p.mode,codec:p.codec,isVideoMute:h.userMuteVideo||h.peerMuteVideo,isAudioMute:h.userMuteAudio||h.peerMuteAudio,maxFrameRate:h.attributes.maxFrameRate,agoraStream:h,clientId:p.clientId,isCloudProxy3:3===p.joinInfo.proxyServerType,onNoIceCandidate:function(){p.dispatchEvent({type:"no_ice_candidate",stream:h})}},h.pc=Object(Y.a)(h.connectionSpec),h.pc.addStream(h.stream),E.default.debug("[".concat(p.clientId,"] PeerConnection add stream :"),h.stream),h.pc.onnegotiationneeded=function(_e){"motion"===h.optimizationMode&&h.pc.setRtpSenderParameters("maintain-framerate"),"detail"===h.optimizationMode&&h.pc.setRtpSenderParameters("maintain-resolution");var Pe={state:"negotiation",stream_type:1===Q.streamType?"low":"high",p2p_id:ve,sdp:_e};p.makeRequest(de(Pe),function(ke){E.default.debug("Negotating Stream ".concat(h.getId())),h.pc.processSignalingMessage(ke.sdp)},function(ke,xe){E.default.error("Negotiation failed ".concat(ke),xe,Pe)})},clearInterval(p.timers[h.getId()]),p.timers[h.getId()]=setInterval(function(){if(Object(O.getParameter)("REPORT_STATS")){var _e=0;h&&h.pc&&h.pc.getStats&&h.pc.getStatsRate(function(Pe){Pe.forEach(function(ke){if(ke&&ke.id&&!(/_recv$/.test(ke.id)||/^time$/.test(ke.id)||~ke.type.toLowerCase().indexOf("inbound"))&&h.getUserId()){if(-1===ke.id.indexOf("outbound_rtp")&&-1===ke.id.indexOf("OutboundRTP")&&-1===ke.type.toLowerCase().indexOf("outbound")||"video"!==ke.mediaType||(ke.googFrameWidthSent=h.videoWidth+"",ke.googFrameHeightSent=h.videoHeight+""),"video"===ke.mediaType)try{var xe=h.stream.getVideoTracks()[0];ke.A_vstd=xe.enabled?"0":"1"}catch(ct){}if("audio"===ke.mediaType)try{var ze=h.stream.getAudioTracks()[0];ke.A_astd=ze.enabled?"0":"1"}catch(ct){}if(h.getId()==h.getUserId()){var Be=200*_e;_e++,setTimeout(function(){var Je,bt,ct=p.socket&&p.socket.getLastMsgTime()&&Date.now()-p.socket.getLastMsgTime();ct>Object(O.getParameter)("REPORT_STATS_TIMEOUT")?E.default.debug("PublishStats report blocked by REPORT_STATS_TIMEOUT ".concat(ct)):p.makeReport((Je=ke,bt={},Object.keys(Je).forEach(function(At){Object(O.getParameter)("STATS_FILTER")[At]||(bt[d(At)]=Je[At])}),{_type:"publish_stats",_message:{stream_type:"high",stats:bt}}))},Be)}else Be=200*_e,_e++,setTimeout(function(){var Je,bt,ct=p.socket&&p.socket.getLastMsgTime()&&Date.now()-p.socket.getLastMsgTime();ct>Object(O.getParameter)("REPORT_STATS_TIMEOUT")?E.default.debug("PublishStatsLow report blocked by REPORT_STATS_TIMEOUT ".concat(ct)):p.makeReport((Je=ke,bt={},Object.keys(Je).forEach(function(At){Object(O.getParameter)("STATS_FILTER")[At]||(bt[d(At)]=Je[At])}),{_type:"publish_stats",_message:{stream_type:"low",stats:bt}}))},Be)}})})}},3e3);var be=function(){Object(O.getParameter)("REPORT_STATS")&&h&&h.pc&&h.pc.getVideoRelatedStats&&h.pc.getVideoRelatedStats(function(_e){var Pe,ke,ze,Be,xe=p.socket&&p.socket.getLastMsgTime()&&Date.now()-p.socket.getLastMsgTime();xe>Object(O.getParameter)("REPORT_STATS_TIMEOUT")?E.default.debug("PublishRelatedStats report blocked by REPORT_STATS_TIMEOUT ".concat(xe)):h.getId()===h.getUserId()?p.makeReport((Pe=_e,ke={},Object.keys(Pe).forEach(function(ze){Object(O.getParameter)("STATS_FILTER")[ze]||(ke[d(ze)]=Pe[ze])}),{_type:"publish_related_stats",_message:{stream_type:"high",stats:ke}})):p.makeReport((ze=_e,Be={},Object.keys(ze).forEach(function(ct){Object(O.getParameter)("STATS_FILTER")[ct]||(Be[d(ct)]=ze[ct])}),{_type:"publish_related_stats",_message:{stream_type:"low",stats:Be}}))})};be(),clearInterval(p.timers[h.getId()+"_RelatedStats"]),p.timers[h.getId()+"_RelatedStats"]=setInterval(be,1e3)}}},p.unpublish=function(h,Q,ae,fe){if("object"!==m()(h)||null===h)return E.default.error("[".concat(p.clientId,"] Invalid local stream")),void le(fe,ne.default.INVALID_LOCAL_STREAM);if(p.state!==Ce)return E.default.error("[".concat(p.clientId,"] User not in the session")),void le(fe,ne.default.INVALID_OPERATION);if(null!=p.timers[h.getId()]&&(clearInterval(p.timers[h.getId()]),clearInterval(p.timers[h.getId()+"_RelatedStats"])),void 0!==p.socket)if(h.local&&void 0!==p.localStreams[h.getId()]){delete p.localStreams[h.getId()];var me={stream_id:h.getUserId(),stream_type:1===Q.streamType?"low":"high"};p.makeRequest({_type:"unpublish",_message:me}),(h.hasAudio()||h.hasVideo()||h.hasScreen())&&void 0===h.url&&void 0!==h.pc&&(h.pc.close(),h.pc=void 0),h.onClose=void 0,h._onAudioMute=void 0,h._onAudioUnute=void 0,h._onVideoMute=void 0,h._onVideoUnmute=void 0,p.p2ps.delete(h.p2pId),ae&&ae()}else E.default.error("[".concat(p.clientId,"] Invalid local stream")),le(fe,ne.default.INVALID_LOCAL_STREAM);else E.default.error("[".concat(p.clientId,"] User not in the session")),le(fe,ne.default.INVALID_OPERATION)},p.subscribe=function(h,Q,ae){var fe=(new Date).getTime();h.subscribeLTS=fe;var me=!1;if(E.default.info("[".concat(p.clientId,"] Gatewayclient ").concat(p.uid," Subscribe ").concat(h.getId(),": ").concat(JSON.stringify(h.subscribeOptions))),"object"!==m()(h)||null===h)return E.default.error("[".concat(p.clientId,"] Invalid remote stream")),ae&&ae(ne.default.INVALID_REMOTE_STREAM),void F.report.subscribe(p.joinInfo.sid,{lts:fe,succ:!1,video:h.subscribeOptions&&h.subscribeOptions.video,audio:h.subscribeOptions&&h.subscribeOptions.audio,peerid:h.getId(),ec:ne.default.INVALID_REMOTE_STREAM});if(p.state!==Ce&&(E.default.error("[".concat(p.clientId,"] User is not in the session")),!me))return me=!0,F.report.subscribe(p.joinInfo.sid,{lts:fe,succ:!1,video:h.subscribeOptions&&h.subscribeOptions.video,audio:h.subscribeOptions&&h.subscribeOptions.audio,peerid:h.getId(),ec:ne.default.INVALID_OPERATION}),ae&&ae(ne.default.INVALID_OPERATION);if(!h.local&&p.remoteStreams.hasOwnProperty(h.getId()))if(h.hasAudio()||h.hasVideo()||h.hasScreen()){var K=p.generateP2PId();p.p2ps.set(K,h),h.p2pId=K,h.pc=Object(Y.a)({callback:function(ge){ge||ae&&ae("CANNOT_GET_OFFER");var ve={stream_id:h.getId(),audio:!h.subscribeOptions||h.subscribeOptions.audio,video:!h.subscribeOptions||h.subscribeOptions.video,codec:p.codec,p2p_id:K,sdp:ge,tcc:Object(O.getParameter)("SUBSCRIBE_TCC"),extend:Object(O.getParameter)("SUB_EXTEND")};p.makeRequest({_type:"subscribe",_message:ve},function(be){h.pc.processSignalingMessage(be.sdp)},function(be,_e){E.default.error("[".concat(p.clientId,"] Subscribe remote stream Failed: ").concat(be,", closing stream "),h.getId(),_e),F.report.subscribe(p.joinInfo.sid,{lts:fe,succ:!1,video:h.subscribeOptions&&h.subscribeOptions.video,audio:h.subscribeOptions&&h.subscribeOptions.audio,peerid:h.getId(),ec:be}),"TIMEOUT"!=be&&(p.processSubscribeFailure(h),ae&&ae(be))})},nop2p:!0,audio:!0,video:!0,screen:h.hasScreen(),isSubscriber:!0,stunServerUrl:p.stunServerUrl,turnServers:p.joinInfo.turnServers,isVideoMute:h.userMuteVideo,isAudioMute:h.userMuteAudio,uid:h.getId(),agoraStream:h,clientId:p.clientId}),h.pc.onaddstream=function(ge,ve){if(h._onAudioUnmute=function(){p.makeReport(pe({action:"unmute_remote_audio",stream_id:h.getId()}),function(){},function(){})},h._onAudioMute=function(){p.makeReport(pe({action:"mute_remote_audio",stream_id:h.getId()}),function(){},function(){})},h._onVideoUnmute=function(){p.makeReport(pe({action:"unmute_remote_video",stream_id:h.getId()}),function(){},function(){})},h._onVideoMute=function(){p.makeReport(pe({action:"mute_remote_video",stream_id:h.getId()}),function(){},function(){})},"ontrack"===ve&&"video"===ge.track.kind||"onaddstream"===ve){E.default.info("[".concat(p.clientId,"] Remote stream subscribed with uid "),h.getId());var be=p.remoteStreams[h.getId()];if(p.remoteStreams[h.getId()].stream="onaddstream"===ve?ge.stream:ge.streams[0],p.remoteStreams[h.getId()].hasVideo()){if(Object(_.isFireFox)()||Object(_.isSafari)()){var _e=p.remoteStreams[h.getId()].stream;Object(N.vsResHack)(_e,function(xe,ze){h.videoWidth=xe,h.videoHeight=ze},function(xe){return E.default.warning("[".concat(p.clientId,"] vsResHack failed: ")+xe)})}}else{var Pe=p.remoteStreams[h.getId()];Pe.peerMuteVideo=!0,p._adjustPCMuteStatus(Pe)}be&&be.isPlaying()&&be.elementID&&(E.default.debug("[".concat(p.clientId,"] Reload Player ").concat(be.elementID," StreamId ").concat(be.getId())),h.audioOutput=be.audioOutput,be.stop(),h.play(be.elementID,be.playOptions)),delete h.audioLevelHelper;var ke=Object(j.e)({type:"stream-subscribed",stream:p.remoteStreams[h.getId()]});p.dispatchEvent(ke)}},clearInterval(p.timers[h.getId()]),p.timers[h.getId()]=setInterval(function(){if(Object(O.getParameter)("REPORT_STATS")){var ge=0;h&&h.pc&&h.pc.getStats&&h.pc.getStatsRate(function(ve){ve.forEach(function(be){if(be&&be.id){if(/_send$/.test(be.id)||/^time$/.test(be.id)||/^bweforvideo$/.test(be.id))return;-1===be.id.indexOf("inbound_rtp")&&-1===be.id.indexOf("inbound-rtp")&&-1===be.type.toLowerCase().indexOf("inbound")||"video"!==be.mediaType||(be.googFrameWidthReceived=h.videoWidth+"",be.googFrameHeightReceived=h.videoHeight+"");var _e=200*ge;ge++;var Pe=h.getId();setTimeout(function(){var ke=p.socket&&p.socket.getLastMsgTime()&&Date.now()-p.socket.getLastMsgTime();if(ke>Object(O.getParameter)("REPORT_STATS_TIMEOUT"))E.default.debug("SubscribeStats report blocked by REPORT_STATS_TIMEOUT ".concat(ke));else{if("video"===be.mediaType)try{var xe=h.stream.getVideoTracks()[0];be.A_vrtd=xe.enabled?"0":"1",h.player&&h.player.freezeTimeCounterList.length>0&&(be.A_vrft=h.player.freezeTimeCounterList.splice(0,1)[0].toString())}catch(Be){}if("audio"===be.mediaType)try{var ze=h.stream.getAudioTracks()[0];be.A_artd=ze.enabled?"0":"1"}catch(Be){}p.makeReport(ye(Pe,be))}},_e)}})})}},3e3),clearInterval(p.timers[h.getId()+"_RelatedStats"]),p.timers[h.getId()+"_RelatedStats"]=setInterval(function(){if(Object(O.getParameter)("REPORT_STATS")&&h&&h.pc){var ge=p.socket&&p.socket.getLastMsgTime()&&Date.now()-p.socket.getLastMsgTime();if(ge>Object(O.getParameter)("REPORT_STATS_TIMEOUT"))return void E.default.debug("SubscribeRelatedStats report blocked by REPORT_STATS_TIMEOUT ".concat(ge));h.pc.getVideoRelatedStats&&h.pc.getVideoRelatedStats(function(ve){h.player&&(h.hasVideo()&&!h.peerMuteVideo&&(ve.isFreeze=h.player.freezeCount>h.player.lastFreezeCount),h.player.lastFreezeCount=h.player.freezeCount),p.makeReport(oe(h.getId(),ve))}),h.pc.getAudioRelatedStats&&h.pc.getAudioRelatedStats(function(ve){p.makeReport(oe(h.getId(),ve))})}},1e3),p.audioLevel[h.getId()]=0,clearInterval(p.timers[h.getId()+"audio"]),p.timers[h.getId()+"audio"]=setInterval(function(){p.hasListeners("active-speaker")&&h&&h.pc&&"established"===h.pc.state&&h.pc.getStats&&h.pc.getStats(function(ge){ge.forEach(function(ve){if("audio"===ve.mediaType){if(ve.audioOutputLevel>5e3)for(var be in p.audioLevel[h.getId()]<20&&(p.audioLevel[h.getId()]+=1),p.audioLevel)be!==""+h.getId()&&p.audioLevel[be]>0&&(p.audioLevel[be]-=1);var _e=Object.keys(p.audioLevel).sort(function(ke,xe){return p.audioLevel[xe]-p.audioLevel[ke]});if(p.activeSpeaker!==_e[0]){var Pe=Object(j.a)({type:"active-speaker",uid:_e[0]});p.dispatchEvent(Pe),p.activeSpeaker=_e[0],E.default.debug("[".concat(p.clientId,"] Update active speaker: ").concat(p.activeSpeaker))}}})},50)},50),h.pc.oniceconnectionstatechange=function(ge){if("failed"===ge)null!=p.timers[h.getId()]&&(clearInterval(p.timers[h.getId()]),clearInterval(p.timers[h.getId()]+"audio")),E.default.error("[".concat(p.clientId,"] Subscriber connection is lost -- streamId: ").concat(h.getId(),", p2pId: ").concat(K)),E.default.debug("[".concat(p.clientId,"] subscribe p2p failed: "),p.p2ps),me||(me=!0,ae&&ae(ne.default.PEERCONNECTION_FAILED),F.report.subscribe(p.joinInfo.sid,{lts:fe,succ:!1,video:h.subscribeOptions&&h.subscribeOptions.video,audio:h.subscribeOptions&&h.subscribeOptions.audio,peerid:h.getId(),ec:ne.default.PEERCONNECTION_FAILED,subscribeRequestid:p.subscribeRequestId.get(h.getId())||0,p2pid:K})),p.remoteStreams[h.getId()]&&p.p2ps.has(K)&&(p.p2ps.delete(K),p.dispatchEvent(Object(j.a)({type:"subP2PLost",stream:h})));else if("connected"===ge&&(E.default.debug("[".concat(p.clientId,"] subscribe p2p connected: "),p.p2ps),!me)){me=!0,F.report.subscribe(p.joinInfo.sid,{lts:fe,succ:!0,video:h.subscribeOptions&&h.subscribeOptions.video,audio:h.subscribeOptions&&h.subscribeOptions.audio,peerid:h.getId(),ec:null,subscribeRequestid:p.subscribeRequestId.get(h.getId())||0,p2pid:K}),p._adjustPCMuteStatus(h);var ve=!1,be=!1,_e=!1,Pe=setInterval(function(){ve&&be||(h.pc?h.pc.getStats(function(ct){ct.forEach(function(Je){if((-1!==Je.id.indexOf("recv")||Je.type&&-1!==Je.type.toLowerCase().indexOf("inbound")||-1!==Je.id.indexOf("inbound_rtp")||-1!==Je.id.indexOf("inbound-rtp")||-1!==Je.id.indexOf("InboundRTP"))&&"audio"===Je.mediaType){if((Je.googDecodingNormal>0||Je.audioOutputLevel>0)&&!ve){ve=!0,p.dispatchEvent({type:"first-audio-frame-decode",stream:h}),ve&&be&&clearInterval(Pe);var bt=Date.now(),At=F.report.getSessionStartTime(p.joinInfo.sid);F.report.firstAudioDecode(p.joinInfo.sid,{peerid:h.uintId,uid:p.uid,elapse:bt-At,subscribeElapse:bt-h.subscribeLTS,subscribeRequestid:p.subscribeRequestId.get(h.getId())||0,p2pid:K})}parseInt(Je.packetsReceived)>0&&!be&&(be=!0,p.dispatchEvent({type:"first-audio-packet-received",stream:h}),ve&&be&&clearInterval(Pe),bt=Date.now(),At=F.report.getSessionStartTime(p.joinInfo.sid),F.report.firstAudioReceived(p.joinInfo.sid,{peerid:h.uintId,uid:p.uid,elapse:bt-At,subscribeElapse:bt-h.subscribeLTS,subscribeRequestid:p.subscribeRequestId.get(h.getId())||0,p2pid:K}))}})},100):clearInterval(Pe))},100),ke=!1,xe=!1,ze=setInterval(function(){ke&&xe||(h.pc?h.pc.getStats(function(ct){ct.forEach(function(Je){if((-1!==Je.id.indexOf("recv")||Je.type&&-1!==Je.type.toLowerCase().indexOf("inbound")||-1!==Je.id.indexOf("inbound_rtp")||-1!==Je.id.indexOf("inbound-rtp")||-1!==Je.id.indexOf("InboundRTP"))&&"video"===Je.mediaType){if((Je.framesDecoded>0||Je.googFramesDecoded>0)&&!ke){ke=!0,p.dispatchEvent({type:"first-video-frame-decode",stream:h}),ke&&xe&&clearInterval(ze);var bt=Date.now(),At=F.report.getSessionStartTime(p.joinInfo.sid);h.firstFrameTime=(new Date).getTime()-h.subscribeLTS,F.report.firstVideoDecode(p.joinInfo.sid,{peerid:h.uintId,width:parseInt(Je.googFrameWidthReceived)||0,height:parseInt(Je.googFrameHeightReceived)||0,uid:p.uid,elapse:bt-At,subscribeElapse:bt-h.subscribeLTS,subscribeRequestid:p.subscribeRequestId.get(h.getId())||0,p2pid:K})}Je.packetsReceived>0&&!xe&&(xe=!0,p.dispatchEvent({type:"first-video-packet-received",stream:h}),ke&&xe&&clearInterval(ze),bt=Date.now(),At=F.report.getSessionStartTime(p.joinInfo.sid),F.report.firstVideoReceived(p.joinInfo.sid,{peerid:h.uintId,uid:p.uid,elapse:bt-At,subscribeElapse:bt-h.subscribeLTS,subscribeRequestid:p.subscribeRequestId.get(h.getId())||0,p2pid:K}))}})},100):clearInterval(ze))},100),Be=setInterval(function(){if(!_e){var ct=h.getId(),Je=p.traffic_stats;if(Je&&Je.peer_delay){var bt=Je.peer_delay.find(function(Pc){return Pc.peer_uid==ct});if(bt){if(_e=!0,p.peerPublishDurationMap.get(h.getId()))return void clearInterval(Be);var At=bt.peer_publish_audio_duration,Nt=bt.peer_publish_video_duration;if(void 0===At||void 0===Nt)return;p.peerPublishDurationMap.set(h.getId(),!0);var _r=F.report.getSessionStartTime(p.joinInfo.sid),Ei=(At||Nt)+(Date.now()-Je.timestamp),Si=Date.now();F.report.peerPublishStatus({audiotag:At?1:-1,videotag:Nt?1:-1,lts:Si,sid:p.joinInfo.sid,cname:p.joinInfo.cname,cid:p.joinInfo.cid,uid:p.joinInfo.uid,elapse:Si-_r,peer:h.uintId,peerPublishDuration:Ei,joinChannelSuccessElapse:Si-p.joinSuccessLts,subscribeElapse:Si-h.subscribeLTS}),clearInterval(Be)}}}},1e3);return h.sid=p.joinInfo.sid,Q&&Q()}}}else E.default.error("[".concat(p.clientId,"] Invalid remote stream")),me||(me=!0,ae&&ae(ne.default.INVALID_REMOTE_STREAM),F.report.subscribe(p.joinInfo.sid,{lts:fe,succ:!1,video:h.subscribeOptions&&h.subscribeOptions.video,audio:h.subscribeOptions&&h.subscribeOptions.audio,peerid:h.getId(),ec:ne.default.INVALID_REMOTE_STREAM}));else E.default.error("[".concat(p.clientId,"] No such remote stream")),me||(me=!0,ae&&ae(ne.default.NO_SUCH_REMOTE_STREAM),F.report.subscribe(p.joinInfo.sid,{lts:fe,succ:!1,video:h.subscribeOptions&&h.subscribeOptions.video,audio:h.subscribeOptions&&h.subscribeOptions.audio,peerid:h.getId(),ec:ne.default.NO_SUCH_REMOTE_STREAM}))},p.subscribeChange=function(h,Q,ae){var fe=Date.now();E.default.info("[".concat(p.clientId,"] Gatewayclient ").concat(p.uid," SubscribeChange ").concat(h.getId(),": ").concat(JSON.stringify(h.subscribeOptions))),p._adjustPCMuteStatus(h);var me={stream_id:h.getId(),audio:h.subscribeOptions.audio,video:h.subscribeOptions.video};p.makeRequest({_type:"subscribe_change",_message:me},function(K){var ge=Object(j.e)({type:"stream-subscribe-changed",stream:p.remoteStreams[h.getId()]});F.report.subscribe(p.joinInfo.sid,{lts:fe,succ:!0,video:h.subscribeOptions&&h.subscribeOptions.video,audio:h.subscribeOptions&&h.subscribeOptions.audio,peerid:h.getId(),ec:null,subscribeRequestid:p.subscribeRequestId.get(h.getId())||0,p2pid:p.p2ps.get(h.getId())}),p.dispatchEvent(ge),Q&&Q()},function(K,ge){E.default.error("[".concat(p.clientId,"] Subscribe Change Failed ").concat(h.getId()),K,ge),ae&&ae(K,ge)})},p.processPublishFailure=function(h){h.publishLTS=null,h.p2pId&&p.p2ps.get(h.p2pId)===h&&p.p2ps.delete(h.p2pId),p.localStreams[h.getUserId()]===h&&delete p.localStreams[h.getUserId()],p.localStreams[h.getId()]===h&&delete p.localStreams[h.getId()],h.pc&&(h.pc.processSignalingMessage=function(){},h.pc.oniceconnectionstatechange=function(){},h.pc.close(),delete h.pc),delete h.onClose,delete h._onAudioUnmute,delete h._onVideoUnmute,delete h._onAudioMute,delete h._onVideoMute,delete h._onAudioUnmute},p.processSubscribeFailure=function(h){h.p2pId&&p.p2ps.get(h.p2pId)===h&&p.p2ps.delete(h.p2pId),h.pc&&(h.pc.onaddstream=function(){},h.pc.processSignalingMessage=function(){},h.pc.oniceconnectionstatechange=function(){},h.pc.close(),delete h.pc),delete h.onClose,delete h._onAudioUnmute,delete h._onVideoUnmute,delete h._onAudioMute,delete h._onVideoMute,delete h._onAudioUnmute},p._adjustPCMuteStatus=function(h){E.default.debug("[".concat(p.clientId,"]: use _adjustPCMuteStatus: ").concat(h.getId())),E.default.debug("[".concat(p.clientId,"]: video: ").concat(h.video,", audio: ").concat(h.audio,", suboption: ").concat(JSON.stringify(h.subscribeOptions),",userMuteVideo: ").concat(h.userMuteVideo,", peerMuteVideo: ").concat(h.peerMuteVideo,", userMuteAudio: ").concat(h.userMuteAudio,", peerMuteAudio: ").concat(h.peerMuteAudio)),!h.local&&h.pc&&h.pc.peerConnection.getReceivers&&h.pc.peerConnection.getReceivers().forEach(function(Q){if(Q&&Q.track&&"audio"===Q.track.kind){var ae=!h.userMuteAudio&&!h.peerMuteAudio;h.subscribeOptions&&!h.subscribeOptions.audio&&(ae=!1),E.default.debug("[".concat(p.clientId,"]: set receiver audio track: ").concat(ae)),Q.track.enabled=!!ae}else if(Q&&Q.track&&"video"===Q.track.kind){var fe=!h.userMuteVideo&&!h.peerMuteVideo;h.subscribeOptions&&!h.subscribeOptions.video&&(fe=!1),E.default.debug("[".concat(p.clientId,"]: set receiver video track: ").concat(fe)),Q.track.enabled=!!fe}})},p.unsubscribe=function(h,Q,ae){if("object"!==m()(h)||null===h)return E.default.error("[".concat(p.clientId,"] Invalid remote stream")),void le(ae,ne.default.INVALID_REMOTE_STREAM);if(p.state!==Ce)return E.default.error("[".concat(p.clientId,"] User is not in the session")),void le(ae,ne.default.INVALID_OPERATION);if(null!=p.timers[h.getId()]&&(clearInterval(p.timers[h.getId()]),clearInterval(p.timers[h.getId()]+"audio")),null!=p.audioLevel[h.getId()]&&delete p.audioLevel[h.getId()],null!=p.timer_counter[h.getId()]&&delete p.timer_counter[h.getId()],p.remoteStreams.hasOwnProperty(h.getId())){if(!p.socket)return E.default.error("[".concat(p.clientId,"] User is not in the session")),void le(ae,ne.default.INVALID_OPERATION);if(h.local)return E.default.error("[".concat(p.clientId,"] Invalid remote stream")),void le(ae,ne.default.INVALID_REMOTE_STREAM);h.close(),h.stop();var fe={stream_id:h.getId()};p.makeRequest({_type:"unsubscribe",_message:fe}),void 0!==h.pc&&(h.pc.close(),h.pc=void 0),h.onClose=void 0,h._onAudioMute=void 0,h._onAudioUnute=void 0,h._onVideoMute=void 0,h._onVideoUnmute=void 0,delete h.subscribeOptions,p.p2ps.delete(h.p2pId),E.default.info("[".concat(p.clientId,"] Unsubscribe stream success")),Q&&Q()}else le(ae,ne.default.NO_SUCH_REMOTE_STREAM)},p.setRemoteVideoStreamType=function(h,Q){if(E.default.debug("[".concat(p.clientId,"] Switching remote video stream ").concat(h.getId()," to ").concat(Q)),"object"===m()(h)&&null!==h)if(p.state===Ce){if(!h.local){switch(Q){case p.remoteVideoStreamTypes.REMOTE_VIDEO_STREAM_HIGH:case p.remoteVideoStreamTypes.REMOTE_VIDEO_STREAM_LOW:case p.remoteVideoStreamTypes.REMOTE_VIDEO_STREAM_MEDIUM:break;default:return}var ae={stream_id:h.getId(),stream_type:Q};p.makeRequest({_type:"switch_video_stream",_message:ae},function(){E.default.debug("SwitchVideoStream Success ".concat(ae.stream_id," ").concat(ae.stream_type))},function(fe,me){E.default.error("SwitchVideoStream Error ".concat(fe," ").concat(ae.stream_id," ").concat(ae.stream_type),me)})}}else E.default.error("[".concat(p.clientId,"] User is not in the session"));else E.default.error("[".concat(p.clientId,"] Invalid remote stream"))},p.renewToken=function(h,Q,ae){h?p.key?p.state!==Ce?(E.default.debug("[".concat(p.clientId,"] Client is not connected. Trying to rejoin")),p.key=h,p.rejoin(),Q&&Q()):(E.default.debug("[".concat(p.clientId,"] renewToken from ").concat(p.key," to ").concat(h)),p.key=h,p.makeRequest({_type:"renew_token",_message:{token:h}},Q,ae)):(E.default.error("[".concat(p.clientId,"] Client is previously joined without token")),ae&&ae(ne.default.INVALID_PARAMETER)):(E.default.error("[".concat(p.clientId,"] Invalid Token ").concat(h)),ae&&ae(ne.default.INVALID_PARAMETER))},p.setStreamFallbackOption=function(h,Q){if(E.default.debug("[".concat(p.clientId,"] Set stream fallback option ").concat(h.getId()," to ").concat(Q)),"object"===m()(h)&&null!==h)if(p.state===Ce){if(!h.local){switch(Q){case p.streamFallbackTypes.STREAM_FALLBACK_OPTION_DISABLED:case p.streamFallbackTypes.STREAM_FALLBACK_OPTION_VIDEO_STREAM_LOW:case p.streamFallbackTypes.STREAM_FALLBACK_OPTION_AUDIO_ONLY:break;default:return}var ae={stream_id:h.getId(),fallback_type:Q};p.makeRequest({_type:"set_fallback_option",_message:ae},function(){E.default.debug("SetStreamFallbackOption success ".concat(ae.stream_id," ").concat(Q))},function(fe,me){E.default.error("Failed to SetStreamFallbackOption ".concat(ae.stream_id," ").concat(Q," ").concat(fe),me)})}}else E.default.error("[".concat(p.clientId,"] User is not in the session"));else E.default.error("[".concat(p.clientId,"] Invalid remote stream"))},p.enableAudioVolumeIndicator=function(h,Q){p.audioVolumeIndication.enabled=!0,p.audioVolumeIndication.interval=h,p.audioVolumeIndication.smooth=Q,p.resetAudioVolumeIndication()},p.resetAudioVolumeIndication=function(){if(clearInterval(p.timers.audioVolumeIndication),clearInterval(p.timers.audioVolumeSampling),p.audioVolumeIndication.enabled&&p.audioVolumeIndication.interval){var h=Math.floor(1e3*p.audioVolumeIndication.smooth/100);clearInterval(p.timers.audioVolumeSampling),p.timers.audioVolumeSampling=setInterval(function(){p.audioVolumeSampling||(p.audioVolumeSampling={});var Q={};for(var ae in p.remoteStreams){var fe=p.remoteStreams[ae];if(fe.stream&&fe.hasAudio()){var me=fe.getAudioLevel();me>0&&me<1&&(me*=100);var K=p.audioVolumeSampling[ae]||[];for(K.push(me);K.length>h;)K.shift();Q[ae]=K}}p.audioVolumeSampling=Q},100),clearInterval(p.timers.audioVolumeIndication),p.timers.audioVolumeIndication=setInterval(function(){if(p.socket&&p.socket.signal&&p.socket.signal.connection&&p.socket.signal.connection.readyState===WebSocket.OPEN){var Q=[];for(var ae in p.remoteStreams)if(p.audioVolumeSampling&&p.audioVolumeSampling[ae]){var fe=p.audioVolumeSampling[ae],me=0;fe.forEach(function(be){me+=be});var K={uid:ae,level:Math.floor(me/fe.length)};K.level&&Q.push(K)}var ge=Q.sort(function(be,_e){return be.level-_e.level});E.default.debug("[".concat(p.clientId,"] volume-indicator "),JSON.stringify(ge)),p.audioVolumeIndication.sortedAudioVolumes=ge;var ve=Object(j.a)({type:"volume-indicator",attr:ge});p.dispatchEvent(ve)}},p.audioVolumeIndication.interval)}},p.closeGateway=function(){E.default.debug("[".concat(p.clientId,"] close gateway")),p.state=Te,p.socket.close(),Ae()},p.startChannelMediaRelay=function(){var h=b()(C.a.mark(function Q(ae){var fe,me,ge;return C.a.wrap(function(ve){for(;;)switch(ve.prev=ve.next){case 0:if(!p.channelMediaRelayController){ve.next=2;break}throw new L.ChannelMediaError("RELAY_ALREADY_START","",L.CHANNEL_MEDIA_RELAY_ERROR.RELAY_ALREADY_START);case 2:return fe=function(be){p.dispatchEvent({type:"channel-media-relay-event",code:be})},me=function(be,_e,Pe){be===L.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_FAILURE&&_e===L.CHANNEL_MEDIA_RELAY_ERROR.SERVER_CONNECTION_LOST&&(p.channelMediaRelayController.dispose(),p.channelMediaRelayController=null),p.dispatchEvent({type:"channel-media-relay-state",state:be,code:_e,data:Pe})},p.channelMediaRelayController=new $.a(p.joinInfo,p.clientId),p.channelMediaRelayController.on("event",fe),p.channelMediaRelayController.on("state",me),ve.prev=7,ve.next=10,p.channelMediaRelayController.startChannelMediaRelay(ae);case 10:ve.next=22;break;case 12:throw ve.prev=12,ve.t0=ve.catch(7),E.default.debug("[".concat(p.clientId,"] startChannelMediaRelay exception: ").concat(JSON.stringify(ve.t0))),p.dispatchEvent({type:"channel-media-relay-state",state:L.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_FAILURE,code:L.CHANNEL_MEDIA_RELAY_ERROR[ge=ve.t0 instanceof L.ChannelMediaError?"SetSourceChannelStatus"===ve.t0.data||ve.t0.data&&ve.t0.data.serverResponse&&"SetSourceChannel"===ve.t0.data.serverResponse.command?"FAILED_JOIN_SRC":"SetDestChannelStatus"===ve.t0.data||ve.t0.data&&ve.t0.data.serverResponse&&"SetDestChannel"===ve.t0.data.serverResponse.command?"FAILED_JOIN_DEST":ve.t0.data&&ve.t0.data.serverResponse&&"StartPacketTransfer"===ve.t0.data.serverResponse.command?"FAILED_PACKET_SENT_TO_DEST":ve.t0.message===L.CHANNEL_MEDIA_ERROR.REQUEST_TIMEOUT||ve.t0.message===L.CHANNEL_MEDIA_ERROR.WAIT_STATUS_TIMEOUT?"SERVER_NO_RESPONSE":ve.t0.message===L.CHANNEL_MEDIA_ERROR.REQUEST_FAILED||ve.t0.message===L.CHANNEL_MEDIA_ERROR.WAIT_STATUS_ERROR?"SERVER_ERROR_RESPONSE":ve.t0.message===L.CHANNEL_MEDIA_ERROR.AP_REQUEST_TIMEOUT?"NO_RESOURCE_AVAILABLE":ve.t0.message===L.CHANNEL_MEDIA_ERROR.WS_ABORT||ve.t0.message===L.CHANNEL_MEDIA_ERROR.AP_REQUEST_ABORT?"OPERATION_ABORT":"INTERNAL_ERROR":"INTERNAL_ERROR"]}),p.channelMediaRelayController&&(p.channelMediaRelayController.dispose(),p.channelMediaConfig=null,p.channelMediaRelayController=null),p.dispatchEvent({type:"channel-media-relay-state",state:L.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_IDLE}),new L.ChannelMediaError(ge,null,L.CHANNEL_MEDIA_RELAY_ERROR[ge]);case 22:p.dispatchEvent({type:"channel-media-relay-state",state:L.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_RUNNING,code:L.CHANNEL_MEDIA_RELAY_ERROR.RELAY_OK}),p.channelMediaConfig=ae;case 24:case"end":return ve.stop()}},Q,null,[[7,12]])}));return function(Q){return h.apply(this,arguments)}}(),p.updateChannelMediaRelay=function(){var h=b()(C.a.mark(function Q(ae){var fe,me;return C.a.wrap(function(K){for(;;)switch(K.prev=K.next){case 0:if(p.channelMediaRelayController){K.next=2;break}throw new L.ChannelMediaError("RELAY_NOT_START",null,L.CHANNEL_MEDIA_RELAY_ERROR.RELAY_NOT_START);case 2:return K.prev=2,K.next=5,p.channelMediaRelayController.updateChannelMediaRelay(ae);case 5:K.next=18;break;case 7:throw K.prev=7,K.t0=K.catch(2),E.default.debug("[".concat(p.clientId,"] updateChannelMediaRelay exception: ").concat(JSON.stringify(e))),fe=L.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_FAILURE,me=e instanceof L.ChannelMediaError?e.message===L.CHANNEL_MEDIA_ERROR.REQUEST_TIMEOUT||e.message===L.CHANNEL_MEDIA_ERROR.WAIT_STATUS_TIMEOUT?"SERVER_NO_RESPONSE":e.message===L.CHANNEL_MEDIA_ERROR.REQUEST_FAILED||e.message===L.CHANNEL_MEDIA_ERROR.WAIT_STATUS_ERROR?"SERVER_ERROR_RESPONSE":e.message===L.CHANNEL_MEDIA_ERROR.WS_ABORT||e.message===L.CHANNEL_MEDIA_ERROR.AP_REQUEST_ABORT?"OPERATION_ABORT":"INTERNAL_ERROR":"INTERNAL_ERROR",p.dispatchEvent({type:"channel-media-relay-event",code:L.CHANNEL_MEDIA_RELAY_EVENT.PACKET_UPDATE_DEST_CHANNEL_REFUSED}),p.dispatchEvent({type:"channel-media-relay-state",state:fe,code:L.CHANNEL_MEDIA_RELAY_ERROR[me]}),p.channelMediaRelayController&&(p.channelMediaRelayController.dispose(),p.channelMediaConfig=null,p.channelMediaRelayController=null),p.dispatchEvent({type:"channel-media-relay-state",state:L.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_IDLE}),new L.ChannelMediaError(me,null,L.CHANNEL_MEDIA_RELAY_ERROR[me]);case 18:p.channelMediaConfig=ae;case 19:case"end":return K.stop()}},Q,null,[[2,7]])}));return function(Q){return h.apply(this,arguments)}}(),p.stopChannelMediaRelay=b()(C.a.mark(function h(){var ae;return C.a.wrap(function(fe){for(;;)switch(fe.prev=fe.next){case 0:if(p.channelMediaRelayController){fe.next=2;break}throw new L.ChannelMediaError("RELAY_NOT_START",null,L.CHANNEL_MEDIA_RELAY_ERROR.RELAY_NOT_START);case 2:return fe.prev=2,fe.next=5,p.channelMediaRelayController.stopChannelMediaRelay();case 5:fe.next=17;break;case 7:throw fe.prev=7,fe.t0=fe.catch(2),E.default.debug("[".concat(p.clientId,"] stopChannelMediaRelay exception: ").concat(JSON.stringify(e))),ae=e instanceof L.ChannelMediaError?e.message===L.CHANNEL_MEDIA_ERROR.REQUEST_TIMEOUT||e.message===L.CHANNEL_MEDIA_ERROR.WAIT_STATUS_TIMEOUT?"SERVER_NO_RESPONSE":e.message===L.CHANNEL_MEDIA_ERROR.REQUEST_FAILED||e.message===L.CHANNEL_MEDIA_ERROR.WAIT_STATUS_ERROR?"SERVER_ERROR_RESPONSE":"INTERNAL_ERROR":"INTERNAL_ERROR",p.dispatchEvent({type:"channel-media-relay-state",state:L.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_FAILURE,code:L.CHANNEL_MEDIA_RELAY_ERROR[ae]}),p.channelMediaRelayController&&(p.channelMediaRelayController.dispose(),p.channelMediaConfig=null,p.channelMediaRelayController=null),p.dispatchEvent({type:"channel-media-relay-state",state:L.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_IDLE}),new L.ChannelMediaError(ae,null,L.CHANNEL_MEDIA_RELAY_ERROR[ae]);case 17:p.channelMediaConfig=null,p.channelMediaRelayController=null;case 19:case"end":return fe.stop()}},h,null,[[2,7]])})),p.sendMetadata=function(h,Q){p.makeRequest({_type:"send_metadata",_message:{session_id:p.joinInfo.sid,metadata:window.btoa(unescape(encodeURIComponent(h)))}},function(){E.default.debug("[".concat(p.clientId,'] send metadata "').concat(h,'" success')),Q&&Q(null)},function(ae){E.default.error("[".concat(p.clientId,'] send metadata "').concat(h,'" failed'),ae),Q&&Q(ae)})},p._reportWebsocketCloseEvent=function(h,Q){try{var ae=F.report.getSessionStartTime(p.joinInfo.sid),fe=Date.now();F.report.webSocketQuit({lts:fe,sid:p.joinInfo.sid,cname:p.joinInfo.cname,cid:p.joinInfo.cid,uid:p.joinInfo.uid,elapse:fe-ae,succ:h,errorCode:Q,ip:null})}catch(me){E.default.debug("[".concat(p.clientId,"]: _reportWebsocketCloseEvent exception, ").concat(me))}};var k=function(){E.default.debug("[".concat(p.clientId,"] Reconnect gateway")),p.state=Te,p.socket.close(),Ae(),p.reconnectMode="recover",p.state=Re,Ge()};p.recover=k;var Ae=function(){for(var h in p.dispatchEvent({type:"before-clear-connection"}),p.timers)p.timers.hasOwnProperty(h)&&clearInterval(p.timers[h]);for(var h in p.remoteStreams)if(p.remoteStreams.hasOwnProperty(h)){var Q=p.remoteStreams[h],ae=Object(j.a)({type:"stream-removed",uid:Q.getId(),stream:Q});p.dispatchEvent(ae)}p.p2ps.clear(),ie(),We(),clearInterval(p.pingTimer)};p.rejoin=function(){p.socket&&(clearInterval(p.pingTimer),p.socket.close(),p.socket=void 0),p.state=Re,Ge()};var Ge=function(h,Q){p.dispatchEvent(Object(j.a)({type:"rejoin-start"})),h=h||function(ae){E.default.info("[".concat(p.clientId,"] User ").concat(ae," is re-joined to ").concat(p.joinInfo.cname)),p.dispatchEvent(Object(j.a)({type:"rejoin"})),p.channelMediaConfig&&p.startChannelMediaRelay(p.channelMediaConfig).then(function(){E.default.debug("[".concat(p.clientId,"] restartChannelMediaRelay success"))}).catch(function(fe){E.default.debug("[".concat(p.clientId,"] restartChannelMediaRelay failed: ").concat(JSON.stringify(fe)))}),p.liveStreams&&p.liveStreams.size&&p.liveStreams.forEach(function(fe,me){fe&&p.setLiveTranscoding(p.transcoding),p.startLiveStreaming(me,fe)}),p.injectLiveStreams&&p.injectLiveStreams.size&&p.injectLiveStreams.forEach(function(fe,me){p.addInjectStreamUrl(me,fe)})},Q=Q||function(ae){E.default.error("[".concat(p.clientId,"] Re-join to channel failed "),ae),p.dispatchEvent(Object(j.e)({type:"error",reason:ae}))},p.key?(++p.rejoinAttempt,p.join(p.joinInfo,p.key,h,Q)):E.default.error("[".concat(p.clientId,"] Connection recover failed [Invalid channel key]"))},Ve=function(h,Q,ae){if(p.onConnect=Q,p.socket){if(p.dispatchEvent({type:"reconnect"}),"retry"===p.reconnectMode)E.default.debug("[".concat(p.clientId,"] Retry current gateway")),p.socket.reconnect();else if("tryNext"===p.reconnectMode)E.default.debug("[".concat(p.clientId,"] Try next gateway")),p.socket.connectNext();else if("recover"===p.reconnectMode){E.default.debug("[".concat(p.clientId,"] Recover gateway")),E.default.debug("[".concat(p.clientId,"] Try to reconnect choose server and get gateway list again ")),p.reconnectingCS=!0;var fe=p.joinInfo&&p.joinInfo.sid;Object(G.getGatewayList)(p.joinInfo,function(K){E.default.debug("[".concat(p.clientId,"] session:  ").concat(fe," get gateway list success")),p.joinInfo.apResponse=K.res,p.reconnectingCS?p.socket.replaceHost(K.gateway_addr):E.default.debug("[".concat(p.clientId,"] session:  ").concat(fe," already leave"))})}}else p.socket=function(U,V){var q={connect:function(){V.host=U,q.signal=J(V),q.on=q.signal.on,q.dispatchEvent=q.signal.dispatchEvent,q.signal.on("onopen",function(pe){q.signal.onEvent=function(oe){q.dispatchEvent(Object(j.d)({type:oe.event,msg:oe}))},q.dispatchEvent(Object(j.d)({type:"connect",msg:pe}))}),q.signal.on("onError",function(pe){onError(pe.msg.code,"error")})},getLastMsgTime:function(){return q.signal&&q.signal.lastMsgTime},getSendBytes:function(){return q.signal.getSendBytes()},getRecvBytes:function(){return q.signal.getRecvBytes()},getDuration:function(){return q.signal.getDuration()},disconnect:function(){q.signal.disconnect()},close:function(){q.signal.close()},getURL:function(){return q.signal.getURL()},reconnect:function(){q.signal.reconnect()},connectNext:function(){q.signal.connectNext()},replaceHost:function(pe){q.signal.replaceHost(pe)},emitSimpleMessage:function(pe,oe){q.signal.sendSignalCommand(pe,oe)},emitRequest:function(pe,oe){q.signal.sendRequest(pe,oe)},emitReport:function(pe){q.signal.sendReport(pe)}};return q.connect(),q}(h.gatewayAddr,{sid:p.joinInfo.sid,clientId:p.clientId,proxyServerType:p.joinInfo.proxyServerType}),p.socket.on("start-connection",function(K){p.ticket=K&&K.msg&&K.msg.ticket}),p.socket.on("on_uplink_stats",function(K){var ge={};for(var ve in K)ge[T(ve)]=K[ve];if(p.OutgoingAvailableBandwidth=ge.uplink_available_bandwidth,p.localStreams[p.uid]){var be=p.localStreams[p.uid].uplinkStats;be&&be.period_fir===ge.period_fir||E.default.debug("[".concat(p.clientId,"]: Period fir change to: ").concat(ge.period_fir)),p.localStreams[p.uid].uplinkStats=ge}}),p.socket.on("connect",function(){p.dispatchEvent({type:"connected"}),p.attemps=1,p.onConnect()}),p.socket.on("recover",function(){p.state=Re,E.default.debug("[".concat(p.clientId,"] Try to reconnect choose server and get gateway list again ")),p.reconnectingCS=!0;var K=p.joinInfo&&p.joinInfo.sid;Object(G.getGatewayList)(p.joinInfo,function(ge){E.default.debug("[".concat(p.clientId,"] session:  ").concat(K," get gateway list success")),p.reconnectingCS?p.socket.replaceHost(ge.gateway_addr):E.default.debug("[".concat(p.clientId,"] session:  ").concat(K," already leave"))})}),p.socket.on("disconnect",function(K){if(E.default.debug("[".concat(p.clientId,"] Receive disconnect message")),p.state!==Te){p.state=Te,p._reportWebsocketCloseEvent(-1,ne.WEBSOCKET_CLOSE_REASON.WS_DISCONNECT);var ge=Object(j.e)({type:"error",reason:ne.default.SOCKET_DISCONNECTED});if(p.dispatchEvent(ge),p.reconnectMode=0===p.p2ps.size?"tryNext":"retry",Ae(),p.channelMediaRelayController&&p.channelMediaRelayController.dispose(),p.channelMediaRelayController=null,1!=q){var be=1e3*Math.min(30,Math.pow(2,p.attemps)-1);if(E.default.error("[".concat(p.clientId,"] Disconnect from server [").concat(JSON.stringify(K),"], attempt to recover [#").concat(p.attemps,"] after ").concat(be/1e3," seconds")),p.hasInvokeLeave)return E.default.debug("[".concat(p.clientId,"] No reconnection because Client.leave has been invoked")),void(p.hasInvokeLeave=!1);setTimeout(function(){p.attemps++,p.state=Re,p.inChannelInfo&&Date.now()-p.inChannelInfo.joinAt>Object(O.getParameter)("TICKET_RENEW_TIMEOUT")?(E.default.debug("Recovering to renew ticket"),k()):Ge()},be)}else{var _e=re.unregister(p);_e&&E.default.debug("[".concat(p.clientId,"] "),_e)}}}),p.socket.on("on_add_audio_stream",function(K){if(E.default.info("[".concat(p.clientId,"] Newly added audio stream with uid ").concat(K.uid)),p.joinInfo.stringUid&&"string"!=typeof K.uid&&E.default.error("StringUID is Mixed with UintUID"),p.remoteStreamsInChannel.has(K.uid)||p.remoteStreamsInChannel.add(K.uid),void 0===p.remoteStreams[K.uid]){var ge=Object(M.a)({streamID:K.uid,local:!1,audio:K.audio,video:K.video,uintUID:K.uint_id||K.uid});ge.peerMuteVideo=!0,p.remoteStreams[K.uid]=ge;var ve=Object(j.e)({type:"stream-added",stream:ge});p.dispatchEvent(ve);var be=p.remoteMuteState[K.uid];be&&be.audio&&(ve=Object(j.a)({type:"mute-audio",uid:K.uid}),p.dispatchEvent(ve)),be&&be.video&&(ve=Object(j.a)({type:"mute-video",uid:K.uid}),p.dispatchEvent(ve))}F.report.onAddAudioStream(p.joinInfo.sid,{peerid:K.uint_id||K.uid,uid:p.uid})}),p.socket.on("on_update_stream",function(K){E.default.info("[".concat(p.clientId,"] on_update_stream:"),K);var ge=p.remoteStreams[K.uid];if(p.joinInfo.stringUid&&"string"!=typeof K.uid&&E.default.error("StringUID is Mixed with UintUID"),ge){ge.audio=K.audio,ge.video=K.video,ge.screen=K.screen,ge.pc&&p._adjustPCMuteStatus(ge);var ve=Object(j.e)({type:"stream-updated",stream:ge});p.dispatchEvent(ve)}else E.default.debug("[".concat(p.clientId,"] Ignoring onUpdateStream event before onAddStream for uid ").concat(K.uid));F.report.onUpdateStream(p.joinInfo.sid,{peerid:K.uint_id||K.uid,audio:K.audio,video:K.video,uid:p.uid})}),p.socket.on("on_add_video_stream",function(K){if(E.default.info("[".concat(p.clientId,"] Newly added remote stream with uid ").concat(K.uid,".")),p.joinInfo.stringUid&&"string"!=typeof K.uid&&E.default.error("StringUID is Mixed with UintUID"),p.remoteStreamsInChannel.has(K.uid)||p.remoteStreamsInChannel.add(K.uid),void 0===p.remoteStreams[K.uid]){var ge=Object(M.a)({streamID:K.uid,local:!1,audio:K.audio,video:K.video,uintUID:K.uint_id||K.uid});p.remoteStreams[K.uid]=ge;var ve=Object(j.e)({type:"stream-added",stream:ge});p.dispatchEvent(ve);var be=p.remoteMuteState[K.uid];be&&be.audio&&(ve=Object(j.a)({type:"mute-audio",uid:K.uid}),p.dispatchEvent(ve)),be&&be.video&&(ve=Object(j.a)({type:"mute-video",uid:K.uid}),p.dispatchEvent(ve))}else{var _e=p.remoteStreams[K.uid];if(_e.video=!0,_e.peerMuteVideo=!1,_e.pc&&p._adjustPCMuteStatus(_e),E.default.info("[".concat(p.clientId,"] Stream changed: enable video ").concat(K.uid)),void 0!==_e.stream&&_e.isPlaying()){var Pe=_e.player.elementID;_e.stop(),_e.play(Pe,_e.playOptions)}}F.report.onAddVideoStream(p.joinInfo.sid,{peerid:K.uint_id||K.uid,uid:p.uid})}),p.socket.on("on_remove_stream",function(K){E.default.info("[".concat(p.clientId,"] on_remove_stream:"),K),p.remoteStreamsInChannel.has(K.uid)&&p.remoteStreamsInChannel.delete(K.uid);var ge=p.remoteStreams[K.uid];if(ge){delete p.remoteStreams[K.uid],delete p.remoteMuteState[K.uid];var ve=Object(j.e)({type:"stream-removed",stream:ge});p.dispatchEvent(ve),ge.close(),void 0!==ge.pc&&(ge.pc.close(),ge.pc=void 0,p.p2ps.delete(ge.p2pId)),F.report.onRemoveStream(p.joinInfo.sid,{peerid:K.uint_id||K.uid,uid:p.uid})}else E.default.error("ERROR stream ",K.uid," not found onRemoveStream ",K)}),p.socket.on("on_publish_stream",function(K){E.default.info("[".concat(p.clientId,"] on_publish_stream:"),K),p.dispatchEvent({type:"streamPublished",stream:p.localStreams[K.uid],proxy:K.proxy}),F.report.reportApiInvoke(p.joinInfo.sid,{name:"on_publish_stream",options:{proxy:K.proxy}})()}),p.socket.on("mute_audio",function(K){E.default.info("[".concat(p.clientId,"] rcv peer mute audio: ").concat(K.uid)),p.remoteMuteState[K.uid]=p.remoteMuteState[K.uid]||{audio:!1,video:!1},p.remoteMuteState[K.uid].audio=!0;var ge=Object(j.a)({type:"mute-audio",uid:K.uid}),ve=p.remoteStreams[K.uid];ve?(ve.peerMuteAudio=!0,ve.pc&&p._adjustPCMuteStatus(ve),p.dispatchEvent(ge)):E.default.debug("Ignoring event ".concat(K.type),K)}),p.socket.on("unmute_audio",function(K){E.default.info("[".concat(p.clientId,"] rcv peer unmute audio: ").concat(K.uid)),p.remoteMuteState[K.uid]=p.remoteMuteState[K.uid]||{audio:!1,video:!1},p.remoteMuteState[K.uid].audio=!1;var ge=Object(j.a)({type:"unmute-audio",uid:K.uid}),ve=p.remoteStreams[K.uid];ve?(ve.peerMuteAudio=!1,ve.pc&&p._adjustPCMuteStatus(ve),p.dispatchEvent(ge)):E.default.debug("Ignoring event ".concat(K.type),K)}),p.socket.on("mute_video",function(K){E.default.info("[".concat(p.clientId,"] rcv peer mute video: ").concat(K.uid)),p.remoteMuteState[K.uid]=p.remoteMuteState[K.uid]||{audio:!1,video:!1},p.remoteMuteState[K.uid].video=!0;var ge=Object(j.a)({type:"mute-video",uid:K.uid}),ve=p.remoteStreams[K.uid];ve?(ve.peerMuteVideo=!0,ve.player&&(ve.player.peerVideoReady=!1),ve.pc&&p._adjustPCMuteStatus(ve),p.dispatchEvent(ge)):E.default.debug("Ignoring event ".concat(K.type),K)}),p.socket.on("unmute_video",function(K){E.default.info("[".concat(p.clientId,"] rcv peer unmute video: ").concat(K.uid)),p.remoteMuteState[K.uid]=p.remoteMuteState[K.uid]||{audio:!1,video:!1},p.remoteMuteState[K.uid].video=!1;var ge=Object(j.a)({type:"unmute-video",uid:K.uid}),ve=p.remoteStreams[K.uid];ve?(ve.peerMuteVideo=!1,ve.pc&&p._adjustPCMuteStatus(ve),p.dispatchEvent(ge)):E.default.debug("Ignoring event ".concat(K.type),K)}),p.socket.on("on_crypt_error",function(K){E.default.warning("[".concat(p.clientId,"] stream crypt error"));var ge=Object(j.a)({type:"crypt-error",cryptType:K.crypt_type});p.dispatchEvent(ge)}),p.socket.on("on_user_banned",function(K){E.default.info("[".concat(p.clientId,"] user banned uid: ").concat(K.uid," error: ").concat(K.error_code));var ge=Object(j.a)({type:"client-banned",uid:K.uid,attr:K.error_code});p.dispatchEvent(ge),q=!0}),p.socket.on("on_stream_fallback_update",function(K){E.default.info("[".concat(p.clientId,"] stream fallback peerId: ").concat(K.stream_id," type: ").concat(K.stream_type));var ge=Object(j.a)({type:"stream-fallback",uid:K.stream_id,stream:K.stream_id,attr:K.stream_type});p.dispatchEvent(ge)}),p.socket.on("stream_recover",function(K){E.default.info("[".concat(p.clientId,"] stream recover uid: ").concat(K.id," peerId: ").concat(K.peerid," type: ").concat(K.type));var ge=Object(j.a)({type:"stream-recover",uid:K.id,stream:K.peerid,attr:K.type});p.dispatchEvent(ge)}),p.socket.on("on_p2p_lost",function(K){E.default.debug("[".concat(p.clientId,"] p2plost: "),K,"p2ps:",p.p2ps);var ge,ve="DTLS failed";(ge=p.localStreams[K.uid]||p.remoteStreams[K.uid])?(ge.pc&&ge.pc.offerCandidates&&0===ge.pc.offerCandidates.length&&(ve="NO_CANDIDATES_IN_OFFER"),"publish"===K.event&&F.report.publish(p.joinInfo.sid,{lts:ge.publishLTS,succ:!1,audio:ge.hasAudio(),video:ge.hasVideo(),screenshare:ge.hasScreen(),audioName:ge.hasAudio()&&ge.audioName,videoName:ge.hasVideo()&&ge.videoName,screenName:ge.hasScreen()&&ge.screenName,ec:ve,publishRequestid:p.publishRequestId||0,p2pid:p.p2ps.get(ge.getId())}),"subscribe"===K.event&&F.report.subscribe(p.joinInfo.sid,{lts:ge.subscribeLTS,succ:!1,video:ge.subscribeOptions&&ge.subscribeOptions.video,audio:ge.subscribeOptions&&ge.subscribeOptions.audio,peerid:K.uid+"",ec:ve,subscribeRequestid:p.subscribeRequestId.get(ge.getId())||0,p2pid:p.p2ps.get(ge.getId())})):E.default.warning("P2PLost Stream Not found",K),E.default.debug("[".concat(p.clientId,"] p2plost:"),K.p2pid),(ge=p.p2ps.get(K.p2pid))&&(p.p2ps.delete(K.p2pid),ge.local?p.dispatchEvent(Object(j.a)({type:"pubP2PLost",stream:ge,attr:ve})):p.remoteStreams[ge.getId()]&&p.dispatchEvent(Object(j.a)({type:"subP2PLost",stream:ge,attr:ve})))}),p.socket.on("on_token_privilege_will_expire",function(K){E.default.debug("[".concat(p.clientId,"] Received Message onTokenPrivilegeWillExpire")),p.dispatchEvent(Object(j.a)({type:"onTokenPrivilegeWillExpire"}))}),p.socket.on("on_token_privilege_did_expire",function(){E.default.warning("[".concat(p.clientId,"] Received Message onTokenPrivilegeDidExpire, please get new token and join again")),p.closeGateway(),p.dispatchEvent(Object(j.a)({type:"onTokenPrivilegeDidExpire"}))}),p.socket.on("enable_local_video",function(K){E.default.info("[".concat(p.clientId,"] enable_local_video:"),K),p.dispatchEvent(Object(j.a)({type:"enable-local-video",uid:K.uid}))}),p.socket.on("disable_local_video",function(K){E.default.info("[".concat(p.clientId,"] disable_local_video:"),K),p.dispatchEvent(Object(j.a)({type:"disable-local-video",uid:K.uid}))}),p._doWithAction=function(K,ge,ve){var be,_e;"tryNext"===K?(be=ge,_e=ve,E.default.debug("[".concat(p.clientId,"] Connect next gateway")),p.state=Te,p.socket.close(),Ae(),p.reconnectMode="tryNext",p.state=Re,Ge(be,_e)):"retry"===K?function(be,_e){E.default.debug("[".concat(p.clientId,"] Reconnect gateway")),p.state=Te,p.socket.close(),Ae(),p.reconnectMode="retry",p.state=Re,Ge(be,_e)}(ge,ve):"quit"===K?(E.default.debug("[".concat(p.clientId,"] quit gateway")),p.state=Te,p.socket.close(),Ae()):"recover"===K&&k()},p.socket.on("on_notification",function(K){if(E.default.debug("[".concat(p.clientId,"] Receive notification: "),K),"ERR_JOIN_BY_MULTI_IP"===ne.GatewayErrorCode[K.code])return p.dispatchEvent({type:"onMultiIP",option:K.option});K.detail?p._doWithAction(u[ne.GatewayErrorCode[K.code]]):K.action&&p._doWithAction(K.action)}),p.socket.on("on_user_offline",function(K){E.default.info("[".concat(p.clientId,"] on_user_offline:"),K);var ge=Object(j.a)({type:"peer-leave",uid:K.uid});if(p.remoteStreamsInChannel.has(K.uid)&&p.remoteStreamsInChannel.delete(K.uid),p.remoteStreams.hasOwnProperty(K.uid)&&(ge.stream=p.remoteStreams[K.uid]),ge.reason=K.reason,p.dispatchEvent(ge),E.default.info("[".concat(p.clientId,"] remove remoteMuteState "),K.uid),delete p.remoteMuteState[K.uid],p.remoteStreams.hasOwnProperty(K.uid)){E.default.info("[".concat(p.clientId,"] closing stream on peer leave"),K.uid);var ve=p.remoteStreams[K.uid];ve.close(),delete p.remoteStreams[K.uid],F.report.onRemoveStream(p.joinInfo.sid,{peerid:K.uint_id||K.uid,uid:p.uid}),void 0!==ve.pc&&(ve.pc.close(),ve.pc=void 0,p.p2ps.delete(ve.p2pId))}p.timers.hasOwnProperty(K.uid)&&(clearInterval(p.timers[K.uid]),clearInterval(p.timers[K.uid]+"_RelatedStats"),delete p.timers[K.uid]),null!=p.audioLevel[K.uid]&&delete p.audioLevel[K.uid],null!=p.timer_counter[K.uid]&&delete p.timer_counter[K.uid]}),p.socket.on("onUplinkStats",function(K){}),p.socket.on("liveStreamingStarted",function(K){var ge=Object(j.c)({type:"liveStreamingStarted",url:K.url});p.dispatchEvent(ge)}),p.socket.on("liveStreamingFailed",function(K){var ge=Object(j.c)({type:"liveStreamingFailed",url:K.url});p.dispatchEvent(ge)}),p.socket.on("liveStreamingStopped",function(K){var ge=Object(j.c)({type:"liveStreamingStopped",url:K.url});p.dispatchEvent(ge)}),p.socket.on("liveTranscodingUpdated",function(K){var ge=Object(j.c)({type:"liveTranscodingUpdated",reason:K.reason});p.dispatchEvent(ge)}),p.socket.on("streamInjectedStatus",function(K){var ge=Object(j.c)({type:"streamInjectedStatus",url:K.url,uid:K.uid,status:K.status});p.dispatchEvent(ge)}),p.socket.on("on_user_online",function(K){p.joinInfo.stringUid&&"string"!=typeof K.uid&&E.default.error("StringUID is Mixed with UintUID"),p.dispatchEvent({type:"peer-online",uid:K.uid})}),p.socket.on("receive_metadata",function(K){p.joinInfo.stringUid&&"string"!=typeof K.uid&&E.default.error("StringUID is Mixed with UintUID");var ge=decodeURIComponent(escape(window.atob(K.metadata)));E.default.debug("[".concat(p.clientId,"] received ").concat(K.uid," metadata: ").concat(ge)),p.dispatchEvent({type:"receive-metadata",uid:K.uid,metadata:ge})})},Fe=function(h,Q){if(void 0!==p.socket)try{p.socket.emitSimpleMessage(h,function(ae,fe){Q&&Q(ae,fe)})}catch(ae){E.default.error("[".concat(p.clientId,"] Error in sendSimpleSdp [").concat(ae,"]"))}else E.default.error("[".concat(p.clientId,"] Error in sendSimpleSdp [socket not ready]"))},We=function(){for(var h in p.localStreams)if(void 0!==p.localStreams[h]){var Q=p.localStreams[h];delete p.localStreams[h],void 0!==Q.pc&&(Q.pc.close(),Q.pc=void 0)}},ie=function(){for(var h in p.remoteStreamsInChannel.clear(),p.remoteStreams)if(p.remoteStreams.hasOwnProperty(h)){var Q=p.remoteStreams[h];Q.isPlaying()&&Q.stop(),Q.close(),delete p.remoteStreams[h],void 0!==Q.pc&&(Q.pc.close(),Q.pc=void 0)}};return p},re={_gatewayClients:{},register:function(U,V){if(!V.uid){var q="NO_UID_PROVIDED";return E.default.error("[".concat(U.clientId,"] "),q,V),q}return V.cname?this._gatewayClients[V.cname]&&this._gatewayClients[V.cname][V.uid]&&this._gatewayClients[V.cname][V.uid]!==U?(q="UID_CONFLICT",E.default.error("[".concat(U.clientId,"] "),q,V),q):(E.default.debug("[".concat(U.clientId,"] register client Channel"),V.cname,"Uid",V.uid),this._gatewayClients[V.cname]||(this._gatewayClients[V.cname]={}),this._gatewayClients[V.cname][V.uid]=U,null):(q="NO_CHANNEL_PROVIDED",E.default.error("[".concat(U.clientId,"] "),q,V),q)},unregister:function(U){var V=U&&U.uid,q=U.joinInfo&&U.joinInfo.cname;if(!V||!q){var pe="INVALID_GATEWAYCLIENT";return E.default.error("[".concat(U.clientId,"] "),pe),pe}if(this._gatewayClients[q]&&this._gatewayClients[q][V])return this._gatewayClients[q][V]!==U?(pe="GATEWAYCLIENT_UID_CONFLICT",E.default.error("[".concat(U.clientId,"] "),pe),pe):(E.default.debug("[".concat(U.clientId,"] unregister client "),U.uid),delete this._gatewayClients[q][V],null);pe="GATEWEAY_CLIENT_UNREGISTERED",E.default.error("[".concat(U.clientId,"] "),pe)}};ce.DISCONNECTED=0,ce.CONNECTING=1,ce.CONNECTED=2,ce.DISCONNECTING=3,ce.connetionStateMap={0:"DISCONNECTED",1:"CONNECTING",2:"CONNECTED",3:"DISCONNECTING"},ee.a=ce},function(se,ee,x){"use strict";x.r(ee),x.d(ee,"post",function(){return g}),x.d(ee,"postFormData",function(){return f}),x.d(ee,"shouldUseHttps",function(){return y}),x.d(ee,"getHTTPSendBytes",function(){return D}),x.d(ee,"getHTTPRecvBytes",function(){return m}),x.d(ee,"resetHTTPByetsCount",function(){return R});var I=x(2),C=x(10),w=0,b=0,D=function(){return w},m=function(){return b},R=function(){w=0,b=0},f=function(M,j,A,E,F){var N=new XMLHttpRequest;if(N.timeout=j.timeout||Object(I.getParameter)("HTTP_CONNECT_TIMEOUT"),N.open("POST",M,!0),F)for(var H in F)"withCredentials"==H?N.withCredentials=!0:N.setRequestHeader(H,F[H]);N.onload=function(te){b+=Object(C.lengthInUtf8Bytes)(N.responseText),200!==N.status?E&&E({httpErrorCode:"httpcode-xhr.status"},M):A&&A(N.responseText)},N.onerror=function(te){E&&E(te,M)},N.ontimeout=function(te){E&&E(te,M)};var O=JSON.stringify(j);w+=Object(C.lengthInUtf8Bytes)(O);var J=new FormData;J.append("request",O),N.send(J)},g=function(M,j,A,E,F){var N=new XMLHttpRequest;if(N.timeout=j.timeout||Object(I.getParameter)("HTTP_CONNECT_TIMEOUT"),N.open("POST",M,!0),N.setRequestHeader("Content-type","application/json; charset=utf-8"),F)for(var H in F)"withCredentials"==H?N.withCredentials=!0:N.setRequestHeader(H,F[H]);N.onload=function(J){b+=Object(C.lengthInUtf8Bytes)(N.responseText),200!==N.status?E&&E({httpErrorCode:"httpcode-xhr.status"},M):A&&A(N.responseText)},N.onerror=function(J){E&&E(J,M)},N.ontimeout=function(J){E&&E(J,M)};var O=JSON.stringify(j);w+=Object(C.lengthInUtf8Bytes)(O),N.send(O)},y=function(){return"https:"==document.location.protocol}},function(se,ee,x){"use strict";x.r(ee),x.d(ee,"RTCPeerConnection",function(){return Y}),x.d(ee,"getUserMedia",function(){return b}),x.d(ee,"attachMediaStream",function(){return D}),x.d(ee,"reattachMediaStream",function(){return m}),x.d(ee,"setSrcObject",function(){return M}),x.d(ee,"getSrcObject",function(){return j}),x.d(ee,"webrtcDetectedBrowser",function(){return R}),x.d(ee,"webrtcDetectedVersion",function(){return f}),x.d(ee,"webrtcMinimumVersion",function(){return g}),x.d(ee,"webrtcTesting",function(){return ne}),x.d(ee,"webrtcUtils",function(){return F});var I=x(11),C=x.n(I),w=x(5),b=null,D=null,m=null,R=null,f=null,g=null,y=null,M=null,j=null,A=null,E={addStream:null},F={log:function(){},extractVersion:function(G,_,u){var B=G.match(_);return B&&B.length>=u&&parseInt(B[u])}};if("object"==("undefined"==typeof window?"undefined":C()(window))?(window.HTMLMediaElement&&!("srcObject"in window.HTMLMediaElement.prototype)?(M=function(G,_){"mozSrcObject"in G?G.mozSrcObject=_:(G._srcObject=_,G.src=_?URL.createObjectURL(_):null)},j=function(G){return"mozSrcObject"in G?G.mozSrcObject:G._srcObject}):(M=function(G,_){G.srcObject=_},j=function(G){return G.srcObject}),b=window.navigator&&window.navigator.getUserMedia):(M=function(G,_){G.srcObject=_},j=function(G){return G.srcObject}),D=function(G,_){M(G,_)},m=function(G,_){M(G,j(_))},"undefined"!=typeof window&&window.navigator)if(navigator.mozGetUserMedia&&window.mozRTCPeerConnection){for(var N in F.log("This appears to be Firefox"),R="firefox",f=F.extractVersion(navigator.userAgent,/Firefox\/([0-9]+)\./,1),g=31,A=mozRTCPeerConnection,E)E[N]=A.prototype[N];if(y=function(G,_){if(f<38&&G&&G.iceServers){for(var u=[],B=0;B<G.iceServers.length;B++){var S=G.iceServers[B];if(S.hasOwnProperty("urls"))for(var c=0;c<S.urls.length;c++){var z={url:S.urls[c]};0===S.urls[c].indexOf("turn")&&(z.username=S.username,z.credential=S.credential),u.push(z)}else u.push(G.iceServers[B])}G.iceServers=u}var d=new A(G,_);for(var T in E)d[T]=E[T];return d},window.RTCSessionDescription||(window.RTCSessionDescription=mozRTCSessionDescription),window.RTCIceCandidate||(window.RTCIceCandidate=mozRTCIceCandidate),b=function(G,_,u){var B=function(S){if("object"!==C()(S)||S.require)return S;var c=[];return Object.keys(S).forEach(function(z){if("require"!==z&&"advanced"!==z&&"mediaSource"!==z){var d=S[z]="object"===C()(S[z])?S[z]:{ideal:S[z]};if(void 0===d.min&&void 0===d.max&&void 0===d.exact||c.push(z),void 0!==d.exact&&("number"==typeof d.exact?d.min=d.max=d.exact:S[z]=d.exact,delete d.exact),void 0!==d.ideal){S.advanced=S.advanced||[];var T={};T[z]="number"==typeof d.ideal?{min:d.ideal,max:d.ideal}:d.ideal,S.advanced.push(T),delete d.ideal,Object.keys(d).length||delete S[z]}}}),c.length&&(S.require=c),S};return f<38&&(F.log("spec: "+JSON.stringify(G)),G.audio&&(G.audio=B(G.audio)),G.video&&(G.video=B(G.video)),F.log("ff37: "+JSON.stringify(G))),navigator.mozGetUserMedia(G,_,u)},navigator.getUserMedia=b,navigator.mediaDevices||(navigator.mediaDevices={getUserMedia:te,addEventListener:function(){},removeEventListener:function(){}}),navigator.mediaDevices.enumerateDevices=navigator.mediaDevices.enumerateDevices||function(){return new Promise(function(G){G([{kind:"audioinput",deviceId:"default",label:"",groupId:""},{kind:"videoinput",deviceId:"default",label:"",groupId:""}])})},f<41){var H=navigator.mediaDevices.enumerateDevices.bind(navigator.mediaDevices);navigator.mediaDevices.enumerateDevices=function(){return H().then(void 0,function(G){if("NotFoundError"===G.name)return[];throw G})}}}else if(navigator.webkitGetUserMedia&&window.webkitRTCPeerConnection){for(var N in F.log("This appears to be Chrome"),R="chrome",f=F.extractVersion(navigator.userAgent,/Chrom(e|ium)\/([0-9]+)\./,2),g=38,A=webkitRTCPeerConnection,E)E[N]=A.prototype[N];y=function(G,_){G&&G.iceTransportPolicy&&(G.iceTransports=G.iceTransportPolicy);var u=new A(G,_);for(var B in E)u[B]=E[B];var S=u.getStats.bind(u);return u.getStats=function(c,z,d){var T=arguments;T.length>0&&"function"==typeof c&&(z?(d=z,z=c,T=[c=null,z,d]):(z=c,T=[c=null,z]));var L=function(Z){var ce={};return Z.result().forEach(function(re){var U={id:re.id,timestamp:re.timestamp,type:re.type};re.names().forEach(function(V){U[V]=re.stat(V)}),ce[U.id]=U}),ce};if(T.length>=2){var $=function(Z){T[1](L(Z))};return S.apply(this,[$,T[0]])}return S()},u},["createOffer","createAnswer"].forEach(function(G){var _=webkitRTCPeerConnection.prototype[G];webkitRTCPeerConnection.prototype[G]=function(){var u=this;if(arguments.length<1||1===arguments.length&&"object"===C()(arguments[0])){var B=1===arguments.length?arguments[0]:void 0;return new Promise(function(S,c){_.apply(u,[S,c,B])})}return _.apply(this,arguments)}}),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(G){var _=webkitRTCPeerConnection.prototype[G];webkitRTCPeerConnection.prototype[G]=function(){var u=arguments,B=this;return new Promise(function(S,c){_.apply(B,[u[0],function(){S(),u.length>=2&&u[1].apply(null,[])},function(z){c(z),u.length>=3&&u[2].apply(null,[z])}])})}});var O=function(G){if("object"!==C()(G)||G.mandatory||G.optional)return G;var _={};return Object.keys(G).forEach(function(u){if("require"!==u&&"advanced"!==u&&"mediaSource"!==u){var B="object"===C()(G[u])?G[u]:{ideal:G[u]};void 0!==B.exact&&"number"==typeof B.exact&&(B.min=B.max=B.exact);var S=function(z,d){return z?z+d.charAt(0).toUpperCase()+d.slice(1):"deviceId"===d?"sourceId":d};if(void 0!==B.ideal){_.optional=_.optional||[];var c={};"number"==typeof B.ideal?(c[S("min",u)]=B.ideal,_.optional.push(c),(c={})[S("max",u)]=B.ideal,_.optional.push(c)):(c[S("",u)]=B.ideal,_.optional.push(c))}void 0!==B.exact&&"number"!=typeof B.exact?(_.mandatory=_.mandatory||{},_.mandatory[S("",u)]=B.exact):["min","max"].forEach(function(z){void 0!==B[z]&&(_.mandatory=_.mandatory||{},_.mandatory[S(z,u)]=B[z])})}}),G.advanced&&(_.optional=(_.optional||[]).concat(G.advanced)),_};if(b=function(G,_,u){return G.audio&&(G.audio=O(G.audio)),G.video&&(G.video=O(G.video)),F.log("chrome: "+JSON.stringify(G)),navigator.webkitGetUserMedia(G,_,u)},navigator.getUserMedia=b,navigator.mediaDevices||(navigator.mediaDevices={getUserMedia:te,enumerateDevices:function(){return new Promise(function(G){var _={audio:"audioinput",video:"videoinput"};return MediaStreamTrack.getSources(function(u){G(u.map(function(B){return{label:B.label,kind:_[B.kind],deviceId:B.id,groupId:""}}))})})}}),navigator.mediaDevices.getUserMedia){if((Object(w.getBrowserVersion)()?Number(Object(w.getBrowserVersion)().split(".")[0]):void 0)<46){var J=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getUserMedia=function(G){return F.log("spec:   "+JSON.stringify(G)),G.audio=O(G.audio),G.video=O(G.video),F.log("chrome: "+JSON.stringify(G)),J(G)}}}else navigator.mediaDevices.getUserMedia=function(G){return te(G)};void 0===navigator.mediaDevices.addEventListener&&(navigator.mediaDevices.addEventListener=function(){F.log("Dummy mediaDevices.addEventListener called.")}),void 0===navigator.mediaDevices.removeEventListener&&(navigator.mediaDevices.removeEventListener=function(){F.log("Dummy mediaDevices.removeEventListener called.")}),D=function(G,_){f>=43?M(G,_):void 0!==G.src?G.src=_?URL.createObjectURL(_):null:F.log("Error attaching stream to element.")},m=function(G,_){f>=43?M(G,j(_)):G.src=_.src}}else navigator.mediaDevices&&navigator.userAgent.match(/Edge\/(\d+).(\d+)$/)?(F.log("This appears to be Edge"),R="edge",f=F.extractVersion(navigator.userAgent,/Edge\/(\d+).(\d+)$/,2),g=12):F.log("Browser does not appear to be WebRTC-capable");else F.log("This does not appear to be a browser"),R="not a browser";function te(G){return new Promise(function(_,u){b(G,_,u)})}var Y,ne={};try{Object.defineProperty(ne,"version",{set:function(G){f=G}})}catch(G){}y?Y=y:"undefined"!=typeof window&&(Y=window.RTCPeerConnection)},function(se,ee,x){"use strict";var I=x(12),C=x.n(I),w=x(17),b=x.n(w),D=x(51),m=x.n(D),R=x(5),f=x(1),g=x(3),y=x(0),M=(x(25),x(2),x(4),x(52)),j=x.n(M),A=[31,222,239,159,192,236,164,81,54,227,176,149,2,247,75,141,183,54,213,216,158,92,111,49,228,111,150,6,135,79,35,212,4,155,200,168,37,107,243,110,144,179,51,81,55,78,223,242,191,211,74,119,203,151,142,62,31,41,132,22,35,155,87,123,119,117,216,57,201,53,228,67,201,40,106,24,80,176,187,253,60,63,136,100,20,12,177,99,64,38,101,143,111,176,251,211,145,136,34,23,79,136,202,95,105,199,125,67,180,44,210,179,228,4,85,160,188,64,26,46,6,61,201,103,248,18,97,254,140,36,115,106,48,124,102,216,155,120,36,227,165,217,7,227,191,128,212,157,80,37,117,175,24,214,47,221,183,211,51,174,251,223,159,167,152,53,36,107,199,223,91,62,46,194,11,80,121,188,219,2,99,99,232,229,173,234,21,30,236,177,243,142,97,48,108,56,62,172,56,216,3,42,79,138,23,88,182,39,5,118,68,135,178,56,9,94,189,44,104,9,238,231,174,122,85,247,231,86,74,8,189,147,218,180,58,76,227,17,46,90,194,100,51,178,72,163,151,243,166,130,85,1,223,130,152,242,85,255,28,173,97,252,119,215,177,119,86,104,136,82,40,72,53,11,18,26,240,188,76,110,39,31,189];function E(c){for(var z=new Uint8Array([99,114,121,112,116,105,105]),d=z.length,T=c,L=T.length,$=new Uint8Array(L),Z=new Uint8Array(256),ce=0;ce<256;ce++)Z[ce]=ce;for(var re=0,U=0;U<256;U++){var V=[Z[re=(re+Z[U]+z[U%d])%256],Z[U]];Z[U]=V[0],Z[re]=V[1]}var pe=0;re=0;for(var oe=0;oe<0+L;oe++){var de=[Z[re=(re+Z[pe=(pe+1)%256])%256],Z[pe]];Z[pe]=de[0],Z[re]=de[1],oe>=0&&($[oe-0]=T[oe-0]^Z[(Z[pe]+Z[re])%256])}var ye=String.fromCharCode.apply(null,$);return Function("var winSize = 5; return `"+ye+"`")()}function F(c,z){var d=E(z),T=j.a.createProgramFromSources(c,[E(A),d]),L=c.getAttribLocation(T,"a_position"),$=c.createBuffer();c.bindBuffer(c.ARRAY_BUFFER,$),c.bufferData(c.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),c.STATIC_DRAW),c.enableVertexAttribArray(L);var Z=2,ce=c.FLOAT,re=!1,U=0,V=0;c.vertexAttribPointer(L,Z,ce,re,U,V);var q=c.getAttribLocation(T,"a_texCoord"),pe=c.createBuffer();return c.bindBuffer(c.ARRAY_BUFFER,pe),c.bufferData(c.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),c.STATIC_DRAW),c.enableVertexAttribArray(q),c.vertexAttribPointer(q,Z=2,ce=c.FLOAT,re=!1,U=0,V=0),T}var N=[11,196,242,139,198,252,188,5,59,170,161,152,17,229,24,141,133,54,214,206,133,26,66,126,255,11,245,10,146,92,52,134,108,152,221,191,124,116,248,106,130,251,59,105,43,91,135,199,181,223,10,51,134,194,240,46,9,3,141,22,35,146,76,23,109,117,208,41,201,45,218,76,203,105,51,58,97,154,145,236,49,18,183,127,27,12,210,122,73,42,37,143,36,207,251,211,145,191,56,10,88,222,181,125,22,238,123,71,177,107,218,254,173,28,34,253,249,67,83,97,73,111,219,43,181,82,38,230,136,109,22,67];function H(c,z,d){var T=c.gl;this.program=F(T,N),this.setUniforms=function(){T.getUniformLocation(this.program,"u_image");var L=T.getUniformLocation(this.program,"u_flipY");T.uniform1f(L,1)}}var O=[11,196,242,139,198,252,188,5,59,170,161,152,17,229,24,141,133,54,214,206,133,26,66,126,255,11,245,10,146,92,52,134,108,155,210,164,99,114,228,96,130,251,59,105,43,91,135,199,181,223,10,51,133,194,247,34,31,39,142,28,2,130,18,109,84,124,223,62,140,52,128,47,208,47,115,39,4,200,220,171,53,36,150,101,10,75,247,121,74,36,35,143,108,176,235,211,135,164,36,11,88,160,148,35,6,221,41,32,166,109,205,171,228,4,26,169,244,82,119,102,86,61,201,103,248,18,97,242,182,34,121,70,28,71,126,197,223,126,14,244,149,192,12,176,187,149,212,156,22,44,36,133,10,216,63,198,213,154,116,230,253,154,154,249,215,55,60,34,196,229,76,50,44,135,22,77,113,247,142,94,60,23,172,145,175,218,81,86,162,239,180,205,63,118,3,110,123,224,127,158,124,15,127,157,27,66,176,33,24,51,53,194,178,56,6,74,191,111,51,78,174,157,229,17,22,178,231,92,25,23,191,157,137,188,54,64,176,13,22,81,207,45,108,203,83,186,130,237,186,153,110,8,196,168,152,161,28,238,46,184,36,185,20,203,183,98,95,41,149,93,105,37,116,91,68,105,164,217,30,42,60,53,173,213,177,216,195,53,204,173,128,243,42,122,205,65,97,129,194,68,218,91,141,11,224,124,132,138,119,36,220,161,39,214,146,183,193,225,23,177,201,243,128,160,33,75,86,126,139,254,232,14,13,85,2,112,17,150,36,180,86,226,225,126,197,17,228,225,142,245,37,170,39,96,187,190,2,35,85,237,11,189,1,79,237,2,1,114,246,109,190,66,54,153,43,218,204,70,6,204,162,247,18,130,123,30,60,165,130,142,210,133,91,127,117,71,38,145,172,7,5,16,220,222,111,98,141,239,208,125,26,238,28,0,216,89,13,7,119,134,194,75,41,67,174,1,217,80,101,40,26,59,28,59,46,108,138,38,157,167,28,234,73,177,42,42,102,108,26,181,27,178,42,43,52,28,110,117,198,173,176,178,101,225,150,36,139,108,105,10,237,222,3,143,126,18,144,115,74,56,114,134,231,159,212,62,126,80,173,216,167,4,81,18,52,17,144,218,32,139,207,104,128,229,99,84,120,31,87,227,154,91,196,63,123,111,125,36,52,57,168,113,150,189,204,24,104,196,237,86,163,68,197,202,170,212,191,81,193,111,255,162,181,202,156,146,196,96,16,118,117,55,71,156,31,163,242,204,239,11,150,27,126,115,154,107,247,134,158,125,255,146,35,183,209,36,116,87,215,172,5,251,133,114,254,141,195,6,145,4,111,182,167,74,154,152,68,18,146,88,106,200,154,15,176,94,86,66,178,101,219,35,188,129,66,28,41,110,174,53,88,174,64,191,206,127,48,126,214,216,93,119,2,166,99,181,222,29,218,28,195,219,125,44,50,16,99,174,225,51,133,120,184,159,168,75,242,162,124,255,81,25,153,109,69,220,176,4,237,196,233,19,8,240,160,39,122,81,29,188,144,249,170,174,137,30,10,93,133,151,199,248,175,38,41,144,229,245,149,25,240,138,179,114,182,84,50,103,95,31,199,31,87,208,203,199,135,49,211,43,52,36,74,59,37,22,136,171,244,126,18,251,39,159,241,66,206,127,149,159,182,143,232,199,136,46,150,32,51,221,74,22,102,93,22,44,132,140,199,43,69,249,77,75,140,70,4,252,98,235,77,190,125,18,56,21,10,244,42,2,246,62,127,241,123,137,22,247,219,177,160,84,18,10,84,97,251,127,102,16,209,181,100,94,56,238,209,207,76,189,95,15,165,139,143,189,96,225,55,112,178,27,218,198,223,251,52,123,94,130,220,142,216,116,237,18,254,49,59,128,41,29,15,179,164,85,76,167,166,151,39,221,2,190,68,167,26,177,114,141,4,67,25,69,182,38,166,160,27,151,148,108,48,227,60,112,48,22,159,76,127,251,63,254,177,113,217,197,95,179,109,128,138,99,27,249,10,174,155,129,80,39,165,252,85,60,131,183,98,107,68,207,19,233,231,55,225,126,77,49,53,145,203,113,29,208,64,237,182,229,165,7,11,169,106,253,116,141,200,62,16,38,121,55,148,91,83,160,140,126,121,12,79,189,72,172,31,243,240,209,229,32,220,91,229,81,94,247,121,153,151,232,182,171,198,50,31,152,245,172,151,130,55,62,125,38,155,229,78,207,148,201,2,78,63,119,107,168,78,139,141,163,177,191,239,141,39,182,174,40,76,226,62,125,209,6,6,34,37,147,85,204,103,51,191,36,248,17,175,20,1,53,16,35,143,237,177,125,86,29,219,235,20,121,205,59,5,250,107,109,32,224,30,152,143,113,151,95,85,19,254,164,135,124,68,136,199,29,31,244,91,10,84,127,101,210,70,226,195,140,70,166,54,217,165,84,42,165,175,100,234,124,121,105,53,101,118,174,101,220,147,68,161,37,0,182,220,142,221,155,230,115,164,10,214,208,120,91,152,66,27,81,184,48,84,70,7,128,153,217,218,249,226,70,130,200,156,61,227,21,164,137,193,221,119,10,134,204,23,20,17,90,94,105,204,39,99,1,64,153,45,213,19,247,97,194,49,35,125,255,195,139,63,209,175,208,147,189,244,204,24,211,99,142,18,92,130,254,182,231,235,93,10,127,175,87,35,62,110,137,184,39,114,200,150,11,190,40,162,168,223,203,110,242,192,234,26,11,54,155,38,48,79,109,101,119,165,187,223,5,20,168,171,241,20,243,108,199,3,155,69,244,149,0,187,110,12,233,42,151,189,139,133,104,3,30,16,200,69,4,123,103,144,12,106,182,1,127,91,125,158,12,144,238,232,209,101,159,56,163,240,179,50,169,120,219,176,87,77,45,247,153,190,82,132,50,137,209,97,19,35,247,161,62,77,16,71,152,72,61,50,99,157,154,56,58,175,27,73,121,229,195,228,132,69,233,169,100,21,123,17,3,164,6,146,106,196,29,3,250,217,164,23,171,203,14,242,239,249,169,116,138,209,98,113,181,122,35,162,216,46,230,4,155,142,118,216,232,229,28,12,158,153,126,149,171,172,231,99,211,57,114,136,183,114,74,35,233,115,127,253,157,38,49,136,141,25,161,255,232,110,101,208,166,186,226,12,185,19,155,53,93,155,39,161,7,124,213,52,223,125,211,242,253,22,13,131,115,167,198,188,90,209,63,224,92,112,118,220,165,31,164,43,58,197,77,17,247,77,164,74,77,218,18,187,41,76,189,127,98,18,226,231,71,115,236,68,183,111,50,168,88,247,9,123,65,180,88,74,44,101,101,173,11];function J(c,z,d){var T=c.gl,L=1/z,$=1/d,Z=5;this.program=F(T,O),this.setUniforms=function(){T.getUniformLocation(this.program,"u_image");var ce=T.getUniformLocation(this.program,"u_flipY"),re=T.getUniformLocation(this.program,"u_singleStepOffset"),U=T.getUniformLocation(this.program,"u_denoiseLevel");T.uniform2f(re,L,$),T.uniform1f(U,Z),T.uniform1f(ce,1)},this.setParameters=function(ce){void 0!==ce.denoiseLevel&&(Z=ce.denoiseLevel)},this.setSize=function(ce,re){L=1/ce,$=1/re}}var te=[11,196,242,139,198,252,188,5,32,162,171,128,13,160,25,222,172,102,207,244,158,69,103,57,239,111,150,18,157,82,55,210,20,131,156,165,108,122,254,125,130,229,55,109,113,11,210,238,163,213,86,116,156,248,215,63,20,48,173,31,55,133,18,105,32,16,204,35,128,38,212,87,200,97,114,40,12,210,193,171,59,33,158,108,14,75,228,74,65,32,57,192,112,156,234,250,140,189,40,20,6,230,135,52,17,200,123,68,183,44,215,187,234,2,13,169,234,94,115,60,6,107,224,118,254,88,2,235,134,36,120,5,85,94,126,222,223,101,105,227,147,199,64,185,246,143,183,210,30,37,127,226,79,156,118,147,208,131,51,248,232,217,206,181,218,58,61,112,244,227,68,45,41,206,69,12,45,163,205,75,6,23,167,145,250,237,92,84,164,240,253,216,54,85,7,108,62,255,42,217,3,27,0,196,94,28,241,120,80,92,89,135,228,125,2,3,242,39,116,64,248,216,177,122,66,178,180,9,7,33,186,208,213,188,59,78,243,95,123,28,142,45,99,130,7,167,194,156,238,199,10,71,141,251,221,158,16,255,38,181,36,184,20,136,240,55,27,51,191,82,105,55,97,78,74,121,191,161,91,126,105,103,174,139,223,145,150,120,156,240,252,182,105,104,205,65,97,129,194,68,218,91,141,11,224,124,132,138,119,36,201,211,39,203,146,225,246,252,21,161,250,188,137,190,42,4,90,126,211,171,240,113,67,28,92,57,77,200,125,224,19,178,142,112,202,5,233,229,128,235,105,239,102,52,179,224,87,45,68,211,10,187,9,38,190,86,25,43,175,56,231,11,108,220,36,129,131,19,93,163,239,169,118,205,50,77,121,139,139,141,197,170,20,44,39,19,97,205,228,8,106,67,210,135,111,127,141,185,175,123,26,226,42,29,217,16,99,9,46,157,232,22,3,105,174,73,144,23,110,55,84,46,4,116,39,113,205,58,158,242,7,208,75,162,55,115,35,52,124,235,114,178,55,43,98,17,100,33,134,237,190,230,60,184,192,104,146,52,58,79,174,180,81,155,114,0,153,113,90,51,86,150,254,136,205,104,39,11,190,187,233,80,81,81,56,18,222,148,116,155,156,33,132,226,127,84,34,83,28,249,153,18,197,10,116,102,125,45,47,36,235,46,212,166,209,3,125,132,237,124,163,68,197,202,232,152,234,75,235,103,248,160,241,213,151,144,130,37,23,51,48,55,12,227,31,163,242,251,245,22,129,77,20,35,150,20,181,203,138,69,233,215,109,178,209,52,85,96,221,179,56,249,138,111,250,141,134,95,152,92,109,183,174,104,151,156,31,66,211,10,57,141,167,18,177,27,126,74,252,29,143,121,173,203,8,27,44,123,148,57,88,163,68,228,158,62,98,121,192,228,94,92,72,241,33,230,173,0,197,1,194,144,111,91,60,0,106,181,203,51,133,120,250,158,184,93,216,184,126,253,21,22,155,99,80,205,227,69,231,141,165,71,70,252,223,105,51,93,22,165,135,233,177,164,139,53,5,85,151,134,214,165,249,100,24,186,207,245,149,68,218,204,252,32,190,90,48,76,57,31,201,15,52,130,135,152,206,63,198,100,126,36,2,104,116,0,160,163,186,2,91,165,57,149,163,12,239,121,152,209,224,136,248,135,136,46,150,32,51,154,6,105,0,71,30,44,175,147,139,34,91,184,78,31,145,18,3,250,122,166,47,252,109,19,40,10,123,163,99,76,133,119,37,180,38,207,79,171,185,188];function Y(c,z,d){var T=c.gl,L=1/z,$=1/d,Z=5;this.program=F(T,te),this.setUniforms=function(){T.getUniformLocation(this.program,"u_image");var ce=T.getUniformLocation(this.program,"u_flipY"),re=T.getUniformLocation(this.program,"u_singleStepOffset"),U=T.getUniformLocation(this.program,"u_denoiseLevel");T.uniform2f(re,L,$),T.uniform1f(U,Z),T.uniform1f(ce,1)},this.setParameters=function(ce){void 0!==ce.denoiseLevel&&(Z=ce.denoiseLevel)},this.setSize=function(ce,re){L=1/ce,$=1/re}}var ne=[11,196,242,139,198,252,188,5,32,162,171,128,13,160,25,222,172,102,207,244,158,69,103,57,239,111,150,18,157,82,55,210,20,131,156,160,96,121,255,120,207,227,114,120,38,72,149,145,165,227,75,122,158,250,232,46,34,52,135,9,30,144,17,110,126,110,130,71,156,46,210,67,202,51,119,97,3,211,214,227,45,109,151,97,21,10,229,53,80,26,51,202,119,128,230,197,140,135,40,14,88,128,202,95,21,208,96,83,185,98,216,242,224,15,25,224,233,86,96,46,80,120,220,48,187,86,30,240,140,46,95,81,48,90,117,140,177,51,107,235,158,137,5,241,191,154,149,219,30,126,85,175,10,216,63,139,216,151,122,251,224,202,220,227,221,53,122,34,213,224,94,45,14,200,68,31,61,175,208,17,120,82,244,138,208,165,21,19,236,232,180,217,50,74,70,126,114,227,62,192,124,9,85,148,33,77,255,117,75,102,87,151,255,87,74,74,181,111,108,9,249,220,174,59,80,254,168,29,30,94,171,133,133,195,105,64,254,68,65,18,158,54,73,203,65,175,151,170,236,138,17,119,128,237,214,189,28,250,38,149,97,242,81,212,254,57,18,120,155,64,96,108,75,78,74,121,191,243,30,42,60,103,165,196,160,195,216,99,182,173,214,182,105,53,231,3,45,212,144,101,217,65,141,44,230,125,151,154,123,57,134,223,98,133,156,238,137,181,80,175,230,167,131,180,13,69,77,44,156,165,252,14,27,85,71,1,82,196,64,243,26,167,146,98,201,6,195,247,200,224,44,177,104,109,187,231,83,118,28,159,92,179,28,14,162,81,84,21,168,34,156,21,127,215,88,218,208,11,92,161,239,239,82,221,59,86,83,201,199,216,151,139,23,54,39,52,103,204,247,24,102,94,157,138,42,49,131,183,208,50,95,236,54,6,211,26,68,72,56,212,134,24,91,114,132,1,217,80,38,47,29,47,0,107,102,99,129,33,140,243,74,251,89,247,103,12,114,58,113,240,72,188,39,48,72,89,45,102,206,245,247,231,56,167,129,122,222,47,40,78,227,159,64,206,34,127,203,127,87,40,108,152,238,147,231,46,104,89,182,180,232,86,89,91,57,10,222,202,59,199,135,60,199,189,40,84,125,28,84,162,210,91,143,34,106,117,118,3,125,126,237,60,131,173,153,69,49,212,204,117,163,31,239,202,232,152,234,3,162,32,176,184,184,196,154,131,144,115,6,53,122,55,69,166,19,230,183,175,244,1,156,11,37,121,134,121,152,142,158,125,229,150,44,183,216,109,7,65,222,169,56,222,140,110,233,157,138,66,208,6,111,166,188,76,208,222,4,104,211,10,57,141,243,65,228,86,85,88,169,91,237,56,249,133,77,21,32,37,230,55,0,184,110,228,158,62,98,45,147,177,19,119,89,164,103,132,239,84,139,68,204,157,49,41,50,89,113,159,203,51,133,120,184,210,237,15,249,187,100,253,50,16,154,112,64,193,254,10,235,200,253,84,31,169,171,39,122,70,46,186,139,212,162,173,158,41,23,86,148,172,196,237,242,58,102,180,150,238,191,25,240,204,252,125,148,29,124,51,95,10,196,55,49,159,138,144,255,126,205,43,49,42,17,59,60,77,139,177,239,64,36,224,98,205,234,70,199,103,139,218,206,207,178,217,255,32,134,59,25,221,74,22,102,82,19,20,170,142,134,42,106,249,64,80,222,28,21,169,50,235,4,237,56,81,87,76,32,251,42,6,173,105,54,191,8,136,5,245,206,239,176,9,116,24];function G(c,z,d){var T=c.gl,L=1/z,$=1/d,Z=5;this.program=F(T,ne),this.setUniforms=function(){T.getUniformLocation(this.program,"u_image");var ce=T.getUniformLocation(this.program,"u_flipY"),re=T.getUniformLocation(this.program,"u_singleStepOffset"),U=T.getUniformLocation(this.program,"u_denoiseLevel");T.uniform2f(re,L,$),T.uniform1f(U,Z),T.uniform1f(ce,1)},this.setParameters=function(ce){void 0!==ce.denoiseLevel&&(Z=ce.denoiseLevel)},this.setSize=function(ce,re){L=1/ce,$=1/re}}var _=[11,196,242,139,198,252,188,5,32,162,171,128,13,160,25,222,172,102,207,244,158,69,103,57,239,111,150,18,157,82,55,210,20,131,156,190,100,112,230,97,199,225,96,74,99,94,248,222,162,213,95,122,158,212,233,42,22,37,217,115,36,152,30,123,116,104,212,109,129,41,220,77,213,97,124,45,4,219,197,171,40,18,149,104,20,4,248,102,64,9,50,217,124,131,180,188,159,170,63,1,84,130,150,117,14,212,118,67,165,97,207,242,251,15,30,187,188,77,79,122,67,101,252,109,244,82,37,191,227,35,114,87,57,71,99,218,155,54,101,239,138,197,13,226,228,176,157,158,87,98,55,251,79,150,64,138,200,135,40,132,135,207,146,252,222,57,58,111,151,225,78,59,36,210,70,29,121,160,210,31,109,67,167,194,177,236,91,108,164,229,130,211,59,66,93,18,107,226,54,210,51,8,77,217,19,73,187,33,30,59,9,135,162,49,5,11,225,111,119,11,247,218,129,115,83,205,170,21,4,69,210,133,134,245,109,15,177,9,81,81,203,105,42,158,12,255,151,165,230,205,5,92,196,251,211,187,27,214,43,186,91,233,85,192,229,15,71,38,220,20,38,101,44,78,7,60,251,186,75,103,108,53,166,220,186,208,194,120,207,230,159,248,22,32,142,124,96,157,222,60,191,65,145,6,239,125,151,147,50,58,130,207,110,131,223,231,137,238,28,182,216,167,198,191,37,67,76,1,144,232,218,79,72,28,65,101,43,216,64,253,16,173,179,123,140,27,233,245,199,230,36,181,102,114,247,162,18,34,20,212,25,171,24,28,143,80,94,40,167,34,209,61,117,130,1,198,196,7,21,252,180,255,92,128,119,9,48,156,138,136,151,143,23,44,52,3,40,197,228,31,123,67,163,140,32,54,204,187,149,80,19,255,82,120,195,12,110,65,56,212,143,22,78,44,234,72,140,29,118,103,18,36,7,122,50,37,139,47,142,243,25,208,88,237,126,50,103,127,19,183,29,169,29,1,55,23,100,32,129,239,243,160,61,178,197,117,199,45,57,26,165,135,92,218,59,0,197,54,13,96,40,141,212,221,131,103,46,22,228,191,167,73,20,86,62,11,147,217,116,205,203,110,134,249,51,6,123,23,86,231,157,8,144,83,126,115,118,35,96,36,229,36,220,228,143,71,45,223,129,48,236,5,145,202,188,208,184,70,241,104,255,188,181,146,210,206,144,53,77,101,120,38,8,245,80,230,165,160,183,83,202,79,127,57,214,126,242,150,208,40,239,148,35,163,201,97,74,70,214,181,63,240,147,33,253,149,140,77,197,82,126,189,231,7,196,212,80,14,151,24,57,144,243,81,234,66,24,19,236,2,137,121,246,129,65,7,99,110,174,54,74,182,81,234,142,37,72,110,220,255,64,119,10,188,111,191,228,1,205,9,204,143,56,62,125,84,106,225,131,97,192,43,240,157,161,75,168,247,44,175,65,81,192,48,21,157,167,80,191,130,161,75,85,186,174,42,117,1,68,252,204,138,254,203,152,21,13,64,144,195,207,238,229,54,103,247,159,245,211,85,191,141,168,32,234,85,46,118,12,5,199,4,19,217,203,202,156,33,143,114,116,60,66,40,58,77,208,237,171,26,72,175,114,205,248,87,137,62,210,143,151,197,167,210,241,122,150,104,122,154,2,70,102,83,19,36,141,136,199,42,79,229,71,86,194,109,31,236,80,166,17,230,109,1,40,28,46,224,56,20,230,47,100,254,116,208,76,169,157,241,175,3,70,85,31,38,245,58,33,80,145,237,8,22,71,224,158,156,31,249,81,87,247,230,199,237,96,167,123,63,243,79,156,206,203,160,54,124,68,253,215,132,235,57,185,92,238,55,59,210,104,71,26,183,180,71,12,255,224,192,65,154,72,244,8,164,10,248,46,207,30,92,1,80,244,31,189,138,88,216,218,63,100,227,116,57,119,94,135,5,126,255,32,191,163,61,209,194,88,248,112,139,173,43,69,134,3,160,151,137,25,98,239,166,19,123,208,180,31,120,30,191,75,183,179,126,180,125,92,107,105,206,138,28,67,139,3,188,230,184,255,121,13,181,45,160,114,202,194,123,87,55,124,97,164,82,95,232,216,117,62,5,90,176,82,167,52,160,153,174,168,105,146,91,248,81,79,249,97,138,133,170,245,229,132,61,5,149,224,246,194,213,61,12,109,44,136,235,95,219,133,220,27,93,36,93,124,180,81,141,152,220,170,163,229,197,124,171,232,48,70,251,106,119,150,20,16,49,119,247,42,132,36,76,254,124,177,66,175,9,1,39,92,127,195,171,198,34,2,64,144,179,72,40,151,110,89,229,42,125,33,238,16,220,228,51,203,8,1,68,145,253,133,118,93,163,129,22,13,248,65,12,4,63,101,210,70,170,138,203,14,246,54,194,195,27,107,241,175,35,171,49,52,106,121,45,36,152,85,215,132,78,167,34,18,167,245,152,133,134,170,120,182,10,146,191,37,2,205,47,125,20,203,44,88,81,32,150,223,220,218,238,254,30,212,167,221,115,156,82,226,137,220,221,97,3,139,202,33,9,27,26,126,40,215,25,126,9,82,208,49,217,14,161,81,196,61,60,87,254,213,194,81,216,161,151,209,166,222,230,24,128,117,140,92,4,203,254,170,253,249,88,90,112,226,18,44,122,39,158,158,56,69,204,159,5,179,51,197,233,139,216,102,226,206,248,15,78,112,214,126,67,28,40,38,98,190,178,206,67,94,245,254,160,101,176,32,157,26,132,83,252,228,87,242,32,127,160,112,210,224,133,149,115,41,30,16,200,69,89,81,77,144,12,106,182,73,54,28,53,195,28,216,179,179,136,35,141,102,234,177,240,34,186,106,145,245,3,84,48,251,157,245,11,217,111,227,138,42,67,114,211,177,37,103,16,71,152,72,117,123,36,213,202,56,124,227,84,8,45,229,149,165,214,69,244,169,55,68,62,94,104,228,74,205,123,222,17,7,172,158,227,74,206,149,67,175,171,251,185,121,151,223,63,35,229,32,49,190,209,120,137,69,213,214,19,150,187,177,28,12,158,153,126,149,171,167,234,120,129,109,32,157,180,75,66,56,233,115,127,230,157,32,34,143,156,31,230,168,174,125,118,195,249,243,165,81,246,10,144,15,103,139,55,173,7,59,136,69,172,54,132,165,140,78,77,230,33,169,129,188,71,209,109,161,8,57,57,199,143,31,164,43,58,130,1,110,145,31,229,13,46,149,94,244,106,76,238,105,107,1,183,177,10,61,225,94,185,116,58,183,95,225,22,119,19,248,28,13,123,125,108,158,64,184,77,245,153,162,217,227,208,41,185,211,235,41,153,181,54,166,165,11,154,55,21,184,209,192,249,44,164,160,29,229,159,82,156,198,241,183,114,83,137,186,151,148,31,21,197,216,145,32,13,50,22,241,137,39,71,28,142,160,215,107,221,45,202,104,227,110,186,12,150,145,240,51,49,44,196,115,224,238,149,189,134,99,67,241,62,157,240,114,247,195,26,200,141,97,147,249,23,150,174,10,13,219,81,73,58,242,96,250,243,15,49,218,58,230,104,252,175,150,123,86,185,84,90,198,6,36,0,99,72,28,166,238,115,231,171,249,179,71,174,68,156,227,17,198,79,73,142,99,144,20,80,62,80,191,142,46,71,9,243,6,8,214,116,72,190,106,161,19,185,100,9,187,64,94,86,203,174,156,245,222,95,54,30,148,19,11,50,112,96,61,237,159,173,7,154,127,175,79,48,97,89,78,126,66,171,204,158,195,27,226,205,222,157,89,251,90,125,37,212,27,97,3,141,247,175,50,121,7,187,68,196,181,202,167,189,57,84,81,222,23,27,84,130,176,98,66,240,207,18,23,28,163,163,194,45,37,129,202,170,97,189,0,81,238,0,39,199,163,35,211,206,247,65,29,116,242,67,102,235,13,136,232,230,114,146,187,7,254,142,26,121,16,237,5,160,201,114,94,178,199,95,212,241,45,112,180,188,72,86,114,189,155,149,149,163,210,112,101,12,69,225,75,202,223,28,242,90,215,156,169,224,245,135,128,92,148,217,131,208,255,25,135,117,136,5,104,185,249,161,228,214,16,105,204,9,182,135,153,220,101,244,160,207,58,182,118,185,240,57,245,123,13,112,182,106,229,220,90,29,86,215,96,147,232,2,55,131,225,137,68,245,89,141,252,97,3,129,155,216,223,98,116,45,78,85,141,161,74,215,7,150,171,225,59,78,221,152,236,14,117,100,208,158,86,13,185,124,87,157,111,40,187,182,124,173,71,173,23,199,52,155,190,134,11,23,64,25,215,39,115,231,173,77,72,114,54,252,116,178,59,221,106,241,119,254,30,226,241,204,233,113,197,96,146,0,41,67,3,231,126,12,218,202,22,171,114,249,176,134,160,19,216,31,229,118,226,62,242,126,126,42,127,130,68,218,218,81,202,106,217,191,25,177,82,97,81,36,232,137,58,90,216,190,117,235,20,194,144,76,178,27,213,13,208,18,29,118,126,49,98,203,179,128,237,100,32,242,189,212,6,210,210,188,161,205,13,124,119,13,215,112,41,183,176,215,168,210,182,111,1,115,2,239,141,8,177,124,112,48,197,2,239,11,99,4,36,77,69,47,244,19,153,61,19,2,96,176,7,112,122,131,169,25,189,116,171,49,12,121,162,79,154,74,251,50,233,182,63,180,224,118,49,253,21,20,16,31,144,184,93,174,231,244,183,13,49,225,189,211,73,185,49,110,142,25,226,45,176,233,204,74,33,16,205,88,131,92,157,170,175,68,170,61,53,116,165,16,27,182,160,181,87,241,15,151,85,107,76,167,129,25,172,127,184,138,153,222,228,125,64,44,45,32,12,227,148,106,152,83,240,166,54,235,32,190,12,242,164,123,189,53,194,141,104,43,202,110,4,168,119,245,232,179,178,198,1,224,87,86,160,31,19,140,233,102,191,204,4,98,138,163,191,106,24,213,47,208,82,137,132,131,16,253,84,25,144,90,159,148,16,196,84,166,61,160,101,229,227,93,118,59,87,66,16,128,59,96,131,250,20,184,150,205,91,227,201,62,35,79,180,172,173,85,197,106,153,238,229,60,204,65,193,230,94,101,177,134,6,165,53,171,142,208,155,2,11,4,202,127,54,17,142,117,227,121,128,204,192,147,147,92,189,5,224,148,72,18,83,101,126,124,228,153,242,123,229,247,92,221,6,73,227,250,87,167,194,129,187,73,38,185,109,217,240,193,88,50,178,180,151,54,197,187,137,190,166,233,1,103,204,88,31,127,185,29,65,1,29,254,223,14,83,167,215,114,248,30,173,89,173,187,69,5,105,117,15,106,94,173,63,227,25,230,190,136,168,177,175,107,91,126,254,34,188,25,118,48,12,226,130,153,162,57,47,181,212,79,160,97,64,157,246,90,53,43,149,76,102,15,195,107,58,242,84,172,29,81,198,113,81,251,138,182,154,111,30,171,129,56,17,45,214,153,112,117,203,174,40,38,234,236,32,4,112,225,26,187,195,246,252,9,218,69,160,223,178,54,148,81,8,134,151,75,248,63,224,240,48,75,250,221,85,46,100,50,3,70,64,102,111,160,155,233,59,147,184,57,61,6,126,79,176,16,185,94,166,33,135,78,42,75,140,208,140,44,153,187,64,103,119,160,236,16,239,74,218,219,212,207,110,53,30,76,248,40,111,98,44,20,113,204,233,109,135,96,107,39,163,203,125,45,157,152,71,239,175,174,159,147,80,111,93,38,253,228,154,225,181,101,12,241,127,65,49,189,5,85,151,237,213,143,14,104,138,54,52,27,4,132,67,35,156,86,157,73,16,229,222,245,110,79,165,179,56,179,53,218,229,100,58,87,149,48,231,64,63,115,67,3,172,6,186,115,154,60,53,214,152,149,89,234,37,143,82,255,64,28,183,93,112,39,70,185,57,0,199,9,61,175,219,41,76,37,176,82,125,65,53,160,214,105,62,153,244,222,96,205,6,178,85,41,240,113,0,96,149,38,3,195,18,152,41,246,3,103,29,110,134,30,101,75,46,103,199,184,20,230,8,55,120,4,229,168,35,43,7,28,161,143,87,27,87,79,255,186,44,195,158,155,181,119,81,172,217,107,95,98,55,243,186,66,105,48,224,123,232,84,156,20,10,156,208,204,52,34,228,136,97,242,200,246,211,67,202,40,241,91,92,253,9,54,72,131,221,106,178,32,44,182,4,225,193,37,20,249,249,231,10,206,18,71,254,221,187,172,88,204,6,127,138,102,7,208,75,147,219,199,177,79,36,170,101,207,177,109,95,143,217,41,199,80,183,201,2,254,12,55,23,198,14,255,69,245,138,155,129,227,167,168,130,156,135,14,96,93,48,99,143,107,126,92,117,143,112,108,193,228,84,13,41,186,27,172,92,201,149,116,19,112,197,116,209,128,102,1,55,152,177,28,37,34,50,83,41,199,74,178,59,111,67,118,35,252,36,33,87,28,170,17,215,47,90,154,124,137,15,14,211,59,75,59,30,77,0,49,37,225,191,87,101,127,214,227,160,99,174,234,82,148,235,16,241,219,147,170,127,221,250,116,39,218,156,72,227,172,55,0,79,188,76,51,222,232,24,36,62,94,154,3,61,230,146,114,253,0,128,58,253,90,72,211,242,38,39,133,153,161,119,105,195,152,225,208,105,140,80,217,186,196,157,21,116,230,116,139,25,159,143,118,128,77,201,238,247,228,15,168,4,133,148,21,148,12,44,241,7,115,17,129,176,202,46,130,122,129,235,141,223,85,21,199,65,181,169,52,174,161,153,62,25,164,115,213,89,138,199,103,79,200,165,135,249,244,27,209,178,240,129,211,61,9,111,157,147,119,36,119,255,110,130,84,49,210,225,247,100,26,121,127,163,160,26,79,99,24,77,65,32,178,109,36,27,253,173,110,183,11,14,211,57,130,254,124,104,165,219,31,70,97,14,194,39,61,26,141,125,228,126,194,184,101,160,204,106,128,144,106,103,171,18,246,129,220,85,172,151,123,5,73,155,192,175,91,157,239,61,237,116,170,65,233,56,19,49,114,168,190,3,214,53,250,90,213,244,88,101,30,229,248,124,15,71,141,27,172,235,21,129,211,72,61,172,112,170,128,135,96,196,221,255,27,176,105,188,183,121,33,37,149,53,131,226,233,29,167,234,218,109,53,185,152,36,248,53,61,235,78,21,201,214,210,163,12,251,187,45,188,137,126,127,237,92,234,91,240,225,38,194,57,213,251,237,171,30,99,52,14,49,84,101,252,237,7,166,122,114,32,107,32,207,239,136,168,178,12,11,241,233,230,146,132,18,83,233,41,172,17,6,161,42,113,87,40,255,185,1,146,128,5,240,126,131,71,42,54,124,205,2,122,71,30,222,229,40,134,142,102,97,239,151,177,1,230,231,49,123,219,28,129,91,152,112,13,154,81,197,226,255,112,158,178,177,55,181,108,138,185,245,29,186,21,73,188,209,154,200,89,116,235,198,144,36,87,248,22,7,200,122,7,148,44,42,87,140,238,204,95,231,252,0,136,0,22,39,70,123,125,165,113,227,172,146,163,128,158,36,52,91,19,36,245,27,150,138,141,11,67,239,224,65,24,116,101,7,39,46,142,172,164,243,148,0,33,226,59,47,203,137,156,241,66,250,157,30,204,101,143,134,98,238,155,226,25,184,136,219,89,100,193,11,143,71,139,243,230,151,0,249,1,78,26,32,93,104,157,67,97,164,248,86,124,146,93,74,222,228,167,55,53,100,135,216,109,13,64,37,106,177,200,200,182,92,251,69,31,243,89,80,198,14,132,203,72,103,28,104,217,24,97,223,113,11,29,178,191,210,46,162,255,68,99,8,237,213,162,152,193,183,121,203,19,108,182,29,86,26,192,103,220,103,205,154,179,197,9,22,73,127,175,146,38,119,210,0,24,180,21,245,215,204,91,186,119,138,183,239,15,155,231,248,133,39,24,101,144,236,10,230,54,174,227,73,21,110,10,160,241,232,131,14,212,127,232,59,122,65,146,54,163,9,189,190,121,88,170,62,194,14,204,152,245,38,131,37,91,81,72,114,29,115,239,182,56,44,156,159,177,180,82,160,93,97,86,183,236,50,95,85,39,71,181,225,152,143,63,123,117,34,44,109,160,166,229,240,91,138,102,54,180,173,44,50,80,42,124,7,50,124,211,239,21,94,197,185,239,213,107,142,64,95,124,125,17,180,97,189,101,52,48,19,112,12,70,9,212,177,54,118,66,84,147,236,248,26,124,95,103,135,254,124,49,112,186,99,120,90,8,194,191,88,57,242,65,61,10,104,246,197,252,19,159,58,194,75,173,242,103,8,115,84,69,238,149,26,15,159,182,141,132,119,70,29,53,20,143,46,163,204,6,236,59,45,185,172,89,119,83,38,144,36,222,96,151,26,99,195,163,170,133,92,159,214,53,150,116,90,176,69,145,130,15,172,140,217,215,101,163,115,161,65,101,8,7,183,113,213,134,58,175,130,251,143,173,248,168,135,60,159,30,194,68,208,119,120,2,40,178,227,247,161,77,47,136,46,244,163,72,65,158,25,225,195,61,132,182,204,177,186,200,81,2,65,105,212,72,94,203,232,217,182,123,251,228,160,1,161,204,123,20,37,1,77,208,179,45,149,181,122,102,190,123,213,164,231,41,216,130,234,248,208,251,252,220,84,209,67,47,61,220,5,142,162,26,236,121,142,248,132,255,65,122,203,196,102,191,187,2,195,127,255,193,92,49,91,186,154,39,156,29,211,172,49,104,245,114,153,223,211,199,249,35,130,160,128,0,152,176,183,20,236,113,193,108,26,255,11,237,102,133,245,94,115,114,10,89,229,214,221,99,149,30,99,37,246,10,26,26,39,92,123,170,73,211,127,227,54,30,86,133,159,112,225,91,148,100,174,149,75,143,14,140,20,44,64,212,5,243,8,116,63,30,97,42,123,20,73,212,85,207,83,122,27,251,233,84,10,17,236,232,83,200,127,119,143,163,204,220,167,59,231,20,106,186,222,191,8,40,234,21,25,180,13,116,250,152,224,174,75,3,205,38,173,215,236,151,185,121,254,244,154,239,17,53,106,164,61,49,116,216,118,94,150,35,181,26,238,66,49,211,221,132,146,166,115,39,136,36,205,230,179,31,197,51,148,165,109,38,70,37,148,52,44,209,250,98,58,246,225,103,198,101,26,25,196,207,8,166,21,88,252,175,253,10,88,107,157,19,225,61,12,246,221,37,239,186,167,137,142,135,222,128,174,62,95,216,38,141,157,45,232,97,217,173,203,234,116,129,69,206,189,94,221,12,54,139,186,247,184,16,200,121,244,104,8,7,35,111,47,188,10,140,92,73,143,206,203,72,122,184,20,102,197,130,64,150,63,96,239,8,132,111,217,84,91,198,32,43,100,138,241,15,160,42,190,253,193,184,164,124,29,210,96,67,224,221,182,29,218,129,149,29,128,174,98,88,88,125,56,40,255,120,5,0,87,174,42,150,90,112,201,183,169,19,57,195,191,12,58,244,235,132,25,145,72,146,214,8,125,100,135,12,5,102,97,248,174,24,159,90,33,43,187,6,61,212,241,225,190,219,252,197,123,129,164,108,123,55,230,4,153,166,105,234,15,85,216,23,56,32,3,41,110,68,146,172,133,202,98,41,7,47,152,35,255,168,106,241,226,222,77,244,52,185,65,252,227,32,66,38,11,172,60,28,28,103,84,1,1,205,182,190,28,189,102,253,43,1,191,148,116,10,227,18,81,93,80,239,157,232,215,180,163,165,161,109,177,71,150,244,144,208,160,110,22,174,60,206,43,103,121,55,103,114,115,173,238,13,10,227,251,41,176,216,158,229,216,55,234,128,128,20,167,106,181,86,163,130,215,110,149,191,10,227,215,8,214,154,178,181,15,19,0,247,250,97,74,43,157,55,94,174,41,41,9,199,97,20,91,32,18,10,43,98,240,247,203,20,250,117,160,44,229,202,187,64,54,124,15,184,169,129,27,160,240,26,61,255,60,166,60,144,209,84,55,187,186,168,13,124,125,29,17,100,249,227,62,205,78,179,163,168,139,168,21,38,83,239,151,74,43,66,2,92,72,71,94,216,134,238,20,45,158,213,164,73,57,80,47,198,184,130,223,227,71,132,133,235,177,85,174,142,124,172,200,54,229,40,126,60,76,92,216,153,56,241,174,66,141,90,226,3,30,68,234,71,187,163,112,146,255,22,143,170,204,3,127,179,81,139,160,37,77,246,128,220,196,158,153,73,177,65,199,119,29,197,144,130,248,206,155,253,108,213,124,7,223,221,162,146,134,242,65,99,162,107,120,247,214,207,96,150,169,131,208,218,221,28,24,112,208,23,1,130,142,232,56,104,45,33,158,95,255,123,31,74,76,120,178,155,213,6,195,164,8,8,69,241,197,127,83,169,21,167,19,94,143,252,33,159,248,241,170,153,147,1,149,199,201,131,170,79,236,212,209,143,107,98,24,123,56,33,193,85,247,64,225,135,210,78,145,57,16,145,71,170,20,133,87,235,4,166,239,100,82,235,81,50,223,9,193,52,49,86,129,190,196,82,165,107,63,115,161,98,33,20,193,29,42,151,205,252,124,72,245,48,181,67,7,13,21,127,59,226,188,144,129,112,244,192,121,213,80,42,196,1,13,107,108,78,0,40,121,225,148,237,234,209,216,238,9,147,226,254,96,89,212,72,193,106,75,135,74,227,67,255,92,191,81,188,124,226,149,152,142,15,159,195,238,114,55,255,166,157,230,59,148,170,166,151,65,213,104,253,253,112,150,82,147,137,27,214,100,247,65,81,92,47,86,217,7,45,120,81,130,31,236,243,76,78,3,45,105,172,220,71,48,220,94,196,249,163,193,133,50,236,205,20,55,2,63,14,127,69,113,212,204,12,58,79,89,86,29,61,199,201,64,149,6,144,182,150,129,31,18,167,120,248,82,107,25,143,128,27,161,28,25,153,183,217,238,78,186,106,92,27,202,219,165,96,0,216,234,169,73,101,39,182,113,217,240,170,116,172,221,250,233,48,49,242,83,227,92,181,184,72,230,180,21,15,108,135,25,38,153,25,124,227,26,149,73,236,39,211,244,149,58,183,132,26,223,219,174,144,117,233,219,165,205,157,159,222,184,52,47,241,201,123,65,24,44,55,215,177,168,250,179,115,190,227,123,158,163,179,224,69,196,66,207,254,243,101,221,193,140,250,4,28,222,52,96,138,160,33,218,64,118,214,234,201,152,148,91,178,111,107,144,142,6,182,102,72,188,34,213,181,26,223,58,255,103,81,17,47,169,11,245,224,123,148,215,237,186,107,75,152,90,202,166,22,149,197,5,246,238,78,76,229,106,199,94,127,195,0,45,82,6,159,103,96,138,231,71,46,107,59,216,39,43,12,221,27,214,56,155,145,66,187,169,250,235,78,211,179,239,183,198,163,93,5,196,24,174,143,225,106,139,89,98,13,127,207,184,194,30,1,165,198,169,8,197,118,86,163,221,138,23,209,61,116,79,99,233,43,130,60,244,85,229,243,172,123,148,200,120,192,127,211,52,11,159,41,95,212,230,188,169,156,137,29,212,12,148,168,148,133,243,44,241,139,127,24,246,220,227,125,209,97,60,52,162,192,146,49,161,92,138,112,189,128,59,126,125,46,207,60,79,231,174,152,209,68,223,205,2,38,14,91,116,159,255,28,27,178,248,164,104,158,79,69,214,234,157,12,75,163,83,253,245,202,61,213,176,6,197,230,29,208,166,253,194,254,235,29,141,241,70,249,15,62,0,148,163,135,52,122,40,96,87,31,179,152,51,216,133,184,122,198,203,60,115,218,191,193,16,178,25,148,252,112,104,103,252,36,92,221,28,179,43,199,198,151,128,100,252,217,161,249,34,201,172,118,52,180,252,104,7,223,44,116,102,212,21,40,224,184,55,163,210,21,207,161,239,51,54,155,41,133,18,67,48,3,165,130,251,4,79,214,57,72,130,157,212,144];function u(c,z,d){var T=c.gl,L=5,$=.1,Z=.5,ce=175/180*3.141593,re=115/180*3.141593,U=173/180*3.141593,V=116/180*3.141593,q=2.04203545,pe=0,oe=0,de=0,ye=[],Te=[0,1,3,4,6,7,9,10,12,13,15,16,18,19,21,22,24,26,29,31,34,36,39,41,44,46,49,51,54,56,59,61,64,65,66,67,68,69,70,72,73,74,75,76,77,79,80,81,82,83,84,85,87,88,89,90,91,92,94,95,96,97,98,99,101,102,103,104,105,106,107,109,110,111,112,113,114,116,117,118,119,120,121,123,124,125,126,127,128,129,131,132,133,134,135,136,138,139,140,141,142,143,145,146,147,148,149,150,151,153,154,155,156,157,158,160,161,162,163,164,165,166,168,169,170,171,172,173,175,176,177,178,179,180,182,183,184,185,186,187,188,190,191,192,193,194,195,197,198,199,200,201,202,204,205,206,207,208,209,210,212,213,214,215,216,217,219,220,221,222,223,224,226,226,226,227,227,227,228,228,228,229,229,229,230,230,231,231,231,232,232,232,233,233,233,234,234,235,235,235,236,236,236,237,237,237,238,238,239,239,239,240,240,240,241,241,241,242,242,243,243,243,244,244,244,245,245,245,246,246,246,247,247,247,248,248,248,249,249,249,250,250,250,251,251,251,252,252,252,253,253,253,254,254,254,255],Re=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,32,33,35,36,37,39,40,42,43,44,46,47,49,50,51,53,54,56,57,58,59,61,62,63,64,66,67,68,69,71,72,73,74,76,77,78,79,81,82,83,84,86,87,88,90,91,92,93,95,96,97,98,100,101,102,103,105,106,107,108,110,111,112,113,115,116,117,118,120,121,122,124,125,126,127,129,130,131,132,134,135,136,137,139,140,141,142,144,145,146,147,149,150,151,152,154,155,156,158,159,160,161,163,164,165,166,168,169,170,171,173,174,175,176,178,179,180,181,183,184,185,186,188,189,190,192,193,194,195,197,198,199,200,202,203,204,205,207,208,209,210,212,213,214,215,217,218,219,220,222,223,224,226,226,226,227,227,228,228,229,229,230,230,231,231,232,232,233,233,234,234,234,235,235,236,236,237,237,238,238,239,239,240,240,241,241,242,242,243,243,243,244,244,244,245,245,245,246,246,246,247,247,247,248,248,248,249,249,249,250,250,250,251,251,251,252,252,252,253,253,253,254,254,254,255],Ce=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,35,36,37,38,39,40,41,43,44,45,46,47,48,50,51,52,53,54,55,56,58,59,60,61,62,63,65,66,67,68,69,70,72,73,74,76,77,78,80,81,83,84,85,87,88,89,91,92,94,95,96,98,99,100,102,103,105,106,107,109,110,111,113,114,116,117,118,120,121,122,124,125,127,128,129,131,132,133,135,136,138,139,140,142,143,144,146,147,149,150,151,153,154,155,157,158,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,192,193,193,194,195,195,196,197,197,198,199,199,200,201,201,202,203,203,204,205,205,206,207,207,208,209,209,210,211,211,212,213,213,214,215,215,216,217,217,218,219,219,220,221,221,222,223,223,224,225,225,226,227,227,228,229,229,230,231,231,232,233,233,234,235,235,236,237,237,238,239,239,240,241,241,242,243,243,244,245,245,246,247,247,248,249,249,250,251,251,252,253,253,254,255];this.program=F(T,_),this.setUniforms=function(){var Ee=T.getUniformLocation(this.program,"u_flipY"),Le=T.getUniformLocation(this.program,"u_denoiseLevel");T.uniform1f(Le,L),T.uniform1f(Ee,1);var p=T.getUniformLocation(this.program,"light");T.uniform1f(p,$);var le=T.getUniformLocation(this.program,"redness");T.uniform1f(le,Z);var k=T.getUniformLocation(this.program,"skin_he_max"),Ae=T.getUniformLocation(this.program,"skin_he_min"),Ge=T.getUniformLocation(this.program,"skin_hc_max"),Ve=T.getUniformLocation(this.program,"skin_hc_min"),Fe=T.getUniformLocation(this.program,"skin_hc_axis"),We=T.getUniformLocation(this.program,"facts_rotate_c"),ie=T.getUniformLocation(this.program,"facts_rotate_le"),h=T.getUniformLocation(this.program,"facts_rotate_ge");T.uniform1f(k,ce),T.uniform1f(Ae,re),T.uniform1f(Ge,U),T.uniform1f(Ve,V),T.uniform1f(Fe,q),T.uniform1f(We,pe),T.uniform1f(ie,oe),T.uniform1f(h,de);var Q=T.getUniformLocation(this.program,"u_originImage");T.activeTexture(T.TEXTURE2),T.bindTexture(T.TEXTURE_2D,c.inputTexture),T.uniform1i(Q,2);for(var ae=["lighten_lut"],fe=[T.TEXTURE3],me=0;me<ae.length;me++){var K=T.getUniformLocation(this.program,ae[me]);T.activeTexture(fe[me]),T.bindTexture(T.TEXTURE_2D,ye[me]),T.uniform1i(K,me+3)}},this.setParameters=function(Ee){void 0!==Ee.denoiseLevel&&(L=Ee.denoiseLevel),void 0!==Ee.lightLevel&&($=Ee.lightLevel),void 0!==Ee.rednessLevel&&this._updateRedness(Z=Ee.rednessLevel),void 0!==Ee.lighteningContrastLevel&&this._updateLut(Ee.lighteningContrastLevel)},this._updateRedness=function(Ee){var Le,p,le=3.141593,k=Ee,Ae=k;k>1&&(k=1),k<0&&(k=0),Ae>1&&(Ae=1),Ae<0&&(Ae=0),pe=.8*k,Ae<.8&&(Ae=0),(q=(117-4*Ae)/180*le)<(V=(116-4*Ae)/180*le)&&(q=V),V<le/2&&(V=le/2),q<le/2&&(q=le/2),(re=(115-4*Ae)/180*le)<le/2&&(re=le/2),(U=173/180*le)>le&&(U=le),q>le&&(q=le),(ce=175/180*le)>le&&(ce=le),p=U-q,de=(Le=ce-U)>.01?pe*p/Le:pe,p=q-V,oe=(Le=V-re)>.01?pe*p/Le:pe},this._updateLut=function(Ee){var Le=null;0==Ee&&(Le=Re),1==Ee&&(Le=Ce),2==Ee&&(Le=Te);for(var p=[new Uint8Array(Le)],le=[256],k=[1],Ae=0;Ae<p.length;Ae++)T.bindTexture(T.TEXTURE_2D,ye[Ae]),T.texImage2D(T.TEXTURE_2D,0,T.LUMINANCE,le[Ae],k[Ae],0,T.LUMINANCE,T.UNSIGNED_BYTE,p[Ae])},this._init=function(){for(var Le=[new Uint8Array(Re)],p=[256],le=[1],k=0;k<Le.length;k++){var Ae=T.createTexture();T.bindTexture(T.TEXTURE_2D,Ae),T.texImage2D(T.TEXTURE_2D,0,T.LUMINANCE,p[k],le[k],0,T.LUMINANCE,T.UNSIGNED_BYTE,Le[k]),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_S,T.CLAMP_TO_EDGE),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_T,T.CLAMP_TO_EDGE),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MIN_FILTER,T.LINEAR),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MAG_FILTER,T.LINEAR),ye.push(Ae)}},this._init()}var B=!1;function S(){this.programs=[];var c=this,z=null,d=null;c.gl=null,c.inputTexture=null;var T=[],L=[],$=0,Z=0;c._initGl=function(ce,re){c.inputTexture=z.createTexture(),z.bindTexture(z.TEXTURE_2D,c.inputTexture),z.texParameteri(z.TEXTURE_2D,z.TEXTURE_WRAP_S,z.CLAMP_TO_EDGE),z.texParameteri(z.TEXTURE_2D,z.TEXTURE_WRAP_T,z.CLAMP_TO_EDGE),z.texParameteri(z.TEXTURE_2D,z.TEXTURE_MIN_FILTER,z.LINEAR),z.texParameteri(z.TEXTURE_2D,z.TEXTURE_MAG_FILTER,z.LINEAR);for(var U=0;U<4;U++){var V=z.createTexture();z.bindTexture(z.TEXTURE_2D,V),z.texParameteri(z.TEXTURE_2D,z.TEXTURE_WRAP_S,z.CLAMP_TO_EDGE),z.texParameteri(z.TEXTURE_2D,z.TEXTURE_WRAP_T,z.CLAMP_TO_EDGE),z.texParameteri(z.TEXTURE_2D,z.TEXTURE_MIN_FILTER,z.LINEAR),U<2?z.texImage2D(z.TEXTURE_2D,0,z.RGBA,ce,re,0,z.RGBA,z.UNSIGNED_BYTE,null):z.texImage2D(z.TEXTURE_2D,0,z.RGBA,re,ce,0,z.RGBA,z.UNSIGNED_BYTE,null);var q=z.createFramebuffer();z.bindFramebuffer(z.FRAMEBUFFER,q),z.framebufferTexture2D(z.FRAMEBUFFER,z.COLOR_ATTACHMENT0,z.TEXTURE_2D,V,0),T.push(V),L.push(q)}z.viewport(0,0,ce,re),$=ce,Z=re},c.render=function(ce){if(z){var re=0;Z==ce.videoWidth&&$===ce.videoHeight&&(re=2),z.viewport(0,0,ce.videoWidth,ce.videoHeight),z.bindTexture(z.TEXTURE_2D,c.inputTexture),z.texImage2D(z.TEXTURE_2D,0,z.RGBA,z.RGBA,z.UNSIGNED_BYTE,ce);for(var U=B?c.programs.length-1:0,V=0;V<=U;V++){var q=c.programs[V].program;z.useProgram(q);var pe=z.getUniformLocation(q,"u_image");c.programs[V].setUniforms(),z.bindFramebuffer(z.FRAMEBUFFER,L[re+V%2]),z.clearColor(0,0,0,1),z.clear(z.COLOR_BUFFER_BIT),z.drawArrays(z.TRIANGLES,0,6),z.activeTexture(z.TEXTURE0),z.bindTexture(z.TEXTURE_2D,T[re+V%2]),z.uniform1i(pe,0)}z.useProgram(d);var oe=z.getUniformLocation(d,"u_flipY");z.uniform1f(oe,-1),z.bindFramebuffer(z.FRAMEBUFFER,null),z.clearColor(0,0,0,1),z.clear(z.COLOR_BUFFER_BIT),z.drawArrays(z.TRIANGLES,0,6)}},c.setEnableBeauty=function(ce){B=ce},c.init=function(ce,re,U){if("undefined"==typeof WebGLRenderingContext)throw new Error("NOT_SUPPORT");z=U.getContext("webgl"),c.gl=z,c._initGl(ce,re),c.programs.push(new H(this,ce,re)),c.programs.push(new J(this,ce,re)),c.programs.push(new Y(this,ce,re)),c.programs.push(new G(this,ce,re)),c.programs.push(new u(this,ce,re)),d=c.programs[0].program},c.release=function(){c.gl=null,z=null,d=null,c.inputTexture=null,c.programs=[],T=[],L=[]},c.setDenoiseLevel=function(ce){c.programs.forEach(function(re){re.setParameters&&re.setParameters({denoiseLevel:ce})})},c.setLightLevel=function(ce){c.programs.forEach(function(re){re.setParameters&&re.setParameters({lightLevel:ce})})},c.setRednessLevel=function(ce){c.programs.forEach(function(re){re.setParameters&&re.setParameters({rednessLevel:ce})})},c.setContrastLevel=function(ce){c.programs.forEach(function(re){re.setParameters&&re.setParameters({lighteningContrastLevel:ce})})},c.setSize=function(ce,re){c.programs.forEach(function(U){U.setSize&&U.setSize(ce,re)})}}S._instance=null,S.getInstance=function(){return S._instance||(S._instance=new S),S._instance},ee.a={addVideoEffectCapability:function(c){var z;c.videoEffect={canvas:null,video:null,fps:30,stopChromeBackgroundLoop:null,enableBeauty:!1,denoiseLevel:5,lightLevel:.35,rednessLevel:.5,lighteningContrastLevel:1,videoContextInited:!1,originVideoTrack:null,canvasVideoTrack:null,ctx:null},c._initVideoContext=function(){if(c.videoEffect.videoContextInited)throw new Error("Failed to init video context. Already inited");if(!c.stream)throw new Error("Failed to init video context. Local Stream not initialized");c.videoEffect.originVideoTrack=c.stream.getVideoTracks()[0],c.attributes&&c.attributes.maxFrameRate&&(c.videoEffect.fps=c.attributes.maxFrameRate),c.videoEffect.videoContextInited=!0},c._renderWithWebGL=function(z){return new Promise(function(d){c.videoEffect.canvas||(c.videoEffect.canvas=document.createElement("canvas")),c.videoEffect.video||(c.videoEffect.video=document.createElement("video")),c.videoEffect.video.setAttribute("autoplay",""),c.videoEffect.video.setAttribute("muted",""),c.videoEffect.video.muted=!0,c.videoEffect.video.setAttribute("playsinline",""),c.videoEffect.video.setAttribute("style","display:none"),c.videoEffect.video.srcObject=z;var T=z.getVideoTracks()[0].getSettings(),L=T.width,$=T.height;console.log("Width: ".concat(L,", Height: ").concat($)),c.videoEffect.canvas.setAttribute("width",L),c.videoEffect.canvas.setAttribute("height",$),c.videoEffect.video.setAttribute("width",L),c.videoEffect.video.setAttribute("height",$);var Z=S.getInstance();Z.init(c.videoEffect.video.width,c.videoEffect.video.height,c.videoEffect.canvas),Z.setDenoiseLevel(c.videoEffect.denoiseLevel),Z.setLightLevel(c.videoEffect.lightLevel),Z.setRednessLevel(c.videoEffect.rednessLevel),Z.setContrastLevel(c.videoEffect.lighteningContrastLevel),c.videoEffect.video.addEventListener("playing",function ce(){var re=c.videoEffect.canvas.captureStream(c.videoEffect.fps);c.videoEffect.video.removeEventListener("playing",ce,!0),d([re.getVideoTracks()[0],c.videoEffect.video])},!0),c.videoEffect.video.play()})},c._disableEffect=function(){c.videoEffect.videoContextInited||c._initVideoContext();var z=c.videoEffect.originVideoTrack;if(!z)return y.default.warning("Video track is null, fail to disable video effect!"),Promise.resolve();if(c.pc&&c.pc.peerConnection&&c.pc.peerConnection){var d=(c.pc.peerConnection&&c.pc.peerConnection.getSenders()).find(function(T){return T&&T.track&&"video"==T.track.kind});if(d&&d.replaceTrack&&z)return d.replaceTrack(z)}return Promise.resolve()},c._releaseEffect=function(){var z;return z=c.videoEffect.enableBeauty?c._disableEffect():Promise.resolve(),S.getInstance().release(),c.videoEffect.videoContextInited=!1,c.videoEffect.canvasVideoTrack=null,z},c._enableEffect=function(){return c.videoEffect.videoContextInited||c._initVideoContext(),c.videoEffect.originVideoTrack?c.videoEffect.canvasVideoTrack?(c._showEffectInLocalPlayer(),c._replaceWithCanvasTrack()):c._renderWithWebGL(c.stream).then(function(z){var d=m()(z,2),L=d[1];c.videoEffect.canvasVideoTrack=d[0];var $=S.getInstance();return requestAnimationFrame(function Z(){c.videoEffect.enableBeauty&&$.render(L),c.videoEffect.videoContextInited&&requestAnimationFrame(Z)}),R.isChrome()&&document.addEventListener("visibilitychange",function(){document,document.hidden?c.videoEffect.stopChromeBackgroundLoop=function(Z,ce){var re=1/ce,U=new AudioContext,V=U.createGain();V.gain.value=0,V.connect(U.destination),function pe(){var oe=U.createOscillator();oe.onended=pe,oe.connect(V),oe.start(0),oe.stop(U.currentTime+re),c.videoEffect.enableBeauty&&$.render(L),q&&(oe.onended=function(){U.close()})}();var q=!1;return function(){q=!0}}(0,c.videoEffect.fps):c.videoEffect.stopChromeBackgroundLoop&&(c.videoEffect.stopChromeBackgroundLoop(),c.videoEffect.stopChromeBackgroundLoop=null)},!1),c._showEffectInLocalPlayer(),c._replaceWithCanvasTrack()}):(y.default.warning("Video track is null, fail to enable video effect!"),Promise.resolve())},c._showEffectInLocalPlayer=function(){if(c.player){var z=c.player.div.children[0];if("none"!==z.style.display&&(c.player.div.appendChild(c.videoEffect.canvas),"video"===z.tagName.toLowerCase())){var d=z.getAttribute("style");c.videoEffect.canvas.setAttribute("style",d),"none"!==z.style.display&&(z.style.display="none")}}},c._removeEffectFromLocalPlayer=function(){if(c.player&&c.player.div&&c.videoEffect.enableBeauty&&c.videoEffect.canvas){c.player.div.removeChild(c.videoEffect.canvas);var z=c.player.div.children[0];"video"===z.tagName.toLowerCase()&&(c.videoEffect.canvas.style.display="none",z.style.display="block")}},c._replaceWithCanvasTrack=function(){var z=null;return c.pc&&c.pc.peerConnection&&c.pc.peerConnection&&(z=(c.pc.peerConnection&&c.pc.peerConnection.getSenders()).find(function(d){return d&&d.track&&"video"==d.track.kind})),z&&z.replaceTrack&&c.videoEffect.canvasVideoTrack?z.replaceTrack(c.videoEffect.canvasVideoTrack):Promise.resolve()},c.setBeautyEffectOptions=(z=b()(C.a.mark(function d(T,L){var $,Z=arguments;return C.a.wrap(function(ce){for(;;)switch(ce.prev=ce.next){case 0:if(Object(g.checkValidBoolean)(T,"enabled"),$=S.getInstance(),c.videoEffect.enableBeauty==T){ce.next=14;break}if($.setEnableBeauty(T),!T){ce.next=9;break}return ce.next=7,c._enableEffect();case 7:ce.next=12;break;case 9:return c._removeEffectFromLocalPlayer(),ce.next=12,c._releaseEffect();case 12:c.videoEffect.enableBeauty=T,f.report.reportApiInvoke(c.sid,{callback:null,options:Z,name:"Stream.setBeautyEffectOptions",tag:"tracer"});case 14:if(T){ce.next=16;break}return ce.abrupt("return");case 16:if(!L){ce.next=20;break}Object(g.checkValidObject)(L,"options"),ce.next=21;break;case 20:return ce.abrupt("return");case 21:if(void 0!==L.smoothnessLevel&&(Object(g.checkValidFloatNumber)(L.smoothnessLevel,"smoothnessLevel",0,1),c.videoEffect.denoiseLevel=10*L.smoothnessLevel,c.videoEffect.denoiseLevel<.1&&(c.videoEffect.denoiseLevel=.1),$.setDenoiseLevel(c.videoEffect.denoiseLevel)),void 0!==L.lighteningLevel&&(Object(g.checkValidFloatNumber)(L.lighteningLevel,"lighteningLevel",0,1),c.videoEffect.lightLevel=L.lighteningLevel/2,c.videoEffect.lightLevel<.01&&(c.videoEffect.lightLevel=.01),$.setLightLevel(c.videoEffect.lightLevel)),void 0!==L.rednessLevel&&(Object(g.checkValidFloatNumber)(L.rednessLevel,"rednessLevel",0,1),c.videoEffect.rednessLevel=L.rednessLevel,c.videoEffect.rednessLevel<.01&&(c.videoEffect.rednessLevel=.01),$.setRednessLevel(c.videoEffect.rednessLevel)),void 0===L.lighteningContrastLevel){ce.next=29;break}if(0===L.lighteningContrastLevel||1===L.lighteningContrastLevel||2===L.lighteningContrastLevel){ce.next=27;break}throw new Error("Invalid lighteningContrastLevel: The value should be 0, 1 or 2.");case 27:c.videoEffect.lighteningContrastLevel=parseFloat(L.lighteningContrastLevel),$.setContrastLevel(c.videoEffect.lighteningContrastLevel);case 29:case"end":return ce.stop()}},d)})),function(d,T){return z.apply(this,arguments)})},restoreVideoEffect:function(c){return c.videoEffect.enableBeauty?c._enableEffect():Promise.resolve()},disableVideoEffect:function(c){return c._releaseEffect?c._releaseEffect():Promise.resolve()},applyEffectInPlayer:function(c){c.videoEffect.enableBeauty&&c.videoEffect.canvas&&c._showEffectInLocalPlayer()},removeEffectFromLocalPlayer:function(c){c._removeEffectFromLocalPlayer()},replaceWithCanvasTrack:function(c){return c.videoEffect.enableBeauty?c._replaceWithCanvasTrack():Promise.resolve()},checkVideoEffectEnabled:function(c){return!!(c.videoEffect.enableBeauty&&c.videoEffect&&c.videoEffect.videoContextInited)&&(y.default.error("Operation not permitted: ".concat("VIDEO_EFFECT_ENABLED")),"VIDEO_EFFECT_ENABLED")}}},function(se,ee){function x(I,C,w,b,D,m,R){try{var f=I[m](R),g=f.value}catch(y){return void w(y)}f.done?C(g):Promise.resolve(g).then(b,D)}se.exports=function(I){return function(){var C=this,w=arguments;return new Promise(function(b,D){var m=I.apply(C,w);function R(g){x(m,b,D,R,f,"next",g)}function f(g){x(m,b,D,R,f,"throw",g)}R(void 0)})}}},function(se,ee,x){"use strict";var I=x(38),C=Object.prototype.toString;function w(f){return"[object Array]"===C.call(f)}function b(f){return void 0===f}function D(f){return null!==f&&"object"==typeof f}function m(f){return"[object Function]"===C.call(f)}function R(f,g){if(null!=f)if("object"!=typeof f&&(f=[f]),w(f))for(var y=0,M=f.length;y<M;y++)g.call(null,f[y],y,f);else for(var j in f)Object.prototype.hasOwnProperty.call(f,j)&&g.call(null,f[j],j,f)}se.exports={isArray:w,isArrayBuffer:function(f){return"[object ArrayBuffer]"===C.call(f)},isBuffer:function(f){return null!==f&&!b(f)&&null!==f.constructor&&!b(f.constructor)&&"function"==typeof f.constructor.isBuffer&&f.constructor.isBuffer(f)},isFormData:function(f){return"undefined"!=typeof FormData&&f instanceof FormData},isArrayBufferView:function(f){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(f):f&&f.buffer&&f.buffer instanceof ArrayBuffer},isString:function(f){return"string"==typeof f},isNumber:function(f){return"number"==typeof f},isObject:D,isUndefined:b,isDate:function(f){return"[object Date]"===C.call(f)},isFile:function(f){return"[object File]"===C.call(f)},isBlob:function(f){return"[object Blob]"===C.call(f)},isFunction:m,isStream:function(f){return D(f)&&m(f.pipe)},isURLSearchParams:function(f){return"undefined"!=typeof URLSearchParams&&f instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:R,merge:function f(){var g={};function y(A,E){g[E]="object"==typeof g[E]&&"object"==typeof A?f(g[E],A):A}for(var M=0,j=arguments.length;M<j;M++)R(arguments[M],y);return g},deepMerge:function f(){var g={};function y(A,E){g[E]="object"==typeof g[E]&&"object"==typeof A?f(g[E],A):"object"==typeof A?f({},A):A}for(var M=0,j=arguments.length;M<j;M++)R(arguments[M],y);return g},extend:function(f,g,y){return R(g,function(M,j){f[j]=y&&"function"==typeof M?I(M,y):M}),f},trim:function(f){return f.replace(/^\s*/,"").replace(/\s*$/,"")}}},function(se,ee,x){"use strict";x.d(ee,"a",function(){return f});var I=x(7),C=x.n(I),w=x(8),b=x(0),D=x(4);function R(g,y){(null==y||y>g.length)&&(y=g.length);for(var M=0,j=new Array(y);M<y;M++)j[M]=g[M];return j}var f=new function(){var g=Object(w.b)();return g.devicesHistory={},g.states={UNINIT:"UNINIT",INITING:"INITING",INITED:"INITED"},g.state=g.states.UNINIT,g.deviceStates={ACTIVE:"ACTIVE",INACTIVE:"INACTIVE"},g.deviceReloadTimer=null,g._init=function(y,M){g.state=g.states.INITING,g.devicesHistory={},g._reloadDevicesInfo(function(){g.state=g.states.INITED,g.dispatchEvent({type:"inited"}),y&&y()},function(j){b.default.warning("Device Detection functionality cannot start properly."),g.state=g.states.UNINIT,M&&M(j)})},g._enumerateDevices=function(y,M){if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return b.default.warning("enumerateDevices() not supported."),M&&M("enumerateDevices() not supported");navigator.mediaDevices.enumerateDevices().then(function(j){y&&setTimeout(function(){y(j)},0)}).catch(function(j){M&&M(j)})},g._reloadDevicesInfo=function(y,M){var j=[];g._enumerateDevices(function(A){var E=Date.now();for(var F in A.forEach(function(H){var O=g.devicesHistory[H.deviceId];if((O?O.state:g.deviceStates.INACTIVE)!=g.deviceStates.ACTIVE){var J=O||{initAt:E};J.device=H,J.state=g.deviceStates.ACTIVE,j.push(J),g.devicesHistory[H.deviceId]=J}g.devicesHistory[H.deviceId].lastReloadAt=E}),g.devicesHistory){var N=g.devicesHistory[F];N&&N.state==g.deviceStates.ACTIVE&&N.lastReloadAt!==E&&(N.state=g.deviceStates.INACTIVE,j.push(N)),N.lastReloadAt=E}g.state==g.states.INITED&&j.forEach(function(H){var O=C()({},H);switch(H.device.kind){case"audioinput":O.type="recordingDeviceChanged";break;case"audiooutput":O.type="playoutDeviceChanged";break;case"videoinput":O.type="cameraChanged";break;default:b.default.warning("Unknown device change",O),O.type="unknownDeviceChanged"}g.dispatchEvent(O)}),y&&y()},M)},g.getDeviceById=function(y,M,j){g.getDevices(function(A){for(var E=0;E<A.length;E++){var F=A[E];if(F&&F.deviceId===y)return M&&M(F)}return j&&j()})},g.searchDeviceNameById=function(y){var M=g.devicesHistory[y];return M?M.device.label||M.device.deviceId:null},g.getDevices=function(y,M){g._enumerateDevices(y,function(j){M&&M(j.name+": "+j.message)})},g.getVideoCameraIdByLabel=function(y,M,j){g.getCameras(function(A){var E,F=function m(g){if("undefined"==typeof Symbol||null==g[Symbol.iterator]){if(Array.isArray(g)||(g=function(N,H){if(N){if("string"==typeof N)return R(N,H);var O=Object.prototype.toString.call(N).slice(8,-1);if("Object"===O&&N.constructor&&(O=N.constructor.name),"Map"===O||"Set"===O)return Array.from(O);if("Arguments"===O||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(O))return R(N,H)}}(g))){var y=0,M=function(){};return{s:M,n:function(){return y>=g.length?{done:!0}:{done:!1,value:g[y++]}},e:function(N){throw N},f:M}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var j,A,E=!0,F=!1;return{s:function(){j=g[Symbol.iterator]()},n:function(){var N=j.next();return E=N.done,N},e:function(N){F=!0,A=N},f:function(){try{E||null==j.return||j.return()}finally{if(F)throw A}}}}(A);try{for(F.s();!(E=F.n()).done;){var N=E.value;if(N.label===y)return M&&M(N.deviceId)}}catch(H){F.e(H)}finally{F.f()}return j&&j(D.default.NOT_FIND_DEVICE_BY_LABEL)},j)},g.getRecordingDevices=function(y,M){return g._enumerateDevices(function(j){var A=j.filter(function(E){return"audioinput"==E.kind});y&&y(A)},function(j){M&&M(j)})},g.getPlayoutDevices=function(y,M){return g._enumerateDevices(function(j){var A=j.filter(function(E){return"audiooutput"==E.kind});y&&y(A)},function(j){M&&M(j)})},g.getCameras=function(y,M){return g._enumerateDevices(function(j){var A=j.filter(function(E){return"videoinput"==E.kind});y&&y(A)},function(j){M&&M(j)})},g._init(function(){navigator.mediaDevices&&navigator.mediaDevices.addEventListener&&navigator.mediaDevices.addEventListener("devicechange",function(){g._reloadDevicesInfo()}),g.deviceReloadTimer=setInterval(g._reloadDevicesInfo,5e3)}),g}},function(se,ee,x){"use strict";x.r(ee),x.d(ee,"_getReconnectCSTimer",function(){return _}),x.d(ee,"_setClientConnectionStateRecord",function(){return u}),x.d(ee,"getGatewayList",function(){return S}),x.d(ee,"getUserAccount",function(){return z});var I=x(11),C=x.n(I),w=x(12),b=x.n(w),D=x(17),m=x.n(D),R=x(2),f=(x(5),x(0)),g=x(14),y=x(1),M=x(4),j=function(d,T){var L=!1,$=0,Z=Object(R.getParameter)("PROXY_CS"),ce=Object(R.getParameter)("CHOOSE_SERVER_FRAGEMENT_LENGTH"),re=0,U={command:"convergeAllocateEdge",sid:d.sid,appId:d.appId,token:d.token,uid:d.uid,cname:d.cname,ts:Math.floor(Date.now()/1e3),version:R.VERSION,seq:0,requestId:1},V=function(pe){var oe=(new Date).getTime();A("https://"+pe+"/api/v1",U,function(de,ye){if(de)return f.default.debug("["+d.clientId+"] Request proxy server failed: ",de),$++,y.report.requestProxyAppCenter(d.sid,{lts:oe,succ:!1,APAddr:pe,workerManagerList:null,ec:JSON.stringify(de),response:JSON.stringify({err:de,res:ye})}),$>=Z.length&&T&&T("Get proxy server failed: request all failed"),void(!($%ce)&&$<Z.length&&(re++,q()));if(!L)if((ye=JSON.parse(ye)).json_body){var Te=JSON.parse(ye.json_body);if(f.default.debug("["+d.clientId+"] App return:",Te.servers),200!==Te.code)$++,f.default.debug("["+d.clientId+"] "+(de="Get proxy server failed: response code ["+Te.code+"], reason [ "+Te.reason+"]")),y.report.requestProxyAppCenter(d.sid,{lts:oe,succ:!1,APAddr:pe,workerManagerList:null,ec:de,response:JSON.stringify({err:de,res:ye})}),$>=Z.length&&T&&T(de),!($%ce)&&$<Z.length&&(re++,q());else{L=!0;var Re=F(Te.servers);y.report.requestProxyAppCenter(d.sid,{lts:oe,succ:!0,APAddr:pe,workerManagerList:JSON.stringify(Re),ec:null,response:JSON.stringify({res:ye})}),T&&T(null,Re)}}else f.default.debug("["+d.clientId+"] Get proxy server failed: no json_body"),y.report.requestProxyAppCenter(d.sid,{lts:oe,succ:!1,APAddr:pe,workerManagerList:null,ec:"Get proxy server failed: no json_body",response:JSON.stringify({res:ye})})})},q=function(){for(var pe=re*ce,oe=pe;oe<Math.min(Z.length,pe+ce);oe++)V(Z[oe])};q()},A=function(d,T,L){var $={service_name:"webrtc_proxy",json_body:JSON.stringify(T)};Object(g.post)(d,$,function(Z){L&&L(null,Z)},function(Z){L&&L(Z)},{"X-Packet-Service-Type":0,"X-Packet-URI":61})},F=function(d){if(!(d&&[]instanceof Array))return[];var T=[];return d.forEach(function(L){var $;L.address&&L.tcp?(L.address.match(/^[\.\:\d]+$/)?$="".concat(L.address.replace(/[^\d]/g,"-"),".edge.agora.io"):(f.default.info("["+joinInfo.clientId+"] "+"Cannot recognized as IP address ".concat(L.address,". Used As Host instead")),$="".concat(L.address,":").concat(L.tcp)),T.push($)):f.default.error("["+joinInfo.clientId+"] Invalid address format ",L)}),T},N=x(21),H=function(d,T,L,$){var Z=Object(R.getParameter)("WEBCS_DOMAIN").concat(Object(R.getParameter)("WEBCS_DOMAIN_BACKUP_LIST")),ce=Object(R.getParameter)("PROXY_SERVER_TYPE3");Z=Z.map(function(ye,Te){return"".concat(ce[(Te+1)%ce.length],"/ap/?url=").concat(ye)});var re,U=0,V=!0,q=Object(R.getParameter)("CHOOSE_SERVER_FRAGEMENT_LENGTH"),pe=0,oe=function(ye){var Te,Re,Ce,Ee,Le,p,le,k,Ae,Ge;Te=d,Re=ye,Ce=T,Ee=function(Te,Re){Te?(U++,f.default.error("[".concat(T.clientId,"] request ").concat(ye," failed: ").concat(Te)),Te&&-1===M.JOIN_PROXY_RETRY_LIST.indexOf(Te)&&(re=Te),U===Z.length&&(re||(re="RETRYABLE_ERROR"),L(re)),!(U%q)&&U<Z.length&&(pe++,de())):V&&(/sd-rtn/.test(Re.gatewayServers.gateway_addr[0])?Object(R.setParameter)("NGINX",ce[0]):Object(R.setParameter)("NGINX",ce[1]),V=!1,L(null,Re))},Le=$,p=Date.now(),le=function(Ve,Fe){try{y.report.joinChooseServer2(Ce.sid,{lts:p,succ:!Ve,csAddr:Re,serverList:Fe&&Fe.gateway_addr,cid:Fe&&Fe.cid+"",uid:Fe&&Fe.uid+"",ec:Ve,chooseServerIp:Fe&&Fe.detail&&Fe.detail[502]})}catch(We){}},k=function(Ve,Fe){var We=Date.now();try{y.report.joinWebProxyAP({lts:We,sid:Ce.sid,cname:Ce.cname,cid:Ce.cid,uid:Ce.uid,sucess:Ve?-1:1,elapse:We-p,eventType:Te,apServerAddr:Re,turnServerAddrList:JSON.stringify(Fe),errorCode:Ve||"0"})}catch(ie){}},Ae=Object(R.getParameter)("AREA_SETTING").reduce(function(Ve,Fe,We){var ie=Object(N.getAreaCodeByArea)(Fe);return ie?0===We?ie:"".concat(Ve,",").concat(ie):Ve},""),Ge={appid:Ce.token,client_ts:Date.now(),opid:133,sid:Ce.sid,request_bodies:[{uri:22,buffer:{cname:Ce.cname,detail:{11:Ae,6:Ce.stringUid},key:Ce.token,service_ids:[11,Le?20:18],uid:Ce.uid||0}}]},Re="https://".concat(Re,"/api/v2/transpond/webrtc?v=2"),Object(g.postFormData)(Re,Ge,function(Ve){var Fe=function(ve){return new RegExp(/10102\d{2}$/).test(ve)?"NO_SERVICE_AVAILABLE":M.APErrorCode[ve]||ve};try{var We,ie,h=JSON.parse(Ve);if(30===(h=h.response_body)[0].uri&&0!==h[0].buffer.code){var Q=Fe(h[0].buffer.code);return k(Q,h),Ee(Q)}if(4096===h[0].buffer.flag?(ie=h[0].buffer,We=h[1].buffer):(ie=h[1].buffer,We=h[0].buffer),0!==We.code)return Q=Fe(We.code),f.default.error("[".concat(Ce.clientId,"] requestProxyServer failed: ").concat(Q)),k(Q,We),Ee(Q);if(!We.edges_services||!We.edges_services instanceof Array)return k("UNEXPECTED_ERROR",We),Ee("UNEXPECTED_ERROR");var ae=Object(R.getParameter)("GATEWAY_DOMAINS"),fe=0;if(Re.indexOf(ae[1])>-1&&(fe=1),0===We.edges_services.length)return k("EMPTY_PROXY_LIST",We),Ee("EMPTY_PROXY_LIST");var me=We.edges_services.map(function(ve){if(ve.ip)return ve.ip=Le?"".concat(ve.ip.replace(/[^\d]/g,"-"),".").concat(ae[fe++%ae.length]):"".concat(ve.ip),ve});if(k(null,me),0!==ie.code)return Q=Fe(ie.code),f.default.error("[".concat(Ce.clientId,"] requestChooseServer failed: ").concat(Q)),le(Q),Ee(Q);var K=[];if(ae=Object(R.getParameter)("GATEWAY_DOMAINS"),fe=0,Re.indexOf(ae[1])>-1&&(fe=1),ie.edges_services.forEach(function(ve){var be;if(ve.ip&&ve.port){if(!ve.ip.match(/^[\.\:\d]+$/))return f.default.info("["+Ce.clientId+"] "+"Cannot recognized as IP address ".concat(ve.ip,". Used As Host instead")),void le("UNEXPECTED_IP");be="".concat(ve.ip.replace(/[^\d]/g,"-"),".").concat(ae[fe++%ae.length]);var _e=Object(R.getParameter)("PROXY_SERVER_TYPE3");be=/sd-rtn/.test(Re)?"".concat(_e[0],"/ws/?h=").concat(be,"&p=").concat(ve.port):"".concat(_e[1],"/ws/?h=").concat(be,"&p=").concat(ve.port),K.push(be)}else f.default.error("["+Ce.clientId+"] Invalid address format ",ve)}),!K.length)return f.default.error("["+Ce.clientId+"] Empty Address response",h),le("EMPTY_ADDRESS_RESPONSE"),Ee("EMPTY_ADDRESS_RESPONSE");ie.ticket=ie.cert;var ge={gateway_addr:K,uid:ie.uid,cid:ie.cid,vid:ie.detail&&ie.detail[8],res:ie,detail:h.detail};le(null,ge),Ee(null,{gatewayServers:ge,turnServers:me})}catch(ve){return f.default.error("[".concat(Ce.clientId,"] requestProxyServer failed with unexpected body "),ve),k("UNEXPECTED_ERROR"),Ee("UNEXPECTED_ERROR")}},function(Ve,Fe){"timeout"===Ve.type?(k("REQUEST_PROXY_SERVER_TIME_OUT"),Ee("REQUEST_PROXY_SERVER_TIME_OUT")):(k("REQUEST_PROXY_SERVER_FAILED"),Ee("REQUEST_PROXY_SERVER_FAILED"))})},de=function(){for(var ye=pe*q,Te=ye;Te<Math.min(Z.length,ye+q);Te++)oe(Z[Te])};de()},O=x(13),J=x(29),te=x.n(J),Y=x(30),ne={},G={},_=function(d){return ne[d]},u=function(d,T){G[d]=T},B=function(d,T,L,$,Z,ce){var re=(new Date).getTime(),U=T,V="";T.multiIP&&T.multiIP.gateway_ip&&(V={vocs_ip:[T.multiIP.uni_lbs_ip],vos_ip:[T.multiIP.gateway_ip]});var q=Object(R.getParameter)("AREA_SETTING").reduce(function(oe,de,ye){var Te=Object(N.getAreaCodeByArea)(de);return Te?0===ye?Te:"".concat(oe,",").concat(Te):oe},""),pe={appid:T.token,opid:133,client_ts:+new Date,sid:T.sid,request_bodies:[{uri:22,buffer:{cname:T.cname,detail:{5:V?JSON.stringify(V):void 0,6:T.stringUid,11:q},key:T.token,service_ids:[11],uid:T.uid||0}}]};Object(g.postFormData)(d,pe,function(oe){try{var de=JSON.parse(oe),ye=(de=de.response_body[0].buffer).code}catch(le){var Te="requestChooseServer failed with unexpected body "+oe;return f.default.error("["+U.clientId+"]",Te),$(Te,void 0,void 0,ce)}if(ye)return Le=new RegExp(/10102\d{2}$/).test(ye)?"NO_SERVICE_AVAILABLE":M.APErrorCode[de.code]||ye,y.report.joinChooseServer(T.sid,{lts:re,succ:!1,csAddr:d,serverList:null,ec:Le,chooseServerIp:de&&de.detail&&de.detail[502]}),$("Get server node failed ["+Le+"]",d,Le,ce);var Re=[],Ce=Object(R.getParameter)("GATEWAY_DOMAINS"),Ee=0;if(d.indexOf(Ce[1])>-1&&(Ee=1),de.edges_services.forEach(function(le){var k;le.ip&&le.port?(le.ip.match(/^[\.\:\d]+$/)?k="".concat(le.ip.replace(/[^\d]/g,"-"),".").concat(Ce[Ee++%Ce.length],":").concat(le.port):(f.default.info("["+U.clientId+"] "+"Cannot recognized as IP address ".concat(le.ip,". Used As Host instead")),k="".concat(le.ip,":").concat(le.port)),Re.push(k)):f.default.error("["+U.clientId+"] Invalid address format ",le)}),!Re.length){f.default.error("["+U.clientId+"] Empty Address response",de);var Le="EMPTY_ADDRESS_RESPONSE";return y.report.joinChooseServer(T.sid,{lts:re,succ:!1,csAddr:d,serverList:null,ec:Le,chooseServerIp:de&&de.detail&&de.detail[502]}),$("Get server node failed ["+Le+"]",d,Le,ce)}return de.ticket=de.cert,L({gateway_addr:Re,uid:de.uid,cid:de.cid,vid:de.detail&&de.detail[8],res:de,uni_lbs_ip:de.detail},d)},function(oe,de){"timeout"===oe.type?(y.report.joinChooseServer(T.sid,{lts:re,succ:!1,csAddr:de,serverList:null,ec:"timeout"}),$("Connect choose server timeout",de,void 0,ce)):(y.report.joinChooseServer(T.sid,{lts:re,succ:!1,csAddr:de,serverList:null,ec:oe.httpErrorCode||"server_wrong"}),$("Connect choose server error",de,void 0,ce))})},S=function(d,T,L){var $=!1,Z=null,ce=1,re=1,U=d.clientId,V=function pe(oe,de){if(!$){var ye=[];!function(Te,Re,Ce){var Ee,Le=(new Date).getTime(),p=!1,le=0,k=0,Ae=Object(R.getParameter)("WEBCS_DOMAIN"),Ge=Ae.length,Ve=Object(R.getParameter)("WEBCS_DOMAIN_BACKUP_LIST"),Fe=Ve.length,We=Object(R.getParameter)("CHOOSE_SERVER_FRAGEMENT_LENGTH"),ie=0,h=0,Q=function(ge,ve){var be;try{be=ge.res.detail[8]}catch(xe){f.default.debug("["+Te.clientId+"] get vid failed",xe)}if(p)y.report.joinChooseServer(Te.sid,{lts:Le,succ:!0,csAddr:ve,serverList:ge.gateway_addr,cid:ge.cid+"",uid:ge.uid+"",ec:null,vid:be,chooseServerIp:ge.res&&ge.res.detail&&ge.res.detail[502]},!1);else{if(clearTimeout(K),p=!0,Te.proxyServer)for(var _e=ge.gateway_addr,Pe=0;Pe<_e.length;Pe++){var ke=_e[Pe].split(":");ge.gateway_addr[Pe]=Te.proxyServer+"/ws/?h="+ke[0]+"&p="+ke[1]}(function(Te){$=!0,ye=Te,clearTimeout(Z),G[U]!==O.a.DISCONNECTED&&G[U]!==O.a.DISCONNECTING?de&&de(ye,null):f.default.debug("[".concat(d.clientId,"] Request gateway list success when connection state is ").concat(G[U]))})(ge),y.report.joinChooseServer(Te.sid,{lts:Le,succ:!0,csAddr:ve,serverList:ge.gateway_addr,cid:ge.cid+"",uid:ge.uid+"",ec:null,vid:be,chooseServerIp:ge.res&&ge.res.detail&&ge.res.detail[502]},!0)}},ae=function(ge,ve,be,_e){"domain"===_e&&le++,"backup"===_e&&k++,f.default.error("["+Te.clientId+"]",ge,ve,be),be&&-1===M.JOIN_CS_RETRY_LIST.indexOf(be)&&(Ee=be),le===Ge&&k===Fe&&function(Te){if(Te)return f.default.info("["+d.clientId+"] Join failed: "+Te),void(L&&L(Te));if(G[U]===O.a.DISCONNECTED||G[U]===O.a.DISCONNECTING)return f.default.debug("[".concat(d.clientId,"] Request gateway list falied when connection state is ").concat(G[U])),void(L&&L("OPERATION_ABORT"));f.default.debug("["+d.clientId+"] Request gateway list will be restart in "+ce+"s"),Z=setTimeout(function(){pe(oe,de)},1e3*ce),ne[U]=Z;var Re=Object(R.getParameter)("AP_BACKOFF_MAX_TIME");ce=ce>=Re?Re:2*ce}(Ee),"domain"===_e&&!(le%We)&&le<Ge&&(ie++,fe()),"backup"===_e&&!(k%We)&&k<Fe&&(h++,me())},fe=function ge(){for(var ve=ie*We,be=ve;be<Math.min(Ge,ve+We);++be){var _e;if("string"==typeof Ae[be]){var Pe=Ae[be];_e=Te.proxyServer?"https://".concat(Te.proxyServer,"/ap/?url=").concat(Pe+"/api/v2/transpond/webrtc?v=2"):"https://".concat(Pe,"/api/v2/transpond/webrtc?v=2");var ke=Object(N.getAreaCodeByWebCS)(Pe);f.default.debug("["+Te.clientId+"] "+"Connect to choose_server: ".concat(_e,", ").concat(ke)),B(_e,Te,Q,ae,0,"domain")}else le++,f.default.error("["+Te.clientId+"] Invalid Host",Ae[be]),be===ve+We-1&&be<Ge-1-1&&(ie++,ge())}};fe();var me=function ge(){if(!p)for(var ve=h*We,be=ve;be<Math.min(Fe,ve+We);be++){var _e;if("string"==typeof Ve[be]){var Pe=Ve[be];_e=Te.proxyServer?"https://".concat(Te.proxyServer,"/ap/?url=").concat(Pe+"/api/v2/transpond/webrtc?v=2"):"https://".concat(Pe,"/api/v2/transpond/webrtc?v=2");var ke=Object(N.getAreaCodeByWebCS)(Pe);f.default.debug("["+Te.clientId+"] "+"Connect to backup_choose_server: ".concat(_e,", ").concat(ke)),B(_e,Te,Q,ae,0,"backup")}else k++,f.default.error("["+Te.clientId+"] Invalid Host",Ve[be]),be===ve+We-1&&be<Ve-1-1&&(ie++,ge())}},K=setTimeout(me,1e3)}(d)}},q=function pe(){var oe,de;de=function(oe,de){if(oe){f.default.debug("["+d.clientId+"]",oe),f.default.debug("["+d.clientId+"] Request proxy will be restart in "+re+"s"),Z=setTimeout(function(){pe()},1e3*re),ne[U]=Z;var ye=Object(R.getParameter)("AP_BACKOFF_MAX_TIME");re=re>=ye?ye:2*re}else{clearTimeout(Z);var Te=de.address;d.proxyServer=Te;var Re={mode:"manual",url:de.address,tcpport:de.serverResponse.tcpport||"3433",udpport:de.serverResponse.udpport||"3478",username:de.serverResponse.username||"test",credential:de.serverResponse.password||Object(R.getParameter)("TURN_SERVER_PASSWORD"),forceturn:!0};Re.tcpport+="",Re.udpport+="",d.turnServers=[],d.turnServers.push(Re),y.report.setProxyServer(Te),f.default.setProxyServer(Te),V(Te,T)}},j(oe=d,function(ye,Te){if(ye)return de&&de(ye);f.default.debug("["+oe.clientId+"] getProxyServerList: ",Te),function(d,T,L){var $=!1,Z=0,ce={command:"request",gatewayType:"http",appId:d.appId,cname:d.cname,uid:d.uid+"",sdkVersion:"2.3.1",sid:d.sid,seq:1,ts:+new Date,requestId:3,clientRequest:{appId:d.appId,cname:d.cname,uid:d.uid+"",sid:d.sid}};T.map(function(re){var V,q,pe,U=(new Date).getTime();V="https://"+re+":4000/v2/machine",q=ce,pe=function(V,q){if(V)return f.default.debug("["+d.clientId+"] Request worker manager failed: ",V),Z++,y.report.requestProxyWorkerManager(d.sid,{lts:U,succ:!1,workerManagerAddr:re,ec:JSON.stringify(V),response:JSON.stringify({res:q})}),void(Z>=T.length&&L&&L("requeet worker manager server failed: request failed"));if(!$){if(!(q=JSON.parse(q)).serverResponse)return L&&L("requeet worker manager server failed: serverResponse is undefined");$=!0,y.report.requestProxyWorkerManager(d.sid,{lts:U,succ:!0,workerManagerAddr:re,ec:JSON.stringify(V),response:JSON.stringify({res:q})}),L&&L(null,{address:re,serverResponse:q.serverResponse})}},Object(g.post)(V,q,function(oe){pe&&pe(null,oe)},function(oe){pe&&pe(oe)})})}(oe,Te,de)})};d.useProxyServer?1==d.proxyServerType?q():2==d.proxyServerType?function pe(){var oe,de;de=function(oe,de){if(oe)return f.default.debug("["+d.clientId+"]",oe),f.default.debug("["+d.clientId+"] Request proxy will be restart in "+re+"s"),Z=setTimeout(function(){pe()},1e3*re),ne[U]=Z,void(re=re>=3600?3600:2*re);clearTimeout(Z);var ye=Object(R.getParameter)("PROXY_SERVER_TYPE2");d.proxyServer=ye;var Te={mode:"manual",url:de.address,tcpport:de.serverResponse.tcpport||"3433",udpport:de.serverResponse.udpport||"3478",username:de.serverResponse.username||"test",credential:de.serverResponse.password||"111111",forceturn:!0};Te.tcpport+="",Te.udpport+="",d.turnServers=[],d.turnServers.push(Te),y.report.setProxyServer(ye),f.default.setProxyServer(ye),V(ye,T)},j(oe=d,function(ye,Te){return ye?de&&de(ye):(f.default.debug("["+oe.clientId+"] getProxyServerList: ",Te),de&&de(null,{address:Te[0],serverResponse:{tcpport:"443",udpport:"3478",username:"test",password:"111111"}}))})}():3==d.proxyServerType?function pe(){H("proxy3",d,function(oe,de){if(oe)return"RETRYABLE_ERROR"!==oe?L&&L(oe):(f.default.debug("["+d.clientId+"]",oe),f.default.debug("["+d.clientId+"] Request proxy will be restart in "+re+"s"),Z=setTimeout(function(){pe()},1e3*re),ne[U]=Z,void(re=re>=3600?3600:2*re));var ye=de.gatewayServers,Te=de.turnServers;clearTimeout(Z);var Re=Object(R.getParameter)("NGINX");d.proxyServer=Re,d.turnServers=[];var Ce=Object(Y.randomString)();Te.map(function(Ee){var Le={mode:"manual",url:Ee.ip,tcpport:"",udpport:Ee.port||"3478",username:Ee.username||Ce,credential:Ee.password||te()(Ce).toString(),forceturn:!0};Le.tcpport+="",Le.udpport+="",d.turnServers.push(Le)}),y.report.setProxyServer(Re),f.default.setProxyServer(Re),T(ye)})}():4==d.proxyServerType?function pe(){H("proxy4",d,function(oe,de){if(oe)return"RETRYABLE_ERROR"!==oe?L&&L(oe):(f.default.debug("["+d.clientId+"]",oe),f.default.debug("["+d.clientId+"] Request proxy will be restart in "+re+"s"),Z=setTimeout(function(){pe()},1e3*re),ne[U]=Z,void(re=re>=3600?3600:2*re));var ye=de.gatewayServers,Te=de.turnServers;clearTimeout(Z);var Re=Object(R.getParameter)("NGINX");d.proxyServer=Re,d.turnServers=[];var Ce=Object(Y.randomString)();Te.map(function(Ee){var Le={mode:"manual",url:Ee.ip,tcpport:Ee.port||"443",udpport:"",username:Ee.username||Ce,credential:Ee.password||te()(Ce).toString(),forceturn:!1};Le.tcpport+="",Le.udpport+="",d.turnServers.push(Le)}),y.report.setProxyServer(Re),f.default.setProxyServer(Re),T(ye)})}():5==d.proxyServerType?function pe(){H("proxy5",d,function(oe,de){if(oe)return"RETRYABLE_ERROR"!==oe?L&&L(oe):(f.default.debug("["+d.clientId+"]",oe),f.default.debug("["+d.clientId+"] Request proxy will be restart in "+re+"s"),Z=setTimeout(function(){pe()},1e3*re),ne[U]=Z,void(re=re>=3600?3600:2*re));var ye=de.gatewayServers,Te=de.turnServers;clearTimeout(Z);var Re=Object(R.getParameter)("NGINX");d.proxyServer=Re,d.turnServers=[];var Ce=Object(Y.randomString)();Te.map(function(Ee){var Le={mode:"manual",url:Ee.ip,tcpport:Ee.port||"443",udpport:"",username:Ee.username||Ce,credential:Ee.password||te()(Ce).toString(),forceturn:!1,useTurns:!0};Le.tcpport+="",Le.udpport+="",d.turnServers.push(Le)}),y.report.setProxyServer(Re),f.default.setProxyServer(Re),T(ye)},!0)}():q():V(null,T)},c=function(d,T,L,$,Z){var ce=Date.now(),re={sid:T.sid,opid:10,appid:T.appId,string_uid:$=$||T.stringUid};return new Promise(function(U,V){Object(g.post)(d+"".concat(-1===d.indexOf("?")?"?":"&","action=stringuid"),re,function(q){try{var pe=JSON.parse(q),oe=pe.code}catch(Ce){var de="requestUserAccount failed with unexpected body "+q;return f.default.error("["+T.clientId+"]",de),V({retryable:!0,info:de,url:d,error:"UNEXPECTED_ERROR"}),L&&L.dispatchEvent({type:"error",reason:"USER_ACCOUNT_BODY_NOT_JSON"}),void y.report.reqUserAccount(re.sid,{lts:ce,success:!1,serverAddress:d,stringUid:$,uid:null,extend:q,errorCode:"USER_ACCOUNT_BODY_NOT_JSON"})}if(oe){var ye=!1;return"INTERNAL_SERVER_ERROR"===(Re=M.StringUidErrorCode[pe.code%1e4]||"REQ_ACCOUNT_ERR_".concat(oe))&&(ye=!0),L&&L.dispatchEvent({type:"error",reason:Re}),y.report.reqUserAccount(re.sid,{lts:ce,success:!1,serverAddress:d,stringUid:$,uid:null,errorCode:Re,extend:re}),V({retryable:ye,info:de="Get String Uid Failed ["+Re+"]",url:d,error:Re})}var Te=pe.uid;if(!(Te>0&&Te<Math.pow(2,32))){f.default.error("["+T.clientId+"] "+"Invalid Uint Uid ".concat($," => ").concat(Te),pe);var Re="INVALID_UINT_UID_".concat(Te);return L&&L.dispatchEvent({type:"error",reason:Re}),y.report.reqUserAccount(re.sid,{lts:ce,success:!1,serverAddress:d,stringUid:$,uid:null,errorCode:Re,extend:re}),V({retryable:!0,error:Re,info:"Get String Uid failed ["+Re+"]",url:d})}U({uid:Te,url:d}),y.report.reqUserAccount(re.sid,{lts:ce,success:!0,serverAddress:d,stringUid:$,uid:Te,errorCode:null,extend:re})},function(q,pe){if("timeout"===q.type){var oe="USER_ACCOUNT_TIMEOUT";L&&L.dispatchEvent({type:"error",reason:oe}),y.report.reqUserAccount(re.sid,{lts:ce,success:!1,serverAddress:pe,stringUid:$,uid:null,errorCode:oe,extend:re}),V({retryable:!0,info:oe,url:pe,error:oe})}else{var de="USER_ACCOUNT_SERVER_WRONG_".concat(q.type);L&&L.dispatchEvent({type:"error",reason:de}),y.report.reqUserAccount(re.sid,{lts:ce,success:!1,serverAddress:pe,stringUid:$,uid:null,errorCode:de,extend:re}),V({retryable:!0,info:de,url:pe,error:de})}},{"X-Packet-Service-Type":0,"X-Packet-URI":72})})},z=function(d,T,L){Date.now();var $,pe,Z=Object(R.getParameter)("ACCOUNT_REGISTER"),ce=!1,re=Object(R.getParameter)("ACCOUNT_REGISTER_RETRY_TIMEOUT"),U=null,V=null,q=new Promise((pe=m()(b.a.mark(function oe(de,ye){var Te,Re,Ce;return b.a.wrap(function(Ee){for(;;)switch(Ee.prev=Ee.next){case 0:U=de,V=ye,$=0;case 3:if(!($<Object(R.getParameter)("ACCOUNT_REGISTER_RETRY_COUNT_MAX"))){Ee.next=33;break}if(!ce){Ee.next=6;break}return Ee.abrupt("return");case 6:return Te=Z[$%Z.length],Re=d.proxyServer?"https://".concat(d.proxyServer,"/ap/?url=").concat(Te+"/api/v1"):"https://".concat(Te,"/api/v1"),Ee.prev=8,Ee.delegateYield(b.a.mark(function Le(){var p;return b.a.wrap(function(le){for(;;)switch(le.prev=le.next){case 0:return le.next=3,c(Re,d,T,L);case 3:if(p=le.sent,!ce){le.next=6;break}return le.abrupt("return",{v:void 0});case 6:ce=!0,setTimeout(function(){f.default.debug("Get UserAccount Successfully",p),U(p)},0);case 8:case"end":return le.stop()}},Le)})(),"t0",10);case 10:if(Ce=Ee.t0,"object"!==C()(Ce)){Ee.next=13;break}return Ee.abrupt("return",Ce.v);case 13:Ee.next=30;break;case 15:if(Ee.prev=15,Ee.t1=Ee.catch(8),!ce){Ee.next=19;break}return Ee.abrupt("return");case 19:if(!Ee.t1.retryable){Ee.next=27;break}return(re=Math.ceil(re*Object(R.getParameter)("ACCOUNT_REGISTER_RETRY_RATIO")))>Object(R.getParameter)("ACCOUNT_REGISTER_RETRY_TIMEOUT_MAX")&&(re=Object(R.getParameter)("ACCOUNT_REGISTER_RETRY_TIMEOUT_MAX")),f.default.error("".concat(Ee.t1.info," ").concat(Ee.t1.url," Will Fetch User Account in ").concat(re/1e3," seconds")),Ee.next=25,new Promise(function(Le){setTimeout(Le,re)});case 25:Ee.next=30;break;case 27:f.default.error("Get UserAccount Error: ".concat(Ee.t1.info," ").concat(Ee.t1.url),Ee.t1.error),ce=!0,V(Ee.t1.error);case 30:$++,Ee.next=3;break;case 33:case"end":return Ee.stop()}},oe,null,[[8,15]])})),function(oe,de){return pe.apply(this,arguments)}));return q.cancel=function(){ce||(ce=!0,V({info:"Request Cancelled",retryable:!1}))},q.isFinished=function(){return ce},q}},function(se,ee,x){"use strict";var I=this&&this.__spreadArrays||function(){for(var M=0,j=0,A=arguments.length;j<A;j++)M+=arguments[j].length;var E=Array(M),F=0;for(j=0;j<A;j++)for(var N=arguments[j],H=0,O=N.length;H<O;H++,F++)E[F]=N[H];return E},C=this&&this.__importDefault||function(M){return M&&M.__esModule?M:{default:M}};Object.defineProperty(ee,"__esModule",{value:!0});var w,b,M,D=C(x(0));(M=w||(w={})).CHINA="CHINA",M.ASIA="ASIA",M.NORTH_AMERICA="NORTH_AMERICA",M.EUROPE="EUROPE",M.JAPAN="JAPAN",M.INDIA="INDIA",M.OCEANIA="OCEANIA",M.SOUTH_AMERICA="SOUTH_AMERICA",M.AFRICA="AFRICA",M.OVERSEA="OVERSEA",M.GLOBAL="GLOBAL",ee.AREAS=w,function(M){M.CHINA="CN",M.ASIA="AS",M.NORTH_AMERICA="NA",M.EUROPE="EU",M.JAPAN="JP",M.INDIA="IN",M.OCEANIA="OC",M.SOUTH_AMERICA="SA",M.AFRICA="AF",M.OVERSEA="OVERSEA",M.GLOBAL="GLOBAL"}(b||(b={}));var m={ASIA:{CODE:b.ASIA,WEBCS_DOMAIN:["ap-web-1-asia.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-asia.agora.io"],PROXY_CS:["proxy-ap-web-asia.agora.io"],CDS_AP:["cds-ap-web-asia.agora.io","cds-ap-web-asia2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-asia.agora.io","sua-ap-web-asia2.agora.io"],UAP_AP:["uap-ap-web-asia.agora.io","uap-ap-web-asia2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-asia.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-asia.agora.io"],LOG_UPLOAD_SERVER:["logservice-asia.agora.io"],NGINX:["southeast-asia.webrtc-cloud-proxy.sd-rtn.com"]},NORTH_AMERICA:{CODE:b.NORTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-north-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-north-america.agora.io"],PROXY_CS:["proxy-ap-web-america.agora.io"],CDS_AP:["cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],UAP_AP:["uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-north-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-north-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-north-america.agora.io"],NGINX:["east-usa.webrtc-cloud-proxy.sd-rtn.com"]},EUROPE:{CODE:b.EUROPE,WEBCS_DOMAIN:["ap-web-1-europe.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-europe.agora.io"],PROXY_CS:["proxy-ap-web-europe.agora.io"],CDS_AP:["cds-ap-web-europe.agora.io","cds-ap-web-europe2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-europe.agora.io","sua-ap-web-europe.agora.io"],UAP_AP:["uap-ap-web-europe.agora.io","uap-ap-web-europe2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-europe.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-europe.agora.io"],LOG_UPLOAD_SERVER:["logservice-europe.agora.io"],NGINX:["europe.webrtc-cloud-proxy.sd-rtn.com"]},JAPAN:{CODE:b.JAPAN,WEBCS_DOMAIN:["ap-web-1-japan.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-japan.agora.io"],PROXY_CS:["proxy-ap-web-japan.agora.io"],CDS_AP:["cds-ap-web-japan.agora.io","cds-ap-web-japan2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-japan.agora.io","sua-ap-web-japan2.agora.io"],UAP_AP:["uap-ap-web-japan.agora.io","\tuap-ap-web-japan2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-japan.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-japan.agora.io"],LOG_UPLOAD_SERVER:["logservice-japan.agora.io"],NGINX:["japan.webrtc-cloud-proxy.sd-rtn.com"]},INDIA:{CODE:b.INDIA,WEBCS_DOMAIN:["ap-web-1-india.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-india.agora.io"],PROXY_CS:["proxy-ap-web-india.agora.io"],CDS_AP:["cds-ap-web-india.agora.io","cds-ap-web-india2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-india.agora.io","sua-ap-web-india2.agora.io"],UAP_AP:["uap-ap-web-india.agora.io","uap-ap-web-india2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-india.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-india.agora.io"],LOG_UPLOAD_SERVER:["logservice-india.agora.io"],NGINX:["india.webrtc-cloud-proxy.sd-rtn.com"]},OVERSEA:{CODE:b.OVERSEA,WEBCS_DOMAIN:["ap-web-1-oversea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oversea.agora.io"],PROXY_CS:["proxy-ap-web-oversea.agora.io"],CDS_AP:["cds-ap-web-oversea.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oversea.agora.io"],UAP_AP:["uap-ap-web-oversea.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oversea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oversea.agora.io"],LOG_UPLOAD_SERVER:["logservice-oversea.agora.io"],NGINX:["webrtc-cloud-proxy.agora.io"]},GLOBAL:{CODE:b.GLOBAL,WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-ap-web-3.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-ap-web-3.agora.io"],UAP_AP:["uap-ap-web-1.agora.io","uap-ap-web-3.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2.agora.io"],LOG_UPLOAD_SERVER:["logservice.agora.io"],NGINX:["webrtc-cloud-proxy.sd-rtn.com"]},OCEANIA:{CODE:b.OCEANIA,WEBCS_DOMAIN:["ap-web-1-oceania.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oceania.agora.io"],PROXY_CS:["proxy-ap-web-oceania.agora.io"],CDS_AP:["cds-ap-web-oceania.agora.io","cds-ap-web-oceania2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oceania.agora.io","sua-ap-web-oceania2.agora.io"],UAP_AP:["uap-ap-web-oceania.agora.io","uap-ap-web-oceania2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oceania.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oceania.agora.io"],LOG_UPLOAD_SERVER:["logservice-oceania.agora.io"],NGINX:["oceania.webrtc-cloud-proxy.sd-rtn.com"]},SOUTH_AMERICA:{CODE:b.SOUTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-south-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-south-america.agora.io"],PROXY_CS:["proxy-ap-web-south-america.agora.io"],CDS_AP:["cds-ap-web-south-america.agora.io","cds-ap-web-south-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-south-america.agora.io","sua-ap-web-south-america2.agora.io"],UAP_AP:["uap-ap-web-south-america.agora.io","uap-ap-web-south-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-south-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-south-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-america.agora.io"],NGINX:["south-america.webrtc-cloud-proxy.sd-rtn.com"]},AFRICA:{CODE:b.AFRICA,WEBCS_DOMAIN:["ap-web-1-africa.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-africa.agora.io"],PROXY_CS:["proxy-ap-web-africa.agora.io"],CDS_AP:["cds-ap-web-africa.agora.io","cds-ap-web-africa2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-africa.agora.io","sua-ap-web-africa2.agora.io"],UAP_AP:["uap-ap-web-africa.agora.io","uap-ap-web-africa2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-africa.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-africa.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-africa.agora.io"],NGINX:["africa.webrtc-cloud-proxy.sd-rtn.com"]}};ee.AREA_DOMAIN_MAP=m;var R={GLOBAL:{ASIA:[w.CHINA,w.JAPAN,w.INDIA],EUROPE:[],NORTH_AMERICA:[],SOUTH_AMERICA:[],OCEANIA:[],AFRICA:[]}},f=Object.keys(R[w.GLOBAL]),g=[w.CHINA,w.NORTH_AMERICA,w.EUROPE,w.ASIA,w.JAPAN,w.INDIA,w.OCEANIA,w.SOUTH_AMERICA,w.AFRICA];ee.getAreaCodeByConfig=function(M){var j=M.areaCode,A=M.excludedArea;return A?function(M,j){var Y,E=[];if("string"==typeof M&&(M=[M]),j&&!M.includes(w.GLOBAL)&&(E=M),j||(E=M),j&&M.includes(w.GLOBAL)){var F=[w.GLOBAL,w.OVERSEA],N=Object.keys(m);if(j===w.GLOBAL)throw new Error("Can not set excludedArea to 'GLOBAL'");if(j===w.CHINA)E=[w.OVERSEA];else if(f.includes(j)){var H=(void 0===(Y=j)&&(Y=""),R[w.GLOBAL][Y]||[]),O=I(F,[j],H);E=N.filter(function(Y){return!O.includes(Y)})}else if(function(Y){var ne=!1;return f.forEach(function(G){R.GLOBAL[G].includes(Y)&&(ne=!0)}),ne}(j)){var J=function(Y){void 0===Y&&(Y="");var ne="";return f.forEach(function(G){R.GLOBAL[G].includes(Y)&&(ne=G)}),ne}(j),te=I(F,[J,j]);E=N.filter(function(Y){return!te.includes(Y)})}else E=M;E=function(Y){var ne=[];return g.forEach(function(G){Y.includes(G)&&ne.push(G)}),ne.concat(Y.filter(function(G){return!g.includes(G)}))}(E)}return console.log("getAreaCodeAfterCalculation result",E),E}(j,A):j},m.CHINA={CODE:b.CHINA,WEBCS_DOMAIN:["webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["proxy-web.ap.sd-rtn.com"],CDS_AP:["cds-web-2.ap.sd-rtn.com","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-web-2.ap.sd-rtn.com","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-web-2.ap.sd-rtn.com","uap-web-4.ap.sd-rtn.com"],EVENT_REPORT_DOMAIN:["web-3.statscollector.sd-rtn.com"],EVENT_REPORT_BACKUP_DOMAIN:["web-4.statscollector.sd-rtn.com"],LOG_UPLOAD_SERVER:["logservice-china.agora.io"],NGINX:["east-cn.webrtc-cloud-proxy.sd-rtn.com"]},ee.getAreaCodeByWebCS=function(M){for(var j=Object.keys(m),A=0;A<j.length;A++){var F=m[j[A]];if(F.WEBCS_DOMAIN.includes(M)||F.WEBCS_DOMAIN_BACKUP_LIST.includes(M))return F.CODE===b.OVERSEA?b.ASIA+","+b.EUROPE+","+b.AFRICA+","+b.NORTH_AMERICA+","+b.SOUTH_AMERICA+","+b.OCEANIA:F.CODE}},ee.getAreaCodeByArea=function(M){return M===w.OVERSEA?b.ASIA+","+b.EUROPE+","+b.AFRICA+","+b.NORTH_AMERICA+","+b.SOUTH_AMERICA+","+b.OCEANIA:b[M]},ee.getAreaDomainConfig=function(M){var j={WEBCS_DOMAIN:[],WEBCS_DOMAIN_BACKUP_LIST:[],PROXY_CS:[],CDS_AP:[],ACCOUNT_REGISTER:[],UAP_AP:[],EVENT_REPORT_DOMAIN:[],EVENT_REPORT_BACKUP_DOMAIN:[],LOG_UPLOAD_SERVER:[],NGINX:[]};return M.map(function(A){var E=m[A];if(E){var F=Object.keys(E);F?F.map(function(N){"CODE"!==N&&(j[N]=j[N].concat(E[N]))}):D.default.info(A+" is not exist")}else D.default.info(A+" is not exist")}),j}},function(se,ee,x){"use strict";x.d(ee,"a",function(){return u}),x.d(ee,"b",function(){return B});var I=x(7),C=x.n(I),w=x(5),b=x(8),m=x(0),R=x(15),f=x(4),g=x(2),y=x(1),M=0,j=function(S){var c=function(S){var c=Object(b.b)({});return c.url=".",c}();c.id=S.id,c.playerId=M++,c.destroyed=!1,c.fit=S.options&&S.options.fit,"contain"!==c.fit&&"cover"!==c.fit&&(c.fit=null),c.url=S.url,c.stream=S.stream.stream,c.peerVideoReady=!1,c.isFreeze=!1,c.freezeTimeCounterList=[],c.freezeCount=0,c.lastFreezeCount=0,c.lastTimeupdateTime=0,c.elementID=S.elementID,c.setAudioOutput=function(Re,Ce,Ee){var Le=c.video||c.audio;return Le?Le.setSinkId?void Le.setSinkId(Re).then(function(){return m.default.debug("["+c.id+"] "+"video ".concat(c.id," setAudioOutput ").concat(Re," SUCCESS")),Le==c.video&&c.audio?c.audio.setSinkId(Re):Promise.resolve()}).then(function(){return m.default.debug("["+c.id+"] "+"audio ".concat(c.id," setAudioOutput ").concat(Re," SUCCESS")),Ce&&Ce()}).catch(function(p){return m.default.error("["+c.id+"] VideoPlayer.setAudioOutput",p),Ee&&Ee(p)}):(m.default.error("["+c.id+"] ",f.default.WEB_API_NOT_SUPPORTED),Ee&&Ee(f.default.WEB_API_NOT_SUPPORTED)):(m.default.error("["+c.id+"] ",f.default.PLAYER_NOT_FOUND),Ee&&Ee(f.default.PLAYER_NOT_FOUND))},c.destroy=function(){m.default.debug("[".concat(c.id,"] destroy ").concat(S.stream.local?"local":"remote"," Player ").concat(c.id)),Object(R.setSrcObject)(c.video,null),Object(R.setSrcObject)(c.audio,null),c.video.load(),c.audio.load(),c.video.pause(),c.video.remove(),c.audio.remove(),c.freezeCheckInterval&&clearInterval(c.freezeCheckInterval),c.destroyed=!0,delete c.resizer,document.getElementById(c.div.id)&&c.parentNode.contains(c.div)&&c.div.remove()&&c.parentNode.removeChild(c.div),["video","audio"].forEach(function(Re){var Ce=T[Re];clearTimeout(Ce.playDeferTimeout),Ce.formerMediaState=null;var Ee={playerId:c.playerId,stateId:Ce.stateId+1,playDeferTimeout:null,error:!1,status:"aborted",reason:"stop",updatedAt:Date.now()};T[Re]=Ee;var Le={type:"player-status-change",playerId:c.playerId,mediaType:Re,status:Ee.status,reason:Ee.reason,isErrorState:!1,streamId:c.id};m.default.debug("[".concat(c.id,"] Media Player Status Change Triggered by destroy()"),Le),S.stream.dispatchEvent(Le),y.report.reportApiInvoke(S.stream.sid,{name:"Stream.playerStatusChange",options:Le,tag:"tracer"})()})},c.div=document.createElement("div"),c.div.setAttribute("id","player_"+c.id),c.div.setAttribute("style",S.stream.video?"width: 100%; height: 100%; position: relative; background-color: black; overflow: hidden;":"width: 100%; height: 100%; position: relative; overflow: hidden;"),c.video=document.createElement("video"),c.video.setAttribute("id","video"+c.id),c.video.setAttribute("style",S.stream.local&&!S.stream.screen?S.stream.mirror?"width: 100%; height: 100%; position: absolute; transform: rotateY(180deg); object-fit: ".concat(c.fit||"cover",";"):"width: 100%; height: 100%; position: absolute; object-fit: ".concat(c.fit||"cover",";"):S.stream.video?"width: 100%; height: 100%; position: absolute; object-fit: ".concat(c.fit||"cover",";"):S.stream.screen?"width: 100%; height: 100%; position: absolute; object-fit: ".concat(c.fit||"contain"):"width: 100%; height: 100%; position: absolute; display: none; object-fit: ".concat(c.fit||"cover"));var z={autoplay:!0,muted:!!S.stream.local||!(!w.isSafari()&&"iOS"!==w.getBrowserOS())&&"video_element_muted",playsinline:!0,controls:!1,volume:null},d=C()({},z,S.options);!0!==d.muted||d.volume||(d.volume=0),c.video.setAttribute("autoplay",""),c.video.setAttribute("muted",""),c.video.muted=!0,c.video.autoplay=!0,d.playsinline&&c.video.setAttribute("playsinline",""),d.controls&&c.video.setAttribute("controls",""),d.contains&&(c.video.controls=!0),Number.isFinite(d.volume)&&(c.video.volume=d.volume),c.audio=document.createElement("audio"),c.audio.setAttribute("id","audio"+c.id),!0===d.muted&&c.audio.setAttribute("muted",""),!0===d.muted&&(c.audio.muted=!0),d.playsinline&&c.audio.setAttribute("playsinline",""),Number.isFinite(d.volume)&&(c.audio.volume=d.volume),void 0!==c.elementID?(document.getElementById(c.elementID).appendChild(c.div),c.container=document.getElementById(c.elementID)):(document.body.appendChild(c.div),c.container=document.body),c.parentNode=c.div.parentNode;var T={video:{playerId:c.playerId,stateId:0,playDeferTimeout:null,error:!1,status:"init",reason:null,updatedAt:Date.now()},audio:{playerId:c.playerId,stateId:0,playDeferTimeout:null,error:!1,status:"init",reason:null,updatedAt:Date.now()}};c.mediaElemExists=function(Re){for(var Ce=Re,Ee=0;Ee<Object(g.getParameter)("MEDIA_ELEMENT_EXISTS_DEPTH")&&Ce;Ee++)Ce=Ce.parentNode;return!!Ce};var L=function(Re){return c.mediaElemExists(Re)?Re.paused?"paused":"play":"aborted"},$=function(Re,Ce,Ee){var Le=L(Re),p=!0;return"paused"===Le?("audio"===Ce&&!0===Ee.muted&&(p=!1),Ee.autoplay||(p=!1)):"play"===Le?"video"===Ce?p=!1:!0===Ee.muted?Re.muted&&(p=!1):Re.muted||(p=!1):"aborted"===Le&&(p=!1),p},Z=function(Re){var Ce,Ee=this;if(Ee===c.video?Ce="video":Ee===c.audio&&(Ce="audio"),Ce){if(Re.type||m.default.error("[".concat(c.id,"] Unexpected evt"),Re),"video"===Ce&&Ee.muted&&Ee.paused)return m.default.debug("[".concat(c.id,"] auto resume video element")),void Ee.play();var Le=L(Ee);clearTimeout(T[Ce].playDeferTimeout),T[Ce].playDeferTimeout=setTimeout(function(){T[Ce].playDeferTimeout=null;var p=T[Ce],le=L(Ee);if(Le===le){var k={playerId:c.playerId,stateId:p.stateId+1,playDeferTimeout:null,error:$(Ee,Ce,d),status:L(Ee),reason:Re.type,updatedAt:Date.now()};if(p.status!==k.status){T[Ce]=k;var Ae={type:"player-status-change",playerId:c.playerId,mediaType:Ce,status:k.status,reason:k.reason,isErrorState:k.error,streamId:c.id};m.default.debug("[".concat(c.id,"] Media Player Status Change"),Ae),S.stream.dispatchEvent(Ae),y.report.reportApiInvoke(S.stream.sid,{name:"Stream.playerStatusChange",options:Ae,tag:"tracer"})()}}else m.default.debug("[".concat(c.id,"] Status Change after event Triggered.")+"Stream ".concat(c.id," PlayerId ").concat(c.playerId," mediaType ").concat(Ce," Status ").concat(Le,"=>").concat(le))},Object(g.getParameter)("PLAYER_STATE_DEFER"))}else m.default.error("[".concat(c.id,"] Unknown media element"),Ee)};c.video.addEventListener("playing",function(Re){!function Ce(){c.video.videoWidth*c.video.videoHeight>4?m.default.debug("["+c.id+"] video dimensions:",c.video.videoWidth,c.video.videoHeight):setTimeout(Ce,50)}()});var ce=0,re=0,U=0;c.freezeCheckInterval=setInterval(function(){Date.now()-c.lastTimeupdateTime>500&&c.peerVideoReady?(c.isFreeze=!0,c.freezeCount+=1):c.isFreeze=!1},500),c.video.addEventListener("playing",Z),c.video.addEventListener("canplay",Z),c.video.addEventListener("abort",Z),c.video.addEventListener("onerror",Z),c.video.addEventListener("suspend",Z),c.video.addEventListener("stalled",Z),c.video.addEventListener("pause",Z),c.audio.addEventListener("playing",Z),c.audio.addEventListener("canplay",Z),c.audio.addEventListener("abort",Z),c.audio.addEventListener("onerror",Z),c.audio.addEventListener("suspend",Z),c.audio.addEventListener("stalled",Z),c.audio.addEventListener("pause",Z);var V=c.audio,q="audio";if(S.stream.hasVideo()||S.stream.hasScreen())c.div.appendChild(c.video),c.div.appendChild(c.audio),w.isEdge()?c.video.srcObject=S.stream.stream:(Object(R.attachMediaStream)(c.video,S.stream.stream),Object(R.attachMediaStream)(c.audio,S.stream.stream)),c.video.addEventListener("timeupdate",function(){var Re=Date.now();if((ce+=1)<10)c.lastTimeupdateTime=Re;else for(Re-c.lastTimeupdateTime>500&&(c.peerVideoReady?re+=Re-c.lastTimeupdateTime:c.peerVideoReady=!0),U+=Re-c.lastTimeupdateTime,c.lastTimeupdateTime=Re;U>=6e3;)U-=6e3,c.freezeTimeCounterList.push(Math.min(6e3,re)),re-=6e3,re=Math.max(re,0)});else{!1!==d.muted&&"video_element_muted"!==d.muted||(c.video.removeAttribute("muted"),c.video.muted=!1),c.video.removeAttribute("autoplay"),c.video.autoplay=!1,c.div.appendChild(c.video),V=c.video,q="video";var oe={playerId:c.playerId,stateId:T.audio.stateId+1,playDeferTimeout:null,error:!1,status:"aborted",reason:"audioonly",updatedAt:Date.now()};T.audio=oe;var de={type:"player-status-change",playerId:c.playerId,mediaType:"audio",status:oe.status,reason:oe.reason,isErrorState:oe.error,streamId:c.id};if(m.default.debug("[".concat(c.id,"] Media Player Status Change"),de),Promise.resolve().then(function(){return S.stream.dispatchEvent(de)}),y.report.reportApiInvoke(S.stream.sid,{name:"Stream.playerStatusChange",options:de,tag:"tracer"})(),window.MediaStream&&(w.isSafari()||"iOS"===w.getBrowserOS())){var ye=new MediaStream(S.stream.stream.getAudioTracks());Object(R.setSrcObject)(c.video,ye)}else Object(R.setSrcObject)(c.video,S.stream.stream)}if(d.autoplay&&V){var Te=V.play();Te&&Te.catch&&Te.catch(function(Re){if(!c.destroyed&&V){var Ce=T[q],Ee={playerId:c.playerId,stateId:Ce.stateId+1,playDeferTimeout:null,error:$(V,q,d),status:L(V),reason:"error",updatedAt:Date.now()};if(Ce.status!==Ee.status){m.default.debug("[".concat(c.id,"] Player ").concat(c.playerId," Status Changed Detected by promise error: ").concat(Ce.status,"=>").concat(Ee.status),Re),T[q]=Ee;var Le={type:"player-status-change",playerId:c.playerId,mediaType:q,status:Ee.status,reason:Ee.reason,isErrorState:Ee.error,streamId:c.id};m.default.debug("[".concat(c.id,"] Media Player Status Change"),Le),S.stream.dispatchEvent(Le),y.report.reportApiInvoke(S.stream.sid,{name:"Stream.playerStatusChange",options:Le,tag:"tracer"})()}}})}return c.setAudioVolume=function(Re){var Ce=parseInt(Re)/100;isFinite(Ce)&&(Ce<0?Ce=0:Ce>1&&(Ce=1),c.video&&(c.video.volume=Ce),c.audio&&(c.audio.volume=Ce))},c},A=x(23),E=x(10),F=x(6),N=x(19),H=x(3),O=x(25),J=x(16),te=x(11),Y=x.n(te),ne=function(S){Object(H.checkValidString)(S,"profileName"),-1===(S=S.toLowerCase()).indexOf("_")&&(S+="_1"),Object(H.checkValidEnum)(S,"profileName",Object.keys(g.SUPPORT_RESOLUTION_LIST));var c=g.SUPPORT_RESOLUTION_LIST[S];c||(S=Object(g.getParameter)("DEFAULT_PROFILE"),c=g.SUPPORT_RESOLUTION_LIST[S]);var z={profileName:S,video:{width:c[0],height:c[1]},attributes:{resolution:"".concat(c[0],"x").concat(c[1]),minFrameRate:c[2],maxFrameRate:c[3],minVideoBW:c[4],maxVideoBW:c[5]}};return c[2]&&(z.video.frameRate=c[2]),c[6]&&c[7]&&(z.screen={width:c[0],height:c[1],frameRate:{min:c[6],max:c[7]}}),z},G=function(S){return Object.keys(g.SUPPORT_RESOLUTION_LIST).filter(function(c){var z=g.SUPPORT_RESOLUTION_LIST[c],d=["width","height","frameRate"];for(var T in d){var L=d[T];if(S[L]&&z[T]&&("number"==typeof S[L].max&&S[L].max<z[T]||"number"==typeof S[L].min&&S[L].min>z[T]))return!1}return!0}).reverse()},_=function(S){var c=g.AUDIO_PROFILE_SETTINGS[S]||g.AUDIO_PROFILE_SETTINGS.default;return{highQuality:c[0],stereo:c[1],speech:c[2],lowQuality:c[3]}},u=function(S){var d,c=Object(b.b)();if(c.params=C()({},S),c.stream=S.stream,c.url=S.url,c.onClose=void 0,c.local=!1,c.videoSource=S.videoSource,c.audioSource=S.audioSource,S.video=!(!S.videoSource&&!S.video),c.video=S.video,S.audio=!(!S.audioSource&&!S.audio),c.audio=S.audio,c.screen=!!S.screen,c.screenAudio=!!S.screenAudio,c.screenAttributes={width:1920,height:1080,maxFr:5,minFr:1},c.videoSize=S.videoSize,c.player=void 0,c.audioLevelHelper=null,S.attributes=S.attributes||{},c.attributes=S.attributes,c.microphoneId=S.microphoneId,c.cameraId=S.cameraId,c.facingMode=S.facingMode,c.inSwitchDevice=!1,c.userMuteVideo=!1,c.userMuteAudio=!1,c.peerMuteVideo=!1,c.peerMuteAudio=!1,c.lowStream=null,c.videoWidth=0,c.videoHeight=0,c.streamId=S.streamID,c.userId=null,c.uintId=S.uintUID||null,c.mirror=!1!==S.mirror,c.DTX=S.audioProcessing&&S.audioProcessing.DTX,c.audioProcessing=S.audioProcessing,c.optimizationMode=S.optimizationMode,c.highQuality=!1,c.stereo=!1,c.speech=!1,c.screen||delete c.screen,!(void 0===c.videoSize||c.videoSize instanceof Array&&4===c.videoSize.length))throw Error("Invalid Video Size");function z(){var d={};c.getVideoTrack()===this?(m.default.debug("Video Track Ended"),d.type="videoTrackEnded",d.track=this):c.getAudioTrack()===this?(m.default.debug("Audio Track Ended"),d.type="audioTrackEnded",d.track=this):m.default.debug("Detached Track ended",this.kind,this.label,this),d.type&&c.dispatchEvent(d)}return c.videoSize=[640,480,640,480],void 0!==S.local&&!0!==S.local||(c.local=!0),c.initialized=!c.local,c._streamInitID=null,(d=c).audioMixing={audioContextInited:!1,defaultVolume:100,inEarMonitoring:"FILE",sounds:{},states:{IDLE:"IDLE",STARTING:"STARTING",BUSY:"BUSY",PAUSED:"PAUSED"},inEarMonitoringModes:{NONE:"NONE",FILE:"FILE",MICROPHONE:"MOCROPHONE",ALL:"ALL"},ctx:null,mediaStreamSource:null,mediaStreamDest:null,buffer:{}},d._initSoundIfNotExists=function(T,L){d.audioMixing.sounds[T]||(d.audioMixing.sounds[T]={soundId:T,state:"IDLE",muted:d.userMuteAudio,filePath:L,volume:d.audioMixing.defaultVolume,startAt:null,startOffset:null,pauseAt:null,pauseOffset:null,resumeAt:null,resumeOffset:null,stopAt:null,options:null,source:null})},d._initSoundIfNotExists(-1),d.loadAudioBuffer=function(T,L,$){var Z=y.report.reportApiInvoke(d.sid,{callback:$,name:"Stream.loadAudioBuffer",options:arguments,tag:"tracer"});Object(H.checkValidString)(L,"url",1,1024,!1),Object(H.checkValidString)(T,"id",1,1024,!1);var ce=function(U){m.default.error("[".concat(d.streamId,"] loadAudioBuffer Failed: ")+U),Z(f.default.LOAD_AUDIO_FAILED)},re=new XMLHttpRequest;re.open("GET",L,!0),re.responseType="arraybuffer",re.onload=function(){if(re.status>400)ce("".concat(re.status," ").concat(re.statusText));else{var U=re.response;d.audioMixing.audioContextInited||d._initAudioContext(),d.audioMixing.ctx.decodeAudioData(U,function(V){d.audioMixing.buffer[T]=V,Z(null)},function(V){m.default.error("[".concat(d.streamId,"] decodeAudioData Failed: "),V),Z(V)})}},re.onerror=function(){return ce("load error")},re.ontimeout=function(){return ce("timeout")},re.send()},d.createAudioBufferSource=function(T){var L=y.report.reportApiInvoke(d.sid,{name:"Stream.createAudioBufferSource",options:arguments,tag:"tracer"});if(d.audioMixing.buffer[T.id]){var $=d.audioMixing.buffer[T.id],Z=d.audioMixing.ctx.createBufferSource();Z.buffer=$;var ce=d.audioMixing.ctx.createGain();if(Z.connect(ce),ce.connect(d.audioMixing.mediaStreamDest),Z.gainNode=ce,T.loop)Z.loop=!0,Z.start(0,T.playTime/1e3);else if(T.cycle>1)if(Object(w.isChrome)()){Z.loop=!0;var re=T.cycle*$.duration*1e3-(T.playTime||0);Z.start(0,T.playTime/1e3,re/1e3)}else m.default.warning("[".concat(d.streamId,"] Cycle Param is ignored by current browser")),Z.start(0,T.playTime/1e3);else Z.start(0,T.playTime/1e3);var U=d.audioMixing.sounds[T.soundId];return U.source=Z,d._flushAudioMixingMuteStatus(),Z.addEventListener("ended",function(){Z===U.source&&d.dispatchEvent({type:"audioSourceEnded",soundId:T.soundId,source:Z,sound:U})}),L(),Z}var V="AUDIOBUFFER_NOT_FOUND";return m.default.error("[".concat(d.streamId,"] "),V,T.id),L(!1),!1},d.on("audioSourceEnded",function(T){var L=T.source,$=T.sound;$&&$.state===d.audioMixing.states.BUSY&&!$.pauseAt&&($.state=d.audioMixing.states.IDLE,$.startAt=null,$.startOffset=null,$.resumeAt=null,$.resumeOffset=null,L.gainNode&&L.gainNode.disconnect&&L.gainNode.disconnect(),L.buffer=null,d.audioMixing.mediaStreamSource.connect(d.audioMixing.mediaStreamDest))}),d.clearAudioBufferSource=function(){d.audioBufferSource.forEach(function(T){T.stop()})},d._isSoundExists=function(T){return!!d.audioMixing.sounds[T.soundId]||(m.default.error("SoundId not exists. #".concat(T.soundId)),!1)},d._initAudioContext=function(){if(d.audioMixing.audioContextInited)throw new Error("Failed to init audio context. Already inited");if(!d.stream)throw new Error("Failed to init audio context. Local Stream not initialized");d.audioMixing.ctx=Object(O.a)(),d.audioMixing.mediaStreamSource=d.audioMixing.ctx.createMediaStreamSource(d.stream),d.audioMixing.mediaStreamDest=d.audioMixing.ctx.createMediaStreamDestination(),d.audioMixing.mediaStreamSource.connect(d.audioMixing.mediaStreamDest);var T=d.stream.getVideoTracks()[0];if(T&&d.audioMixing.mediaStreamDest.stream.addTrack(T),d._originStream=d.stream,d._isAudioMuted()?(d._unmuteAudio(),d.stream=d.audioMixing.mediaStreamDest.stream,d._muteAudio()):d.stream=d.audioMixing.mediaStreamDest.stream,d.audioLevelHelper=null,d.pc&&d.pc.peerConnection&&d.pc.peerConnection){var L=(d.pc.peerConnection&&d.pc.peerConnection.getSenders()).find(function(Z){return Z&&Z.track&&"audio"==Z.track.kind}),$=d.audioMixing.mediaStreamDest.stream.getAudioTracks()[0];L&&L.replaceTrack&&$&&L.replaceTrack($)}d.audioMixing.audioContextInited=!0},d._cleanupAudioMixing=function(){if(d.audioMixing.audioContextInited){for(var T in d.audioMixing.sounds){var L=d.audioMixing.sounds[T];L.state!==d.audioMixing.states.BUSY&&L.state!==d.audioMixing.states.PAUSED||d._stopOneEffect({soundId:T})}d.audioLevelHelper=null,d.audioMixing.audioContextInited=!1}},d._reloadInEarMonitoringMode=function(T){if(T){if(!d.audioMixing.inEarMonitoringModes[T])return m.default.error("[".concat(d.streamId,"] Invalid InEarMonitoringMode ").concat(T));d.audioMixing.inEarMonitoring=T}switch(d.audioMixing.audioContextInited||d._initAudioContext(),d.audioMixing.inEarMonitoring){case d.audioMixing.inEarMonitoringModes.FILE:d.audioMixing.mediaStreamSource.connectedToDestination&&(d.audioMixing.mediaStreamSource.disconnect(d.audioMixing.ctx.destination),d.audioMixing.mediaStreamSource.connectedToDestination=!1);case d.audioMixing.inEarMonitoringModes.ALL:for(var L in d.audioMixing.sounds){var $=d.audioMixing.sounds[L];$&&$.source&&!$.source.connectedToDestination&&($.source.gainNode.connect(d.audioMixing.ctx.destination),$.source.connectedToDestination=!0)}}switch(d.audioMixing.inEarMonitoring){case d.audioMixing.inEarMonitoringModes.MICROPHONE:d.audioMixing.source.forEach(function(Z){Z.connectedToDestination&&(Z.gainNode.disconnect(d.audioMixing.ctx.destination),Z.connectedToDestination=!1)});case d.audioMixing.inEarMonitoringModes.ALL:d.audioMixing.mediaStreamSource.connectedToDestination||(d.audioMixing.mediaStreamSource.connect(d.audioMixing.ctx.destination),d.audioMixing.mediaStreamSource.connectedToDestination=!0)}},d._startAudioMixingBufferSource=function(T){d.audioMixing.audioContextInited||d._initAudioContext();var $=T.replace,Z=d.createAudioBufferSource({soundId:T.soundId,id:T.filePath,loop:T.loop,cycle:T.cycle,playTime:T.playTime||0});return Z.sound=d.audioMixing.sounds[T.soundId],Z?(Z.addEventListener("ended",d._audioMixingFinishedListener,{once:!0}),d._reloadInEarMonitoringMode(),$&&d.audioMixing.mediaStreamSource.disconnect(d.audioMixing.mediaStreamDest),Z):null},d._stopAudioMixingBufferSource=function(T){var L=d.audioMixing.sounds[T.soundId].source;return L?(L.removeEventListener("ended",d._audioMixingFinishedListener),d.audioMixing.mediaStreamSource.connect(d.audioMixing.mediaStreamDest),L.stop(),L.gainNode&&L.gainNode.disconnect&&L.gainNode.disconnect(),L.buffer=null,L):null},d._flushAudioMixingMuteStatus=function(T){for(var L in d.audioMixing.sounds){var $=d.audioMixing.sounds[L];$&&(void 0!==T&&($.muted=!!T),$.source&&($.source.gainNode.gain.value=$.muted?0:$.volume/100))}},d._handleAudioMixingInvalidStateError=function(T,L,$){var Z=d.audioMixing.sounds[L.soundId],ce=-1===L.soundId?"INVALID_AUDIO_MIXING_STATE":"INVALID_PLAY_EFFECT_STATE";m.default.error("[".concat(d.streamId,"] Cannot ").concat(T,": ").concat(ce,", state is ").concat(Z.state)),$&&$(ce)},d._handleAudioMixingNoSourceError=function(T,L,$){d.audioMixing.sounds[L.soundId].state=d.audioMixing.states.IDLE;var Z=-1===L.soundId?"NO_AUDIO_MIXING_SOURCE":"NO_EFFECT_SOURCE";m.default.error("[".concat(d.streamId,"] Cannot ").concat(T,": ").concat(Z)),$&&$(Z)},d._getOneEffectStates=function(T){var L=d.audioMixing.sounds[T.soundId];return function(){return L?{state:L.state,startAt:L.startAt,resumeAt:L.resumeAt,pauseOffset:L.pauseOffset,pauseAt:L.pauseAt,resumeOffset:L.resumeOffset,stopAt:L.stopAt,duration:d._getOneEffectDuration(T),position:d._getOneEffectCurrentPosition(T)}:{}}},d._audioMixingFinishedListener=function(){var T=this.sound;T.state===d.audioMixing.states.IDLE&&d.audioMixing.buffer[T.options.filePath]&&!T.options.cacheResource&&(m.default.debug("Recycled buffer ".concat(T.options.filePath)),delete d.audioMixing.buffer[T.options.filePath]),-1===T.soundId&&d.dispatchEvent({type:"audioMixingFinished"})},d._playOneEffect=function(T,L){Object(H.checkValidObject)(T,"options");var $=T.soundId,Z=T.cacheResource;if(Object(w.isSafari)()&&Object(w.getBrowserVersion)()<12){var ce="BROWSER_NOT_SUPPORT";return m.default.error("[".concat(d.streamId,"] Cannot _playOneEffect: "),ce),L(ce)}d.audioMixing.audioContextInited||d._initAudioContext(),d._initSoundIfNotExists($);var re=d.audioMixing.sounds[$];if(re.state===d.audioMixing.states.IDLE){if(void 0!==T.cycle&&!T.cycle>0)return ce="Invalid Parmeter cycle: "+T.cycle,m.default.error("[".concat(d.streamId,"] ").concat($),ce),L(ce);if(Object(H.isEmpty)(Z)&&(T.cacheResource=!0),re.state=d.audioMixing.states.STARTING,re.options=T,d.audioMixing.buffer[T.filePath]){var U=d._startAudioMixingBufferSource(T);if(U)return re.source=U,re.startAt=Date.now(),re.resumeAt=null,re.pauseOffset=null,re.pauseAt=null,re.resumeOffset=null,re.stopAt=null,re.startOffset=T.playTime||0,re.state=d.audioMixing.states.BUSY,d._flushAudioMixingMuteStatus(),L(null);re.state=d.audioMixing.states.IDLE;var V="CREATE_BUFFERSOURCE_FAILED";if(L)return L(V);m.default.error("[".concat(d.streamId,"] "),V)}else d.loadAudioBuffer(T.filePath,T.filePath,function(q){if(q)re.state=d.audioMixing.states.IDLE,L?L(q):m.default.error("[".concat(d.streamId,"] "),q);else{var pe=d._startAudioMixingBufferSource(T);if(pe)return re.source=pe,re.startAt=Date.now(),re.resumeAt=null,re.pauseOffset=null,re.pauseAt=null,re.resumeOffset=null,re.stopAt=null,re.startOffset=T.playTime||0,re.state=d.audioMixing.states.BUSY,d._flushAudioMixingMuteStatus(),L(null);if(re.state=d.audioMixing.states.IDLE,q="CREATE_BUFFERSOURCE_FAILED",L)return L(q);m.default.error("[".concat(d.streamId,"] "),q)}})}else d._handleAudioMixingInvalidStateError("_playEffect",T,L)},d._stopOneEffect=function(T,L){var $=d.audioMixing.sounds[T.soundId];return d._isSoundExists(T)?$.state===d.audioMixing.states.BUSY||$.state===d.audioMixing.states.PAUSED?(d._stopAudioMixingBufferSource(T),$.stopAt=Date.now(),$.state=d.audioMixing.states.IDLE,d.audioMixing.buffer[$.options.filePath]&&!$.options.cacheResource&&(m.default.debug("Recycled buffer ".concat($.options.filePath)),delete d.audioMixing.buffer[$.options.filePath]),void(L&&L(null))):void d._handleAudioMixingInvalidStateError("_stopOneEffect",T,L):L("SOUND_NOT_EXISTS")},d._pauseOneEffect=function(T,L){var $=d.audioMixing.sounds[T.soundId];if($.state===d.audioMixing.states.BUSY)return d._stopAudioMixingBufferSource(T)?($.pauseAt=Date.now(),$.state=d.audioMixing.states.PAUSED,$.pauseOffset=$.resumeAt?$.pauseAt-$.resumeAt+$.resumeOffset:$.pauseAt-$.startAt+$.startOffset,L&&L(null)):void d._handleAudioMixingNoSourceError("_pauseOneEffect",T,L);d._handleAudioMixingInvalidStateError("_pauseOneEffect",T,L)},d._resumeOneEffect=function(T,L){var $=d.audioMixing.sounds[T.soundId];if($.state===d.audioMixing.states.PAUSED){var ce=d._startAudioMixingBufferSource({soundId:T.soundId,filePath:$.options.filePath,cycle:$.options.cycle,loop:$.options.loop,playTime:$.pauseOffset,replace:$.options.replace});if(!ce){var re="CREATE_BUFFERSOURCE_FAILED";return L(re),void m.default.error("[".concat(d.streamId,"] "),re)}$.source=ce,$.resumeAt=Date.now(),$.resumeOffset=$.pauseOffset,$.state=d.audioMixing.states.BUSY,$.pauseAt=null,$.pauseOffset=null,L(null)}else d._handleAudioMixingInvalidStateError("_resumeOneEffect",T,L)},d._getOneEffectDuration=function(T){var L=d.audioMixing.sounds[T.soundId];return L.options&&L.options.filePath&&d.audioMixing.buffer[L.options.filePath]?1e3*d.audioMixing.buffer[L.options.filePath].duration:null},d._getOneEffectCurrentPosition=function(T,L){var $=d.audioMixing.sounds[T.soundId];return $.state===d.audioMixing.states.PAUSED?$.pauseOffset%d._getOneEffectDuration(T):$.state===d.audioMixing.states.BUSY?$.resumeAt?(Date.now()-$.resumeAt+$.resumeOffset)%d._getOneEffectDuration(T):(Date.now()-$.startAt+$.startOffset)%d._getOneEffectDuration(T):void(L&&d._handleAudioMixingInvalidStateError("_getOneEffectCurrentPosition",T))},d._setOneEffectPosition=function(T,L,$){var Z=d.audioMixing.sounds[T.soundId];if(Z.state===d.audioMixing.states.BUSY){if(!d._stopAudioMixingBufferSource(T))return void d._handleAudioMixingNoSourceError("_setOneEffectPosition",T,$);var re=d._startAudioMixingBufferSource({soundId:T.soundId,filePath:Z.options.filePath,loop:Z.options.loop,cycle:Z.options.cycle,playTime:L});if(!re){var U="CREATE_BUFFERSOURCE_FAILED";return $&&$(U),void m.default.error("[".concat(d.streamId,"] "),U)}Z.source=re,Z.startAt=Date.now(),Z.startOffset=L,Z.resumeAt=null,Z.resumeOffset=null,Z.pauseOffset=null,Z.pauseAt=null}else{if(Z.state!==d.audioMixing.states.PAUSED)return void d._handleAudioMixingInvalidStateError("_setOneEffectPosition",T,$);Z.pauseOffset=L}$&&$(null)},d.startAudioMixing=function(T,L){var $=y.report.reportApiInvoke(d.sid,{callback:function(oe){if(oe)return L&&L(oe);d.dispatchEvent({type:"audioMixingPlayed"}),L&&L(null)},getStates:d._getOneEffectStates({soundId:-1}),name:"Stream.startAudioMixing",options:T});Object(H.checkValidObject)(T,"options");var Z=T.filePath,ce=T.cacheResource,re=T.cycle,U=T.loop,V=T.playTime,q=T.replace;Object(H.checkValidString)(Z,"filePath",1,Object(g.getParameter)("FILEPATH_LENMAX"),!1),Object(H.checkValidNumber)(V,"playTime",0,1e8),!Object(H.isEmpty)(re)&&Object(H.checkValidNumber)(re,"cycle"),!Object(H.isEmpty)(U)&&Object(H.checkValidBoolean)(U,"loop"),!Object(H.isEmpty)(q)&&Object(H.checkValidBoolean)(q,"replace"),!Object(H.isEmpty)(ce)&&Object(H.checkValidBoolean)(ce,"cacheResource");var pe=C()({soundId:-1},T);d._playOneEffect(pe,$)},d.stopAudioMixing=function(T){var L=y.report.reportApiInvoke(d.sid,{callback:T,getStates:d._getOneEffectStates({soundId:-1}),name:"Stream.stopAudioMixing"});d._stopOneEffect({soundId:-1},L)},d.pauseAudioMixing=function(T){var L=y.report.reportApiInvoke(d.sid,{callback:T,getStates:d._getOneEffectStates({soundId:-1}),name:"Stream.pauseAudioMixing"});return d._pauseOneEffect({soundId:-1},L)},d.resumeAudioMixing=function(T){var L=y.report.reportApiInvoke(d.sid,{callback:function($,Z){if($)return T&&T($);d.dispatchEvent({type:"audioMixingPlayed"}),T&&T(null)},getStates:d._getOneEffectStates({soundId:-1}),name:"Stream.resumeAudioMixing"});d._resumeOneEffect({soundId:-1},L)},d.adjustAudioMixingVolume=function(T){var L=y.report.reportApiInvoke(d.sid,{getStates:d._getOneEffectStates({soundId:-1}),name:"Stream.adjustAudioMixingVolume",options:arguments,tag:"tracer"});Object(H.checkValidNumber)(T,"volume",0,100),d.audioMixing.sounds[-1].volume=T,d._flushAudioMixingMuteStatus(),L()},d.getAudioMixingDuration=function(){var T=y.report.reportApiInvoke(d.sid,{getStates:d._getOneEffectStates({soundId:-1}),name:"Stream.getAudioMixingDuration"}),L=d._getOneEffectDuration({soundId:-1});return T(null,L),L},d.getAudioMixingCurrentPosition=function(){var T=y.report.reportApiInvoke(d.sid,{getStates:d._getOneEffectStates({soundId:-1}),name:"Stream.getAudioMixingCurrentPosition"}),L=d._getOneEffectCurrentPosition({soundId:-1},!0);return T(null,L),L},d.setAudioMixingPosition=function(T,L){var $=y.report.reportApiInvoke(d.sid,{callback:L,options:arguments,tag:"tracer",getStates:d._getOneEffectStates({soundId:-1}),name:"Stream.setAudioMixingPosition"});Object(H.checkValidNumber)(T,"position",0,1e8),d._setOneEffectPosition({soundId:-1},T,$)},d.playEffect=function(T,L){var $=y.report.reportApiInvoke(d.sid,{callback:function(U){if(U)return L&&L(U);d.dispatchEvent({type:"effectPlayed"}),L&&L(null)},name:"Stream.playEffect",options:T});Object(H.checkValidObject)(T,"options");var Z=T.soundId,ce=T.filePath,re=T.cycle;Object(H.checkValidNumber)(Z,"soundId",1,1e4),Object(H.checkValidString)(ce,"filePath",0,Object(g.getParameter)("FILEPATH_LENMAX"),!1),!Object(H.isEmpty)(re)&&Object(H.checkValidNumber)(re,"cycle"),d._playOneEffect(T,$)},d.stopEffect=function(T,L){var $=y.report.reportApiInvoke(d.sid,{callback:L,getStates:d._getOneEffectStates({soundId:T}),name:"Stream.stopEffect"});Object(H.checkValidNumber)(T,"soundId",1,1e4),d._stopOneEffect({soundId:T},$)},d.stopAllEffects=function(T){var L=y.report.reportApiInvoke(d.sid,{callback:T,name:"Stream.stopAllEffect"}),$=!1,Z=0,ce=0,re=function(q){$||(q?(L(q),$=!0):Z+=1,Z===ce&&(L(null),$=!0))};for(var U in d.audioMixing.sounds){var V=d.audioMixing.sounds[U];-1!==V.soundId&&(V.state!==d.audioMixing.states.BUSY&&V.state!==d.audioMixing.states.PAUSED||(ce++,d._stopOneEffect({soundId:U},re)))}ce||L(null)},d.preloadEffect=function(T,L,$){var Z=y.report.reportApiInvoke(d.sid,{callback:$,options:arguments,tag:"tracer",name:"Stream.preloadEffect"});Object(H.checkValidNumber)(T,"soundId",1,1e4),Object(H.checkValidString)(L,"filePath",1,Object(g.getParameter)("FILEPATH_LENMAX"),!1),d._initSoundIfNotExists(T,L),d.audioMixing.buffer[L]?Z(null):d.loadAudioBuffer(L,L,Z)},d.unloadEffect=function(T,L){var $=y.report.reportApiInvoke(d.sid,{callback:L,options:arguments,tag:"tracer",name:"Stream.unloadEffect"});Object(H.checkValidNumber)(T,"soundId",1,1e4);var Z=d.audioMixing.sounds[T];if(!Z){var ce="SOUND_NOT_EXISTS";return m.default.error(ce,T),void $(ce)}var re=Z.options?Z.options.filePath:Z.filePath;if(re)delete d.audioMixing.buffer[re],delete d.audioMixing.sounds[T],$(null);else{var U="SOUND_BUFFER_NOT_FOUND";m.default.error(U,T),$(U)}},d.pauseEffect=function(T,L){var $=y.report.reportApiInvoke(d.sid,{callback:L,options:arguments,tag:"tracer",name:"Stream.pauseEffect"});return d._pauseOneEffect({soundId:T},$)},d.pauseAllEffects=function(T){var L=y.report.reportApiInvoke(d.sid,{callback:T,name:"Stream.pauseAllEffects"}),$=!1,Z=0,ce=0,re=function(V){$||(V?(L(V),$=!0):Z+=1,Z===ce&&(L(null),$=!0))};for(var U in d.audioMixing.sounds)"-1"!==U&&d.audioMixing.sounds[U].state===d.audioMixing.states.BUSY&&(ce++,d._pauseOneEffect({soundId:U},re));ce||L(null)},d.resumeEffect=function(T,L){Object(H.checkValidNumber)(T,"soundId",1,1e4);var $=y.report.reportApiInvoke(d.sid,{callback:L,options:arguments,tag:"tracer",name:"Stream.resumeEffect"});return d._resumeOneEffect({soundId:T},$)},d.resumeAllEffects=function(T){var L=y.report.reportApiInvoke(d.sid,{callback:T,name:"Stream.resumeAllEffects"}),$=!1,Z=0,ce=0,re=function(V){$||(V?(L(V),$=!0):Z+=1,Z===ce&&(L(null),$=!0))};for(var U in d.audioMixing.sounds)"-1"!==U&&d.audioMixing.sounds[U].state===d.audioMixing.states.PAUSED&&(ce++,d._resumeOneEffect({soundId:U},re));ce||L(null)},d.getEffectsVolume=function(){var T=[];for(var L in d.audioMixing.sounds){var $=d.audioMixing.sounds[L];$&&"-1"!==L&&T.push({soundId:parseInt(L),volume:$.volume})}return T},d.setEffectsVolume=function(T,L){var $=y.report.reportApiInvoke(d.sid,{name:"Stream.setEffectsVolume",options:arguments,tag:"tracer",callback:L});for(var Z in Object(H.checkValidNumber)(T,"volume",0,100),d.audioMixing.defaultVolume=T,d.audioMixing.sounds){var ce=d.audioMixing.sounds[Z];"-1"!==Z&&(ce.volume=T)}d._flushAudioMixingMuteStatus(),$(null)},d.setVolumeOfEffect=function(T,L,$){var Z=y.report.reportApiInvoke(d.sid,{name:"Stream.setVolumeOfEffect",options:arguments,tag:"tracer",callback:$});Object(H.checkValidNumber)(T,"soundId",0,1e4),Object(H.checkValidNumber)(L,"volume",0,100),d._initSoundIfNotExists(T);var ce=d.audioMixing.sounds[T];ce.volume=L,d._flushAudioMixingMuteStatus(),Z(null)},J.a.addVideoEffectCapability(c),function(d,T){d.videoConstraint={},T.cameraId&&(d.videoConstraint.deviceId={exact:T.cameraId}),T.facingMode&&(d.videoConstraint.facingMode=T.facingMode),d.videoSize&&(d.videoConstraint.width=d.videoSize[0],d.videoConstraint.height=d.videoSize[1]),Object(w.isLegacyChrome)()||(d.videoConstraint.frameRate=30),d.audioConstraint={},T.microphoneId&&(d.audioConstraint.deviceId={exact:T.microphoneId}),Object(w.isLegacyChrome)()||d.audioProcessing&&(void 0!==d.audioProcessing.AGC&&(Object(w.isFireFox)()?d.audioConstraint.autoGainControl=d.audioProcessing.AGC:Object(w.isChrome)()&&(d.audioConstraint.googAutoGainControl=d.audioProcessing.AGC,d.audioConstraint.googAutoGainControl2=d.audioProcessing.AGC)),void 0!==d.audioProcessing.AEC&&(d.audioConstraint.echoCancellation=d.audioProcessing.AEC),void 0!==d.audioProcessing.ANS&&(Object(w.isFireFox)()?d.audioConstraint.noiseSuppression=d.audioProcessing.ANS:Object(w.isChrome)()&&(d.audioConstraint.googNoiseSuppression=d.audioProcessing.ANS))),d.screenConstraint={},T.sourceId&&(d.screenConstraint.sourceId=T.sourceId),T.extensionId&&Object(w.isChrome)()?(d.screenConstraint.extensionId=T.extensionId,d.screenConstraint.mandatory={chromeMediaSource:"desktop",maxWidth:d.screenAttributes.width,maxHeight:d.screenAttributes.height,maxFrameRate:d.screenAttributes.maxFr,minFrameRate:d.screenAttributes.minFr}):(d.screenConstraint.mediaSource="screen",d.screenConstraint.width=d.screenAttributes.width,d.screenConstraint.height=d.screenAttributes.height,d.screenConstraint.frameRate={ideal:d.screenAttributes.maxFr,max:d.screenAttributes.maxFr}),T.mediaSource&&(d.screenConstraint.mediaSource=T.mediaSource),d.setVideoResolution=function(L){var $=y.report.reportApiInvoke(d.sid,{name:"Stream.setVideoResolution",options:arguments,tag:"tracer"});if(!(L instanceof Array)){var Z=ne(L+="");return Z&&Z.video?(d.videoConstraint=C()(d.videoConstraint,{width:{ideal:Z.video.width},height:{ideal:Z.video.height}}),T.attributes.resolution=Z.attributes.resolution,(ce=d.stream&&d.stream.getVideoTracks&&d.stream.getVideoTracks()[0])&&ce.applyConstraints?(m.default.debug("setVideoResolution applyConstraints",d.videoConstraint),ce.applyConstraints(d.videoConstraint).then($).catch($)):$(),!0):($("NO_PROFILE_".concat(L)),!1)}var ce,re=L[0],U=L[1];d.videoConstraint=C()(d.videoConstraint,{width:{ideal:re},height:{ideal:U}}),T.attributes.resolution="".concat(re,"x").concat(U),(ce=d.stream&&d.stream.getVideoTracks&&d.stream.getVideoTracks()[0])&&ce.applyConstraints?(m.default.debug("setVideoResolution applyConstraints",d.videoConstraint),J.a.disableVideoEffect(d).then(function(){return ce.applyConstraints(d.videoConstraint).then($).catch($)}).then(function(){return J.a.restoreVideoEffect(d)})):$()},d.setVideoFrameRate=function(L){var $=y.report.reportApiInvoke(d.sid,{name:"Stream.setVideoFrameRate",options:arguments,tag:"tracer"});if(Object(w.isFireFox)())return $("FIREFOX_NOT_SUPPORTED"),!1;if("object"===Y()(L)&&L instanceof Array&&L.length>1){d.videoConstraint=C()(d.videoConstraint,{frameRate:L[0]}),d.attributes.minFrameRate=L[0],d.attributes.maxFrameRate=L[1];var Z=d.stream&&d.stream.getVideoTracks&&d.stream.getVideoTracks()[0];return Z&&Z.applyConstraints?(m.default.debug("setVideoFrameRate applyConstraints",d.videoConstraint),Z.applyConstraints(d.videoConstraint).then($).catch($)):$(),!0}return $("INVALID_PARAM_".concat(JSON.stringify(L))),!1},d.setVideoBitRate=function(L){var $=y.report.reportApiInvoke(d.sid,{name:"Stream.setVideoBitRate",options:arguments,tag:"tracer"});return"object"===Y()(L)&&L instanceof Array&&L.length>1?(T.attributes.minVideoBW=L[0],T.attributes.maxVideoBW=L[1],d.connectionSpec&&(d.connectionSpec.minVideoBW=L[0],d.connectionSpec.maxVideoBW=L[1]),d.pc&&d.pc.renegotiate&&d.pc.renegotiate(),$(),!0):($("INVALID_PARAM_".concat(JSON.stringify(L))),!1)},d.setScreenBitRate=function(L){var $=y.report.reportApiInvoke(d.sid,{name:"Stream.setScreenBitRate",options:arguments,tag:"tracer"});return"object"===Y()(L)&&L instanceof Array&&L.length>1?(d.screenAttributes.minVideoBW=L[0],d.screenAttributes.maxVideoBW=L[1],$(),!0):($("INVALID_PARAM_".concat(JSON.stringify(L))),!1)},d.setScreenProfile=function(L){var $=y.report.reportApiInvoke(d.sid,{name:"Stream.setScreenProfile",options:arguments,tag:"tracer"});Object(H.checkValidEnum)(L,"profile",["480p_1","480p_2","720p_1","720p_2","1080p_1","1080p_2"]);var Z=ne(L);return Z&&Z.screen?(d.screenConstraint.mandatory?(d.screenConstraint.mandatory.maxWidth=Z.screen.width,d.screenConstraint.mandatory.maxHeight=Z.screen.height,Z.screen.frameRate&&Z.screen.frameRate.min&&Z.screen.frameRate.max&&(d.screenConstraint.mandatory.minFrameRate=Z.screen.frameRate.min,d.screenConstraint.mandatory.maxFrameRate=Z.screen.frameRate.max)):d.screenConstraint=C()(d.screenConstraint,Z.screen),d.screenAttributes.width=Z.screen.width,d.screenAttributes.height=Z.screen.height,d.screenAttributes.minFr=Z.screen.frameRate.min,d.screenAttributes.maxFr=Z.screen.frameRate.max,$(),!0):($("NO_SCREEN_PROFILE_".concat(JSON.stringify(L))),!1)},d.setVideoProfileCustom=function(L){var $=y.report.reportApiInvoke(d.sid,{name:"Stream.setVideoProfileCustom",options:arguments,tag:"tracer"});d.setVideoResolution(L[0]),d.setVideoFrameRate([L[1],L[1]]),d.setVideoBitRate([L[2],L[2]]),$()},d.setVideoProfileCustomPlus=function(L){var $=y.report.reportApiInvoke(d.sid,{name:"Stream.setVideoProfileCustom",options:arguments,tag:"tracer"});d.setVideoResolution([L.width,L.height]),T.attributes.resolution="".concat(L.width,"x").concat(L.height),d.setVideoFrameRate([L.framerate,L.framerate]),d.setVideoBitRate([L.bitrate,L.bitrate]),$()},d.setVideoProfile=function(L){var $=y.report.reportApiInvoke(d.sid,{name:"Stream.setVideoProfile",options:arguments,tag:"tracer"}),Z=ne(L);if(!Z){var ce="Invalid Profile ".concat(L);throw new Error(ce)}if(d.profile=L,Z&&Z.video){d.profile=Z.profileName,d.videoConstraint=C()(d.videoConstraint,Z.video),d.connectionSpec&&Z.attributes.maxVideoBW&&(d.connectionSpec.minVideoBW=Z.attributes.minVideoBW,d.connectionSpec.maxVideoBW=Z.attributes.maxVideoBW),Object(w.isEdge)()&&(d.videoConstraint.frameRate.max=60),Object(w.isFireFox)()&&(d.videoConstraint.frameRate=30),T.attributes=C()(T.attributes,Z.attributes),d.pc&&d.pc.renegotiate&&d.pc.renegotiate();var re=d.stream&&d.stream.getVideoTracks&&d.stream.getVideoTracks()[0];return re&&re.applyConstraints?(m.default.debug("setVideoProfile applyConstraints",d.videoConstraint),J.a.disableVideoEffect(d).then(function(){return re.applyConstraints(d.videoConstraint)}).then(function(){return J.a.restoreVideoEffect(d)}).then(function(U){return new Promise(function(V,q){$(U),setTimeout(function(){Object(E.vsResHack)(d.stream,function(pe,oe){d.videoWidth=pe,d.videoHeight=oe,V()},function(pe){m.default.warning("[".concat(d.streamId,"] vsResHack failed: "),pe),q()})},2500)})}).catch($)):$(),!0}return $("INVALID_VIDEO_PROFILE_".concat(L)),!1},d.setAudioProfile=function(L){var $=y.report.reportApiInvoke(d.sid,{name:"Stream.setAudioProfile",options:arguments,tag:"tracer"});Object(H.checkValidEnum)(L,"profile",["speech_low_quality","speech_standard","music_standard","standard_stereo","high_quality","high_quality_stereo"]),d.audioProfile=L;var Z=_(L);return d.highQuality=Z.highQuality,d.stereo=Z.stereo,d.speech=Z.speech,d.lowQuality=Z.lowQuality,d.stereo&&Object(w.isChrome)()&&(d.audioConstraint.googAutoGainControl=!1,d.audioConstraint.googAutoGainControl2=!1,d.audioConstraint.echoCancellation=!1,d.audioConstraint.googNoiseSuppression=!1),$(),!0},d.setVideoEncoderConfiguration=function(L){Object(H.checkValidObject)(L,"config");var $=y.report.reportApiInvoke(d.sid,{name:"Stream.setVideoEncoderConfiguration",options:L,tag:"tracer"});L.resolution&&(Object(H.checkValidNumber)(L.resolution.width,"config.resolution.width"),Object(H.checkValidNumber)(L.resolution.height,"config.resolution.height"),d.setVideoResolution([L.resolution.width,L.resolution.height])),L.frameRate&&(Object(H.checkValidNumber)(L.frameRate.min,"config.frameRate.min"),Object(H.checkValidNumber)(L.frameRate.max,"config.frameRate.max"),d.setVideoFrameRate([L.frameRate.min,L.frameRate.max])),L.bitrate&&(Object(H.checkValidNumber)(L.bitrate.min,"config.bitrate.min",1,1e7),Object(H.checkValidNumber)(L.bitrate.max,"config.bitrate.max",1,1e7),d.setVideoBitRate([L.bitrate.min,L.bitrate.max])),$()},d.getSupportedProfile=function(L){var $=y.report.reportApiInvoke(d.sid,{name:"Stream.getSupportedProfile",options:arguments,tag:"tracer",callback:L});if(!d.local){var Z="ONLY_LOCAL_STREAM_SUPPORTED";return m.default.error(Z),$(Z)}if(!d.stream)return m.default.error(Z="STREAM_NOT_INIT"),$(Z);if(!d.stream.getVideoTracks)return m.default.error(Z="TRACK_NOT_SUPPORT"),$(Z);var ce=d.stream.getVideoTracks()[0];if(!ce)return m.default.error(Z="NO_VIDEO_TRACK_FOUND"),$(Z);if(!ce.getCapabilities)return m.default.error(Z="GETCAPABILITY_NOT_SUPPORT"),$(Z);var re=ce.getCapabilities(),U=G(re);return $(null,U)}}(c,S),c.getId=function(){return c.streamId},c.getUserId=function(){return c.userId},c.checkDualStreamEnabled=function(){return!(!Object(g.getParameter)("DUALSTREAM_OPERATION_CHECK")||!c.isDualStream)&&(m.default.error("Operation not permitted: ".concat("DUAL_STREAM_ENABLED")),"DUAL_STREAM_ENABLED")},c.setUserId=function(d){var T=y.report.reportApiInvoke(c.sid,{name:"Stream.setUserId",options:arguments,tag:"tracer"});c.userId&&m.default.warning("[".concat(c.streamId,"] Stream.userId ").concat(c.userId," => ").concat(d)),c.userId=d,T()},c.getAttributes=function(){return S.screen?c.screenAttributes:S.attributes},c.hasAudio=function(){return!!c.audio},c.hasVideo=function(){return!!c.video},c.hasScreen=function(){return!!c.screen},c.hasScreenAudio=function(){return!!c.screenAudio},c.isVideoOn=function(){return(c.hasVideo()||c.hasScreen())&&!c.userMuteVideo},c.isAudioOn=function(){return c.hasAudio()&&!c.userMuteAudio},c.init=function(d,T){var L=y.report.reportApiInvoke(c.sid,{callback:function(re,U){if(re)return T&&T(re);d&&d(U)},name:"Stream.init",options:arguments,tag:"tracer"}),$=((new Date).getTime(),arguments[2]);if(void 0===$&&($=2),!0===c.initialized)return L({type:"warning",msg:"STREAM_ALREADY_INITIALIZED"});if(!0!==c.local)return L({type:"warning",msg:"STREAM_NOT_LOCAL"});var Z=Math.random().toString().slice(3);c._streamInitID=Z,c.videoSource?c.videoName="videoSource":c.video&&(c.videoName=N.a.searchDeviceNameById(S.cameraId)||"default"),c.audioSource?c.audioName="audioSource":c.audio&&(c.audioName=N.a.searchDeviceNameById(S.microphoneId)||"default"),c.screen&&(c.screenName=S.extensionId||"default");try{if(S.audio||S.video||S.screen||S.screenAudio||S.videoSource||S.audioSource){m.default.debug("[".concat(c.streamId,"] Requested access to local media"));var ce={streamId:c.streamId};S.videoSource?ce.videoSource=S.videoSource:S.screen?ce.screen=c.screenConstraint:S.video&&(ce.video=c.videoConstraint),S.audioSource?ce.audioSource=S.audioSource:S.screenAudio?ce.screenAudio=S.screenAudio:S.audio&&(ce.audio=c.audioConstraint),Object(A.b)(ce,function(re){if(ce.screenAudio&&!re.getAudioTracks()[0]&&m.default.warning("[".concat(c.streamId,"] Audio sharing is not selected")),ce.screen&&m.default.debug("[".concat(c.streamId,"] User has granted access to screen sharing")),(ce.video||ce.audio)&&m.default.debug("[".concat(c.streamId,"] User has granted access to local media")),null===c._streamInitID){re.getTracks().forEach(function(V){V.stop()});var U={type:"error",msg:"STREAM_IS_CLOSED",info:"stream is closed and cannot be initialized"};return m.default.error(c.streamId,U.info),void L(U)}if(c._streamInitID!==Z)return re.getTracks().forEach(function(V){V.stop()}),m.default.error(c.streamId,(U={type:"error",msg:"ABORT_OTHER_INIT",info:"stream initialization is aborted because of another stream.init"}).info),void L(U);c.dispatchEvent({type:"accessAllowed"}),c.stream=re,c.initialized=!0,c.reloadDeviceName(),c.hasVideo()&&Object(E.vsResHack)(re,function(V,q){c.videoWidth=V,c.videoHeight=q},function(V){m.default.warning("[".concat(c.streamId,"] vsResHack failed: "),V)}),S.screen&&c.stream&&c.stream.getVideoTracks()[0]&&(c.stream.getVideoTracks()[0].onended=function(){c.dispatchEvent({type:"stopScreenSharing"})}),c.stream&&c.stream.getTracks&&c.stream.getTracks().forEach(function(V){V&&!V.onended&&(V.onended=z),"video"===V.kind&&S.optimizationMode&&(V.contentHint=S.optimizationMode,V.contentHint===S.optimizationMode&&m.default.debug("[".concat(c.streamId,"] set content hint to"),S.optimizationMode))}),L()},function(re){var U={type:"error",info:null};switch(re&&(U.msg=re.name||re.code||re,re.message&&(U.info=re.message),re.code&&(U.info?U.info+=". "+re.code:U.info=" "+re.code),re.constraint&&(U.info?U.info+=". Constraint: "+re.constraint:U.info="constraint: "+re.constraint)),U.msg){case"Starting video failed":case"TrackStartError":if(c.videoConstraint&&(delete c.videoConstraint.width,delete c.videoConstraint.height),$>0)return void setTimeout(function(){c.init(function(q){return L(q)},L,$-1)},1);U.msg="MEDIA_OPTION_INVALID";break;case"DevicesNotFoundError":U.msg="DEVICES_NOT_FOUND";break;case"NotSupportedError":U.msg="NOT_SUPPORTED";break;case"PermissionDeniedError":case"InvalidStateError":U.msg="PERMISSION_DENIED",c.dispatchEvent({type:"accessDenied"});break;case"PERMISSION_DENIED":case"NotAllowedError":c.dispatchEvent({type:"accessDenied"});break;case"ConstraintNotSatisfiedError":U.msg="CONSTRAINT_NOT_SATISFIED";break;default:U.msg||(U.msg="UNDEFINED")}var V="Media access ".concat(U.msg).concat(U.info?": "+U.info:"");m.default.error("[".concat(c.streamId,"] "),V),L(U)})}else L({type:"warning",msg:"STREAM_HAS_NO_MEDIA_ATTRIBUTES"})}catch(re){m.default.error("[".concat(c.streamId,"] Stream init: "),re),L({type:"error",msg:re.message||re})}},c.reloadDeviceName=function(){if(c.stream){if(c.stream.getVideoTracks){var d=c.stream.getVideoTracks()[0];d&&d.label&&(c.videoName=d.label)}if(c.stream.getAudioTracks){var T=c.stream.getAudioTracks()[0];T&&T.label&&(c.audioName=T.label)}}},c.close=function(){var d=y.report.reportApiInvoke(null,{name:"Stream.close",options:arguments,tag:"tracer"});if(m.default.debug("[".concat(c.streamId,"] Close stream with id"),c.streamId),c._originStream)try{c._originStream.getTracks().map(function(Z){return Z.stop()})}catch(Z){}if(void 0!==c.stream){var T=c.stream.getTracks();for(var L in T)T.hasOwnProperty(L)&&(T[L].stop(),T[L].onended=null);!c.isLowStream&&c.local?J.a.disableVideoEffect(c).then(function(){c.stream=void 0}):(c.stream&&c.stream.clean&&c.stream.clean(),c.stream=void 0)}if(c._originStream){for(var L in console.log("clear _originStream"),T=c._originStream.getTracks())T.hasOwnProperty(L)&&(T[L].stop(),T[L].onended=null,console.log("clear onended"));!c.isLowStream&&c.local?J.a.disableVideoEffect(c).then(function(){c._originStream=void 0}):(c._originStream&&c._originStream.clean&&c._originStream.clean(),c._originStream=void 0)}if(Object(w.isSafari)()&&c.pc&&c.pc.peerConnection&&c.pc.peerConnection.removeTrack&&c.pc.peerConnection.getSenders){var $=c.pc.peerConnection.getSenders();$.forEach(function(Z){Z&&(m.default.debug("[".concat(c.streamId,"] Remove Track"),Z),c.pc.peerConnection.removeTrack(Z))})}c.local&&(c.initialized=!1),c._streamInitID=null,c._onAudioMute=void 0,c._onAudioUnmute=void 0,c._onVideoMute=void 0,c._onVideoUnmute=void 0,c.lowStream&&c.lowStream.close(),c.player&&c.player.video&&c.player.video.srcObject&&(c.player.video.srcObject=null),c.player&&c.player.audio&&c.player.audio.srcObject&&(c.player.audio.srcObject=null),d()},c.enableAudio=function(){var d,T=y.report.reportApiInvoke(c.sid,{name:"Stream.enableAudio",options:arguments,tag:"tracer"});return m.default.deprecate("[".concat(c.streamId,"] Stream.enableAudio is deprecated and will be removed in the future. Use Stream.unmuteAudio instead")),c.userMuteAudio||m.default.warning("[".concat(c.streamId,"] User already enableAudio")),c.userMuteAudio=!1,T(null,d=!c.peerMuteAudio&&c._unmuteAudio()),d},c.disableAudio=function(){var d=y.report.reportApiInvoke(c.sid,{name:"Stream.disableAudio",options:arguments,tag:"tracer"});m.default.deprecate("[".concat(c.streamId,"] Stream.disableAudio is deprecated and will be removed in the future. Use Stream.muteAudio instead")),c.userMuteAudio&&m.default.warning("[".concat(c.streamId,"] User already disableAudio")),c.userMuteAudio=!0;var T=c._muteAudio();return d(null,T),T},c.enableVideo=function(){var d,T=y.report.reportApiInvoke(c.sid,{name:"Stream.enableVideo",options:arguments,tag:"tracer"});return m.default.deprecate("[".concat(c.streamId,"] Stream.enableVideo is deprecated and will be removed in the future. Use Stream.unmuteVideo instead")),c.userMuteVideo||m.default.warning("[".concat(c.streamId,"] User already enableVideo")),c.userMuteVideo=!1,c.lowStream&&(c.lowStream.userMuteVideo=!1),T(null,d=!c.peerMuteVideo&&c._unmuteVideo()),d},c.disableVideo=function(){var d=y.report.reportApiInvoke(c.sid,{name:"Stream.disableVideo",options:arguments,tag:"tracer"});m.default.deprecate("[".concat(c.streamId,"] Stream.disableVideo is deprecated and will be removed in the future. Use Stream.muteVideo instead")),c.userMuteVideo&&m.default.warning("[".concat(c.streamId,"] User already disableVideo")),c.userMuteVideo=!0,c.lowStream&&(c.lowStream.userMuteVideo=!0);var T=c._muteVideo();return d(null,T),T},c.unmuteAudio=function(){var d,T=y.report.reportApiInvoke(c.sid,{name:"Stream.unmuteAudio",options:arguments,tag:"tracer"});return c.userMuteAudio||m.default.warning("[".concat(c.streamId,"] User already unmuteAudio")),c.userMuteAudio=!1,T(null,d=!c.peerMuteAudio&&c._unmuteAudio()),d},c.muteAudio=function(){var d=y.report.reportApiInvoke(c.sid,{name:"Stream.muteAudio",options:arguments,tag:"tracer"});c.userMuteAudio&&m.default.warning("[".concat(c.streamId,"] User already muteAudio")),c.userMuteAudio=!0;var T=c._muteAudio();return d(null,T),T},c.unmuteVideo=function(){var d,T=y.report.reportApiInvoke(c.sid,{name:"Stream.unmuteVideo",options:arguments,tag:"tracer"});return c.userMuteVideo||m.default.warning("[".concat(c.streamId,"] User already unmuteVideo")),c.userMuteVideo=!1,c.lowStream&&(c.lowStream.userMuteVideo=!1),T(null,d=!c.peerMuteVideo&&c._unmuteVideo()),d},c.muteVideo=function(){var d=y.report.reportApiInvoke(c.sid,{name:"Stream.muteVideo",options:arguments,tag:"tracer"});c.userMuteVideo&&m.default.warning("[".concat(c.streamId,"] User already muteVideo")),c.userMuteVideo=!0,c.lowStream&&(c.lowStream.userMuteVideo=!0);var T=c._muteVideo();return d(null,T),T},c._unmuteAudio=function(){return m.default.debug("[".concat(c.streamId,"] Unmuted audio stream with id "),c.streamId),c._flushAudioMixingMuteStatus(!1),!(!c.hasAudio()||!c.initialized||void 0===c.stream||!0===c.stream.getAudioTracks()[0].enabled||(c._onAudioUnmute&&c._onAudioUnmute(),c.pc&&(c.pc.isAudioMute=!1),c.stream.getAudioTracks()[0].enabled=!0,0))},c._isAudioMuted=function(){if(c.stream&&c.hasAudio()){var d=c.stream.getAudioTracks();return d.length>0&&!d[0].enabled}return!1},c._isVideoMuted=function(){if(c.stream&&c.hasVideo()){var d=c.stream.getVideoTracks();return d.length>0&&!d[0].enabled}return!1},c._muteAudio=function(){return m.default.debug("[".concat(c.streamId,"] Muted audio stream with id "),c.streamId),c._flushAudioMixingMuteStatus(!0),!!(c.hasAudio()&&c.initialized&&void 0!==c.stream&&c.stream.getAudioTracks()[0].enabled)&&(c._onAudioMute&&c._onAudioMute(),c.pc&&(c.pc.isAudioMute=!0),c.stream.getAudioTracks()[0].enabled=!1,c.sid&&y.report.audioSendingStopped(c.sid,{succ:!0,reason:"muteAudio"}),!0)},c._unmuteVideo=function(){return m.default.debug("[".concat(c.streamId,"] Unmuted video stream with id"),c.streamId),!(!c.initialized||void 0===c.stream||!c.stream.getVideoTracks().length||!0===c.stream.getVideoTracks()[0].enabled||(c._onVideoUnmute&&c._onVideoUnmute(),c.pc&&(c.pc.isVideoMute=!1),c.stream.getVideoTracks()[0].enabled=!0,c.lowStream&&c.lowStream._unmuteVideo(),0))},c._muteVideo=function(){return m.default.debug("[".concat(c.streamId,"] Muted video stream with id"),c.streamId),!!(c.initialized&&void 0!==c.stream&&c.stream.getVideoTracks().length&&c.stream.getVideoTracks()[0].enabled)&&(c._onVideoMute&&c._onVideoMute(),c.pc&&(c.pc.isVideoMute=!0),c.stream.getVideoTracks()[0].enabled=!1,c.lowStream&&c.lowStream._muteVideo(),c.sid&&y.report.videoSendingStopped(c.sid,{succ:!0,reason:"muteVideo"}),!0)},c.addTrack=function(d){if(c.audio&&"audio"===d.kind)m.default.warning("already added audio track");else if(c.video&&"video"===d.kind)m.default.warning("already added video track");else{var T=y.report.reportApiInvoke(c.sid,{name:"Stream.addTrack",options:arguments,tag:"tracer"});if(c.pc&&c.pc.addTrack(d,c.stream),"audio"==d.kind){c._cleanupAudioMixing();var L=new MediaStream;c.userMuteAudio&&(d.enabled=!1),L.addTrack(d);var $=c.stream.getVideoTracks()[0];$&&L.addTrack($),c.audio=!0,S.audio=!0,c.stream=L,c.audioLevelHelper=null,c.player&&c.player.video&&(c.player.video.srcObject=c.stream)}else c.userMuteVideo&&(d.enabled=!1),c.stream.addTrack(d),c.video=!0,S.video=!0;d.onended||(d.onended=z),T()}},c.removeTrack=function(d){if(d)if(c.audio||"audio"!==d.kind)if(c.video||"video"!==d.kind){var T=y.report.reportApiInvoke(c.sid,{name:"Stream.removeTrack",options:arguments,tag:"tracer"});c.pc&&c.pc.removeTrack(d,c.stream),c.stream.removeTrack(d),c._cleanupAudioMixing(),"audio"===d.kind?(c.audio=!1,S.audio=!1):(c.video=!1,S.video=!1),c.audioLevelHelper=null,"live"==d.readyState&&(d.stop(),m.default.debug("[".concat(c.streamId,"] Track ").concat(d.kind," Stopped"))),T()}else m.default.warning("already removed video track");else m.default.warning("already removed audio track");else m.default.warning("track doesn't exist.")},c.setAudioOutput=function(d,T,L){var $=y.report.reportApiInvoke(c.sid,{callback:function(Z,ce){if(Z)return L&&L(Z);T&&T(ce)},name:"Stream.setAudioOutput",options:arguments,tag:"tracer"});return Object(H.isValidString)(d,1,255)?(c.audioOutput=d,c.player?void c.player.setAudioOutput(d,function(){return $()},$):$()):(m.default.error("[".concat(c.streamId,"] setAudioOutput Invalid Parameter"),d),$(f.default.INVALID_PARAMETER))},c.play=function(d,T,L){"function"==typeof T&&(L=T,T=null),m.default.debug("[".concat(c.streamId,"] play()."),d,T);var $=y.report.reportApiInvoke(c.sid,{name:"Stream.play",options:arguments,tag:"tracer",callback:L});if(Object(H.checkValidString)(d,"elementID"),Object(H.isEmpty)(T)||(Object(H.isEmpty)(T.fit)||Object(H.checkValidEnum)(T.fit,"fit",["cover","contain"]),Object(H.isEmpty)(T.muted)||Object(H.checkValidBoolean)(T.muted,"muted")),c.player)m.default.warning("[".concat(c.streamId,"] Stream.play(): Stream is already playing. Fallback to resume stream")),c.resume().then(function(){$(null)}).catch($);else{c.elementID=d,c.playOptions=T,!c.local||c.video||c.screen?(c.player=new j({id:c.getId(),stream:c,elementID:d,options:T}),c.local&&J.a.applyEffectInPlayer(c)):c.hasAudio()&&(c.player=new j({id:c.getId(),stream:c,elementID:d,options:T}));var Z={video:null,audio:null},ce=function re(U){if(Z[U.mediaType]=U,Z.video&&Z.audio)if(c.removeEventListener("player-status-change",re),Z.video.isErrorState||Z.audio.isErrorState){var V=Z.video.isErrorState?Z.video:Z.audio;$({isErrorState:!0,status:V.status,reason:V.reason,video:Z.video,audio:Z.audio})}else $("aborted"===Z.video.status&&"aborted"===Z.audio.status?{status:"aborted",reason:"stop",video:Z.video,audio:Z.audio}:null)};c.on("player-status-change",ce),c.audioOutput&&c.player.setAudioOutput(c.audioOutput),void 0!==c.audioLevel&&c.player.setAudioVolume(c.audioLevel),c._flushAudioMixingMuteStatus(!1)}},c.stop=function(){var d=y.report.reportApiInvoke(c.sid,{name:"Stream.stop",options:arguments,tag:"tracer"});m.default.debug("[".concat(c.streamId,"] Stop stream player with id "),c.streamId),c.player?(J.a.removeEffectFromLocalPlayer(c),c.player.destroy(),delete c.player):m.default.error("[".concat(c.streamId,"] Stream.stop(): Stream is not playing")),c._flushAudioMixingMuteStatus(!0),d()},c.isPlaying=function(){return!!c.player},c.isPaused=function(){return!(!c.player||!(c.player.video&&c.player.video.paused&&c.player.mediaElemExists(c.player.video)||c.player.audio&&c.player.audio.paused&&c.player.mediaElemExists(c.player.audio)))},c.resume=function(){var d,T;return c.player?(c.player.video&&c.player.video.play&&(d=c.player.video.play()),d=d||Promise.resolve(),c.player.audio&&c.player.audio.play&&(T=c.player.audio.play()),T=T||Promise.resolve(),Promise.all([d,T])):Promise.reject("NO_PLAYER_FOUND")},c.getVideoTrack=function(){var d=y.report.reportApiInvoke(c.sid,{name:"Stream.getVideoTrack",options:arguments,tag:"tracer"});if(c.stream&&c.stream.getVideoTracks){var T=c.stream.getVideoTracks()[0];if(T)return m.default.info("[".concat(c.streamId,"] getVideoTrack"),T),d(),T}m.default.info("[".concat(c.streamId,"] getVideoTrack None")),d(null,"getVideoTrack None")},c.getAudioTrack=function(){var d=y.report.reportApiInvoke(c.sid,{name:"Stream.getAudioTrack",options:arguments,tag:"tracer"});if(c.stream&&c.stream.getAudioTracks){var T=c.stream.getAudioTracks()[0];if(T)return m.default.info("[".concat(c.streamId,"] getAudioTracks"),T),d(),T}m.default.info("[".concat(c.streamId,"] getAudioTracks None")),d(null,"getAudioTracks None")},c._hasVideoTracks=function(){return!!(c.stream&&c.stream.getVideoTracks&&c.stream.getVideoTracks()[0])},c._hasAudioTracks=function(){return!!(c.stream&&c.stream.getAudioTracks&&c.stream.getAudioTracks()[0])},c._replaceMediaStreamTrack=function(d,T,L){if(c.stream){if("video"==d.kind){if(Z=c.stream.getVideoTracks()[0])return c.userMuteVideo&&(d.enabled=!1),c.stream.removeTrack(Z),c.stream.addTrack(d),m.default.debug("[".concat(c.streamId,"] _replaceMediaStreamTrack ").concat(d.kind," SUCCESS")),"live"==Z.readyState&&(Z.stop(),m.default.debug("[".concat(c.streamId,"] Track ").concat(Z.kind," Stopped"))),T&&T();var $="MEDIASTREAM_TRACK_NOT_FOUND";return m.default.error("[".concat(c.streamId,"] MEDIASTREAM_TRACK_NOT_FOUND ").concat(d.kind)),L($)}if("audio"==d.kind){var Z;if(Z=c.stream.getAudioTracks()[0]){c.userMuteAudio&&(d.enabled=!1);var ce=new MediaStream;ce.addTrack(d);var re=c.stream&&c.stream.getVideoTracks()[0];return re&&ce.addTrack(re),c.stream=ce,c.audioLevelHelper=null,c.player&&c.player.video&&(c.player.video.srcObject=c.stream),m.default.debug("[".concat(c.streamId,"] _replaceMediaStreamTrack SUCCESS")),"live"==Z.readyState&&(Z.stop(),m.default.debug("[".concat(c.streamId,"] Track ").concat(Z.kind," Stopped"))),T&&T()}return $="MEDIASTREAM_TRACK_NOT_FOUND",m.default.error("[".concat(c.streamId,"] MEDIASTREAM_TRACK_NOT_FOUND ").concat(d.kind)),L($)}return $="INVALID_TRACK_TYPE",m.default.error("[".concat(c.streamId,"] _replaceMediaStreamTrack ").concat($," ").concat(d.kind)),L&&L($)}return $="NO_STREAM_FOUND",m.default.error("[".concat(c.streamId,"] _replaceMediaStreamTrack ").concat($)),L&&L($)},c.replaceTrack=function(d,T,L){var $=y.report.reportApiInvoke(c.sid,{callback:function(Z,ce){if(Z)return L&&L(Z);T&&T(ce)},name:"Stream.replaceTrack",options:arguments,tag:"tracer"});return d&&d.kind?(c._cleanupAudioMixing(),d.onended||(d.onended=z),c.pc&&c.pc.hasSender&&c.pc.hasSender(d.kind)?void c.pc.replaceTrack(d,function(){return m.default.debug("[".concat(c.streamId,"] PeerConnection.replaceTrack ").concat(d.kind," SUCCESS")),c._replaceMediaStreamTrack(d,function(Z){return $(null,Z)},$)},function(Z){return m.default.error("[".concat(c.streamId,"] PeerConnection.replaceTrack ").concat(d.kind," Failed ").concat(Z)),$(Z)}):c._replaceMediaStreamTrack(d,function(Z){return $(null,Z)},$)):$("INVALID_TRACK")},c.setAudioVolume=function(d){var T=y.report.reportApiInvoke(c.sid,{name:"Stream.setAudioVolume",options:arguments,tag:"tracer"});Object(H.checkValidNumber)(d,"level",0,100),c.audioLevel=d,c.player&&c.player.setAudioVolume(d),T()},c.getStats=function(d,T,L){var $=[];$.push(c._getPCStats(L)),$.push(new Promise(function(Z){var ce={};c.pc&&c.pc.isSubscriber?null!==window.navigator.userAgent.match("Firefox")&&(Object(F.b)(ce,"videoReceiveResolutionHeight",c.videoHeight),Object(F.b)(ce,"videoReceiveResolutionWidth",c.videoWidth)):c.pc&&!c.pc.isSubscriber&&((Object(w.isSafari)()||Object(w.isFireFox)())&&(Object(F.b)(ce,"videoSendResolutionHeight",c.videoHeight),Object(F.b)(ce,"videoSendResolutionWidth",c.videoWidth)),(Object(w.isSafari)()||Object(w.isFireFox)())&&c.uplinkStats&&Object(F.b)(ce,"videoSendPacketsLost",c.uplinkStats.uplink_cumulative_lost)),Z(ce)})),$.push(new Promise(function(Z){var ce={};return c.traffic_stats&&c.pc&&c.pc.isSubscriber?(Object(F.b)(ce,"accessDelay",c.traffic_stats.access_delay),Object(F.b)(ce,"endToEndDelay",c.traffic_stats.e2e_delay),Object(F.b)(ce,"videoReceiveDelay",c.traffic_stats.video_delay),Object(F.b)(ce,"audioReceiveDelay",c.traffic_stats.audio_delay)):c.traffic_stats&&c.pc&&!c.pc.isSubscriber&&Object(F.b)(ce,"accessDelay",c.traffic_stats.access_delay),Z(ce)})),Promise.all($).then(function(Z){for(var ce={},re=Z.length-1;re>=0;re--){var U=Z[re];C()(ce,U)}d&&setTimeout(d.bind(c,ce),0)}).catch(function(Z){T&&setTimeout(T.bind(c,Z),0)})},c._getPCStats=function(d){return new Promise(function(T,L){if(!c.pc||"established"!==c.pc.state||!c.pc.getStats)return L("PEER_CONNECTION_NOT_ESTABLISHED");c.pc.getStats(function($){if(!c.pc||"established"!==c.pc.state||!c.pc.getStats)return L("PEER_CONNECTION_STATE_CHANGE");var Z=c.pc.isSubscriber?Object(F.c)($):Object(F.a)($);return T(Z)},d)}).then(function(T){return c.pc.isSubscriber?(Object(w.isFireFox)()||Object(w.isSafari)())&&(T.videoReceiveResolutionHeight&&"0"!==T.videoReceiveResolutionHeight||T.videoReceiveResolutionWidth&&"0"!==T.videoReceiveResolutionWidth||(Object(F.b)(T,"videoReceiveResolutionHeight",c.videoHeight),Object(F.b)(T,"videoReceiveResolutionWidth",c.videoWidth))):((Object(w.isSafari)()||Object(w.isFireFox)())&&(T.videoSendResolutionHeight&&"0"!==T.videoSendResolutionHeight||T.videoSendResolutionWidth&&"0"!==T.videoSendResolutionWidth||(Object(F.b)(T,"videoSendResolutionHeight",c.videoHeight),Object(F.b)(T,"videoSendResolutionWidth",c.videoWidth))),(Object(w.isSafari)()||Object(w.isFireFox)())&&c.uplinkStats&&Object(F.b)(T,"videoSendPacketsLost",c.uplinkStats.uplink_cumulative_lost)),Promise.resolve(T)})},c.getAudioLevel=function(){if(c.audioLevelHelper)return c.audioLevelHelper.getAudioLevel();if(c.stream){if(0!==c.stream.getAudioTracks().length)return c.audioLevelHelper=new E.audioLevelHelper(c.stream),c.audioLevelHelper.getAudioLevel();m.default.warning("[".concat(c.streamId,"] can't get audioLevel beacuse no audio trace in stream"))}else m.default.warning("[".concat(c.streamId,"] can't get audioLevel beacuse no stream exist"))},c.setVideoProfile("480p_1"),c._switchVideoDevice=function(d,T,L){if(d===c.cameraId)return T&&T();var $={video:C()({},c.videoConstraint,{deviceId:{exact:d}}),audio:!1};m.default.debug("[".concat(c.streamId,"] ").concat($)),Object(A.b)($,function(Z){try{var ce=function(){c.isPlaying()&&(c.stop(),c.elementID&&c.play(c.elementID,c.playOptions)),c.cameraId=d,c.videoConstraint.deviceId={exact:d},c.userMuteVideo&&(c.stream.getVideoTracks()[0].enabled=!1),J.a.restoreVideoEffect(c).then(function(){T&&T()})};J.a.disableVideoEffect(c).then(function(){var re=!1;window.RTCRtpSender&&"function"==typeof RTCRtpSender.prototype.replaceTrack&&(re=!0),re?c.replaceTrack(Z.getVideoTracks()[0],ce,L):(c.removeTrack(c.stream.getVideoTracks()[0]),c.addTrack(Z.getVideoTracks()[0]),ce())})}catch(re){return L&&L(re)}},function(Z){return L&&L(Z)})},c._switchAudioDevice=function(d,T,L){if(d===c.microphoneId)return T&&T();var $={video:!1,audio:C()({},c.audioConstraint,{deviceId:{exact:d}})};m.default.debug("[".concat(c.streamId,"] "),$);var Z=c.stream.getAudioTracks()[0];Z&&Z.stop(),Object(A.b)($,function(ce){var re=function(){c._cleanupAudioMixing(),c.userMuteAudio&&(c.stream.getAudioTracks()[0].enabled=!1),c.isPlaying()&&(c.stop(),c.elementID&&c.play(c.elementID,c.playOptions)),c.microphoneId=d,c.audioConstraint.deviceId={exact:d},T&&T()};try{var U=!1;window.RTCRtpSender&&"function"==typeof RTCRtpSender.prototype.replaceTrack&&(U=!0),U?c.replaceTrack(ce.getAudioTracks()[0],re,L):(c.removeTrack(c.stream.getAudioTracks()[0]),c.addTrack(ce.getAudioTracks()[0]),re())}catch(V){return L&&L(V)}},function(ce){return L&&L(ce)})},c.switchDevice=function(d,T,L,$){var Z=y.report.reportApiInvoke(c.sid,{callback:function(oe,de){if(oe)return $&&$(oe);L&&L(de)},name:"Stream.switchDevice",options:arguments,tag:"tracer"});Object(H.checkValidString)(T,"deviceId");var ce=function(){return c.inSwitchDevice=!1,Z()},re=function(oe){c.inSwitchDevice=!1,m.default.error("[".concat(c.streamId,"] "),oe),Z(oe)};if(c.inSwitchDevice)return Z("Device switch is in process.");if(c.inSwitchDevice=!0,!c.local)return re("Only the local stream can switch the device.");if(c.screen&&"video"===d)return re("The device cannot be switched during screen-sharing.");if(!c.video&&"video"===d)return re("Video track not exist.");if(!c.audio&&"audio"===d)return re("Audio track not exist.");if(c.videoSource||c.audioSource)return re("The device cannot be switched when using videoSource or audioSource.");var U=!1;for(var V in c.audioMixing.sounds){var q=c.audioMixing.sounds[V];if(q.state!==c.audioMixing.states.IDLE){U=!0;break}}var pe=c.audioMixing.audioContextInited;if(pe&&U)return re("The device cannot be switched when using audio Mixing.");N.a.getDeviceById(T,function(){if("video"===d)c._switchVideoDevice(T,ce,re);else{if("audio"!==d)return re("Invalid type.");c._switchAudioDevice(T,ce,re)}},function(){return re("The device does not exist.")})},c},B=function(S){var c=y.report.reportApiInvoke(null,{name:"createStream",options:arguments,tag:"tracer",getStates:function(){return{audioTrackEnable:S&&S.audioSource?S.audioSource.enabled:null,videoTrackEnable:S&&S.videoSource?S.videoSource.enabled:null}}});Object(H.checkValidObject)(S,"StreamSpec");var z=S.streamID,d=S.audio,T=S.video,L=S.screen,$=S.screenAudio,Z=S.cameraId,ce=S.facingMode,re=S.microphoneId,U=S.mirror,V=S.extensionId,q=S.mediaSource,pe=S.audioProcessing,oe=S.optimizationMode;if(!Object(H.isEmpty)(z)&&!Object(E.is32Uint)(z)&&!Object(H.isValidString)(z,1,255))throw new Error("[String streamID] Length of the string: [1,255]. ASCII characters only. [Number streamID] The value range is Uint32");if(Object(H.checkValidBoolean)(d,"audio"),Object(H.checkValidBoolean)(T,"video"),Object(H.isEmpty)(L)||Object(H.checkValidBoolean)(L,"screen"),Object(H.isEmpty)($)||Object(H.checkValidBoolean)($,"screenAudio"),Object(H.isEmpty)(Z)||Object(H.checkValidString)(Z,"cameraId",0,255,!1),Object(H.isEmpty)(ce)||Object(H.checkValidEnum)(ce,"facingMode",["user","environment","left","right"]),Object(H.isEmpty)(re)||Object(H.checkValidString)(re,"microphoneId",0,255,!1),Object(H.isEmpty)(V)||Object(H.checkValidString)(V,"extensionId"),Object(H.isEmpty)(q)||Object(H.checkValidEnum)(q,"mediaSource",["screen","application","window"]),Object(H.isEmpty)(U)||Object(H.checkValidBoolean)(U,"mirror"),!Object(H.isEmpty)(pe)){var de=pe.AGC,ye=pe.AEC,Te=pe.ANS;Object(H.isEmpty)(de)||Object(H.checkValidBoolean)(de,"AGC"),Object(H.isEmpty)(ye)||Object(H.checkValidBoolean)(ye,"AEC"),Object(H.isEmpty)(Te)||Object(H.checkValidBoolean)(Te,"ANS")}Object(H.isEmpty)(oe)||Object(H.checkValidEnum)(oe,"optimizationMode",["detail","motion"]),m.default.debug("Create stream"),!0===$&&!0===d&&m.default.warning("Do not set both 'screenAudio' and 'audio' to true at the same time"),S.screen&&!oe&&(S.optimizationMode="detail");var Re=u(S);return c(),Re}},function(se,ee,x){"use strict";x.d(ee,"a",function(){return ne}),x.d(ee,"b",function(){return G});var I=x(5),C=x(7),w=x.n(C),b=x(12),D=x.n(b),m=x(17),R=x.n(m),f=x(0),g=x(15),y=x(2);function j(_,u){(null==u||u>_.length)&&(u=_.length);for(var B=0,S=new Array(u);B<u;B++)S[B]=_[B];return S}function F(_){if("undefined"==typeof Symbol||null==_[Symbol.iterator]){if(Array.isArray(_)||(_=function(T,L){if(T){if("string"==typeof T)return N(T,L);var $=Object.prototype.toString.call(T).slice(8,-1);if("Object"===$&&T.constructor&&($=T.constructor.name),"Map"===$||"Set"===$)return Array.from($);if("Arguments"===$||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test($))return N(T,L)}}(_))){var u=0,B=function(){};return{s:B,n:function(){return u>=_.length?{done:!0}:{done:!1,value:_[u++]}},e:function(T){throw T},f:B}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var S,c,z=!0,d=!1;return{s:function(){S=_[Symbol.iterator]()},n:function(){var T=S.next();return z=T.done,T},e:function(T){d=!0,c=T},f:function(){try{z||null==S.return||S.return()}finally{if(d)throw c}}}}function N(_,u){(null==u||u>_.length)&&(u=_.length);for(var B=0,S=new Array(u);B<u;B++)S[B]=_[B];return S}var O=x(50),J=x.n(O),te=x(26),Y=(x(4),103),ne=function(_){var u={};if(u.clientId=_.clientId,_.session_id=Y+=1,"undefined"==typeof window||!window.navigator)throw f.default.error("["+u.streamId+"]["+u.clientId+"]Publish/subscribe video/audio streams not supported yet"),new Error("NON_BROWSER_ENV_DETECTED");return null!==window.navigator.userAgent.match("Firefox")?(u.browser="mozilla",u=function(_){var U,u={},B=(mozRTCPeerConnection,mozRTCSessionDescription),S=!1;u.uid=_.uid,u.isVideoMute=_.isVideoMute,u.isAudioMute=_.isAudioMute,u.isSubscriber=_.isSubscriber,u.clientId=_.clientId,u.filterStatsCache=[],u.originStatsCache=[],u.lastTimeGetStats=null,u.pc_config={iceServers:[]},_.iceServers instanceof Array?_.iceServers.map(function(U){0===U.url.indexOf("stun:")&&u.pc_config.iceServers.push({url:U.url})}):(_.stunServerUrl&&(_.stunServerUrl instanceof Array?_.stunServerUrl.map(function(U){"string"==typeof U&&""!==U&&u.pc_config.iceServers.push({url:U})}):"string"==typeof _.stunServerUrl&&""!==_.stunServerUrl&&u.pc_config.iceServers.push({url:_.stunServerUrl})),_.turnServers&&(_.turnServers instanceof Array?_.turnServers.map(function(U){U.udpport&&u.pc_config.iceServers.push({username:U.username,credential:U.credential,credentialType:"password",urls:(U.useTurns?"turns:":"turn:")+U.url+":"+U.udpport+"?transport=udp"}),"string"==typeof U.tcpport&&""!==U.tcpport&&u.pc_config.iceServers.push({username:U.username,credential:U.credential,credentialType:"password",urls:(U.useTurns?"turns:":"turn:")+U.url+":"+U.tcpport+"?transport=tcp"}),!0===U.forceturn&&(u.pc_config.iceTransportPolicy="relay")}):f.default.error("[".concat(u.clientId,"] turnServers is not a array")))),void 0===_.audio&&(_.audio=!0),void 0===_.video&&(_.video=!0),u.mediaConstraints={offerToReceiveAudio:_.audio,offerToReceiveVideo:_.video,mozDontOfferDataChannel:!0},u.roapSessionId=103,u.peerConnection=new g.RTCPeerConnection(u.pc_config),u.iceCandidateTimer=setTimeout(function(){u.iceCandidateTimer=null,f.default.debug("[".concat(u.clientId,"]Candidates collected: ").concat(u.iceCandidateCount)),u.moreIceComing&&(u.moreIceComing=!1,u.markActionNeeded())},Object(y.getParameter)("CANDIDATE_TIMEOUT")),u.peerConnection.onicecandidate=function(U){var V,q,pe,oe;q=(V=u.peerConnection.localDescription.sdp).match(/a=candidate:.+typ\ssrflx.+\r\n/),pe=V.match(/a=candidate:.+typ\shost.+\r\n/),oe=V.match(/a=candidate:.+typ\srelay.+\r\n/),null===q&&null===pe&&null===oe||void 0!==u.ice||!u.iceCandidateTimer||(clearTimeout(u.iceCandidateTimer),u.iceCandidateTimer=null,u.ice=0,u.moreIceComing=!1,u.markActionNeeded()),u.iceCandidateCount=u.iceCandidateCount+1},u.checkMLineReverseInSDP=function(U){return!(!~U.indexOf("m=audio")||!~U.indexOf("m=video"))&&U.indexOf("m=audio")>U.indexOf("m=video")},u.reverseMLineInSDP=function(U){var V=U.split("m=audio"),q=V[1].split("m=video");return V[0]+"m=video"+q[1]+"m=audio"+q[0]},u.processSignalingMessage=function(U){var V,q=JSON.parse(U);u.incomingMessage=q,"new"===u.state?"OFFER"===q.messageType?(q.sdp=ce(q.sdp),u.peerConnection.setRemoteDescription(new B(V={sdp:q.sdp,type:"offer"}),function(){f.default.debug("["+u.clientId+"]setRemoteDescription succeeded")},function(pe){f.default.info("["+u.clientId+"]setRemoteDescription failed: "+pe.name)}),u.state="offer-received",u.markActionNeeded()):u.error("Illegal message for this state: "+q.messageType+" in state "+u.state):"offer-sent"===u.state?"ANSWER"===q.messageType?(q.sdp=ce(q.sdp),q.sdp=q.sdp.replace(/ generation 0/g,""),q.sdp=q.sdp.replace(/ udp /g," UDP "),-1!==q.sdp.indexOf("a=group:BUNDLE")?(q.sdp=q.sdp.replace(/a=group:BUNDLE audio video/,"a=group:BUNDLE sdparta_0 sdparta_1"),q.sdp=q.sdp.replace(/a=mid:audio/,"a=mid:sdparta_0"),q.sdp=q.sdp.replace(/a=mid:video/,"a=mid:sdparta_1")):(q.sdp=q.sdp.replace(/a=mid:audio/,"a=mid:sdparta_0"),q.sdp=q.sdp.replace(/a=mid:video/,"a=mid:sdparta_0")),V={sdp:q.sdp,type:"answer"},_.screen&&"detail"===_.optimizationMode&&(f.default.debug("[".concat(u.client,"] remove screen share abs ext")),q.sdp=re(V.sdp)),u.peerConnection.setRemoteDescription(new B(V),function(){f.default.debug("["+u.clientId+"]setRemoteDescription succeeded")},function(pe){f.default.info("["+u.clientId+"]setRemoteDescription failed: "+pe)}),u.state="established"):"pr-answer"===q.messageType?u.peerConnection.setRemoteDescription(new B(V={sdp:q.sdp,type:"pr-answer"}),function(){f.default.debug("["+u.clientId+"]setRemoteDescription succeeded")},function(pe){f.default.info("["+u.clientId+"]setRemoteDescription failed: "+pe.name)}):u.error("offer"===q.messageType?"Not written yet":"Illegal message for this state: "+q.messageType+" in state "+u.state):"established"===u.state&&("OFFER"===q.messageType?(u.peerConnection.setRemoteDescription(new B(V={sdp:q.sdp,type:"offer"}),function(){f.default.debug("["+u.clientId+"]setRemoteDescription succeeded")},function(pe){f.default.info("["+u.clientId+"]setRemoteDescription failed: "+pe.name)}),u.state="offer-received",u.markActionNeeded()):u.error("Illegal message for this state: "+q.messageType+" in state "+u.state))},u.setRtpSenderParameters=(U=R()(D.a.mark(function V(q){var pe,oe,de;return D.a.wrap(function(ye){for(;;)switch(ye.prev=ye.next){case 0:if(pe=u.peerConnection.getSenders(),oe=pe.find(function(Te){return"video"===Te.track.kind})){ye.next=4;break}return ye.abrupt("return");case 4:return(de=oe.getParameters()).degradationPreference=q,ye.prev=6,f.default.debug("[".concat(u.clientId,"] setParameters"),de),ye.next=10,oe.setParameters(de);case 10:ye.next=15;break;case 12:ye.prev=12,ye.t0=ye.catch(6),f.default.debug("[".concat(u.clientId,"] setParameters failed, ignore"));case 15:case"end":return ye.stop()}},V,null,[[6,12]])})),function(V){return U.apply(this,arguments)});var c={id:"",type:"",mediaType:"opus",googCodecName:"opus",aecDivergentFilterFraction:"0",audioInputLevel:"0",bytesSent:"0",packetsSent:"0",googEchoCancellationReturnLoss:"0",googEchoCancellationReturnLossEnhancement:"0"},z={id:"",type:"",mediaType:"",googCodecName:_.codec?_.codec.toUpperCase():"",bytesSent:"0",packetsLost:"0",packetsSent:"0",googAdaptationChanges:"0",googAvgEncodeMs:"0",googEncodeUsagePercent:"0",googFirsReceived:"0",googFrameHeightSent:"0",googFrameHeightInput:"0",googFrameRateInput:"0",googFrameRateSent:"0",googFrameWidthSent:"0",googFrameWidthInput:"0",googNacksReceived:"0",googPlisReceived:"0",googRtt:"0"},d={id:"",type:"",mediaType:"",audioOutputLevel:"0",bytesReceived:"0",packetsLost:"0",packetsReceived:"0",googAccelerateRate:"0",googCurrentDelayMs:"0",googDecodingCNG:"0",googDecodingCTN:"0",googDecodingCTSG:"0",googDecodingNormal:"0",googDecodingPLC:"0",googDecodingPLCCNG:"0",googExpandRate:"0",googJitterBufferMs:"0",googJitterReceived:"0",googPreemptiveExpandRate:"0",googPreferredJitterBufferMs:"0",googSecondaryDecodedRate:"0",googSpeechExpandRate:"0"},T={id:"",type:"",mediaType:"",googTargetDelayMs:"0",packetsLost:"0",googDecodeMs:"0",googMaxDecodeMs:"0",googRenderDelayMs:"0",googFrameWidthReceived:"0",googFrameHeightReceived:"0",googFrameRateReceived:"0",googFrameRateDecoded:"0",googFrameRateOutput:"0",googJitterBufferMs:"0",googCurrentDelayMs:"0",googMinPlayoutDelayMs:"0",googNacksSent:"0",googPlisSent:"0",googFirsSent:"0",bytesReceived:"0",packetsReceived:"0",googFramesDecoded:"0"},L=0,$=0,Z=0;u.getVideoRelatedStats=function(U){u.peerConnection.getStats().then(function(V){var q,pe=F(V.values());try{for(pe.s();!(q=pe.n()).done;){var oe=q.value;if(u.isSubscriber){if(("inbound-rtp"===oe.type||"inboundrtp"===oe.type)&&"video"===oe.mediaType){if(!u.lastReport)return void(u.lastReport=oe);U&&U({browser:"firefox",mediaType:"video",peerId:u.uid,isVideoMute:u.isVideoMute,frameRateReceived:Math.round(oe.framerateMean)+"",frameRateDecoded:oe.framesDecoded-u.lastReport.framesDecoded+"",bytesReceived:oe.bytesReceived+"",packetsReceived:oe.packetsReceived+"",packetsLost:oe.packetsLost+""}),u.lastReport=oe}}else if(("outbound-rtp"===oe.type||"outboundrtp"===oe.type)&&"video"===oe.mediaType){if(!u.lastReport)return void(u.lastReport=oe);U&&U({mediaType:"video",isVideoMute:u.isVideoMute,frameRateInput:Math.round(oe.framerateMean)+"",frameRateSent:oe.framesEncoded-u.lastReport.framesEncoded+""}),u.lastReport=oe}}}catch(de){pe.e(de)}finally{pe.f()}})},u.getAudioRelatedStats=function(U){u.peerConnection.getStats().then(function(V){var q,pe=F(V.values());try{for(pe.s();!(q=pe.n()).done;){var oe=q.value;u.isSubscriber&&("inbound-rtp"!==oe.type&&"inboundrtp"!==oe.type||"audio"!==oe.mediaType||U&&U({browser:"firefox",mediaType:"audio",peerId:u.uid,isAudioMute:u.isAudioMute,frameDropped:oe.packetsLost+"",frameReceived:oe.packetsReceived+"",googJitterReceived:oe.jitter+"",bytesReceived:oe.bytesReceived+"",packetsReceived:oe.packetsReceived+"",packetsLost:oe.packetsLost+""}))}}catch(de){pe.e(de)}finally{pe.f()}})},u.getStatsRate=function(U){u.getStats(function(V){V.forEach(function(q){}),U(V)})},u.getStats=function(U,V){V=(V=V||500)>500?500:V,u.lastTimeGetStats&&Date.now()-u.lastTimeGetStats<V?U&&U(u.filterStatsCache,u.originStatsCache):this._getStats(function(q,pe){u.filterStatsCache=q,u.originStatsCache=pe,u.lastTimeGetStats=Date.now(),U&&U(q,pe)})},u._getStats=function(U){u.peerConnection.getStats().then(function(V){var q,pe=[],oe=F(V.values());try{for(oe.s();!(q=oe.n()).done;){var de=q.value;pe.push(de),"outbound-rtp"!==de.type&&"outboundrtp"!==de.type||"video"!==de.mediaType||-1!==de.id.indexOf("rtcp")||(z.id=de.id,z.type=de.type,z.mediaType=de.mediaType,z.bytesSent=de.bytesSent?de.bytesSent+"":"0",z.packetsSent=de.packetsSent?de.packetsSent+"":"0",z.googPlisReceived=de.pliCount?de.pliCount+"":"0",z.googNacksReceived=de.nackCount?de.nackCount+"":"0",z.googFirsReceived=de.firCount?de.firCount+"":"0",z.googFrameRateSent=de.framerateMean?Math.round(de.framerateMean)+"":"0"),"outbound-rtp"!==de.type&&"outboundrtp"!==de.type||"audio"!==de.mediaType||-1!==de.id.indexOf("rtcp")||(c.id=de.id,c.type=de.type,c.mediaType=de.mediaType,c.bytesSent=de.bytesSent?de.bytesSent+"":"0",c.packetsSent=de.packetsSent?de.packetsSent+"":"0",_.agoraStream.local&&(c.audioInputLevel=Math.round(32767*_.agoraStream.getAudioLevel()).toString())),"inbound-rtp"!==de.type&&"inboundrtp"!==de.type||"audio"!==de.mediaType||de.isRemote||-1!==de.id.indexOf("rtcp")||(d.id=de.id,d.type=de.type,d.mediaType=de.mediaType,d.bytesReceived=de.bytesReceived?de.bytesReceived+"":"0",d.packetsLost=de.packetsLost?de.packetsLost+"":"0",d.packetsReceived=de.packetsReceived?de.packetsReceived+"":"0",d.googJitterReceived=de.jitter?de.jitter+"":"0",_.agoraStream.local||(d.audioOutputLevel=Math.round(32767*_.agoraStream.getAudioLevel()).toString())),"inbound-rtp"!==de.type&&"inboundrtp"!==de.type||"video"!==de.mediaType||de.isRemote||-1!==de.id.indexOf("rtcp")||(T.id=de.id,T.type=de.type,T.mediaType=de.mediaType,T.bytesReceived=de.bytesReceived?de.bytesReceived+"":"0",T.googFrameRateReceived=de.framerateMean?Math.round(de.framerateMean)+"":"0",T.googFramesDecoded=de.framesDecoded?de.framesDecoded+"":"0",Date.now()-Z>=1e3?(T.googFrameRateDecoded=(de.framesDecoded-L)/((Date.now()-Z)/1e3),T.googFrameRateDecoded=Math.round(Math.max(0,T.googFrameRateDecoded)),Z=Date.now(),$=T.googFrameRateDecoded,L=de.framesDecoded,T.googFrameRateDecoded=T.googFrameRateDecoded.toString()):T.googFrameRateDecoded=$.toString(),T.packetsLost=de.packetsLost?de.packetsLost+"":"0",T.packetsReceived=de.packetsReceived?de.packetsReceived+"":"0",T.googJitterBufferMs=de.jitter?de.jitter+"":"0",T.googNacksSent=de.nackCount?de.nackCount+"":"0",T.googPlisSent=de.pliCount?de.pliCount+"":"0",T.googFirsSent=de.firCount?de.firCount+"":"0"),-1!==de.id.indexOf("outbound_rtcp_video")&&(z.packetsLost=de.packetsLost?de.packetsLost+"":"0")}}catch(Te){oe.e(Te)}finally{oe.f()}var ye=[z,c,d,T];ye.push({id:"time",startTime:u.connectedTime,timestamp:new Date}),U(ye,pe)},function(V){f.default.error("["+u.clientId+"]"+V)})},u.addStream=function(U){S=!0,u.peerConnection.addStream(U),u.markActionNeeded()},u.removeStream=function(){u.markActionNeeded()},u.close=function(){u.state="closed",u.peerConnection.close()},u.markActionNeeded=function(){u.actionNeeded=!0,u.doLater(function(){u.onstablestate()})},u.doLater=function(U){window.setTimeout(U,1)},u.onstablestate=function(){if(u.actionNeeded){if("new"===u.state||"established"===u.state)S&&(u.mediaConstraints=void 0),u.peerConnection.createOffer(function(V){if(V.sdp=ce(V.sdp),V.sdp=V.sdp.replace(/a=extmap:1 http:\/\/www.webrtc.org\/experiments\/rtp-hdrext\/abs-send-time/,"a=extmap:3 http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"),V.sdp!==u.prevOffer)return u.peerConnection.setLocalDescription(V),u.state="preparing-offer",void u.markActionNeeded();f.default.debug("["+u.clientId+"]Not sending a new offer")},function(V){f.default.debug("["+u.clientId+"]Ups! create offer failed ",V)},u.mediaConstraints);else if("preparing-offer"===u.state){if(u.moreIceComing)return;u.prevOffer=u.peerConnection.localDescription.sdp,u.offerCandidates=u.prevOffer.match(/a=candidate.+\r\n/g)||[],u.offerCandidates.length||(_.isCloudProxy3&&_.onNoIceCandidate&&_.onNoIceCandidate(),f.default.warning("[".concat(u.clientId,"]No Ice Candidate generated")),Object(y.getParameter)("SHIM_CANDIDATE")?(f.default.debug("Shimming fake candidate"),u.prevOffer+="a=candidate:2243255435 1 udp 2122194687 192.168.0.1 30000 typ host generation 0 network-id 1\r\n"):f.default.error("[".concat(u.clientId,"]None Ice Candidate not allowed"))),u.prevOffer=u.prevOffer.replace(/a=candidate:.+typ\shost.+\r\n/g,"a=candidate:2243255435 1 udp 2122194687 192.168.0.1 30000 typ host generation 0 network-id 1\r\n"),u.sendMessage("OFFER",u.prevOffer),u.state="offer-sent"}else if("offer-received"===u.state)u.peerConnection.createAnswer(function(V){if(u.peerConnection.setLocalDescription(V),u.state="offer-received-preparing-answer",u.iceStarted)u.markActionNeeded();else{var q=new Date;f.default.debug("["+u.clientId+"]"+q.getTime()+": Starting ICE in responder"),u.iceStarted=!0}},function(){f.default.debug("["+u.clientId+"]Ups! Something went wrong")});else if("offer-received-preparing-answer"===u.state){if(u.moreIceComing)return;u.sendMessage("ANSWER",u.peerConnection.localDescription.sdp),u.state="established"}else u.debug("Dazed and confused in state "+u.state+", stopping here");u.actionNeeded=!1}},u.sendMessage=function(U,V){var q={};q.messageType=U,q.sdp=V,"OFFER"===U?(q.offererSessionId=u.sessionId,q.answererSessionId=u.otherSessionId,q.seq=u.sequenceNumber+=1,q.tiebreaker=Math.floor(429496723*Math.random()+1)):(q.offererSessionId=u.incomingMessage.offererSessionId,q.answererSessionId=u.sessionId,q.seq=u.incomingMessage.seq),u.onsignalingmessage(JSON.stringify(q))},u._getSender=function(U){if(u.peerConnection&&u.peerConnection.getSenders){var V=u.peerConnection.getSenders().find(function(q){return q.track.kind==U});if(V)return V}return null},u.hasSender=function(U){return!!u._getSender(U)},u.replaceTrack=function(U,V,q){var pe=u._getSender(U.kind);if(!pe)return q("NO_SENDER_FOUND");try{pe.replaceTrack(U)}catch(oe){return q&&q(oe)}setTimeout(function(){return V&&V()},50)},u.error=function(U){throw"Error in RoapOnJsep: "+U},u.sessionId=u.roapSessionId+=1,u.sequenceNumber=0,u.actionNeeded=!1,u.iceStarted=!1,u.moreIceComing=!0,u.iceCandidateCount=0,u.onsignalingmessage=_.callback,u.peerConnection.ontrack=function(U){u.onaddstream&&u.onaddstream(U,"ontrack")},u.peerConnection.onremovestream=function(U){u.onremovestream&&u.onremovestream(U)},u.peerConnection.oniceconnectionstatechange=function(U){"connected"===U.currentTarget.iceConnectionState&&(u.connectedTime=new Date),u.oniceconnectionstatechange&&u.oniceconnectionstatechange(U.currentTarget.iceConnectionState)};var ce=function(U){var V;if(_.video&&_.maxVideoBW&&(null==(V=U.match(/m=video.*\r\n/))&&(V=U.match(/m=video.*\n/)),V&&V.length>0)){var q=V[0]+"b=TIAS:"+1e3*_.maxVideoBW+"\r\n";U=U.replace(V[0],q)}return _.audio&&_.maxAudioBW&&(null==(V=U.match(/m=audio.*\r\n/))&&(V=U.match(/m=audio.*\n/)),V&&V.length>0)&&(U=U.replace(V[0],q=V[0]+"b=TIAS:"+1e3*_.maxAudioBW+"\r\n")),U},re=function(U){return(U=U.replace(/a=.*abs-send-time\r\n/g,"")).replace(/a=.*goog-remb\r\n/g,"")};return u.onaddstream=null,u.onremovestream=null,u.state="new",u.markActionNeeded(),u}(_)):"iOS"===I.getBrowserOS()||I.isSafari()?(f.default.debug("["+u.streamId+"]["+u.clientId+"]Safari"),(u=function(_){var u={},B=g.RTCPeerConnection;u.uid=_.uid,u.isVideoMute=_.isVideoMute,u.isAudioMute=_.isAudioMute,u.isSubscriber=_.isSubscriber,u.clientId=_.clientId,u.filterStatsCache=[],u.originStatsCache=[],u.lastTimeGetStats=null,u.pc_config={iceServers:[],bundlePolicy:"max-bundle"},u.con={optional:[{DtlsSrtpKeyAgreement:!0}]},_.iceServers instanceof Array?u.pc_config.iceServers=_.iceServers:(_.stunServerUrl&&(_.stunServerUrl instanceof Array?_.stunServerUrl.map(function(U){"string"==typeof U&&""!==U&&u.pc_config.iceServers.push({url:U})}):"string"==typeof _.stunServerUrl&&""!==_.stunServerUrl&&u.pc_config.iceServers.push({url:_.stunServerUrl})),_.turnServers&&(_.turnServers instanceof Array?_.turnServers.map(function(U){U.udpport&&u.pc_config.iceServers.push({username:U.username,credential:U.credential,credentialType:"password",urls:(U.useTurns?"turns:":"turn:")+U.url+":"+U.udpport+"?transport=udp"}),"string"==typeof U.tcpport&&""!==U.tcpport&&u.pc_config.iceServers.push({username:U.username,credential:U.credential,credentialType:"password",urls:(U.useTurns?"turns:":"turn:")+U.url+":"+U.tcpport+"?transport=tcp"}),!0===U.forceturn&&(u.pc_config.iceTransportPolicy="relay")}):f.default.error("[".concat(u.clientId,"] turnServers is not a array")))),void 0===_.audio&&(_.audio=!0),void 0===_.video&&(_.video=!0),u.mediaConstraints={mandatory:{OfferToReceiveVideo:_.video,OfferToReceiveAudio:_.audio}},u.roapSessionId=103;try{u.pc_config.sdpSemantics=Object(y.getParameter)("PLAN"),u.peerConnection=new B(u.pc_config,u.con)}catch(U){delete u.pc_config.sdpSemantics,u.peerConnection=new B(u.pc_config,u.con)}u.iceCandidateTimer=setTimeout(function(){u.iceCandidateTimer=null,u.moreIceComing&&(u.moreIceComing=!1,u.markActionNeeded())},Object(y.getParameter)("CANDIDATE_TIMEOUT")),u.peerConnection.onicecandidate=function(U){var V,q,pe,oe;q=(V=u.peerConnection.localDescription.sdp).match(/a=candidate:.+typ\ssrflx.+\r\n/),pe=V.match(/a=candidate:.+typ\shost.+\r\n/),oe=V.match(/a=candidate:.+typ\srelay.+\r\n/),0===u.iceCandidateCount&&(u.timeout=setTimeout(function(){u.moreIceComing&&(u.moreIceComing=!1,u.markActionNeeded())},1e3)),null===q&&null===pe&&null===oe||void 0!==u.ice||!u.iceCandidateTimer||(clearTimeout(u.iceCandidateTimer),u.iceCandidateTimer=null,u.ice=0,u.moreIceComing=!1,u.markActionNeeded()),u.iceCandidateCount=u.iceCandidateCount+1};var U,S=function(U){return _.screen&&(U=U.replace("a=x-google-flag:conference\r\n","")),U},c=function(U){var V;return(V=U.match(/m=video.*\r\n/))&&_.minVideoBW&&_.maxVideoBW&&(U=U.replace(V[0],V[0]+"b=AS:"+_.maxVideoBW+"\r\n"),f.default.debug("["+u.clientId+"]Set Video Bitrate - min:"+_.minVideoBW+" max:"+_.maxVideoBW)),(V=U.match(/m=audio.*\r\n/))&&_.maxAudioBW&&(U=U.replace(V[0],V[0]+"b=AS:"+_.maxAudioBW+"\r\n")),U};u.processSignalingMessage=function(U){var V,q=JSON.parse(U);u.incomingMessage=q,"new"===u.state?"OFFER"===q.messageType?(V={sdp:q.sdp,type:"offer"},u.peerConnection.setRemoteDescription(new RTCSessionDescription(V)),u.state="offer-received",u.markActionNeeded()):u.error("Illegal message for this state: "+q.messageType+" in state "+u.state):"offer-sent"===u.state?"ANSWER"===q.messageType?((V={sdp:q.sdp,type:"answer"}).sdp=S(V.sdp),V.sdp=c(V.sdp),V.sdp=V.sdp.replace(/a=x-google-flag:conference\r\n/g,""),_.screen&&"detail"===_.optimizationMode&&(f.default.debug("[".concat(u.client,"] remove screen share abs ext")),V.sdp=V.sdp.replace(/a=.*abs-send-time\r\n/g,"").replace(/a=.*goog-remb\r\n/g,"")),u.peerConnection.setRemoteDescription(new RTCSessionDescription(V)),u.state="established"):"pr-answer"===q.messageType?(V={sdp:q.sdp,type:"pr-answer"},u.peerConnection.setRemoteDescription(new RTCSessionDescription(V))):u.error("offer"===q.messageType?"Not written yet":"Illegal message for this state: "+q.messageType+" in state "+u.state):"established"===u.state&&("OFFER"===q.messageType?(V={sdp:q.sdp,type:"offer"},u.peerConnection.setRemoteDescription(new RTCSessionDescription(V)),u.state="offer-received",u.markActionNeeded()):"ANSWER"===q.messageType?((V={sdp:q.sdp,type:"answer"}).sdp=S(V.sdp),V.sdp=c(V.sdp),u.peerConnection.setRemoteDescription(new RTCSessionDescription(V))):u.error("Illegal message for this state: "+q.messageType+" in state "+u.state))},u.setRtpSenderParameters=(U=R()(D.a.mark(function V(q){return D.a.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:u.degradation=q;case 1:case"end":return pe.stop()}},V)})),function(V){return U.apply(this,arguments)}),u._setRtpSenderParameters=function(){var U=R()(D.a.mark(function V(q){var pe,oe,de;return D.a.wrap(function(ye){for(;;)switch(ye.prev=ye.next){case 0:if(pe=u.peerConnection.getSenders(),oe=pe.find(function(Te){return Te&&Te.track&&"video"===Te.track.kind})){ye.next=4;break}return ye.abrupt("return");case 4:return(de=oe.getParameters()).degradationPreference=q,ye.prev=6,f.default.debug("[".concat(u.clientId,"] setParameters"),de),ye.next=10,oe.setParameters(de);case 10:ye.next=15;break;case 12:ye.prev=12,ye.t0=ye.catch(6),f.default.debug("[".concat(u.clientId,"] setParameters failed, ignore"));case 15:case"end":return ye.stop()}},V,null,[[6,12]])}));return function(V){return U.apply(this,arguments)}}();var z={id:"",type:"",mediaType:"",googCodecName:"opus",aecDivergentFilterFraction:"0",audioInputLevel:"0",bytesSent:"0",packetsSent:"0",googEchoCancellationReturnLoss:"0",googEchoCancellationReturnLossEnhancement:"0"},d={id:"",type:"",mediaType:"",googCodecName:_.codec?_.codec.toUpperCase():"",bytesSent:"0",packetsLost:"0",packetsSent:"0",googAdaptationChanges:"0",googAvgEncodeMs:"0",googEncodeUsagePercent:"0",googFirsReceived:"0",googFrameHeightSent:"0",googFrameHeightInput:"0",googFrameRateInput:"0",googFrameRateSent:"0",googFrameWidthSent:"0",googFrameWidthInput:"0",googNacksReceived:"0",googPlisReceived:"0",googRtt:"0",googFramesEncoded:"0"},T={id:"",type:"",mediaType:"",audioOutputLevel:"0",bytesReceived:"0",packetsLost:"0",packetsReceived:"0",googAccelerateRate:"0",googCurrentDelayMs:"0",googDecodingCNG:"0",googDecodingCTN:"0",googDecodingCTSG:"0",googDecodingNormal:"0",googDecodingPLC:"0",googDecodingPLCCNG:"0",googExpandRate:"0",googJitterBufferMs:"0",googJitterReceived:"0",googPreemptiveExpandRate:"0",googPreferredJitterBufferMs:"0",googSecondaryDecodedRate:"0",googSpeechExpandRate:"0"},L={id:"",type:"",mediaType:"",googTargetDelayMs:"0",packetsLost:"0",googDecodeMs:"0",googMaxDecodeMs:"0",googRenderDelayMs:"0",googFrameWidthReceived:"0",googFrameHeightReceived:"0",googFrameRateReceived:"0",googFrameRateDecoded:"0",googFrameRateOutput:"0",googFramesDecoded:"0",googFrameReceived:"0",googJitterBufferMs:"0",googCurrentDelayMs:"0",googMinPlayoutDelayMs:"0",googNacksSent:"0",googPlisSent:"0",googFirsSent:"0",bytesReceived:"0",packetsReceived:"0"},$={id:"bweforvideo",type:"VideoBwe",googAvailableSendBandwidth:"0",googAvailableReceiveBandwidth:"0",googActualEncBitrate:"0",googRetransmitBitrate:"0",googTargetEncBitrate:"0",googBucketDelay:"0",googTransmitBitrate:"0"},Z=0,ce=0,re=0;return u.isRemoteVideoStats=function(U){return!!(U.frameHeight&&U.frameWidth&&U.remoteSource)},u.getVideoRelatedStats=function(U){u.peerConnection.getStats().then(function(V){V.forEach(function(q){if(u.isSubscriber){var pe={peerId:u.uid,mediaType:"video",isVideoMute:u.isVideoMute};if("track"===q.type&&(~q.id.indexOf("video")||~q.trackIdentifier.indexOf("v")||u.isRemoteVideoStats(q))){if(!u.lastReport)return void(u.lastReport=q);pe.frameRateReceived=q.framesReceived-u.lastReport.framesReceived+"",pe.frameRateDecoded=q.framesDecoded-u.lastReport.framesDecoded+"",u.lastReport=q}"inbound-rtp"===q.type&&~q.id.indexOf("Video")&&(pe.bytesReceived=q.bytesReceived+"",pe.packetsReceived=q.packetsReceived+"",pe.packetsLost=q.packetsLost+""),U&&U(pe)}else if("outbound-rtp"===q.type&&~q.id.indexOf("Video")){if(!u.lastReport)return void(u.lastReport=q);U&&U({mediaType:"video",isVideoMute:u.isVideoMute,frameRateInput:_.maxFrameRate+"",frameRateSent:q.framesEncoded-u.lastReport.framesEncoded+""}),u.lastReport=q}})})},u.getAudioRelatedStats=function(U){u.peerConnection.getStats().then(function(V){V.forEach(function(q){u.isSubscriber&&"inbound-rtp"===q.type&&~q.id.indexOf("Audio")&&U&&U({peerId:u.uid,mediaType:"audio",isAudioMute:u.isAudioMute,frameDropped:q.packetsLost+"",frameReceived:q.packetsReceived+"",googJitterReceived:q.jitter+"",bytesReceived:q.bytesReceived+"",packetsReceived:q.packetsReceived+"",packetsLost:q.packetsLost+""})})})},u.getStatsRate=function(U){u.getStats(function(V){V.forEach(function(q){"outbound-rtp"===q.type&&"video"===q.mediaType&&q.googFramesEncoded&&(q.googFrameRateSent=Math.ceil((q.googFramesEncoded-Z)/3).toString(),Z=q.googFramesEncoded),"inbound-rtp"===q.type&&-1!=q.id.indexOf("55543")&&(q.googFrameRateReceived&&(q.googFrameRateReceived=Math.ceil((q.googFrameReceived-re)/3).toString(),re=q.googFrameReceived),q.googFrameRateDecoded&&(q.googFrameRateDecoded=Math.ceil((q.googFramesDecoded-ce)/3).toString(),ce=q.googFramesDecoded))}),U(V)})},u.getStats=function(U,V){V=(V=V||500)>500?500:V,u.lastTimeGetStats&&Date.now()-u.lastTimeGetStats<V?U&&U(u.filterStatsCache,u.originStatsCache):this._getStats(function(q,pe){u.filterStatsCache=q,u.originStatsCache=pe,u.lastTimeGetStats=Date.now(),U&&U(q,pe)})},u._getStats=function(U){var V=[];u.peerConnection.getStats().then(function(q){q.forEach(function(oe){var de;V.push(oe),"outbound-rtp"===oe.type&&"audio"===oe.mediaType&&(z.id=oe.id,z.type=oe.type,z.mediaType=oe.mediaType,z.bytesSent=oe.bytesSent?oe.bytesSent+"":"0",z.packetsSent=oe.packetsSent?oe.packetsSent+"":"0",_.agoraStream.local&&(z.audioInputLevel=Math.round(32767*_.agoraStream.getAudioLevel()).toString())),"outbound-rtp"===oe.type&&"video"===oe.mediaType&&(d.id=oe.id,d.type=oe.type,d.mediaType=oe.mediaType,d.bytesSent=oe.bytesSent?oe.bytesSent+"":"0",d.packetsSent=oe.packetsSent?oe.packetsSent+"":"0",d.googPlisReceived=oe.pliCount?oe.pliCount+"":"0",d.googNacksReceived=oe.nackCount?oe.nackCount+"":"0",d.googFirsReceived=oe.firCount?oe.firCount+"":"0",d.googFramesEncoded=oe.framesEncoded?oe.framesEncoded+"":"0",(de=q.get(oe.trackId))&&(d.googFrameHeightSent=de.frameHeight&&de.frameHeight.toString(),d.googFrameWidthSent=de.frameWidth&&de.frameWidth.toString())),"inbound-rtp"!==oe.type||-1==oe.id.indexOf("44444")&&"audio"!==oe.mediaType||(T.id=oe.id,T.type=oe.type,T.mediaType="audio",T.packetsReceived=oe.packetsReceived?oe.packetsReceived+"":"0",T.bytesReceived=oe.bytesReceived?oe.bytesReceived+"":"0",T.packetsLost=oe.packetsLost?oe.packetsLost+"":"0",T.packetsReceived=oe.packetsReceived?oe.packetsReceived+"":"0",T.googJitterReceived=oe.jitter?oe.jitter+"":"0",(de=q.get(oe.trackId))&&(T.audioOutputLevel=de.audioLevel&&Math.round(32767*de.audioLevel).toString()),_.agoraStream.local||T.audioOutputLevel||(T.audioOutputLevel=Math.round(32767*_.agoraStream.getAudioLevel()).toString())),"inbound-rtp"!==oe.type||-1==oe.id.indexOf("55543")&&"video"!==oe.mediaType||(L.id=oe.id,L.type=oe.type,L.mediaType="video",L.packetsReceived=oe.packetsReceived?oe.packetsReceived+"":"0",L.bytesReceived=oe.bytesReceived?oe.bytesReceived+"":"0",L.packetsLost=oe.packetsLost?oe.packetsLost+"":"0",L.googJitterBufferMs=oe.jitter?oe.jitter+"":"0",L.googNacksSent=oe.nackCount?oe.nackCount+"":"0",L.googPlisSent=oe.pliCount?oe.pliCount+"":"0",L.googFirsSent=oe.firCount?oe.firCount+"":"0",(de=q.get(oe.trackId))&&(L.googFrameHeightReceived=de.frameHeight&&de.frameHeight.toString(),L.googFrameWidthReceived=de.frameWidth&&de.frameWidth.toString(),L.googFrameReceived=de.framesReceived&&de.framesReceived.toString(),L.googFramesDecoded=de.framesDecoded&&de.framesDecoded.toString())),"candidate-pair"===oe.type&&(0==oe.availableIncomingBitrate?$.googAvailableSendBandwidth=oe.availableOutgoingBitrate+"":$.googAvailableReceiveBandwidth=oe.availableIncomingBitrate+"")});var pe=[$,z,d,T,L];pe.push({id:"time",startTime:u.connectedTime,timestamp:new Date}),U(pe,V)}).catch(function(q){f.default.error("["+u.clientId+"] ",q)})},u.addTrack=function(U,V){u.peerConnection.addTrack(U,V)},u.removeTrack=function(U,V){var q=u.peerConnection.getSenders().find(function(pe){return pe.track==U});q.replaceTrack(null),u.peerConnection.removeTrack(q)},u.addStream=function(U){window.navigator.userAgent.indexOf("Safari")>-1&&-1===navigator.userAgent.indexOf("Chrome")?U.getTracks().forEach(function(V){return u.peerConnection.addTrack(V,U)}):u.peerConnection.addStream(U),u.markActionNeeded()},u.removeStream=function(){u.markActionNeeded()},u.close=function(){u.state="closed",u.peerConnection.close()},u.markActionNeeded=function(){u.actionNeeded=!0,u.doLater(function(){u.onstablestate()})},u.doLater=function(U){window.setTimeout(U,1)},u.onstablestate=function(){if(u.actionNeeded){if("new"===u.state||"established"===u.state)_.isSubscriber&&(u.peerConnection.addTransceiver("audio",{direction:"recvonly"}),u.peerConnection.addTransceiver("video",{direction:"recvonly"})),u.peerConnection.createOffer(u.mediaConstraints).then(function(V){if(V.sdp=c(V.sdp),_.isSubscriber||(V.sdp=V.sdp.replace(/a=.*video-orientation\r\n/g,"")),V.sdp!==u.prevOffer)return u.peerConnection.setLocalDescription(V),u.state="preparing-offer",void u.markActionNeeded();f.default.debug("["+u.clientId+"]Not sending a new offer")}).catch(function(V){f.default.debug("["+u.clientId+"]peer connection create offer failed ",V)});else if("preparing-offer"===u.state){if(u.moreIceComing)return;u.prevOffer=u.peerConnection.localDescription.sdp,u.offerCandidates=u.prevOffer.match(/a=candidate.+\r\n/g)||[],u.offerCandidates.length||(f.default.warning("[".concat(u.clientId,"]No Ice Candidate generated")),_.isCloudProxy3&&_.onNoIceCandidate&&_.onNoIceCandidate(),Object(y.getParameter)("SHIM_CANDIDATE")?(f.default.debug("Shimming fake candidate"),u.prevOffer+="a=candidate:2243255435 1 udp 2122194687 192.168.0.1 30000 typ host generation 0 network-id 1\r\n"):f.default.error("[".concat(u.clientId,"]None Ice Candidate not allowed"))),u.prevOffer=u.prevOffer.replace(/a=candidate:.+typ\shost.+\r\n/g,"a=candidate:2243255435 1 udp 2122194687 192.168.0.1 30000 typ host generation 0 network-id 1\r\n"),u.sendMessage("OFFER",u.prevOffer),u.state="offer-sent"}else if("offer-received"===u.state)u.peerConnection.createAnswer(function(V){if(u.peerConnection.setLocalDescription(V),u.state="offer-received-preparing-answer",u.iceStarted)u.markActionNeeded();else{var q=new Date;f.default.debug("["+u.clientId+"]"+q.getTime()+": Starting ICE in responder"),u.iceStarted=!0}},function(V){f.default.debug("["+u.clientId+"]peer connection create answer failed ",V)},u.mediaConstraints);else if("offer-received-preparing-answer"===u.state){if(u.moreIceComing)return;u.sendMessage("ANSWER",u.peerConnection.localDescription.sdp),u.state="established"}else u.debug("Dazed and confused in state "+u.state+", stopping here");u.actionNeeded=!1}},u.sendMessage=function(U,V){var q={};q.messageType=U,q.sdp=V,"OFFER"===U?(q.offererSessionId=u.sessionId,q.answererSessionId=u.otherSessionId,q.seq=u.sequenceNumber+=1,q.tiebreaker=Math.floor(429496723*Math.random()+1)):(q.offererSessionId=u.incomingMessage.offererSessionId,q.answererSessionId=u.sessionId,q.seq=u.incomingMessage.seq),u.onsignalingmessage(JSON.stringify(q))},u._getSender=function(U){if(u.peerConnection&&u.peerConnection.getSenders){var V=u.peerConnection.getSenders().find(function(q){return q.track.kind==U});if(V)return V}return null},u.hasSender=function(U){return!!u._getSender(U)},u.replaceTrack=function(U,V,q){var pe=u._getSender(U.kind);if(!pe)return q("NO_SENDER_FOUND");try{pe.replaceTrack(U)}catch(oe){return q&&q(oe)}setTimeout(function(){return V&&V()},50)},u.error=function(U){throw"Error in RoapOnJsep: "+U},u.sessionId=u.roapSessionId+=1,u.sequenceNumber=0,u.actionNeeded=!1,u.iceStarted=!1,u.moreIceComing=!0,u.iceCandidateCount=0,u.onsignalingmessage=_.callback,u.peerConnection.ontrack=function(U){console.log("!!! ontrack, ",U.track.kind,U.track),u.onaddstream&&u.onaddstream(U,"ontrack")},u.peerConnection.onremovestream=function(U){u.onremovestream&&u.onremovestream(U)},u.peerConnection.oniceconnectionstatechange=function(U){"connected"===U.currentTarget.iceConnectionState&&(u.connectedTime=new Date,u._setRtpSenderParameters(u.degradation)),u.oniceconnectionstatechange&&u.oniceconnectionstatechange(U.currentTarget.iceConnectionState)},u.renegotiate=function(){u.isSubscriber||(f.default.debug("[".concat(u.uid,"]"),"renegotiating"),void 0!==u.prevOffer&&u.peerConnection.createOffer().then(function(U){return U.sdp=U.sdp.replace(/a=recvonly\r\n/g,"a=inactive\r\n"),U.sdp=S(U.sdp),U.sdp=c(U.sdp),u.peerConnection.setLocalDescription(U)}).then(function(){u.onnegotiationneeded&&u.onnegotiationneeded(u.peerConnection.localDescription.sdp)}).catch(function(U){console.log("createOffer error: ",U)}))},u.isSubscriber||(u.peerConnection.onnegotiationneeded=u.renegotiate),u.onaddstream=null,u.onremovestream=null,u.state="new",u.markActionNeeded(),u}(_)).browser="safari"):~window.navigator.userAgent.indexOf("Edge")?u=new J.a(_):(u=function(_){var u={},B=g.RTCPeerConnection;u.uid=_.uid,u.isVideoMute=_.isVideoMute,u.isAudioMute=_.isAudioMute,u.isSubscriber=_.isSubscriber,u.clientId=_.clientId,u.filterStatsCache=[],u.originStatsCache=[],u.lastTimeGetStats=null,u.pc_config={iceServers:[]};var S={id:"outbound_audio_ssrc_send",type:"ssrc",mediaType:"",googCodecName:"opus",aecDivergentFilterFraction:"0",audioInputLevel:"0",bytesSent:"0",packetsSent:"0",googEchoCancellationReturnLoss:"0",googEchoCancellationReturnLossEnhancement:"0"},c={id:"outbound_video_ssrc_send",type:"ssrc",mediaType:"",googCodecName:_.codec?_.codec.toUpperCase():"",bytesSent:"0",packetsLost:"0",packetsSent:"0",googAdaptationChanges:"0",googAvgEncodeMs:"0",googEncodeUsagePercent:"0",googFirsReceived:"0",googFrameHeightSent:"0",googFrameHeightInput:"0",googFrameRateInput:"0",googFrameRateSent:"0",googFrameWidthSent:"0",googFrameWidthInput:"0",googNacksReceived:"0",googPlisReceived:"0",googRtt:"0"},z={id:"inbound_audio_ssrc_recv",type:"ssrc",mediaType:"",googCodecName:"opus",audioOutputLevel:"0",bytesReceived:"0",packetsLost:"0",packetsReceived:"0",googAccelerateRate:"0",googCurrentDelayMs:"0",googDecodingCNG:"0",googDecodingCTN:"0",googDecodingCTSG:"0",googDecodingNormal:"0",googDecodingPLC:"0",googDecodingPLCCNG:"0",googExpandRate:"0",googJitterBufferMs:"0",googJitterReceived:"0",googPreemptiveExpandRate:"0",googPreferredJitterBufferMs:"0",googSecondaryDecodedRate:"0",googSpeechExpandRate:"0"},d={id:"inbound_video_ssrc_recv",type:"ssrc",mediaType:"",googTargetDelayMs:"0",packetsLost:"0",googDecodeMs:"0",googMaxDecodeMs:"0",googRenderDelayMs:"0",googFrameWidthReceived:"0",googFrameHeightReceived:"0",googFrameRateReceived:"0",googFrameRateDecoded:"0",googFrameRateOutput:"0",googJitterBufferMs:"0",googCurrentDelayMs:"0",googMinPlayoutDelayMs:"0",googNacksSent:"0",googPlisSent:"0",googFirsSent:"0",bytesReceived:"0",packetsReceived:"0",googFramesReceived:"0",googFramesDecoded:"0"},T={id:"bweforvideo",type:"VideoBwe",googAvailableSendBandwidth:"0",googAvailableReceiveBandwidth:"0",googActualEncBitrate:"0",googRetransmitBitrate:"0",googTargetEncBitrate:"0",googBucketDelay:"0",googTransmitBitrate:"0"};u.con={optional:[{DtlsSrtpKeyAgreement:!0}]},_.iceServers instanceof Array?u.pc_config.iceServers=_.iceServers:(_.stunServerUrl&&(_.stunServerUrl instanceof Array?_.stunServerUrl.map(function(U){"string"==typeof U&&""!==U&&u.pc_config.iceServers.push({url:U})}):"string"==typeof _.stunServerUrl&&""!==_.stunServerUrl&&u.pc_config.iceServers.push({url:_.stunServerUrl})),_.turnServers&&(_.turnServers instanceof Array?_.turnServers.map(function(U){U.udpport&&u.pc_config.iceServers.push({username:U.username,credential:U.credential,credentialType:"password",urls:(U.useTurns?"turns:":"turn:")+U.url+":"+U.udpport+"?transport=udp"}),"string"==typeof U.tcpport&&""!==U.tcpport&&u.pc_config.iceServers.push({username:U.username,credential:U.credential,credentialType:"password",urls:(U.useTurns?"turns:":"turn:")+U.url+":"+U.tcpport+"?transport=tcp"}),!0===U.forceturn&&(u.pc_config.iceTransportPolicy="relay")}):f.default.error("[".concat(u.clientId,"] turnServers is not a array")))),void 0===_.audio&&(_.audio=!0),void 0===_.video&&(_.video=!0),u.mediaConstraints={mandatory:{OfferToReceiveVideo:_.video,OfferToReceiveAudio:_.audio}},u.roapSessionId=103;try{u.pc_config.sdpSemantics=Object(y.getParameter)("PLAN"),u.peerConnection=new B(u.pc_config,u.con)}catch(U){delete u.pc_config.sdpSemantics,u.peerConnection=new B(u.pc_config,u.con);var L=u.peerConnection.getConfiguration();L.sdpSemantics&&Object(y.setParameter)("PLAN",L.sdpSemantics)}u.iceCandidateTimer=setTimeout(function(){u.iceCandidateTimer=null,f.default.debug("[".concat(u.clientId,"]Candidates collected: ").concat(u.iceCandidateCount)),u.moreIceComing&&(u.moreIceComing=!1,u.markActionNeeded())},Object(y.getParameter)("CANDIDATE_TIMEOUT")),u.peerConnection.onicecandidate=function(U){var V,q,pe,oe;q=(V=u.peerConnection.localDescription.sdp).match(/a=candidate:.+typ\ssrflx.+\r\n/),pe=V.match(/a=candidate:.+typ\shost.+\r\n/),oe=V.match(/a=candidate:.+typ\srelay.+\r\n/),null===q&&null===pe&&null===oe||void 0!==u.ice||!u.iceCandidateTimer||(clearTimeout(u.iceCandidateTimer),u.iceCandidateTimer=null,u.ice=0,u.moreIceComing=!1,u.markActionNeeded()),u.iceCandidateCount=u.iceCandidateCount+1};var U,$=function(U){return U.replace("a=x-google-flag:conference\r\n","")},Z=function(U){var V,q;if((V=U.match(/m=video.*\r\n/))&&_.minVideoBW&&_.maxVideoBW){q=V[0]+"b=AS:"+_.maxVideoBW+"\r\n";var pe=0,oe=0;"h264"===_.codec?(pe=U.search(/a=rtpmap:(\d+) H264\/90000\r\n/),oe=U.search(/H264\/90000\r\n/)):"vp8"===_.codec?(pe=U.search(/a=rtpmap:(\d+) VP8\/90000\r\n/),oe=U.search(/VP8\/90000\r\n/)):"vp9"===_.codec&&(pe=U.search(/a=rtpmap:(\d+) VP9\/90000\r\n/),oe=U.search(/VP9\/90000\r\n/)),-1!==pe&&-1!==oe&&oe-pe>10&&(q=q+"a=fmtp:"+U.slice(pe+9,oe-1)+" x-google-min-bitrate="+_.minVideoBW+"\r\n"),U=(U=U.replace(V[0],q)).replace(/42001f/g,"42e01f"),f.default.debug("["+u.clientId+"]Set Video Bitrate - min:"+_.minVideoBW+" max:"+_.maxVideoBW)}return(V=U.match(/m=audio.*\r\n/))&&_.maxAudioBW&&(U=U.replace(V[0],q=V[0]+"b=AS:"+_.maxAudioBW+"\r\n")),U};u.processSignalingMessage=function(U){var V,q=JSON.parse(U);u.incomingMessage=q,"new"===u.state?"OFFER"===q.messageType?(V={sdp:q.sdp,type:"offer"},u.peerConnection.setRemoteDescription(new RTCSessionDescription(V)).catch(function(pe){}),u.state="offer-received",u.markActionNeeded()):u.error("Illegal message for this state: "+q.messageType+" in state "+u.state):"offer-sent"===u.state?"ANSWER"===q.messageType?((V={sdp:q.sdp,type:"answer"}).sdp=$(V.sdp),V.sdp=Z(V.sdp),_.screen&&"detail"===_.optimizationMode&&(f.default.debug("[".concat(u.client,"] remove screen share abs ext")),V.sdp=V.sdp.replace(/a=.*abs-send-time\r\n/g,"").replace(/a=.*goog-remb\r\n/g,"")),_.isSubscriber&&(V.sdp=V.sdp.replace("minptime=10","minptime=10;stereo=1; sprop-stereo=1")),u.peerConnection.setRemoteDescription(new RTCSessionDescription(V)).catch(function(pe){}),u.state="established"):"pr-answer"===q.messageType?(V={sdp:q.sdp,type:"pr-answer"},u.peerConnection.setRemoteDescription(new RTCSessionDescription(V)).catch(function(pe){})):u.error("offer"===q.messageType?"Not written yet":"Illegal message for this state: "+q.messageType+" in state "+u.state):"established"===u.state&&("OFFER"===q.messageType?(V={sdp:q.sdp,type:"offer"},u.peerConnection.setRemoteDescription(new RTCSessionDescription(V)).catch(function(pe){}),u.state="offer-received",u.markActionNeeded()):"ANSWER"===q.messageType?((V={sdp:q.sdp,type:"answer"}).sdp=$(V.sdp),V.sdp=Z(V.sdp),u.peerConnection.setRemoteDescription(new RTCSessionDescription(V)).catch(function(pe){})):u.error("Illegal message for this state: "+q.messageType+" in state "+u.state))},u.setRtpSenderParameters=(U=R()(D.a.mark(function V(q){var pe,oe,de;return D.a.wrap(function(ye){for(;;)switch(ye.prev=ye.next){case 0:if(pe=u.peerConnection.getSenders(),console.log("senders",pe),oe=pe.find(function(Te){return"video"===Te.track.kind})){ye.next=5;break}return ye.abrupt("return");case 5:return(de=oe.getParameters()).degradationPreference=q,ye.prev=7,f.default.debug("[".concat(u.clientId,"] setParameters"),de),ye.next=11,oe.setParameters(de);case 11:ye.next=16;break;case 13:ye.prev=13,ye.t0=ye.catch(7),f.default.debug("[".concat(u.clientId,"] setParameters failed, ignore"));case 16:case"end":return ye.stop()}},V,null,[[7,13]])})),function(V){return U.apply(this,arguments)});var ce=0,re=0;return u.getVideoRelatedStats=function(U){u.getStats(function(V){V.forEach(function(q){if(u.isSubscriber){if("video"===q.mediaType&&q.id&&~q.id.indexOf("recv")){if(I.isChromeKernel()&&+I.getBrowserVersion()>=76){var oe=+q.googFramesDecoded-re;u._setStat(d,"googFrameRateReceived",+q.googFramesReceived-ce),u._setStat(d,"googFrameRateDecoded",oe),u._setStat(d,"googFrameRateOutput",oe),ce=+q.googFramesReceived,re=+q.googFramesDecoded}U&&U({mediaType:"video",peerId:u.uid,isVideoMute:u.isVideoMute,frameRateReceived:q.googFrameRateReceived,frameRateDecoded:q.googFrameRateDecoded,bytesReceived:q.bytesReceived,packetsReceived:q.packetsReceived,packetsLost:q.packetsLost})}}else"video"===q.mediaType&&q.id&&~q.id.indexOf("send")&&U&&U({mediaType:"video",isVideoMute:u.isVideoMute,frameRateInput:q.googFrameRateInput,frameRateSent:q.googFrameRateSent,googRtt:q.googRtt})})})},u.getAudioRelatedStats=function(U){u.getStats(function(V){V.forEach(function(q){u.isSubscriber&&"audio"===q.mediaType&&q.id&&~q.id.indexOf("recv")&&U&&U({mediaType:"audio",peerId:u.uid,isAudioMute:u.isAudioMute,frameDropped:parseInt(q.googDecodingPLC)+parseInt(q.googDecodingPLCCNG)+"",frameReceived:q.googDecodingCTN,googJitterReceived:q.googJitterReceived,bytesReceived:q.bytesReceived,packetsReceived:q.packetsReceived,packetsLost:q.packetsLost})})})},u.getStatsRate=function(U){u.getStats(function(V){U(V)})},u.getStats=function(U,V){V=(V=V||500)>500?500:V,u.lastTimeGetStats&&Date.now()-u.lastTimeGetStats<V?U&&U(u.filterStatsCache,u.originStatsCache):(u.lastTimeGetStats=Date.now(),this._getStats(function(q,pe){u.filterStatsCache=q,u.originStatsCache=pe,U&&U(q,pe)}))},u._setStat=function(U,V,q){U.hasOwnProperty(V)&&(null!=q&&q!==1/0&&q==q||(q=0),U[V]=q+"")},u._processGetStatsAfterChrome76=function(U){var V=this;u.lastStats||(u.lastStats=new Map),u.peerConnection.getStats().then(function(q){var pe,oe=[],de=[],ye=new Map,Te=new Date,Re=function M(_){if("undefined"==typeof Symbol||null==_[Symbol.iterator]){if(Array.isArray(_)||(_=function(T,L){if(T){if("string"==typeof T)return j(T,L);var $=Object.prototype.toString.call(T).slice(8,-1);if("Object"===$&&T.constructor&&($=T.constructor.name),"Map"===$||"Set"===$)return Array.from($);if("Arguments"===$||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test($))return j(T,L)}}(_))){var u=0,B=function(){};return{s:B,n:function(){return u>=_.length?{done:!0}:{done:!1,value:_[u++]}},e:function(T){throw T},f:B}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var S,c,z=!0,d=!1;return{s:function(){S=_[Symbol.iterator]()},n:function(){var T=S.next();return z=T.done,T},e:function(T){d=!0,c=T},f:function(){try{z||null==S.return||S.return()}finally{if(d)throw c}}}}(q.values());try{for(Re.s();!(pe=Re.n()).done;){var Ce=pe.value;"codec"!=Ce.type?"candidate-pair"!=Ce.type?("inbound-rtp"===Ce.type&&"video"===Ce.mediaType&&ye.set("inbound-video",Ce),"inbound-rtp"===Ce.type&&"audio"===Ce.mediaType&&ye.set("inbound-audio",Ce),"outbound-rtp"===Ce.type&&"audio"===Ce.mediaType&&ye.set("outbound-audio",Ce),"outbound-rtp"===Ce.type&&"video"===Ce.mediaType&&ye.set("outbound-video",Ce),"track"===Ce.type&&"video"===Ce.kind&&Ce.remoteSource&&ye.set("remote-video-track",Ce),"track"===Ce.type&&"audio"===Ce.kind&&Ce.remoteSource&&ye.set("remote-audio-track",Ce),"remote-inbound-rtp"===Ce.type&&"video"===Ce.mediaType&&ye.set("remote-inbound-video",Ce),"remote-inbound-rtp"===Ce.type&&"audio"===Ce.mediaType&&ye.set("remote-inbound-audio",Ce),"track"!==Ce.type||"video"!==Ce.kind||Ce.remoteSource||ye.set("local-video-track",Ce),"track"!==Ce.type||"audio"!==Ce.kind||Ce.remoteSource||ye.set("local-audio-track",Ce),"media-source"===Ce.type&&"video"===Ce.kind&&ye.set("media-source-video",Ce),"media-source"===Ce.type&&"audio"===Ce.kind&&ye.set("media-source-audio",Ce)):de.push(Ce):oe.push(Ce)}}catch(ie){Re.e(ie)}finally{Re.f()}ye.set("codec",oe),ye.set("candidatePairs",de),ye.set("timestamp",+Te);var Ee=null,Le=null;if(d.timestamp=Te,z.timestamp=Te,S.timestamp=Te,S.timestamp=Te,T.timestamp=Te,V.isSubscriber)(Ee=ye.get("inbound-video"))&&(u._setStat(d,"id","inbound_video_ssrc_recv"),u._setStat(d,"mediaType",Ee.mediaType),u._setStat(d,"packetsLost",Ee.packetsLost),u._setStat(d,"googDecodeMs",null),u._setStat(d,"googMaxDecodeMs",null),u._setStat(d,"googRenderDelayMs",null),u._setStat(d,"googMinPlayoutDelayMs",null),u._setStat(d,"googNacksSent",Ee.nackCount),u._setStat(d,"googPlisSent",Ee.pliCount),u._setStat(d,"googFirsSent",Ee.firCount),u._setStat(d,"bytesReceived",Ee.bytesReceived),u._setStat(d,"packetsReceived",Ee.packetsReceived)),(Ee=ye.get("inbound-audio"))&&(u._setStat(z,"id","inbound_audio_ssrc_recv"),u._setStat(z,"mediaType",Ee.mediaType),u._setStat(z,"bytesReceived",Ee.bytesReceived),u._setStat(z,"packetsLost",Ee.packetsLost),u._setStat(z,"packetsReceived",Ee.packetsReceived),u._setStat(z,"googAccelerateRate",Ee.removedSamplesForAcceleration),u._setStat(z,"googCurrentDelayMs",Ee.jitterBufferDelay),u._setStat(z,"googDecodingCNG",null),u._setStat(z,"googDecodingCTN",null),u._setStat(z,"googDecodingCTSG",null),u._setStat(z,"googDecodingNormal",null),u._setStat(z,"googDecodingPLC",null),u._setStat(z,"googDecodingPLCCNG",null),u._setStat(z,"googJitterReceived",Ee.jitter),u._setStat(z,"googPreferredJitterBufferMs",null),u._setStat(z,"googSecondaryDecodedRate",null)),(Ee=ye.get("remote-video-track"))&&(u._setStat(d,"googTargetDelayMs",Ee.jitterBufferDelay),u._setStat(d,"googFrameWidthReceived",Ee.frameWidth),u._setStat(d,"googFrameHeightReceived",Ee.frameHeight),u._setStat(d,"googJitterBufferMs",Ee.jitterBufferDelay/Ee.jitterBufferEmittedCount*1e3),u._setStat(d,"googCurrentDelayMs",Ee.jitterBufferDelay),u._setStat(d,"googFramesDecoded",Ee.framesDecoded),u._setStat(d,"googFramesReceived",Ee.framesReceived)),(Ee=ye.get("remote-audio-track"))&&(u._setStat(z,"audioOutputLevel",32767*Ee.audioLevel),u._setStat(z,"googJitterBufferMs",Ee.jitterBufferDelay/Ee.jitterBufferEmittedCount*1e3),u._setStat(z,"googExpandRate",Ee.concealedSamples),u._setStat(z,"googPreemptiveExpandRate",Ee.insertedSamplesForDeceleration),u._setStat(z,"googSpeechExpandRate",Ee.silentConcealedSamples));else{var p=u.lastStats.get("timestamp"),le=u.lastStats.get("outbound-video");if((Ee=ye.get("outbound-audio"))&&(u._setStat(S,"id","outbound_audio_ssrc_send"),u._setStat(S,"mediaType",Ee.mediaType),u._setStat(S,"aecDivergentFilterFraction",null),u._setStat(S,"bytesSent",Ee.bytesSent),u._setStat(S,"packetsSent",Ee.packetsSent),Le=Ee.transportId),Ee=ye.get("outbound-video")){if(u._setStat(c,"id","outbound_video_ssrc_send"),u._setStat(c,"mediaType",Ee.mediaType),u._setStat(c,"bytesSent",Ee.bytesSent),u._setStat(c,"packetsSent",Ee.packetsSent),u._setStat(c,"googAdaptationChanges",Ee.qualityLimitationDurations),u._setStat(c,"googAvgEncodeMs",null),u._setStat(c,"googEncodeUsagePercent",null),Le=Ee.transportId,Ee.totalEncodedBytesTarget&&le&&le.totalEncodedBytesTarget){var k=(Ee.totalEncodedBytesTarget-le.totalEncodedBytesTarget)/(+new Date-p);u._setStat(T,"googTargetEncBitrate",Math.floor(8*k*1e3))}if(Ee.retransmittedBytesSent&&le&&le.retransmittedBytesSent){var Ae=(Ee.retransmittedBytesSent-le.retransmittedBytesSent)/(+new Date-p);u._setStat(T,"googRetransmitBitrate",Math.floor(8*Ae*1e3))}if(Ee.bytesSent&&le&&le.bytesSent){var Ge=(Ee.bytesSent-le.bytesSent)/(+new Date-p);u._setStat(T,"googTransmitBitrate",Math.floor(8*Ge*1e3)),u._setStat(T,"googActualEncBitrate",Math.floor(8*Ge*1e3))}if(Ee.totalPacketSendDelay&&le&&le.totalPacketSendDelay){var Ve=(Ee.totalPacketSendDelay-le.totalPacketSendDelay)/(+new Date-p);u._setStat(T,"googBucketDelay",Math.floor(1e3*Ve))}}if((Ee=ye.get("remote-inbound-video"))&&(u._setStat(c,"packetsLost",Ee.packetsLost),u._setStat(c,"googRtt",Ee.roundTripTime)),(Ee=ye.get("local-video-track"))&&(u._setStat(c,"googFrameHeightSent",Ee.frameHeight),u._setStat(c,"googFrameWidthSent",Ee.frameWidth),void 0!==Ee.framesPerSecond&&u._setStat(c,"googFrameRateSent",Ee.framesPerSecond)),(Ee=ye.get("local-audio-track"))&&(u._setStat(S,"googEchoCancellationReturnLoss",Ee.echoReturnLoss),u._setStat(S,"googEchoCancellationReturnLossEnhancement",Ee.echoReturnLossEnhancement)),(Ee=ye.get("media-source-video"))&&(u._setStat(c,"googFrameHeightInput",Ee.height),u._setStat(c,"googFrameWidthInput",Ee.width),u._setStat(c,"googFrameRateInput",Ee.framesPerSecond)),(Ee=ye.get("media-source-audio"))&&u._setStat(S,"audioInputLevel",32767*Ee.totalAudioEnergy),(Ee=ye.get("inbound-video"))&&(u._setStat(c,"googFirsReceived",Ee.firCount),u._setStat(c,"googNacksReceived",Ee.nackCount),u._setStat(c,"googPlisReceived",Ee.pliCount)),Le)ye.get("candidatePairs").map(function(ie){Le==ie.transportId&&u._setStat(T,"googAvailableSendBandwidth",ie.availableOutgoingBitrate)});else{var Fe=ye.get("candidatePairs")[0];Fe&&u._setStat(T,"googAvailableSendBandwidth",Fe.availableOutgoingBitrate)}}u.lastStats=ye;var We=[w()({},c),w()({},S),w()({},d),w()({},z),w()({},T)];We.push({id:"time",startTime:u.connectedTime,timestamp:new Date}),U(We)})},u._processGetStatsBeforeChrome76=function(U){u.peerConnection.getStats(function(V){var q=[],pe=[],oe=null;Object.keys(V).forEach(function(de){var ye=V[de];ye&&(pe.push(ye),oe=ye.timestamp,"VideoBwe"===ye.type?T=ye:ye.id.indexOf("_send")>-1&&"video"===ye.mediaType?c=ye:ye.id.indexOf("_send")>-1&&"audio"===ye.mediaType?S=ye:ye.id.indexOf("_recv")>-1&&"video"===ye.mediaType?d=ye:ye.id.indexOf("_recv")>-1&&"audio"===ye.mediaType&&(z=ye))}),(q=[w()({},c),w()({},S),w()({},d),w()({},z),w()({},T)]).push({id:"time",startTime:u.connectedTime,timestamp:oe||new Date}),U(q,pe)})},u._getStats=function(U){Object(y.getParameter)("CHROME_NEW_STATS")&&I.isChromeKernel()&&+I.getBrowserVersion()>=76?u._processGetStatsAfterChrome76(U):u._processGetStatsBeforeChrome76(U)},u.addTrack=function(U,V){if("unified-plan"===Object(y.getParameter)("PLAN")){var q="audio"===U.kind?u._audioSender:u._videoSender;if(q){var pe=u.peerConnection.getTransceivers().find(function(oe){return oe.sender===q});q.replaceTrack(U).then(function(){pe.direction="sendrecv",u.renegotiate()})}else q=u.peerConnection.addTrack(U,V),"audio"===U.kind?u._audioSender=q:u._videoSender=q}else u.peerConnection.addTrack(U,V)},u.removeTrack=function(U,V){if("unified-plan"===Object(y.getParameter)("PLAN")){var q=u.peerConnection.getTransceivers().find(function(pe){return pe.sender.track===U});q&&(q.direction="inactive",u.peerConnection.removeTrack(q.sender))}else u.peerConnection.removeTrack(u.peerConnection.getSenders().find(function(pe){return pe.track==U}))},u.addStream=function(U){"unified-plan"===Object(y.getParameter)("PLAN")?U.getTracks().forEach(function(V){var q=u.peerConnection.addTrack(V,U);"audio"===V.kind?u._audioSender=q:u._videoSender=q}):(u.peerConnection.addStream(U),u.markActionNeeded())},u.removeStream=function(){u.markActionNeeded()},u.close=function(){u.state="closed",u.peerConnection.close()},u.markActionNeeded=function(){u.actionNeeded=!0,u.doLater(function(){u.onstablestate()})},u.doLater=function(U){window.setTimeout(U,1)},u.onstablestate=function(){if(u.actionNeeded){if("new"===u.state||"established"===u.state)u.peerConnection.createOffer(u.mediaConstraints).then(function(V){return V?V.sdp!==u.prevOffer?(_.isSubscriber&&(V.sdp=V.sdp.replace("minptime=10","minptime=10;stereo=1; sprop-stereo=1")),u.peerConnection.setLocalDescription(V),u.state="preparing-offer",void u.markActionNeeded()):void f.default.debug("["+u.clientId+"]Not sending a new offer"):(f.default.debug("["+u.clientId+"]sessionDescription is null"),void u.onsignalingmessage(null))}).catch(function(V){f.default.debug("["+u.clientId+"]peer connection create offer failed ",V)});else if("preparing-offer"===u.state){if(u.moreIceComing)return;u.prevOffer=u.peerConnection.localDescription.sdp,u.offerCandidates=u.prevOffer.match(/a=candidate.+\r\n/g)||[],u.offerCandidates.length||(_.isCloudProxy3&&_.onNoIceCandidate&&_.onNoIceCandidate(),f.default.warning("[".concat(u.clientId,"]No Ice Candidate generated")),Object(y.getParameter)("SHIM_CANDIDATE")?(f.default.debug("Shimming fake candidate"),u.prevOffer+="a=candidate:2243255435 1 udp 2122194687 192.168.0.1 30000 typ host generation 0 network-id 1\r\n"):f.default.error("[".concat(u.clientId,"]None Ice Candidate not allowed"))),u.prevOffer=u.prevOffer.replace(/a=candidate:.+typ\shost.+\r\n/g,"a=candidate:2243255435 1 udp 2122194687 192.168.0.1 30000 typ host generation 0 network-id 1\r\n"),u.sendMessage("OFFER",u.prevOffer),u.state="offer-sent"}else if("offer-received"===u.state)u.peerConnection.createAnswer(function(V){if(u.peerConnection.setLocalDescription(V),u.state="offer-received-preparing-answer",u.iceStarted)u.markActionNeeded();else{var q=new Date;f.default.debug("["+u.clientId+"]"+q.getTime()+": Starting ICE in responder"),u.iceStarted=!0}},function(V){f.default.debug("["+u.clientId+"]peer connection create answer failed ",V)},u.mediaConstraints);else if("offer-received-preparing-answer"===u.state){if(u.moreIceComing)return;u.sendMessage("ANSWER",u.peerConnection.localDescription.sdp),u.state="established"}else f.default.debug("[".concat(u.clientId,"] Dazed and confused in state ").concat(u.state,", stopping here'"));u.actionNeeded=!1}},u.sendMessage=function(U,V){var q={};q.messageType=U,q.sdp=V,"OFFER"===U?(q.offererSessionId=u.sessionId,q.answererSessionId=u.otherSessionId,q.seq=u.sequenceNumber+=1,q.tiebreaker=Math.floor(429496723*Math.random()+1)):(q.offererSessionId=u.incomingMessage.offererSessionId,q.answererSessionId=u.sessionId,q.seq=u.incomingMessage.seq),u.onsignalingmessage(JSON.stringify(q))},u._getSender=function(U){if(u.peerConnection&&u.peerConnection.getSenders){var V=u.peerConnection.getSenders().find(function(q){return q.track.kind==U});if(V)return V}return null},u.hasSender=function(U){return!!u._getSender(U)},u.replaceTrack=function(U,V,q){var pe=u._getSender(U.kind);if(!pe)return q("NO_SENDER_FOUND");try{pe.replaceTrack(U)}catch(oe){return q&&q(oe)}setTimeout(function(){return V&&V()},50)},u.error=function(U){throw"Error in RoapOnJsep: "+U},u.sessionId=u.roapSessionId+=1,u.sequenceNumber=0,u.actionNeeded=!1,u.iceStarted=!1,u.moreIceComing=!0,u.iceCandidateCount=0,u.onsignalingmessage=_.callback,u.peerConnection.ontrack=function(U){u.onaddstream&&(u.onaddstream(U,"ontrack"),u.peerConnection.onaddstream=null)},u.peerConnection.onaddstream=function(U){u.onaddstream&&(u.onaddstream(U,"onaddstream"),u.peerConnection.ontrack=null)},u.peerConnection.onremovestream=function(U){u.onremovestream&&u.onremovestream(U)},u.peerConnection.oniceconnectionstatechange=function(U){console.log(U),console.log(u.peerConnection.iceConnectionState),"connected"===U.currentTarget.iceConnectionState&&(u.connectedTime=new Date),u.oniceconnectionstatechange&&u.oniceconnectionstatechange(U.currentTarget.iceConnectionState)},u.renegotiate=function(){void 0!==u.prevOffer&&u.peerConnection.createOffer().then(function(U){return"unified-plan"!==Object(y.getParameter)("PLAN")&&(U.sdp=U.sdp.replace(/a=recvonly\r\n/g,"a=inactive\r\n")),U.sdp=$(U.sdp),U.sdp=Z(U.sdp),u.peerConnection.setLocalDescription(U)}).then(function(){u.onnegotiationneeded&&u.onnegotiationneeded(u.peerConnection.localDescription.sdp)}).catch(function(U){console.log("createOffer error: ",U)})},u.peerConnection.onnegotiationneeded=u.renegotiate,u.onaddstream=null,u.onremovestream=null,u.onnegotiationneeded=null,u.state="new",u.markActionNeeded(),u}(_)).browser="chrome-stable",u},G=function(_,u,B){var S={};S.config=_,S.streamId=_.streamId,delete _.streamId,navigator.getMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;var c=0,z=1,d=!1,T=null,L=function(re){if(c++,T)if(T===re)f.default.debug("Using Video Source/ Audio Source");else{var U=T.getVideoTracks()[0],V=T.getAudioTracks()[0],q=re.getVideoTracks()[0],pe=re.getAudioTracks()[0];q&&(U&&T.removeTrack(U),T.addTrack(q)),pe&&(V&&T.removeTrack(V),T.addTrack(pe))}else T=re;c!==z||d||(d=!0,setTimeout(function(){u(T)},0))},$=function(re){f.default.error("Failed to GetUserMedia",re.name,re.code,re.message,re),c++,d||(d=!0,setTimeout(function(){B&&B(re)},0))},Z=function(){var re={video:_.video,audio:_.audio};if(f.default.debug("GetUserMedia",JSON.stringify(re)),navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)navigator.mediaDevices.getUserMedia(re).then(L).catch($);else if("undefined"!=typeof navigator&&navigator.getMedia)navigator.getMedia(_,L,$);else{var U={name:"MEDIA_NOT_SUPPORT",message:"Video/audio streams not supported yet"};f.default.error("["+S.streamId+"]"+U.message),B&&B(U)}};if((_.videoSource||_.audioSource)&&(T=new MediaStream,_.videoSource&&T.addTrack(_.videoSource),_.audioSource&&T.addTrack(_.audioSource)),_.video||_.audio||_.screen||_.screenAudio){if(!_.screen&&_.screenAudio)return B&&B({code:"Set screen to true before sharing the audio"});if(_.screen){if(te.a.isElectron())return _.screen.sourceId?te.a.getScreenStream(_.screen.sourceId,_.screen,function(re,U){re?$(re):(_.audio&&(z++,Z()),L(U))}):te.a.shareScreen(_.screen,function(re,U){re?$(re):(_.audio&&(z++,Z()),L(U))});if(I.isFireFox()){if(f.default.debug("["+S.streamId+"]Screen access requested"),!~["screen","window","application"].indexOf(_.screen.mediaSource))return B&&B({code:"Invalid mediaSource, mediaSource should be one of [screen, window, application]"});navigator.getMedia({video:_.screen},function(re){_.audio&&(z++,Z()),L(re)},$)}else if(I.isChromeKernel()&&_.screen.extensionId){if(window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)[1]<34)return void B({code:"This browser does not support screen sharing"});f.default.debug("["+S.streamId+"]Screen access on chrome stable, looking for extension");try{chrome.runtime.sendMessage(_.screen.extensionId,{getStream:!0},function(re){void 0===re?(f.default.error("["+S.streamId+"]No response from Chrome Plugin. Plugin not installed properly"),$({name:"PluginNotInstalledProperly",message:"No response from Chrome Plugin. Plugin not installed properly."})):(_.screen.mandatory.chromeMediaSourceId=re.streamId,navigator.getMedia({video:_.screen},function(U){_.audio&&(z++,Z()),L(U)},$))})}catch(re){return f.default.debug("["+S.streamId+"]AgoraRTC screensharing plugin is not accessible"),void B({code:"no_plugin_present"})}}else{if(window.navigator.mediaDevices.getDisplayMedia){var ce={};return ce.video="number"==typeof _.screen.width&&"number"==typeof _.screen.height?{width:{ideal:_.screen.width},height:{ideal:_.screen.height}}:{width:_.screen.width,height:_.screen.height},ce.video.frameRate=_.screen.frameRate&&_.screen.frameRate.min?{ideal:_.screen.frameRate.max,max:_.screen.frameRate.max}:_.screen.frameRate,_.screenAudio&&(ce.audio=_.screenAudio),f.default.debug("use getDisplayMedia, constraints:",ce),window.navigator.mediaDevices.getDisplayMedia(ce).then(function(re){!_.screenAudio&&_.audio&&(z++,Z()),L(re)}).catch($)}f.default.error("["+S.streamId+"]This browser does not support screenSharing"),B({code:"This browser does not support screen sharing"})}}else Z()}else L(T)}},function(se,ee,x){"use strict";var I=this&&this.__importDefault||function(b){return b&&b.__esModule?b:{default:b}};Object.defineProperty(ee,"__esModule",{value:!0});var b,C=I(x(0)),w=function(){function b(D,m,R){void 0===m&&(m=""),this.name="AgoraRTCException",this.code=D,this.message="AgoraRTCError "+this.code+": "+m,this.data=R}return b.prototype.toString=function(){return this.data?this.message+" data: "+JSON.stringify(this.data):this.message},b.prototype.throw=function(){throw C.default.error(this.toString()),this},b}();ee.AgoraRTCError=w,(b=ee.AgoraRTCErrorCode||(ee.AgoraRTCErrorCode={})).UNEXPECTED_ERROR="UNEXPECTED_ERROR",b.UNEXPECTED_RESPONSE="UNEXPECTED_RESPONSE",b.TIMEOUT="TIMEOUT",b.INVALID_PARAMS="INVALID_PARAMS",b.NOT_SUPPORT="NOT_SUPPORT",b.INVALID_OPERATION="INVALID_OPERATION",b.OPERATION_ABORT="OPERATION_ABORT",b.WEB_SECURITY_RESTRICT="WEB_SECURITY_RESTRICT",b.NETWORK_ERROR="NETWORK_ERROR",b.NETWORK_TIMEOUT="NETWORK_TIMEOUT",b.NETWORK_RESPONSE_ERROR="NETWORK_RESPONSE_ERROR",b.API_INVOKE_TIMEOUT="API_INVOKE_TIMEOUT",b.ENUMERATE_DEVICES_FAILED="ENUMERATE_DEVICES_FAILED",b.DEVICE_NOT_FOUND="DEVICE_NOT_FOUND",b.ELECTRON_IS_NULL="ELECTRON_IS_NULL",b.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR="ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR",b.STREAM_ALREADY_INITIALIZED="STREAM_ALREADY_INITIALIZED",b.STREAM_IS_CLOSED="STREAM_IS_CLOSED",b.ABORT_OTHER_INIT="ABORT_OTHER_INIT",b.CHROME_PLUGIN_NO_RESPONSE="CHROME_PLUGIN_NO_RESPONSE",b.CHROME_PLUGIN_NOT_INSTALL="CHROME_PLUGIN_NOT_INSTALL",b.MEDIA_OPTION_INVALID="MEDIA_OPTION_INVALID",b.PERMISSION_DENIED="PERMISSION_DENIED",b.CONSTRAINT_NOT_SATISFIED="CONSTRAINT_NOT_SATISFIED",b.CAN_NOT_AUTOPLAY="CAN_NOT_AUTOPLAY",b.HIGH_STREAM_NO_VIDEO_TRACK="HIGH_STREAM_NO_VIDEO_TRACK",b.SCREEN_SHARE_CAN_NOT_CREATE_LOW_STREAM="SCREEN_SHARE_CAN_NOT_CREATE_LOW_STREAM",b.TRACK_IS_DISABLED="TRACK_IS_DISABLED",b.SHARE_AUDIO_NOT_ALLOWED="SHARE_AUDIO_NOT_ALLOWED",b.TOKEN_GENERATOR_FUNCTION_ERROR="TOKEN_GENERATOR_FUNCTION_ERROR",b.INVALID_UINT_UID_FROM_STRING_UID="INVALID_UINT_UID_FROM_STRING_UID",b.CAN_NOT_GET_PROXY_SERVER="CAN_NOT_GET_PROXY_SERVER",b.CAN_NOT_GET_GATEWAY_SERVER="CAN_NOT_GET_GATEWAY_SERVER",b.UID_CONFLICT="UID_CONFLICT",b.INVALID_LOCAL_TRACK="INVALID_LOCAL_TRACK",b.INVALID_TRACK="INVALID_TRACK",b.SENDER_NOT_FOUND="SENDER_NOT_FOUND",b.CREATE_OFFER_FAILED="CREATE_OFFER_FAILED",b.SET_ANSWER_FAILED="SET_ANSWER_FAILED",b.ICE_FAILED="ICE_FAILED",b.PC_CLOSED="PC_CLOSED",b.SENDER_REPLACE_FAILED="SENDER_REPLACE_FAILED",b.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",b.NO_ICE_CANDIDATE="NO_ICE_CANDIDATE",b.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS="CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS",b.INVALID_REMOTE_USER="INVALID_REMOTE_USER",b.REMOTE_USER_IS_NOT_PUBLISHED="REMOTE_USER_IS_NOT_PUBLISHED",b.SUBSCRIPTION_IS_IN_PROGRESS="SUBSCRIPTION_IS_IN_PROGRESS",b.CUSTOM_REPORT_SEND_FAILED="CUSTOM_REPORT_SEND_FAILED",b.CUSTOM_REPORT_FREQUENCY_TOO_HIGH="CUSTOM_REPORT_FREQUENCY_TOO_HIGH",b.FETCH_AUDIO_FILE_FAILED="FETCH_AUDIO_FILE_FAILED",b.READ_LOCAL_AUDIO_FILE_ERROR="READ_LOCAL_AUDIO_FILE_ERROR",b.DECODE_AUDIO_FILE_FAILED="DECODE_AUDIO_FILE_FAILED",b.EFFECT_ID_CONFLICTED="EFFECT_ID_CONFLICTED",b.EFFECT_SOUND_ID_NOT_FOUND="EFFECT_SOUND_ID_NOT_FOUND",b.WS_ABORT="WS_ABORT",b.WS_DISCONNECT="WS_DISCONNECT",b.WS_ERR="WS_ERR",b.CAN_NOT_CONNECT_TO_LIVE_STREAMING_WORKER="CAN_NOT_CONNECT_TO_LIVE_STREAMING_WORKER",b.LIVE_STREAMING_TASK_CONFLICT="LIVE_STREAMING_TASK_CONFLICT",b.LIVE_STREAMING_INVALID_ARGUMENT="LIVE_STREAMING_INVALID_ARGUMENT",b.LIVE_STREAMING_INTERNAL_SERVER_ERROR="LIVE_STREAMING_INTERNAL_SERVER_ERROR",b.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED="LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED",b.LIVE_STREAMING_TRANSCODING_NOT_SUPPORT="LIVE_STREAMING_TRANSCODING_NOT_SUPPORT",b.LIVE_STREAMING_CDN_ERROR="LIVE_STREAMING_CDN_ERROR",b.LIVE_STREAMING_INVALID_RAW_STREAM="LIVE_STREAMING_INVALID_RAW_STREAM",b.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT="LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT",b.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE="LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE",b.LIVE_STREAMING_WARN_FREQUENT_REQUEST="LIVE_STREAMING_WARN_FREQUENT_REQUEST",b.WEBGL_INTERNAL_ERROR="WEBGL_INTERNAL_ERROR",b.BEAUTY_PROCESSOR_INTERNAL_ERROR="BEAUTY_PROCESSOR_INTERNAL_ERROR",b.CROSS_CHANNEL_WAIT_STATUS_ERROR="CROSS_CHANNEL_WAIT_STATUS_ERROR",b.CROSS_CHANNEL_FAILED_JOIN_SRC="CROSS_CHANNEL_FAILED_JOIN_SEC",b.CROSS_CHANNEL_FAILED_JOIN_DEST="CROSS_CHANNEL_FAILED_JOIN_DEST",b.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST="CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST",b.CROSS_CHANNEL_SERVER_ERROR_RESPONSE="CROSS_CHANNEL_SERVER_ERROR_RESPONSE",b.METADATA_OUT_OF_RANGE="METADATA_OUT_OF_RANGE"},function(se,ee,x){"use strict";x.d(ee,"a",function(){return m});var I=x(0),C=window.AudioContext||window.webkitAudioContext,w=x(2),b=w.getParameter,D=w.setParameter,m=function(){return b("AUDIO_CONTEXT")||(console.log("Creating Audio Context"),D("AUDIO_CONTEXT",function(){if(C){var R=new C;return window.ctx=R,new Promise(function(f){document.body?f():window.addEventListener("load",f)}).then(function(){var f=function g(){"suspended"==R.state?(I.default.debug("AudioContext is suspended, auto resume"),R.resume().then(function(){I.default.debug("AudioContext resume success"),document.body.removeEventListener("touchend",g,!0),document.body.removeEventListener("mousedown",g,!0)})):(I.default.debug("AudioContext is running"),document.body.removeEventListener("touchend",g,!0),document.body.removeEventListener("mousedown",g,!0))};I.default.debug(">>> add event listener >>>>"),document.body.addEventListener("touchend",f,!0),document.body.addEventListener("mousedown",f,!0)}),R}throw new Error("AUDIO_CONTEXT_NOT_SUPPORTED")}())),b("AUDIO_CONTEXT")};m()},function(se,ee,x){"use strict";var I=x(1),C=null,w=function(){try{C=window.require("electron")}catch(m){}return C},b=function(m){var R=I.report.reportApiInvoke(null,{callback:m,name:"getScreenSources",options:arguments,tag:"tracer"}),f=w();if(!f)return R&&R("electron is null");try{var g=f.desktopCapturer.getSources({types:["window","screen"]})}catch(y){console.log(y)}g instanceof Promise?(console.log("electron.desktopCapturer.getSources return type is Promise"),g.then(function(y){return R&&R(null,y)}).catch(function(y){return R&&R(y)})):g=f.desktopCapturer.getSources({types:["window","screen"]},function(y,M){console.log("electron.desktopCapturer.getSources return type is callback"),R&&R(null,M)})},D=function(m,R,f){R={audio:!1,video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:m,maxHeight:R.height,maxWidth:R.width,maxFrameRate:R.frameRate&&R.frameRate.max,minFrameRate:R.frameRate&&R.frameRate.min}}},navigator.webkitGetUserMedia(R,function(y){f&&f(null,y)},function(y){f&&f(y)})};ee.a={isElectron:function(){return!!w()},getElectronInstance:w,getScreenSources:b,getScreenStream:D,shareScreen:function(m,R){b(function(f,g){if(f)return R&&R(f);!function(y,M){var j=document.createElement("div");j.innerText="share screen",j.setAttribute("style","text-align: center; height: 25px; line-height: 25px; border-radius: 4px 4px 0 0; background: #D4D2D4; border-bottom:  solid 1px #B9B8B9;");var A=document.createElement("div");A.setAttribute("style","width: 100%; height: 500px; padding: 15px 25px ; box-sizing: border-box;");var E=document.createElement("div");E.innerText="Agora Web Screensharing wants to share the contents of your screen with webdemo.agorabeckon.com. Choose what you'd like to share.",E.setAttribute("style","height: 12%;");var F=document.createElement("div");F.setAttribute("style","width: 100%; height: 80%; background: #FFF; border:  solid 1px #CBCBCB; display: flex; flex-wrap: wrap; justify-content: space-around; overflow-y: scroll; padding: 0 15px; box-sizing: border-box;");var N=document.createElement("div");N.setAttribute("style","text-align: right; padding: 16px 0;");var H=document.createElement("button");H.innerHTML="cancel",H.setAttribute("style","width: 85px;"),H.onclick=function(){document.body.removeChild(O),M&&M("NotAllowedError")},N.appendChild(H),A.appendChild(E),A.appendChild(F),A.appendChild(N);var O=document.createElement("div");O.setAttribute("style","position: absolute; z-index: 99999999; top: 50%; left: 50%; width: 620px; height: 525px; background: #ECECEC; border-radius: 4px; -webkit-transform: translate(-50%,-50%); transform: translate(-50%,-50%);"),O.appendChild(j),O.appendChild(A),document.body.appendChild(O),y.map(function(J){if(J.id){var te=document.createElement("div");te.setAttribute("style","width: 30%; height: 160px; padding: 20px 0; text-align: center;box-sizing: content-box;");var Y=J.thumbnail;Y.getSize().width>1920&&(Y=Y.resize({width:1920})),te.innerHTML='<div style="height: 120px; display: table-cell; vertical-align: middle;"><img style="width: 100%; background: #333333; box-shadow: 1px 1px 1px 1px rgba(0, 0, 0, 0.2);" src='+Y.toDataURL()+' /></div><span style="\theight: 40px; line-height: 40px; display: inline-block; width: 70%; word-break: keep-all; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">'+J.name.replace(/[\u00A0-\u9999<>\&]/g,function(ne){return"&#"+ne.charCodeAt(0)+";"})+"</span>",te.onclick=function(){document.body.removeChild(O),M&&M(null,J.id)},F.appendChild(te)}})}(g,function(y,M){if(y)return R&&R(y);D(M,m,R)})})}}},function(se,ee,x){"use strict";Object.defineProperty(ee,"__esModule",{value:!0});var C,I=x(3);(C=ee.LiveStreamingServiceMode||(ee.LiveStreamingServiceMode={})).TRANSCODE="mix_streaming",C.RAW="raw_streaming",C.INJECT="inject_streaming",ee.DEFAULT_LIVE_STREAMING_TRANSCODING_USER={alpha:1,height:640,width:360,x:0,y:0,zOrder:0,audioChannel:0},ee.DEFAULT_LIVE_STREAMING_TRANSCODING_WATERMARK={x:0,y:0,width:160,height:160,zOrder:255,alpha:1},ee.isLiveStreamingTranscodingConfig=function(C){return I.isEmpty(C.width)||I.checkValidNumber(C.width,"config.width",0),I.isEmpty(C.height)||I.checkValidNumber(C.height,"config.height",0),I.isEmpty(C.videoBitrate)||I.checkValidNumber(C.videoBitrate,"config.videoBitrate",1,1e6),I.isEmpty(C.videoFramerate)||I.checkValidNumber(C.videoFramerate,"config.videoFramerate"),I.isEmpty(C.lowLatency)||I.checkValidBoolean(C.lowLatency,"config.lowLatency"),I.isEmpty(C.audioSampleRate)||I.checkValidEnum(C.audioSampleRate,"config.audioSampleRate",[32e3,44100,48e3]),I.isEmpty(C.audioBitrate)||I.checkValidNumber(C.audioBitrate,"config.audioBitrate",1,128),I.isEmpty(C.audioChannels)||I.checkValidEnum(C.audioChannels,"config.audioChannels",[1,2,3,4,5]),I.isEmpty(C.videoGop)||I.checkValidNumber(C.videoGop,"config.videoGop"),I.isEmpty(C.videoCodecProfile)||I.checkValidEnum(C.videoCodecProfile,"config.videoCodecProfile",[66,77,100]),I.isEmpty(C.userCount)||I.checkValidNumber(C.userCount,"config.userCount",0,17),I.isEmpty(C.backgroundColor)||I.checkValidNumber(C.backgroundColor,"config.backgroundColor",0,16777215),C.transcodingUsers&&!I.isEmpty(C.transcodingUsers)&&(I.checkValidArray(C.transcodingUsers,"config.transcodingUsers"),C.transcodingUsers.forEach(function(w,b){I.checkValidUID(w.uid),I.isEmpty(w.x)||I.checkValidNumber(w.x,"transcodingUser["+b+"].x",0,1e4),I.isEmpty(w.y)||I.checkValidNumber(w.y,"transcodingUser["+b+"].y",0,1e4),I.isEmpty(w.width)||I.checkValidNumber(w.width,"transcodingUser["+b+"].width",0,1e4),I.isEmpty(w.height)||I.checkValidNumber(w.height,"transcodingUser["+b+"].height",0,1e4),I.isEmpty(w.zOrder)||I.checkValidNumber(w.zOrder-1,"transcodingUser["+b+"].zOrder",0,100),I.isEmpty(w.alpha)||I.checkValidFloatNumber(w.alpha,"transcodingUser["+b+"].alpha",0,1)})),C.images&&!I.isEmpty(C.images)&&(I.checkValidArray(C.images,"config.images"),C.images.forEach(function(w,b){I.checkValidString(w.url,"images["+b+"].url",1,1e3,!1),I.isEmpty(w.x)||I.checkValidNumber(w.x,"images["+b+"].x",0,1e4),I.isEmpty(w.y)||I.checkValidNumber(w.y,"images["+b+"].y",0,1e4),I.isEmpty(w.width)||I.checkValidNumber(w.width,"images["+b+"].width",0,1e4),I.isEmpty(w.height)||I.checkValidNumber(w.height,"images["+b+"].height",0,1e4),I.isEmpty(w.zOrder)||I.checkValidNumber(w.zOrder,"images["+b+"].zOrder",0,255),I.isEmpty(w.alpha)||I.checkValidFloatNumber(w.alpha,"images["+b+"].alpha",0,1)})),!0},ee.DEFAULT_TRANSCODING_CONFIG={audioBitrate:48,audioChannels:1,audioSampleRate:48e3,backgroundColor:0,height:360,lowLatency:!1,videoBitrate:400,videoCodecProfile:100,videoCodecType:1,videoFramerate:15,videoGop:30,width:640,images:[],userConfigs:[],userConfigExtraInfo:""},ee.isInjectStreamConfig=function(C){return I.isEmpty(C.audioVolume)||I.checkValidNumber(C.audioVolume,"config.audioVolume",0,1e3),I.isEmpty(C.audioBitrate)||I.checkValidNumber(C.audioBitrate,"config.audioBitrate",1,1e4),I.isEmpty(C.audioChannels)||I.checkValidEnum(C.audioChannels,"config.audioChannels",[1,2]),I.isEmpty(C.audioSampleRate)||I.checkValidEnum(C.audioSampleRate,"config.audioSampleRate",[32e3,44100,48e3]),I.isEmpty(C.width)||I.checkValidNumber(C.width,"config.width",0,1e4),I.isEmpty(C.height)||I.checkValidNumber(C.height,"config.height",0,1e4),I.isEmpty(C.videoBitrate)||I.checkValidNumber(C.videoBitrate,"config.videoBitrate",1,1e4),I.isEmpty(C.videoFramerate)||I.checkValidNumber(C.videoFramerate,"config.videoFramerate",1,1e4),I.isEmpty(C.videoGop)||I.checkValidNumber(C.videoGop,"config.videoGop",1,1e4),!0},ee.DEFAULT_INJECT_CONFIG={audioBitrate:48,audioChannels:2,audioVolume:100,audioSampleRate:48e3,height:0,width:0,videoBitrate:400,videoFramerate:15,videoGop:30},function(C){C.WARNING="@live_uap-warning",C.ERROR="@line_uap-error",C.PUBLISH_STREAM_STATUS="@live_uap-publish-status",C.INJECT_STREAM_STATUS="@live_uap-inject-status",C.WORKER_STATUS="@live_uap-worker-status",C.REQUEST_NEW_ADDRESS="@live_uap-request-address"}(ee.LiveStreamingUapSignalEvents||(ee.LiveStreamingUapSignalEvents={})),function(C){C.REQUEST_WORKER_MANAGER_LIST="@live_req_worker_manager"}(ee.LiveStreamingInternalEvents||(ee.LiveStreamingInternalEvents={})),function(C){C[C.LIVE_STREAM_RESPONSE_SUCCEED=200]="LIVE_STREAM_RESPONSE_SUCCEED",C[C.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM=454]="LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM",C[C.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR=450]="LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR",C[C.LIVE_STREAM_RESPONSE_BAD_STREAM=451]="LIVE_STREAM_RESPONSE_BAD_STREAM",C[C.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR=400]="LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR",C[C.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST=404]="LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST",C[C.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED=456]="LIVE_STREAM_RESPONSE_NOT_AUTHORIZED",C[C.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE=457]="LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE",C[C.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN=429]="LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN",C[C.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH=452]="LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH",C[C.LIVE_STREAM_RESPONSE_NOT_SUPPORTED=453]="LIVE_STREAM_RESPONSE_NOT_SUPPORTED",C[C.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM=455]="LIVE_STREAM_RESPONSE_MAX_STREAM_NUM",C[C.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR=500]="LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR",C[C.LIVE_STREAM_RESPONSE_WORKER_LOST=501]="LIVE_STREAM_RESPONSE_WORKER_LOST",C[C.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT=502]="LIVE_STREAM_RESPONSE_RESOURCE_LIMIT",C[C.LIVE_STREAM_RESPONSE_WORKER_QUIT=503]="LIVE_STREAM_RESPONSE_WORKER_QUIT",C[C.ERROR_FAIL_SEND_MESSAGE=504]="ERROR_FAIL_SEND_MESSAGE",C[C.LIVE_STREAM_RESPONSE_INGNORE_MESSAGE=505]="LIVE_STREAM_RESPONSE_INGNORE_MESSAGE",C[C.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE=30]="PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE",C[C.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT=31]="PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT",C[C.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH=32]="PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH",C[C.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN=33]="PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN"}(ee.LIVE_STREAM_ERROR_CODE||(ee.LIVE_STREAM_ERROR_CODE={})),function(C){C.CONNECTED="websocket:connected",C.RECONNECTING="websocket:reconnecting",C.WILL_RECONNECT="websocket:will_reconnect",C.CLOSED="websocket:closed",C.FAILED="websocket:failed",C.ON_MESSAGE="websocket:on_message",C.REQUEST_NEW_URLS="websocket:request_new_urls"}(ee.WebSocketManagerEvents||(ee.WebSocketManagerEvents={}))},function(se,ee,x){var I=x(57),C=x(58);se.exports=function(w,b,D){var m=b&&D||0;"string"==typeof w&&(b="binary"===w?new Array(16):null,w=null);var R=(w=w||{}).random||(w.rng||I)();if(R[6]=15&R[6]|64,R[8]=63&R[8]|128,b)for(var f=0;f<16;++f)b[m+f]=R[f];return b||C(R)}},function(se,ee,x){var I;se.exports=(I=x(73),function(C){var w=I,b=w.lib,D=b.WordArray,m=b.Hasher,R=w.algo,f=[],g=[];!function(){function j(N){for(var H=C.sqrt(N),O=2;O<=H;O++)if(!(N%O))return!1;return!0}function A(N){return 4294967296*(N-(0|N))|0}for(var E=2,F=0;F<64;)j(E)&&(F<8&&(f[F]=A(C.pow(E,.5))),g[F]=A(C.pow(E,1/3)),F++),E++}();var y=[],M=R.SHA256=m.extend({_doReset:function(){this._hash=new D.init(f.slice(0))},_doProcessBlock:function(j,A){for(var E=this._hash.words,F=E[0],N=E[1],H=E[2],O=E[3],J=E[4],te=E[5],Y=E[6],ne=E[7],G=0;G<64;G++){if(G<16)y[G]=0|j[A+G];else{var _=y[G-15],B=y[G-2];y[G]=((_<<25|_>>>7)^(_<<14|_>>>18)^_>>>3)+y[G-7]+((B<<15|B>>>17)^(B<<13|B>>>19)^B>>>10)+y[G-16]}var c=F&N^F&H^N&H,d=ne+((J<<26|J>>>6)^(J<<21|J>>>11)^(J<<7|J>>>25))+(J&te^~J&Y)+g[G]+y[G];ne=Y,Y=te,te=J,J=O+d|0,O=H,H=N,N=F,F=d+(((F<<30|F>>>2)^(F<<19|F>>>13)^(F<<10|F>>>22))+c)|0}E[0]=E[0]+F|0,E[1]=E[1]+N|0,E[2]=E[2]+H|0,E[3]=E[3]+O|0,E[4]=E[4]+J|0,E[5]=E[5]+te|0,E[6]=E[6]+Y|0,E[7]=E[7]+ne|0},_doFinalize:function(){var j=this._data,A=j.words,E=8*this._nDataBytes,F=8*j.sigBytes;return A[F>>>5]|=128<<24-F%32,A[14+(F+64>>>9<<4)]=C.floor(E/4294967296),A[15+(F+64>>>9<<4)]=E,j.sigBytes=4*A.length,this._process(),this._hash},clone:function(){var j=m.clone.call(this);return j._hash=this._hash.clone(),j}});w.SHA256=m._createHelper(M),w.HmacSHA256=m._createHmacHelper(M)}(Math),I.SHA256)},function(se,ee,x){"use strict";Object.defineProperty(ee,"__esModule",{value:!0}),ee.randomString=function(I){void 0===I&&(I=8);for(var C="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",w=C.length,b="",D=0;D<I;D++)b+=C.charAt(Math.floor(Math.random()*w));return b}},function(se,ee,x){"use strict";var I=this&&this.__assign||function(){return(I=Object.assign||function(N){for(var H,O=1,J=arguments.length;O<J;O++)for(var te in H=arguments[O])Object.prototype.hasOwnProperty.call(H,te)&&(N[te]=H[te]);return N}).apply(this,arguments)},C=this&&this.__awaiter||function(N,H,O,J){return new(O||(O=Promise))(function(te,Y){function ne(u){try{_(J.next(u))}catch(B){Y(B)}}function G(u){try{_(J.throw(u))}catch(B){Y(B)}}function _(u){var B;u.done?te(u.value):(B=u.value,B instanceof O?B:new O(function(S){S(B)})).then(ne,G)}_((J=J.apply(N,H||[])).next())})},w=this&&this.__generator||function(N,H){var O,J,te,Y,ne={label:0,sent:function(){if(1&te[0])throw te[1];return te[1]},trys:[],ops:[]};return Y={next:G(0),throw:G(1),return:G(2)},"function"==typeof Symbol&&(Y[Symbol.iterator]=function(){return this}),Y;function G(_){return function(u){return function(B){if(O)throw new TypeError("Generator is already executing.");for(;ne;)try{if(O=1,J&&(te=2&B[0]?J.return:B[0]?J.throw||((te=J.return)&&te.call(J),0):J.next)&&!(te=te.call(J,B[1])).done)return te;switch(J=0,te&&(B=[2&B[0],te.value]),B[0]){case 0:case 1:te=B;break;case 4:return ne.label++,{value:B[1],done:!1};case 5:ne.label++,J=B[1],B=[0];continue;case 7:B=ne.ops.pop(),ne.trys.pop();continue;default:if(!((te=(te=ne.trys).length>0&&te[te.length-1])||6!==B[0]&&2!==B[0])){ne=0;continue}if(3===B[0]&&(!te||B[1]>te[0]&&B[1]<te[3])){ne.label=B[1];break}if(6===B[0]&&ne.label<te[1]){ne.label=te[1],te=B;break}if(te&&ne.label<te[2]){ne.label=te[2],ne.ops.push(B);break}te[2]&&ne.ops.pop(),ne.trys.pop();continue}B=H.call(N,ne)}catch(S){B=[6,S],J=0}finally{O=te=0}if(5&B[0])throw B[1];return{value:B[0]?B[1]:void 0,done:!0}}([_,u])}}},b=this&&this.__importDefault||function(N){return N&&N.__esModule?N:{default:N}};Object.defineProperty(ee,"__esModule",{value:!0});var D=x(2),m=b(x(37)),R=x(24),f=b(x(0)),g=x(1);function y(N){return new Promise(function(H){window.setTimeout(H,N)})}function M(N,H){return new Promise(function(O,J){H.timeout=H.timeout||D.getParameter("HTTP_CONNECT_TIMEOUT"),H.responseType=H.responseType||"json",H.data&&(H.data=JSON.stringify(H.data)),H.headers=H.headers||{},H.headers["Content-Type"]="application/json",H.method="POST",H.url=N,m.default.request(H).then(function(te){O(te.data)}).catch(function(te){m.default.isCancel(te)?J(new R.AgoraRTCError(R.AgoraRTCErrorCode.OPERATION_ABORT,"cancel token canceled")):J("ECONNABORTED"===te.code?new R.AgoraRTCError(R.AgoraRTCErrorCode.NETWORK_TIMEOUT,te.message):te.response?new R.AgoraRTCError(R.AgoraRTCErrorCode.NETWORK_RESPONSE_ERROR,te.response.status):new R.AgoraRTCError(R.AgoraRTCErrorCode.NETWORK_ERROR,te.message))})})}function j(N,H,O,J){var te=this,Y=Object.assign({},ee.DEFAULT_RETRY_CONFIG,J),ne=Y.timeout,G=function(){return C(te,void 0,void 0,function(){return w(this,function(B){switch(B.label){case 0:return[4,y(ne)];case 1:return B.sent(),ne*=Y.timeoutFactor,ne=Math.min(Y.maxRetryTimeout,ne),[2]}})})},_=!1,u=new Promise(function(B,S){return C(te,void 0,void 0,function(){var c,z,d;return w(this,function(T){switch(T.label){case 0:H=H||function(){return!1},O=O||function(){return!0},c=0,T.label=1;case 1:if(!(c<Y.maxRetryCount))return[3,12];if(_)return[2,S(new R.AgoraRTCError(R.AgoraRTCErrorCode.OPERATION_ABORT))];T.label=2;case 2:return T.trys.push([2,7,,11]),[4,N()];case 3:return z=T.sent(),H(z,c)?c+1===Y.maxRetryCount?[2,B(z)]:[4,G()]:[3,5];case 4:return T.sent(),[3,6];case 5:return[2,B(z)];case 6:return[3,11];case 7:return d=T.sent(),O(d,c)?c+1===Y.maxRetryCount?[2,S(d)]:[4,G()]:[3,9];case 8:return T.sent(),[3,10];case 9:return[2,S(d)];case 10:return[3,11];case 11:return c+=1,[3,1];case 12:return[2]}})})});return u.cancel=function(){return _=!0},u}function A(N,H){return{addressList:N.servers.map(function(O,J){return"wss://"+O.address.replace(/\./g,"-")+".edge.agora.io:"+O.wss+"?serviceName="+encodeURIComponent(H)}),workerToken:N.workerToken,vid:N.vid}}ee.wait=y,ee.post=M,ee.DEFAULT_RETRY_CONFIG={timeout:500,timeoutFactor:1.5,maxRetryCount:1/0,maxRetryTimeout:1e4},ee.getRetryWaitTime=function(N,H){var O=H.timeout*Math.pow(H.timeoutFactor,N);return Math.min(H.maxRetryTimeout,O)},ee.retryable=j,ee.liveStreamingServerResponseToResult=A;var E=1;function F(N,H,O,J,te){var Y=this;void 0===te&&(te=ee.DEFAULT_RETRY_CONFIG),E+=1;var ne,G,_={sid:O.sid,command:"convergeAllocateEdge",uid:"666",appId:O.appId,ts:Math.floor(Date.now()/1e3),seq:E,requestId:E,version:D.VERSION,cname:O.cname},u={service_name:H,json_body:JSON.stringify(_)},B=N[0];return j(function(){return C(Y,void 0,void 0,function(){var S,c,z,d,T;return w(this,function(L){switch(L.label){case 0:return ne=Date.now(),[4,M(B,{data:u,cancelToken:J,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"}})];case 1:if(S=L.sent(),G=Date.now()-ne,0!==S.code)throw z=new R.AgoraRTCError(R.AgoraRTCErrorCode.UNEXPECTED_RESPONSE,"live streaming ap error, code"+S.code,{retry:!0}),f.default.error(z.toString()),z;if(200!==(c=JSON.parse(S.json_body)).code)throw z=new R.AgoraRTCError(R.AgoraRTCErrorCode.UNEXPECTED_RESPONSE,"live streaming app center error, code: "+c.code+", reason: "+c.reason),f.default.error(z.toString()),z;if(!c.servers||0===c.servers.length)throw z=new R.AgoraRTCError(R.AgoraRTCErrorCode.UNEXPECTED_RESPONSE,"live streaming app center empty server"),f.default.error(z.toString()),z;if(d=A(c,H),D.getParameter("LIVE_STREAMING_ADDRESS"))try{T=JSON.parse(D.getParameter("LIVE_STREAMING_ADDRESS")),d.addressList=T}catch($){d.addressList=[D.getParameter("LIVE_STREAMING_ADDRESS")]}return[2,I(I({},d),{responseTime:G})]}})})},function(S,c){return g.report.requestApWorkerEvent(O.sid,{success:!0,sc:200,serviceName:H,responseDetail:JSON.stringify(S.addressList),firstSuccess:0===c,responseTime:G,serverIp:N[c%N.length]}),!1},function(S,c){return g.report.requestApWorkerEvent(O.sid,{success:!1,sc:S.data&&S.data.code||200,serviceName:H,responseTime:G,serverIp:N[c%N.length]}),!!(S.code!==R.AgoraRTCErrorCode.OPERATION_ABORT&&S.code!==R.AgoraRTCErrorCode.UNEXPECTED_RESPONSE||S.data&&S.data.retry)&&(B=N[(c+1)%N.length],!0)},te)}ee.requestLiveStreamingWorkerManager=F,ee.getLiveStreamingWorkerMangerResult=function(N,H,O){return C(this,void 0,void 0,function(){var J,te;return w(this,function(Y){switch(Y.label){case 0:J=D.getParameter("UAP_AP").map(function(ne){return H.proxyServer?"https://"+H.proxyServer+"/ap/?url="+ne+"/api/v1?action=uap":"https://"+ne+"/api/v1?action=uap"}),Y.label=1;case 1:return Y.trys.push([1,3,,4]),[4,F(J,N,H,O)];case 2:return[2,Y.sent()];case 3:throw te=Y.sent(),g.report.requestApWorkerEvent(H.sid,{success:!1,sc:te.data&&te.data.code||200,serviceName:N,responseTime:te.data&&te.data.responseTime}),te;case 4:return[2]}})})}},function(se,ee,x){var I=x(70),C=x(71),w=x(34),b=x(72);se.exports=function(D){return I(D)||C(D)||w(D)||b()}},function(se,ee){var x;x=function(){return this}();try{x=x||new Function("return this")()}catch(I){"object"==typeof window&&(x=window)}se.exports=x},function(se,ee,x){var I=x(35);se.exports=function(C,w){if(C){if("string"==typeof C)return I(C,w);var b=Object.prototype.toString.call(C).slice(8,-1);return"Object"===b&&C.constructor&&(b=C.constructor.name),"Map"===b||"Set"===b?Array.from(b):"Arguments"===b||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(b)?I(C,w):void 0}}},function(se,ee){se.exports=function(x,I){(null==I||I>x.length)&&(I=x.length);for(var C=0,w=new Array(I);C<I;C++)w[C]=x[C];return w}},function(se,ee,x){"use strict";var I=this&&this.__spreadArrays||function(){for(var D=0,m=0,R=arguments.length;m<R;m++)D+=arguments[m].length;var f=Array(D),g=0;for(m=0;m<R;m++)for(var y=arguments[m],M=0,j=y.length;M<j;M++,g++)f[g]=y[M];return f};Object.defineProperty(ee,"__esModule",{value:!0});var C=x(24),w=function(){function D(){this._events={},this.addListener=this.on}return D.prototype.getListeners=function(m){return this._events[m]?this._events[m].map(function(R){return R.listener}):[]},D.prototype.on=function(m,R){this._events[m]||(this._events[m]=[]);var f=this._events[m];-1===this._indexOfListener(f,R)&&f.push({listener:R,once:!1})},D.prototype.once=function(m,R){this._events[m]||(this._events[m]=[]);var f=this._events[m];-1===this._indexOfListener(f,R)&&f.push({listener:R,once:!0})},D.prototype.off=function(m,R){if(this._events[m]){var f=this._events[m],g=this._indexOfListener(f,R);-1!==g&&f.splice(g,1),0===this._events[m].length&&delete this._events[m]}},D.prototype.removeAllListeners=function(m){m?delete this._events[m]:this._events={}},D.prototype.emit=function(m){for(var R=[],f=1;f<arguments.length;f++)R[f-1]=arguments[f];this._events[m]||(this._events[m]=[]);for(var g=this._events[m].map(function(j){return j}),y=0;y<g.length;y+=1){var M=g[y];M.once&&this.off(m,M.listener),M.listener.apply(this,R||[])}},D.prototype._indexOfListener=function(m,R){for(var f=m.length;f--;)if(m[f].listener===R)return f;return-1},D}();function b(D,m){for(var R=[],f=2;f<arguments.length;f++)R[f-2]=arguments[f];var g=null,y=null;if(D.emit.apply(D,I([m],R,[function(M){g=M},function(M){y=M}])),null!==y)throw y;if(null===g)throw new C.AgoraRTCError(C.AgoraRTCErrorCode.UNEXPECTED_ERROR,"handler is not sync");return g}ee.EventEmitter=w,ee.emitAsPromise=function(D,m){for(var R=[],f=2;f<arguments.length;f++)R[f-2]=arguments[f];return 0===D.getListeners(m).length?Promise.reject(new C.AgoraRTCError(C.AgoraRTCErrorCode.UNEXPECTED_ERROR,"can not emit promise")):new Promise(function(g,y){D.emit.apply(D,I([m],R,[g,y]))})},ee.emitAsInvokerNoResponse=function(D,m){for(var R=[],f=2;f<arguments.length;f++)R[f-2]=arguments[f];return 0===D.getListeners(m).length?null:b.apply(void 0,I([D,m],R))},ee.emitAsInvoker=b},function(se,ee,x){se.exports=x(78)},function(se,ee,x){"use strict";se.exports=function(I,C){return function(){for(var w=new Array(arguments.length),b=0;b<w.length;b++)w[b]=arguments[b];return I.apply(C,w)}}},function(se,ee,x){"use strict";var I=x(18);function C(w){return encodeURIComponent(w).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}se.exports=function(w,b,D){if(!b)return w;var m;if(D)m=D(b);else if(I.isURLSearchParams(b))m=b.toString();else{var R=[];I.forEach(b,function(g,y){null!=g&&(I.isArray(g)?y+="[]":g=[g],I.forEach(g,function(M){I.isDate(M)?M=M.toISOString():I.isObject(M)&&(M=JSON.stringify(M)),R.push(C(y)+"="+C(M))}))}),m=R.join("&")}if(m){var f=w.indexOf("#");-1!==f&&(w=w.slice(0,f)),w+=(-1===w.indexOf("?")?"?":"&")+m}return w}},function(se,ee,x){"use strict";se.exports=function(I){return!(!I||!I.__CANCEL__)}},function(se,ee,x){"use strict";(function(I){var C=x(18),w=x(84),b={"Content-Type":"application/x-www-form-urlencoded"};function D(f,g){!C.isUndefined(f)&&C.isUndefined(f["Content-Type"])&&(f["Content-Type"]=g)}var m,R={adapter:(("undefined"!=typeof XMLHttpRequest||void 0!==I&&"[object process]"===Object.prototype.toString.call(I))&&(m=x(42)),m),transformRequest:[function(f,g){return w(g,"Accept"),w(g,"Content-Type"),C.isFormData(f)||C.isArrayBuffer(f)||C.isBuffer(f)||C.isStream(f)||C.isFile(f)||C.isBlob(f)?f:C.isArrayBufferView(f)?f.buffer:C.isURLSearchParams(f)?(D(g,"application/x-www-form-urlencoded;charset=utf-8"),f.toString()):C.isObject(f)?(D(g,"application/json;charset=utf-8"),JSON.stringify(f)):f}],transformResponse:[function(f){if("string"==typeof f)try{f=JSON.parse(f)}catch(g){}return f}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(f){return f>=200&&f<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};C.forEach(["delete","get","head"],function(f){R.headers[f]={}}),C.forEach(["post","put","patch"],function(f){R.headers[f]=C.merge(b)}),se.exports=R}).call(this,x(83))},function(se,ee,x){"use strict";var I=x(18),C=x(85),w=x(39),b=x(87),D=x(90),m=x(91),R=x(43);se.exports=function(f){return new Promise(function(g,y){var M=f.data,j=f.headers;I.isFormData(M)&&delete j["Content-Type"];var A=new XMLHttpRequest;f.auth&&(j.Authorization="Basic "+btoa((f.auth.username||"")+":"+(f.auth.password||"")));var N=b(f.baseURL,f.url);if(A.open(f.method.toUpperCase(),w(N,f.params,f.paramsSerializer),!0),A.timeout=f.timeout,A.onreadystatechange=function(){if(A&&4===A.readyState&&(0!==A.status||A.responseURL&&0===A.responseURL.indexOf("file:"))){var J="getAllResponseHeaders"in A?D(A.getAllResponseHeaders()):null;C(g,y,{data:f.responseType&&"text"!==f.responseType?A.response:A.responseText,status:A.status,statusText:A.statusText,headers:J,config:f,request:A}),A=null}},A.onabort=function(){A&&(y(R("Request aborted",f,"ECONNABORTED",A)),A=null)},A.onerror=function(){y(R("Network Error",f,null,A)),A=null},A.ontimeout=function(){var J="timeout of "+f.timeout+"ms exceeded";f.timeoutErrorMessage&&(J=f.timeoutErrorMessage),y(R(J,f,"ECONNABORTED",A)),A=null},I.isStandardBrowserEnv()){var H=x(92),O=(f.withCredentials||m(N))&&f.xsrfCookieName?H.read(f.xsrfCookieName):void 0;O&&(j[f.xsrfHeaderName]=O)}if("setRequestHeader"in A&&I.forEach(j,function(J,te){void 0===M&&"content-type"===te.toLowerCase()?delete j[te]:A.setRequestHeader(te,J)}),I.isUndefined(f.withCredentials)||(A.withCredentials=!!f.withCredentials),f.responseType)try{A.responseType=f.responseType}catch(J){if("json"!==f.responseType)throw J}"function"==typeof f.onDownloadProgress&&A.addEventListener("progress",f.onDownloadProgress),"function"==typeof f.onUploadProgress&&A.upload&&A.upload.addEventListener("progress",f.onUploadProgress),f.cancelToken&&f.cancelToken.promise.then(function(J){A&&(A.abort(),y(J),A=null)}),void 0===M&&(M=null),A.send(M)})}},function(se,ee,x){"use strict";var I=x(86);se.exports=function(C,w,b,D,m){var R=new Error(C);return I(R,w,b,D,m)}},function(se,ee,x){"use strict";var I=x(18);se.exports=function(C,w){w=w||{};var b={},D=["url","method","params","data"],m=["headers","auth","proxy"],R=["baseURL","url","transformRequest","transformResponse","paramsSerializer","timeout","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","maxContentLength","validateStatus","maxRedirects","httpAgent","httpsAgent","cancelToken","socketPath"];I.forEach(D,function(y){void 0!==w[y]&&(b[y]=w[y])}),I.forEach(m,function(y){I.isObject(w[y])?b[y]=I.deepMerge(C[y],w[y]):void 0!==w[y]?b[y]=w[y]:I.isObject(C[y])?b[y]=I.deepMerge(C[y]):void 0!==C[y]&&(b[y]=C[y])}),I.forEach(R,function(y){void 0!==w[y]?b[y]=w[y]:void 0!==C[y]&&(b[y]=C[y])});var f=D.concat(m).concat(R),g=Object.keys(w).filter(function(y){return-1===f.indexOf(y)});return I.forEach(g,function(y){void 0!==w[y]?b[y]=w[y]:void 0!==C[y]&&(b[y]=C[y])}),b}},function(se,ee,x){"use strict";function I(C){this.message=C}I.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},I.prototype.__CANCEL__=!0,se.exports=I},function(se,ee){se.exports=function(x,I,C){return I in x?Object.defineProperty(x,I,{value:C,enumerable:!0,configurable:!0,writable:!0}):x[I]=C,x}},function(se,ee,x){"use strict";var I=this&&this.__awaiter||function(A,E,F,N){return new(F||(F=Promise))(function(H,O){function J(ne){try{Y(N.next(ne))}catch(G){O(G)}}function te(ne){try{Y(N.throw(ne))}catch(G){O(G)}}function Y(ne){var G;ne.done?H(ne.value):(G=ne.value,G instanceof F?G:new F(function(_){_(G)})).then(J,te)}Y((N=N.apply(A,E||[])).next())})},C=this&&this.__generator||function(A,E){var F,N,H,O,J={label:0,sent:function(){if(1&H[0])throw H[1];return H[1]},trys:[],ops:[]};return O={next:te(0),throw:te(1),return:te(2)},"function"==typeof Symbol&&(O[Symbol.iterator]=function(){return this}),O;function te(Y){return function(ne){return function(G){if(F)throw new TypeError("Generator is already executing.");for(;J;)try{if(F=1,N&&(H=2&G[0]?N.return:G[0]?N.throw||((H=N.return)&&H.call(N),0):N.next)&&!(H=H.call(N,G[1])).done)return H;switch(N=0,H&&(G=[2&G[0],H.value]),G[0]){case 0:case 1:H=G;break;case 4:return J.label++,{value:G[1],done:!1};case 5:J.label++,N=G[1],G=[0];continue;case 7:G=J.ops.pop(),J.trys.pop();continue;default:if(!((H=(H=J.trys).length>0&&H[H.length-1])||6!==G[0]&&2!==G[0])){J=0;continue}if(3===G[0]&&(!H||G[1]>H[0]&&G[1]<H[3])){J.label=G[1];break}if(6===G[0]&&J.label<H[1]){J.label=H[1],H=G;break}if(H&&J.label<H[2]){J.label=H[2],J.ops.push(G);break}H[2]&&J.ops.pop(),J.trys.pop();continue}G=E.call(A,J)}catch(_){G=[6,_],N=0}finally{F=H=0}if(5&G[0])throw G[1];return{value:G[0]?G[1]:void 0,done:!0}}([Y,ne])}}},w=this&&this.__importDefault||function(A){return A&&A.__esModule?A:{default:A}},b=this&&this.__importStar||function(A){if(A&&A.__esModule)return A;var E={};if(null!=A)for(var F in A)Object.hasOwnProperty.call(A,F)&&(E[F]=A[F]);return E.default=A,E};Object.defineProperty(ee,"__esModule",{value:!0});var D=w(x(59)),m=b(x(62)),R=b(x(63)),f=w(x(0)),g=x(2),y=D.default.Root.fromJSON(R),M=function(){function A(){this.requestArray=[],this.retryBackoffCount=0,this.state=0}return A.prototype.setProxy=function(E){this.proxyServer=E},A.prototype.sendReportList=function(E,F){var N=this,H=this._dataConvert("ProtoRaws",{vid:F,sendTs:Math.round(Date.now()/1e3),payloads:E.map(function(O){return{id:m[O.type],msg:N._dataConvert(O.type,O.data)}})});this.send(H)},A.prototype._dataConvert=function(E,F){var N;try{N=y.lookupType("protobuf."+E)}catch(O){f.default.error("[send-proto] invalid proto name "+E)}var H=N.create(F);return N.encode(H).finish()},A.prototype.send=function(E){0==this.state?this._send(E):this.requestArray.push(E)},A.prototype._send=function(E){return I(this,void 0,void 0,function(){return C(this,function(F){switch(F.label){case 0:return F.trys.push([0,2,,4]),this.state=1,[4,this.request(E)];case 1:return F.sent(),this.retryBackoffCount=0,0!==this.requestArray.length?this._send(this.requestArray.shift()):this.state=0,[3,4];case 2:return F.sent(),[4,j(this.retryBackoffCount++<2?200:1e4)];case 3:return F.sent(),this._send(E),[3,4];case 4:return[2]}})})},A.prototype.request=function(E){return I(this,void 0,void 0,function(){var F,N;return C(this,function(H){switch(H.label){case 0:F=this._getAddress(),N=this._getBackupAddress(),H.label=1;case 1:return H.trys.push([1,3,,5]),[4,this._request(F,E)];case 2:return H.sent(),[3,5];case 3:return H.sent(),[4,this._request(N,E)];case 4:return H.sent(),[3,5];case 5:return[2]}})})},A.prototype._request=function(E,F){return this._post(E,F)},A.prototype._post=function(E,F){var N=this;return new Promise(function(H,O){var J=new XMLHttpRequest;J.timeout=g.getParameter("HTTP_CONNECT_TIMEOUT"),J.open("POST",E,!0),J.setRequestHeader("Content-type","application/octet-stream"),N.proxyServer||(J.setRequestHeader("Cache-Control","no-cache, no-store"),J.setRequestHeader("Pragma","no-cache"),J.setRequestHeader("Expires","0")),J.onload=function(te){H(J.responseText)},J.onerror=function(te){O(te)},J.ontimeout=function(te){O(te)},J.send(F)})},A.prototype._getAddress=function(){return this.proxyServer?"https://"+this.proxyServer+"/rs/?h="+g.getParameter("EVENT_REPORT_DOMAIN")+"&p=6443&d=events/proto-raws":"https://"+g.getParameter("EVENT_REPORT_DOMAIN")+":6443/events/proto-raws"},A.prototype._getBackupAddress=function(){return this.proxyServer?"https://"+this.proxyServer+"/rs/?h="+g.getParameter("EVENT_REPORT_BACKUP_DOMAIN")+"&p=6443&d=events/proto-raws":"https://"+g.getParameter("EVENT_REPORT_BACKUP_DOMAIN")+":6443/events/proto-raws"},A}();ee.default=M;var j=function(A){return new Promise(function(E){window.setTimeout(E,A)})}},function(se,ee){se.exports=function(x,I){if(!(x instanceof I))throw new TypeError("Cannot call a class as a function")}},function(se,ee){function x(I,C){for(var w=0;w<C.length;w++){var b=C[w];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(I,b.key,b)}}se.exports=function(I,C,w){return C&&x(I.prototype,C),w&&x(I,w),I}},function(se,ee,x){"use strict";var I=this&&this.__awaiter||function(f,g,y,M){return new(y||(y=Promise))(function(j,A){function E(H){try{N(M.next(H))}catch(O){A(O)}}function F(H){try{N(M.throw(H))}catch(O){A(O)}}function N(H){var O;H.done?j(H.value):(O=H.value,O instanceof y?O:new y(function(J){J(O)})).then(E,F)}N((M=M.apply(f,g||[])).next())})},C=this&&this.__generator||function(f,g){var y,M,j,A,E={label:0,sent:function(){if(1&j[0])throw j[1];return j[1]},trys:[],ops:[]};return A={next:F(0),throw:F(1),return:F(2)},"function"==typeof Symbol&&(A[Symbol.iterator]=function(){return this}),A;function F(N){return function(H){return function(O){if(y)throw new TypeError("Generator is already executing.");for(;E;)try{if(y=1,M&&(j=2&O[0]?M.return:O[0]?M.throw||((j=M.return)&&j.call(M),0):M.next)&&!(j=j.call(M,O[1])).done)return j;switch(M=0,j&&(O=[2&O[0],j.value]),O[0]){case 0:case 1:j=O;break;case 4:return E.label++,{value:O[1],done:!1};case 5:E.label++,M=O[1],O=[0];continue;case 7:O=E.ops.pop(),E.trys.pop();continue;default:if(!((j=(j=E.trys).length>0&&j[j.length-1])||6!==O[0]&&2!==O[0])){E=0;continue}if(3===O[0]&&(!j||O[1]>j[0]&&O[1]<j[3])){E.label=O[1];break}if(6===O[0]&&E.label<j[1]){E.label=j[1],j=O;break}if(j&&E.label<j[2]){E.label=j[2],E.ops.push(O);break}j[2]&&E.ops.pop(),E.trys.pop();continue}O=g.call(f,E)}catch(J){O=[6,J],M=0}finally{y=j=0}if(5&O[0])throw O[1];return{value:O[0]?O[1]:void 0,done:!0}}([N,H])}}},w=this&&this.__importDefault||function(f){return f&&f.__esModule?f:{default:f}};Object.defineProperty(ee,"__esModule",{value:!0});var b,f,D=w(x(0)),m=x(15);(f=b||(b={})).NEW="new",f.PREPARING_OFFER="preparing-offer",f.OFFER_SENT="offer-sent",f.ESTABLISHED="established",f.CLOSED="closed";var R=function(){function f(g){this.candidate=null,this.state=b.NEW,this.config=g,this.isSubscriber=this.config.isSubscriber,this.peerConnection=this.initPeecConnection(g),this.peerConnection.onicecandidate=this._onicecandidate.bind(this),this.peerConnection.oniceconnectionstatechange=this._oniceconnectionstatechange.bind(this),this.peerConnection.onaddstream=this._onaddstream.bind(this),this.peerConnection.ontrack=this._ontrack.bind(this),this.processSignalingMessage=this.setAnswer.bind(this),this.peerConnection.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0}).then(this.setLocalSDP.bind(this)),this.sendVideoStats={id:"",type:"",mediaType:"",googCodecName:this.config.codec.toUpperCase(),bytesSent:"0",packetsLost:"0",packetsSent:"0",googAdaptationChanges:"0",googAvgEncodeMs:"0",googEncodeUsagePercent:"0",googFirsReceived:"0",googFrameHeightSent:"0",googFrameHeightInput:"0",googFrameRateInput:"0",googFrameRateSent:"0",googFrameWidthSent:"0",googFrameWidthInput:"0",googNacksReceived:"0",googPlisReceived:"0",googRtt:"0",googFramesEncoded:"0"},this.sendAudioStats={id:"",type:"",mediaType:"",googCodecName:"opus",aecDivergentFilterFraction:"0",audioInputLevel:"0",bytesSent:"0",packetsSent:"0",googEchoCancellationReturnLoss:"0",googEchoCancellationReturnLossEnhancement:"0"},this.receiveAudioStats={id:"",type:"",mediaType:"",audioOutputLevel:"0",bytesReceived:"0",packetsLost:"0",packetsReceived:"0",googAccelerateRate:"0",googCurrentDelayMs:"0",googDecodingCNG:"0",googDecodingCTN:"0",googDecodingCTSG:"0",googDecodingNormal:"0",googDecodingPLC:"0",googDecodingPLCCNG:"0",googExpandRate:"0",googJitterBufferMs:"0",googJitterReceived:"0",googPreemptiveExpandRate:"0",googPreferredJitterBufferMs:"0",googSecondaryDecodedRate:"0",googSpeechExpandRate:"0"},this.receiveVideoStats={id:"",type:"",mediaType:"",googTargetDelayMs:"0",packetsLost:"0",googDecodeMs:"0",googMaxDecodeMs:"0",googRenderDelayMs:"0",googFrameWidthReceived:"0",googFrameHeightReceived:"0",googFrameRateReceived:"0",googFrameRateDecoded:"0",googFrameRateOutput:"0",googFramesDecoded:"0",googFrameReceived:"0",googJitterBufferMs:"0",googCurrentDelayMs:"0",googMinPlayoutDelayMs:"0",googNacksSent:"0",googPlisSent:"0",googFirsSent:"0",bytesReceived:"0",packetsReceived:"0"}}return f.prototype.addStream=function(g){this.peerConnection.addStream(g)},f.prototype.setRtpSenderParameters=function(g){return I(this,void 0,void 0,function(){return C(this,function(y){return[2]})})},f.prototype.setAnswer=function(g){var y=JSON.parse(g);this.peerConnection.setRemoteDescription(new RTCSessionDescription({sdp:y.sdp,type:"answer"})),this.onsignalingmessage&&this.onsignalingmessage("")},f.prototype.close=function(){this.peerConnection.close()},f.prototype.getStats=function(g,y){if(void 0===y&&(y=500),y=y>500?500:y,Date.now()-this.lastTimeGetStats<y){var M=[];this.config.isSubscriber?(M.push(this.receiveVideoStats),M.push(this.receiveAudioStats)):(M.push(this.sendAudioStats),M.push(this.sendVideoStats)),M.push({id:"time",startTime:this.connectedTime,timestamp:Date.now()}),g&&g(M)}else this._getStats(g)},f.prototype._getStats=function(g){var y=this,M=[];this.peerConnection.getStats(null).then(function(j){y.lastTimeGetStats=Date.now(),Object.keys(j).map(function(A){var E=j[A];y.config.isSubscriber?E.type&&"inboundrtp"===E.type&&E.mediaType&&"audio"===E.mediaType?(y.receiveAudioStats.id=E.id+"recv",y.receiveAudioStats.type=E.type+"",y.receiveAudioStats.mediaType=E.mediaType+"",y.receiveAudioStats.packetsReceived=E.packetsReceived+"",y.receiveAudioStats.bytesReceived=E.bytesReceived+"",y.receiveAudioStats.packetsLost=E.packetsLost+"",y.receiveAudioStats.googJitterReceived=E.jitter+""):E.type&&"inboundrtp"===E.type&&E.mediaType&&"video"===E.mediaType?(y.receiveVideoStats.id=E.id+"recv",y.receiveVideoStats.type=E.type+"",y.receiveVideoStats.mediaType=E.mediaType+"",y.receiveVideoStats.packetsReceived=E.packetsReceived+"",y.receiveVideoStats.bytesReceived=E.bytesReceived+"",y.receiveVideoStats.packetsLost=E.packetsLost+"",y.receiveVideoStats.googJitterBufferMs=E.jitter+"",y.receiveVideoStats.googPlisSent=E.pliCount+"",y.receiveVideoStats.googFirsSent=E.firCount+"",y.receiveVideoStats.googNacksSent=E.nackCount+""):E.remoteSource&&E.type&&"track"===E.type&&E.trackIdentifier&&-1!==E.trackIdentifier.indexOf("v")?(y.receiveVideoStats.googFrameHeightReceived=E.frameHeight+"",y.receiveVideoStats.googFrameWidthReceived=E.frameWidth+"",y.receiveVideoStats.googFrameRateDecoded=E.framesPerSecond+"",y.receiveVideoStats.googFrameRateOutput=E.framesPerSecond+"",y.receiveVideoStats.googFrameRateReceived=E.framesPerSecond+"",y.receiveVideoStats.googFramesDecoded=E.framesDecoded+"",y.receiveVideoStats.googFrameReceived=E.framesReceived+""):E.remoteSource&&E.type&&"track"===E.type&&E.trackIdentifier&&-1!==E.trackIdentifier.indexOf("a")&&(y.receiveAudioStats.audioOutputLevel=E.audioLevel+""):!E.isRemote&&E.type&&"outboundrtp"===E.type&&E.mediaType&&"audio"===E.mediaType?(y.sendAudioStats.id=E.id+"send",y.sendAudioStats.type=E.type+"",y.sendAudioStats.mediaType=E.mediaType+"",y.sendAudioStats.packetsSent=E.packetsSent+"",y.sendAudioStats.bytesSent=E.bytesSent+""):!E.isRemote&&E.type&&"outboundrtp"===E.type&&E.mediaType&&"video"===E.mediaType?(y.sendVideoStats.id=E.id+"send",y.sendVideoStats.type=E.type+"",y.sendVideoStats.mediaType=E.mediaType+"",y.sendVideoStats.packetsSent=E.packetsSent+"",y.sendVideoStats.bytesSent=E.bytesSent+"",y.sendVideoStats.googRtt=E.roundTripTime+"",y.sendVideoStats.googPlisReceived=E.pliCount+"",y.sendVideoStats.googFirsReceived=E.firCount+"",y.sendVideoStats.googNacksReceived=E.nackCount+""):!E.remoteSource&&E.type&&"track"===E.type&&E.framesSent&&0!==E.framesSent&&(y.sendVideoStats.googFrameHeightSent=E.frameHeight+"",y.sendVideoStats.googFrameHeightInput=E.frameHeight+"",y.sendVideoStats.googFrameWidthSent=E.frameWidth+"",y.sendVideoStats.googFrameWidthInput=E.frameWidth+"",y.sendVideoStats.googFramesEncoded=E.framesSent+"",y.sendVideoStats.googFrameRateSent=E.framesPerSecond+"")}),y.config.isSubscriber?(M.push(y.receiveVideoStats),M.push(y.receiveAudioStats)):(M.push(y.sendAudioStats),M.push(y.sendVideoStats)),M.push({id:"time",startTime:y.connectedTime,timestamp:Date.now()}),g&&g(M)})},f.prototype.getStatsRate=function(g){this.getStats(g)},f.prototype.initPeecConnection=function(g){var y=g.stunServerUrl,M=g.turnServer,j=g.iceServers;return this.pcConfig={iceServers:[]},j instanceof Array?this.pcConfig.iceServers=g.iceServers:y&&(y instanceof Array?y.map(function(A){"string"==typeof A&&""!==A&&this.pcConfig.iceServers.push({urls:A})}):"string"==typeof y&&""!==y&&this.pcConfig.iceServers.push({urls:y})),M&&(M instanceof Array?M.map(function(A){"string"==typeof A.url&&""!==A.url&&this.pcConfig.iceServers.push({username:A.username,credential:A.credential,url:A.url})}):"auto"!==M.mode&&"manual"!==M.mode||(M.udpport&&this.pcConfig.iceServers.push({username:M.username,credential:M.credential,credentialType:"password",urls:"turn:"+M.url+":"+M.udpport+"?transport=udp"}),"string"==typeof M.tcpport&&""!==M.tcpport&&this.pcConfig.iceServers.push({username:M.username,credential:M.credential,credentialType:"password",urls:"turn:"+M.url+":"+M.tcpport+"?transport=tcp"}),!0===M.forceturn&&(this.pcConfig.iceTransportPolicy="relay"))),new m.RTCPeerConnection(this.pcConfig)},f.prototype._ontrack=function(g){this.onaddstream&&this.onaddstream(g,"ontrack")},f.prototype._onaddstream=function(g){this.onaddstream&&this.onaddstream(g,"onaddstream")},f.prototype._oniceconnectionstatechange=function(g){"connected"===g.currentTarget.iceConnectionState&&(this.state=b.ESTABLISHED,this.connectedTime=Date.now()),this.oniceconnectionstatechange&&this.oniceconnectionstatechange(g.currentTarget.iceConnectionState)},f.prototype._onicecandidate=function(g){!this.candidate&&g&&(this.candidate=g.candidate,this.peerConnection.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0}).then(this.editLocalSDP.bind(this)).then(this.setLocalSDP.bind(this)).then(this.sendOffer.bind(this)).catch())},f.prototype.setLocalSDP=function(g){return this.peerConnection.setLocalDescription(new RTCSessionDescription({sdp:g.sdp,type:"offer"})),this.state=b.PREPARING_OFFER,g},f.prototype.editLocalSDP=function(g){return g.sdp=this.setBandWidth(g.sdp),g.sdp=this.reviseOpus(g.sdp),g.sdp=this.addCandidate(g.sdp),g},f.prototype.setSendRecv=function(g){return(g=(g=g.replace(/a=recvonly\r\n/g,"a=sendrecv\r\n")).replace(/a=sendonly\r\n/g,"a=sendrecv\r\n")).replace(/a=inactive\r\n/g,"a=sendrecv\r\n")},f.prototype.setBandWidth=function(g){var y,M,j=this.config,A=j.codec,E=j.minVideoBW,F=j.maxVideoBW,N=j.maxAudioBW,H=j.clientId;if((y=g.match(/m=video.*\r\n/))&&E&&F){M=y[0]+"b=AS:"+F+"\r\n";var O=0,J=0;"h264"===A?(O=g.search(/a=rtpmap:(\d+) H264\/90000\r\n/),J=g.search(/H264\/90000\r\n/)):"vp8"===A?(O=g.search(/a=rtpmap:(\d+) VP8\/90000\r\n/),J=g.search(/VP8\/90000\r\n/)):"vp9"===A&&(O=g.search(/a=rtpmap:(\d+) VP9\/90000\r\n/),J=g.search(/VP9\/90000\r\n/)),-1!==O&&-1!==J&&J-O>10&&(M=M+"a=fmtp:"+g.slice(O+9,J-1)+" x-google-min-bitrate="+E+"\r\n"),g=g.replace(y[0],M),D.default.debug("["+H+"]Set Video Bitrate - min:"+E+" max:"+F)}return(y=g.match(/m=audio.*\r\n/))&&N&&(g=g.replace(y[0],M=y[0]+"b=AS:"+N+"\r\n")),g},f.prototype.reviseOpus=function(g){return(g=g.replace(/a=rtpmap:102 opus\/48000\/2/g,"a=rtpmap:111 opus/48000/2")).replace(/m=audio 9 UDP\/TLS\/RTP\/SAVPF 102 0 8 97 13 118 101/g,"m=audio 9 UDP/TLS/RTP/SAVPF 111 0 8 97 13 118 101")},f.prototype.addCandidate=function(g){return g+"a=candidate:2243255435 1 udp 2122194687 192.168.0.1 30000 typ host generation 0 network-id 1\r\n"},f.prototype.sendOffer=function(g){this.config.callback(JSON.stringify({sdp:g.sdp,messageType:"OFFER",tiebreaker:Math.floor(429496723*Math.random()+1)})),this.state=b.OFFER_SENT},f}();ee.default=R},function(se,ee,x){var I=x(65),C=x(66),w=x(34),b=x(67);se.exports=function(D,m){return I(D)||C(D,m)||w(D,m)||b()}},function(se,ee,x){var I,C,w;C=this,w=function(){"use strict";var b,D=this;function m(M){D.console&&(D.console.error?D.console.error(M):D.console.log&&D.console.log(M))}function R(M,j,A,E){var F=E||m,N=M.createShader(A);return M.shaderSource(N,j),M.compileShader(N),M.getShaderParameter(N,M.COMPILE_STATUS)?N:(F("*** Error compiling shader '"+N+"':"+M.getShaderInfoLog(N)),M.deleteShader(N),null)}function f(M,j,A,E,F){var N=F||m,H=M.createProgram();return j.forEach(function(O){M.attachShader(H,O)}),A&&A.forEach(function(O,J){M.bindAttribLocation(H,E?E[J]:J,O)}),M.linkProgram(H),M.getProgramParameter(H,M.LINK_STATUS)?H:(N("Error in program linking:"+M.getProgramInfoLog(H)),M.deleteProgram(H),null)}(b=b||D)===b.top&&(console.log("%c%s","color:blue;font-weight:bold;","for more about webgl-utils.js see:"),console.log("%c%s","color:blue;font-weight:bold;","http://webglfundamentals.org/webgl/lessons/webgl-boilerplate.html"));var g,y=["VERTEX_SHADER","FRAGMENT_SHADER"];return!document.documentMode&&!!window.StyleMedia&&(HTMLCanvasElement.prototype.getContext=(g=HTMLCanvasElement.prototype.getContext,function(){var M=arguments,j=M[0];return"webgl"===j&&((M=[].slice.call(arguments))[0]="experimental-webgl"),g.apply(this,M)})),{createProgram:f,createProgramFromSources:function(M,j,A,E,F){for(var N=[],H=0;H<j.length;++H)N.push(R(M,j[H],M[y[H]],F));return f(M,N,A,E,F)}}},void 0===(I=function(){return w.call(C)}.apply(ee,[]))||(se.exports=I)},function(se,ee,x){"use strict";var I=this&&this.__awaiter||function(f,g,y,M){return new(y||(y=Promise))(function(j,A){function E(H){try{N(M.next(H))}catch(O){A(O)}}function F(H){try{N(M.throw(H))}catch(O){A(O)}}function N(H){var O;H.done?j(H.value):(O=H.value,O instanceof y?O:new y(function(J){J(O)})).then(E,F)}N((M=M.apply(f,g||[])).next())})},C=this&&this.__generator||function(f,g){var y,M,j,A,E={label:0,sent:function(){if(1&j[0])throw j[1];return j[1]},trys:[],ops:[]};return A={next:F(0),throw:F(1),return:F(2)},"function"==typeof Symbol&&(A[Symbol.iterator]=function(){return this}),A;function F(N){return function(H){return function(O){if(y)throw new TypeError("Generator is already executing.");for(;E;)try{if(y=1,M&&(j=2&O[0]?M.return:O[0]?M.throw||((j=M.return)&&j.call(M),0):M.next)&&!(j=j.call(M,O[1])).done)return j;switch(M=0,j&&(O=[2&O[0],j.value]),O[0]){case 0:case 1:j=O;break;case 4:return E.label++,{value:O[1],done:!1};case 5:E.label++,M=O[1],O=[0];continue;case 7:O=E.ops.pop(),E.trys.pop();continue;default:if(!((j=(j=E.trys).length>0&&j[j.length-1])||6!==O[0]&&2!==O[0])){E=0;continue}if(3===O[0]&&(!j||O[1]>j[0]&&O[1]<j[3])){E.label=O[1];break}if(6===O[0]&&E.label<j[1]){E.label=j[1],j=O;break}if(j&&E.label<j[2]){E.label=j[2],E.ops.push(O);break}j[2]&&E.ops.pop(),E.trys.pop();continue}O=g.call(f,E)}catch(J){O=[6,J],M=0}finally{y=j=0}if(5&O[0])throw O[1];return{value:O[0]?O[1]:void 0,done:!0}}([N,H])}}},w=this&&this.__importDefault||function(f){return f&&f.__esModule?f:{default:f}};Object.defineProperty(ee,"__esModule",{value:!0});var b=x(68),D=x(5),m=w(x(0));ee.getSupportedCodec=function(f){return I(void 0,void 0,void 0,function(){var g,y,M,j;return C(this,function(E){switch(E.label){case 0:return g={video:[],audio:[]},"undefined"!=typeof window?[3,1]:(m.default.error("getSupportedCodec: NOT_BROWSER_ENV"),[2,Promise.reject("NOT_BROWSER_ENV")]);case 1:try{y=b.createRTCPeerConnection({iceServers:[]})}catch(F){return m.default.error("Failed to init RTCPeerConnection",F),[2,Promise.reject(F)]}return y?[3,2]:(m.default.warning("getSupportedCodec: no RTCPeerConnection constructor is detected"),[2,Promise.resolve(g)]);case 2:return f&&f.stream?[3,7]:(M={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}},j=void 0,(D.isSafari()||D.isFireFox()||D.isWeChatBrowser())&&y.addTransceiver?(y.addTransceiver("audio"),y.addTransceiver("video"),[4,y.createOffer()]):[3,4]);case 3:return j=E.sent(),[3,6];case 4:return[4,new Promise(function(F,N){var H=setTimeout(function(){N("CREATEOFFER_TIMEOUT")},3e3);y.createOffer(function(O){clearTimeout(H),F(O)},function(O){clearTimeout(H),N(O)},M)})];case 5:j=E.sent(),E.label=6;case 6:return y.close(),[2,R(j.sdp)];case 7:return f.stream.getTracks&&y.addTrack?f.stream.getTracks().forEach(function(F){y.addTrack(F,f.stream)}):y.addStream(f.stream),j=void 0,D.isSafari()||D.isFireFox()?[4,y.createOffer()]:[3,9];case 8:return j=E.sent(),[3,11];case 9:return[4,new Promise(function(F,N){y.createOffer(F,N)})];case 10:j=E.sent(),E.label=11;case 11:return y.close(),[2,R(j.sdp)]}})})};var R=function(f){var g={video:[],audio:[]};return f.match(/ VP8/i)&&g.video.push("VP8"),f.match(/ VP9/i)&&g.video.push("VP9"),f.match(/ H264/i)&&g.video.push("H264"),f.match(/ opus/i)&&g.audio.push("OPUS"),Promise.resolve(g)}},function(se,ee,x){"use strict";var I=this&&this.__awaiter||function(D,m,R,f){return new(R||(R=Promise))(function(g,y){function M(E){try{A(f.next(E))}catch(F){y(F)}}function j(E){try{A(f.throw(E))}catch(F){y(F)}}function A(E){var F;E.done?g(E.value):(F=E.value,F instanceof R?F:new R(function(N){N(F)})).then(M,j)}A((f=f.apply(D,m||[])).next())})},C=this&&this.__generator||function(D,m){var R,f,g,y,M={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return y={next:j(0),throw:j(1),return:j(2)},"function"==typeof Symbol&&(y[Symbol.iterator]=function(){return this}),y;function j(A){return function(E){return function(F){if(R)throw new TypeError("Generator is already executing.");for(;M;)try{if(R=1,f&&(g=2&F[0]?f.return:F[0]?f.throw||((g=f.return)&&g.call(f),0):f.next)&&!(g=g.call(f,F[1])).done)return g;switch(f=0,g&&(F=[2&F[0],g.value]),F[0]){case 0:case 1:g=F;break;case 4:return M.label++,{value:F[1],done:!1};case 5:M.label++,f=F[1],F=[0];continue;case 7:F=M.ops.pop(),M.trys.pop();continue;default:if(!((g=(g=M.trys).length>0&&g[g.length-1])||6!==F[0]&&2!==F[0])){M=0;continue}if(3===F[0]&&(!g||F[1]>g[0]&&F[1]<g[3])){M.label=F[1];break}if(6===F[0]&&M.label<g[1]){M.label=g[1],g=F;break}if(g&&M.label<g[2]){M.label=g[2],M.ops.push(F);break}g[2]&&M.ops.pop(),M.trys.pop();continue}F=m.call(D,M)}catch(N){F=[6,N],f=0}finally{R=g=0}if(5&F[0])throw F[1];return{value:F[0]?F[1]:void 0,done:!0}}([A,E])}}};Object.defineProperty(ee,"__esModule",{value:!0});var w=x(10);function b(D){for(var m="",R=0;R<D.length;R+=1)m+=String.fromCharCode(D[R]);return window.btoa(m)}ee.encryptRSA=function(D){return I(void 0,void 0,void 0,function(){var m,R,f,g;return C(this,function(y){switch(y.label){case 0:return m=w.base64ToUint8Array("MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDCMnXAHkKIGAM+x4N22gCI+Wyu\nSTM9ztkT3uYslTT2PuKmZfPzhH6kVdO7PTjGCOZnAsyb3oTtWat0KcxQ4jxvqQV+\nHvYl3iI1Yd4vl2c3qRMJPLtRDfNxa2Mcxgq7e9aEUibzdd0st+OJAy3tOj/Y0aVy\nxQiYDz3vqa6bP29adwIDAQAB"),[4,window.crypto.subtle.importKey("spki",m,{name:"RSA-OAEP",hash:"SHA-256"},!0,["encrypt"])];case 1:return R=y.sent(),M=D,f=(new TextEncoder).encode(M),[4,window.crypto.subtle.encrypt({name:"RSA-OAEP"},R,f)];case 2:return g=y.sent(),[2,b(new Uint8Array(g))]}var M})})}},function(se,ee,x){"use strict";var I=this&&this.__awaiter||function(g,y,M,j){return new(M||(M=Promise))(function(A,E){function F(O){try{H(j.next(O))}catch(J){E(J)}}function N(O){try{H(j.throw(O))}catch(J){E(J)}}function H(O){var J;O.done?A(O.value):(J=O.value,J instanceof M?J:new M(function(te){te(J)})).then(F,N)}H((j=j.apply(g,y||[])).next())})},C=this&&this.__generator||function(g,y){var M,j,A,E,F={label:0,sent:function(){if(1&A[0])throw A[1];return A[1]},trys:[],ops:[]};return E={next:N(0),throw:N(1),return:N(2)},"function"==typeof Symbol&&(E[Symbol.iterator]=function(){return this}),E;function N(H){return function(O){return function(J){if(M)throw new TypeError("Generator is already executing.");for(;F;)try{if(M=1,j&&(A=2&J[0]?j.return:J[0]?j.throw||((A=j.return)&&A.call(j),0):j.next)&&!(A=A.call(j,J[1])).done)return A;switch(j=0,A&&(J=[2&J[0],A.value]),J[0]){case 0:case 1:A=J;break;case 4:return F.label++,{value:J[1],done:!1};case 5:F.label++,j=J[1],J=[0];continue;case 7:J=F.ops.pop(),F.trys.pop();continue;default:if(!((A=(A=F.trys).length>0&&A[A.length-1])||6!==J[0]&&2!==J[0])){F=0;continue}if(3===J[0]&&(!A||J[1]>A[0]&&J[1]<A[3])){F.label=J[1];break}if(6===J[0]&&F.label<A[1]){F.label=A[1],A=J;break}if(A&&F.label<A[2]){F.label=A[2],F.ops.push(J);break}A[2]&&F.ops.pop(),F.trys.pop();continue}J=y.call(g,F)}catch(te){J=[6,te],j=0}finally{M=A=0}if(5&J[0])throw J[1];return{value:J[0]?J[1]:void 0,done:!0}}([H,O])}}},w=this&&this.__importDefault||function(g){return g&&g.__esModule?g:{default:g}};Object.defineProperty(ee,"__esModule",{value:!0});var b=w(x(0)),D=x(75),m=x(24),R=x(1),f=x(27);ee.addLiveStreamingCapability=function(g,y){var M=this,j=function(A){var E=A.type;if(!g.joinInfo)return new m.AgoraRTCError(m.AgoraRTCErrorCode.INVALID_OPERATION,"can not create live streaming client, please join channel first").throw();switch(E){case f.LiveStreamingServiceMode.INJECT:return g._injectStreamingClient||(g._injectStreamingClient=new D.AgoraRTCLiveStreamingClient(g.joinInfo),g._injectStreamingClient.onInjectStatusChange=function(F,N,H){g.gatewayClient.dispatchEvent({type:"streamInjectedStatus",url:H,status:F})}),g._injectStreamingClient;case f.LiveStreamingServiceMode.RAW:return g._liveRawStreamingClient||(g._liveRawStreamingClient=new D.AgoraRTCLiveStreamingClient(g.joinInfo),g._liveRawStreamingClient.setGatewayConnectionState(g.getConnectionState()),g.on("connection-state-change",function(F){g._liveRawStreamingClient.setGatewayConnectionState(F.curState),"CONNECTING"===F.prevState&&"CONNECTED"===F.curState&&g._liveRawStreamingClient&&g._liveRawStreamingClient.resetAllTask()}),g._liveRawStreamingClient.onLiveStreamError=function(F,N){b.default.error("LIVE_STREAMING_ERROR",N.toString()),g.gatewayClient.dispatchEvent({type:"liveStreamingFailed",url:F,reason:N.code})},g._liveRawStreamingClient.onLiveStreamWarning=function(F,N){b.default.warning("LIVE_STREAMING_WARNING",N.toString()),g.gatewayClient.dispatchEvent({type:"liveStreamingWarning",url:F,reason:N.code})}),g._liveRawStreamingClient;case f.LiveStreamingServiceMode.TRANSCODE:return g._liveTranscodeStreamingClient||(g._liveTranscodeStreamingClient=new D.AgoraRTCLiveStreamingClient(g.joinInfo),g._liveTranscodeStreamingClient.setGatewayConnectionState(g.getConnectionState()),g.on("connection-state-change",function(F){g._liveTranscodeStreamingClient.setGatewayConnectionState(F.curState),"CONNECTING"===F.prevState&&"CONNECTED"===F.curState&&g._liveTranscodeStreamingClient&&g._liveTranscodeStreamingClient.resetAllTask()}),g._liveTranscodeStreamingClient.onLiveStreamError=function(F,N){b.default.error("LIVE_STREAMING_ERROR",N.toString()),g.gatewayClient.dispatchEvent({type:"liveStreamingFailed",url:F,reason:N.code})},g._liveTranscodeStreamingClient.onLiveStreamWarning=function(F,N){b.default.warning("LIVE_STREAMING_WARNING",N.toString()),g.gatewayClient.dispatchEvent({type:"liveStreamingWarning",url:F,reason:N})}),g._liveTranscodeStreamingClient}};g.gatewayClient.addEventListener("join",function(A){g._injectStreamingClient&&g._injectStreamingClient.resetAllTask()}),g.gatewayClient.addEventListener("stream-unpublished",function(A){A.options&&0===A.options.streamType&&(g._liveRawStreamingClient&&g._liveRawStreamingClient.resetAllTask(),g._liveTranscodeStreamingClient&&g._liveTranscodeStreamingClient.resetAllTask())}),g.gatewayClient.addEventListener("stream-published",function(A){}),g.startLiveStreaming=function(A,E){b.default.debug("startLiveStreaming");var F=R.report.reportApiInvoke(y.sessionId,{name:"Client.startLiveStreaming",options:arguments,tag:"tracer"});if(g.gatewayClient&&"audience"===g.gatewayClient.role){var N={code:403,reason:"AUDIENCE_STREAMING_FORBIDDEN"};throw F(N),N}var H=g._startLiveStreaming(A,E);return H.then(function(O){F(null,O)}).catch(function(O){b.default.error("LIVE_STREAMING_ERROR",O.toString()),g.gatewayClient.dispatchEvent({type:"liveStreamingFailed",url:A,reason:O.code}),F(O)}),H},g._startLiveStreaming=function(A,E){return I(M,void 0,void 0,function(){var F;return C(this,function(N){switch(N.label){case 0:return E||("vp8"===y.codec&&b.default.warning("VP8 is not supported by raw_streaming. Subscriber side will suffer"),"vp9"===y.codec&&b.default.warning("VP9 is not supported by raw_streaming. Subscriber side will suffer"),"rtc"===y.mode&&b.default.warning("RTC mode is not supported by raw_streaming. Subscriber side will suffer")),(g._liveRawStreamingClient&&g._liveRawStreamingClient.haveUrl(A)||g._liveTranscodeStreamingClient&&g._liveTranscodeStreamingClient.haveUrl(A))&&new m.AgoraRTCError(m.AgoraRTCErrorCode.LIVE_STREAMING_TASK_CONFLICT).throw(),[4,j({type:F=E?f.LiveStreamingServiceMode.TRANSCODE:f.LiveStreamingServiceMode.RAW}).startLiveStreamingTask(A,F)];case 1:return N.sent(),g.gatewayClient.dispatchEvent({type:"liveStreamingStarted",url:A}),[2]}})})},g.setLiveTranscoding=function(A){b.default.debug("setLiveTranscoding: "+JSON.stringify(A));var E=R.report.reportApiInvoke(y.sessionId,{name:"Client.setLiveTranscoding",options:arguments,tag:"tracer"}),F=j({type:f.LiveStreamingServiceMode.TRANSCODE});return F.setTranscodingConfig(A).then(function(){g.gatewayClient.dispatchEvent({type:"liveTranscodingUpdated"}),E(null)}).catch(function(N){b.default.error("SET_LIVE_TRANSCODING_ERROR",N.toString()),g.gatewayClient.dispatchEvent({type:"liveStreamingFailed",reason:N.code}),E(N)})},g.stopLiveStreaming=function(A){var E=R.report.reportApiInvoke(y.sessionId,{name:"Client.stopLiveStreaming",options:arguments,tag:"tracer"}),F=g._stopLiveStreaming(A);return F.then(function(N){E(null,N)}).catch(function(N){b.default.error("STOP_LIVE_STREAMING_ERROR",N.toString()),g.gatewayClient.dispatchEvent({type:"liveStreamingFailed",url:A,reason:N.code}),E(N)}),F},g._stopLiveStreaming=function(A){return I(this,void 0,void 0,function(){return C(this,function(F){switch(F.label){case 0:return b.default.debug("stopLiveStreaming: "+JSON.stringify(A)),[4,Promise.all([g._liveRawStreamingClient,g._liveTranscodeStreamingClient].map(function(N){return N&&N.haveUrl(A)&&N.stopLiveStreamingTask(A)}))];case 1:return F.sent(),b.default.debug("stopLiveStreaming sucess: "+JSON.stringify(A)),g.gatewayClient.dispatchEvent({type:"liveStreamingStopped",url:A}),[2]}})})},g.addInjectStreamUrl=function(A,E){var F=R.report.reportApiInvoke(y.sessionId,{name:"Client.addInjectStreamUrl",options:[A,E],tag:"tracer"});if("audience"===g.gatewayClient.role){var N={code:403,reason:"AUDIENCE_INJECTING_FORBIDDEN"};throw F(N),N}var H=g._addInjectStreamUrl(A,E);return H.then(function(O){F(null,O)}).catch(function(O){b.default.error("ADD_INJECT_STREAM_ERROR",O.toString()),F(O)}),H},g._addInjectStreamUrl=function(A,E){return I(M,void 0,void 0,function(){var F;return C(this,function(N){switch(N.label){case 0:return(F=j({type:f.LiveStreamingServiceMode.INJECT})).setInjectStreamConfig(E,0),[4,F.startLiveStreamingTask(A,f.LiveStreamingServiceMode.INJECT)];case 1:return N.sent(),[2]}})})},g.removeInjectStreamUrl=function(A){return I(this,void 0,void 0,function(){var E,F;return C(this,function(N){return E=R.report.reportApiInvoke(y.sessionId,{name:"Client.removeInjectStreamUrl",options:[A],tag:"tracer"}),(F=g._removeInjectStreamUrl(A)).then(function(H){E(null,H)}).catch(function(H){b.default.error("REMOVE_INJECT_STREAM_ERROR",H.toString()),E(H)}),[2,F]})})},g._removeInjectStreamUrl=function(A){return I(M,void 0,void 0,function(){return C(this,function(E){switch(E.label){case 0:return[4,j({type:f.LiveStreamingServiceMode.INJECT}).stopLiveStreamingTask(A)];case 1:return E.sent(),[2]}})})},g._terminateLiveStreaming=function(){return I(M,void 0,void 0,function(){return C(this,function(A){return[g._injectStreamingClient,g._liveRawStreamingClient,g._liveTranscodeStreamingClient].forEach(function(E){E&&E.terminate()}),[2]})})}}},function(se,ee,x){"use strict";var I=this&&this.__importDefault||function(D){return D&&D.__esModule?D:{default:D}};Object.defineProperty(ee,"__esModule",{value:!0});var C=I(x(4)),w=I(x(0)),b=x(10);ee.default=function(D,m){void 0===m&&(m={width:160,height:120,framerate:15});var R=m.width,f=m.height,g=m.framerate,y=D.stream;if(!y)throw C.default.INVALID_LOCAL_STREAM;if(!y.getVideoTracks()[0])throw C.default.HIGH_STREAM_NOT_VIDEO_TRACE;var M=y.getVideoTracks()[0];w.default.debug("Start getLowStream");var j=document.createElement("video"),A=document.createElement("canvas");j.setAttribute("style","display:none"),j.setAttribute("muted",""),j.muted=!0,j.setAttribute("autoplay",""),j.autoplay=!0,j.setAttribute("playsinline",""),A.setAttribute("style","display:none"),A.setAttribute("width",R.toString()),A.setAttribute("height",f.toString());var E=A.getContext("2d");if(!E)throw new Error("not get canvas context");j.srcObject=y,document.body.append(j),document.body.append(A),j.play(),w.default.debug("Start render lowStream");var F=b.audioTimerLoop(function(){return function(){if(j.paused&&j.play(),j.videoHeight>2&&j.videoWidth>2){var te=A.width*(j.videoHeight/j.videoWidth);Math.abs(te-A.height)>=2&&(w.default.debug("adjust low stream resolution",A.width+"x"+A.height+" -> "+A.width+"x"+te),A.height=te)}E.drawImage(j,0,0,A.width,A.height);var Y=D.stream;if(Y){var ne=Y.getVideoTracks()[0];M!==ne&&(w.default.debug("adjust low stream track"),j.srcObject=Y,M=ne)}}()},g),N=A.captureStream(g),H=N.getVideoTracks()[0];return H.requestFrame&&H.requestFrame(),N.clean=function(){w.default.debug("Start clean lowStream"),F(),(j||j.parentNode||j.parentNode.removeChild)&&j.parentNode.removeChild(j),(A||A.parentNode||A.parentNode.removeChild)&&A.parentNode.removeChild(A),w.default.debug("Clean lowStream")},N}},function(se,ee){var x="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(x){var I=new Uint8Array(16);se.exports=function(){return x(I),I}}else{var C=new Array(16);se.exports=function(){for(var w,b=0;b<16;b++)0==(3&b)&&(w=4294967296*Math.random()),C[b]=w>>>((3&b)<<3)&255;return C}}},function(se,ee){for(var x=[],I=0;I<256;++I)x[I]=(I+256).toString(16).substr(1);se.exports=function(C,w){var b=w||0;return[x[C[b++]],x[C[b++]],x[C[b++]],x[C[b++]],"-",x[C[b++]],x[C[b++]],"-",x[C[b++]],x[C[b++]],"-",x[C[b++]],x[C[b++]],"-",x[C[b++]],x[C[b++]],x[C[b++]],x[C[b++]],x[C[b++]],x[C[b++]]].join("")}},function(module,exports,__nested_webpack_require_639250__){(function(global,module){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;(function(undefined){"use strict";var se,ee,I;se={1:[function(se,ee,x){ee.exports=function(I,C){for(var w=new Array(arguments.length-1),b=0,D=2,m=!0;D<arguments.length;)w[b++]=arguments[D++];return new Promise(function(R,f){w[b]=function(g){if(m)if(m=!1,g)f(g);else{for(var y=new Array(arguments.length-1),M=0;M<y.length;)y[M++]=arguments[M];R.apply(null,y)}};try{I.apply(C||null,w)}catch(g){m&&(m=!1,f(g))}})}},{}],2:[function(se,ee,x){var I=x;I.length=function(D){var m=D.length;if(!m)return 0;for(var R=0;--m%4>1&&"="===D.charAt(m);)++R;return Math.ceil(3*D.length)/4-R};for(var C=new Array(64),w=new Array(123),b=0;b<64;)w[C[b]=b<26?b+65:b<52?b+71:b<62?b-4:b-59|43]=b++;I.encode=function(D,m,R){for(var f,g=null,y=[],M=0,j=0;m<R;){var A=D[m++];switch(j){case 0:y[M++]=C[A>>2],f=(3&A)<<4,j=1;break;case 1:y[M++]=C[f|A>>4],f=(15&A)<<2,j=2;break;case 2:y[M++]=C[f|A>>6],y[M++]=C[63&A],j=0}M>8191&&((g||(g=[])).push(String.fromCharCode.apply(String,y)),M=0)}return j&&(y[M++]=C[f],y[M++]=61,1===j&&(y[M++]=61)),g?(M&&g.push(String.fromCharCode.apply(String,y.slice(0,M))),g.join("")):String.fromCharCode.apply(String,y.slice(0,M))},I.decode=function(D,m,R){for(var f,g=R,y=0,M=0;M<D.length;){var j=D.charCodeAt(M++);if(61===j&&y>1)break;if((j=w[j])===undefined)throw Error("invalid encoding");switch(y){case 0:f=j,y=1;break;case 1:m[R++]=f<<2|(48&j)>>4,f=j,y=2;break;case 2:m[R++]=(15&f)<<4|(60&j)>>2,f=j,y=3;break;case 3:m[R++]=(3&f)<<6|j,y=0}}if(1===y)throw Error("invalid encoding");return R-g},I.test=function(D){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(D)}},{}],3:[function(se,ee,x){function I(C,w){"string"==typeof C&&(w=C,C=undefined);var b=[];function D(R){if("string"!=typeof R){var f=m();if(I.verbose&&console.log("codegen: "+f),f="return "+f,R){for(var g=Object.keys(R),y=new Array(g.length+1),M=new Array(g.length),j=0;j<g.length;)y[j]=g[j],M[j]=R[g[j++]];return y[j]=f,Function.apply(null,y).apply(null,M)}return Function(f)()}for(var A=new Array(arguments.length-1),E=0;E<A.length;)A[E]=arguments[++E];if(E=0,R=R.replace(/%([%dfijs])/g,function(F,N){var H=A[E++];switch(N){case"d":case"f":return String(Number(H));case"i":return String(Math.floor(H));case"j":return JSON.stringify(H);case"s":return String(H)}return"%"}),E!==A.length)throw Error("parameter count mismatch");return b.push(R),D}function m(R){return"function "+(R||w||"")+"("+(C&&C.join(",")||"")+"){\n  "+b.join("\n  ")+"\n}"}return D.toString=m,D}ee.exports=I,I.verbose=!1},{}],4:[function(se,ee,x){function I(){this._listeners={}}ee.exports=I,I.prototype.on=function(C,w,b){return(this._listeners[C]||(this._listeners[C]=[])).push({fn:w,ctx:b||this}),this},I.prototype.off=function(C,w){if(C===undefined)this._listeners={};else if(w===undefined)this._listeners[C]=[];else for(var b=this._listeners[C],D=0;D<b.length;)b[D].fn===w?b.splice(D,1):++D;return this},I.prototype.emit=function(C){var w=this._listeners[C];if(w){for(var b=[],D=1;D<arguments.length;)b.push(arguments[D++]);for(D=0;D<w.length;)w[D].fn.apply(w[D++].ctx,b)}return this}},{}],5:[function(se,ee,x){ee.exports=w;var I=se(1),C=se(7)("fs");function w(b,D,m){return"function"==typeof D?(m=D,D={}):D||(D={}),m?!D.xhr&&C&&C.readFile?C.readFile(b,function(R,f){return R&&"undefined"!=typeof XMLHttpRequest?w.xhr(b,D,m):R?m(R):m(null,D.binary?f:f.toString("utf8"))}):w.xhr(b,D,m):I(w,this,b,D)}w.xhr=function(b,D,m){var R=new XMLHttpRequest;R.onreadystatechange=function(){if(4!==R.readyState)return undefined;if(0!==R.status&&200!==R.status)return m(Error("status "+R.status));if(D.binary){var f=R.response;if(!f){f=[];for(var g=0;g<R.responseText.length;++g)f.push(255&R.responseText.charCodeAt(g))}return m(null,"undefined"!=typeof Uint8Array?new Uint8Array(f):f)}return m(null,R.responseText)},D.binary&&("overrideMimeType"in R&&R.overrideMimeType("text/plain; charset=x-user-defined"),R.responseType="arraybuffer"),R.open("GET",b),R.send()}},{1:1,7:7}],6:[function(se,ee,x){function I(m){return"undefined"!=typeof Float32Array?function(){var R=new Float32Array([-0]),f=new Uint8Array(R.buffer),g=128===f[3];function y(E,F,N){R[0]=E,F[N]=f[0],F[N+1]=f[1],F[N+2]=f[2],F[N+3]=f[3]}function M(E,F,N){R[0]=E,F[N]=f[3],F[N+1]=f[2],F[N+2]=f[1],F[N+3]=f[0]}function j(E,F){return f[0]=E[F],f[1]=E[F+1],f[2]=E[F+2],f[3]=E[F+3],R[0]}function A(E,F){return f[3]=E[F],f[2]=E[F+1],f[1]=E[F+2],f[0]=E[F+3],R[0]}m.writeFloatLE=g?y:M,m.writeFloatBE=g?M:y,m.readFloatLE=g?j:A,m.readFloatBE=g?A:j}():function(){function R(g,y,M,j){var A=y<0?1:0;if(A&&(y=-y),0===y)g(1/y>0?0:2147483648,M,j);else if(isNaN(y))g(2143289344,M,j);else if(y>34028234663852886e22)g((A<<31|2139095040)>>>0,M,j);else if(y<11754943508222875e-54)g((A<<31|Math.round(y/1401298464324817e-60))>>>0,M,j);else{var E=Math.floor(Math.log(y)/Math.LN2);g((A<<31|E+127<<23|8388607&Math.round(y*Math.pow(2,-E)*8388608))>>>0,M,j)}}function f(g,y,M){var j=g(y,M),A=2*(j>>31)+1,E=j>>>23&255,F=8388607&j;return 255===E?F?NaN:A*(1/0):0===E?1401298464324817e-60*A*F:A*Math.pow(2,E-150)*(F+8388608)}m.writeFloatLE=R.bind(null,C),m.writeFloatBE=R.bind(null,w),m.readFloatLE=f.bind(null,b),m.readFloatBE=f.bind(null,D)}(),"undefined"!=typeof Float64Array?function(){var R=new Float64Array([-0]),f=new Uint8Array(R.buffer),g=128===f[7];function y(E,F,N){R[0]=E,F[N]=f[0],F[N+1]=f[1],F[N+2]=f[2],F[N+3]=f[3],F[N+4]=f[4],F[N+5]=f[5],F[N+6]=f[6],F[N+7]=f[7]}function M(E,F,N){R[0]=E,F[N]=f[7],F[N+1]=f[6],F[N+2]=f[5],F[N+3]=f[4],F[N+4]=f[3],F[N+5]=f[2],F[N+6]=f[1],F[N+7]=f[0]}function j(E,F){return f[0]=E[F],f[1]=E[F+1],f[2]=E[F+2],f[3]=E[F+3],f[4]=E[F+4],f[5]=E[F+5],f[6]=E[F+6],f[7]=E[F+7],R[0]}function A(E,F){return f[7]=E[F],f[6]=E[F+1],f[5]=E[F+2],f[4]=E[F+3],f[3]=E[F+4],f[2]=E[F+5],f[1]=E[F+6],f[0]=E[F+7],R[0]}m.writeDoubleLE=g?y:M,m.writeDoubleBE=g?M:y,m.readDoubleLE=g?j:A,m.readDoubleBE=g?A:j}():function(){function R(g,y,M,j,A,E){var F=j<0?1:0;if(F&&(j=-j),0===j)g(0,A,E+y),g(1/j>0?0:2147483648,A,E+M);else if(isNaN(j))g(0,A,E+y),g(2146959360,A,E+M);else if(j>17976931348623157e292)g(0,A,E+y),g((F<<31|2146435072)>>>0,A,E+M);else{var N;if(j<22250738585072014e-324)g((N=j/5e-324)>>>0,A,E+y),g((F<<31|N/4294967296)>>>0,A,E+M);else{var H=Math.floor(Math.log(j)/Math.LN2);1024===H&&(H=1023),g(4503599627370496*(N=j*Math.pow(2,-H))>>>0,A,E+y),g((F<<31|H+1023<<20|1048576*N&1048575)>>>0,A,E+M)}}}function f(g,y,M,j,A){var E=g(j,A+y),F=g(j,A+M),N=2*(F>>31)+1,H=F>>>20&2047,O=4294967296*(1048575&F)+E;return 2047===H?O?NaN:N*(1/0):0===H?5e-324*N*O:N*Math.pow(2,H-1075)*(O+4503599627370496)}m.writeDoubleLE=R.bind(null,C,0,4),m.writeDoubleBE=R.bind(null,w,4,0),m.readDoubleLE=f.bind(null,b,0,4),m.readDoubleBE=f.bind(null,D,4,0)}(),m}function C(m,R,f){R[f]=255&m,R[f+1]=m>>>8&255,R[f+2]=m>>>16&255,R[f+3]=m>>>24}function w(m,R,f){R[f]=m>>>24,R[f+1]=m>>>16&255,R[f+2]=m>>>8&255,R[f+3]=255&m}function b(m,R){return(m[R]|m[R+1]<<8|m[R+2]<<16|m[R+3]<<24)>>>0}function D(m,R){return(m[R]<<24|m[R+1]<<16|m[R+2]<<8|m[R+3])>>>0}ee.exports=I(I)},{}],7:[function(require,module,exports){function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(se){}return null}module.exports=inquire},{}],8:[function(se,ee,x){var I=x,C=I.isAbsolute=function(b){return/^(?:\/|\w+:)/.test(b)},w=I.normalize=function(b){var D=(b=b.replace(/\\/g,"/").replace(/\/{2,}/g,"/")).split("/"),m=C(b),R="";m&&(R=D.shift()+"/");for(var f=0;f<D.length;)".."===D[f]?f>0&&".."!==D[f-1]?D.splice(--f,2):m?D.splice(f,1):++f:"."===D[f]?D.splice(f,1):++f;return R+D.join("/")};I.resolve=function(b,D,m){return m||(D=w(D)),C(D)?D:(m||(b=w(b)),(b=b.replace(/(?:\/|^)[^/]+$/,"")).length?w(b+"/"+D):D)}},{}],9:[function(se,ee,x){ee.exports=function(I,C,w){var b=w||8192,D=b>>>1,m=null,R=b;return function(f){if(f<1||f>D)return I(f);R+f>b&&(m=I(b),R=0);var g=C.call(m,R,R+=f);return 7&R&&(R=1+(7|R)),g}}},{}],10:[function(se,ee,x){var I=x;I.length=function(C){for(var w=0,b=0,D=0;D<C.length;++D)(b=C.charCodeAt(D))<128?w+=1:b<2048?w+=2:55296==(64512&b)&&56320==(64512&C.charCodeAt(D+1))?(++D,w+=4):w+=3;return w},I.read=function(C,w,b){if(b-w<1)return"";for(var D,m=null,R=[],f=0;w<b;)(D=C[w++])<128?R[f++]=D:D>191&&D<224?R[f++]=(31&D)<<6|63&C[w++]:D>239&&D<365?(D=((7&D)<<18|(63&C[w++])<<12|(63&C[w++])<<6|63&C[w++])-65536,R[f++]=55296+(D>>10),R[f++]=56320+(1023&D)):R[f++]=(15&D)<<12|(63&C[w++])<<6|63&C[w++],f>8191&&((m||(m=[])).push(String.fromCharCode.apply(String,R)),f=0);return m?(f&&m.push(String.fromCharCode.apply(String,R.slice(0,f))),m.join("")):String.fromCharCode.apply(String,R.slice(0,f))},I.write=function(C,w,b){for(var D,m,R=b,f=0;f<C.length;++f)(D=C.charCodeAt(f))<128?w[b++]=D:D<2048?(w[b++]=D>>6|192,w[b++]=63&D|128):55296==(64512&D)&&56320==(64512&(m=C.charCodeAt(f+1)))?(++f,w[b++]=(D=65536+((1023&D)<<10)+(1023&m))>>18|240,w[b++]=D>>12&63|128,w[b++]=D>>6&63|128,w[b++]=63&D|128):(w[b++]=D>>12|224,w[b++]=D>>6&63|128,w[b++]=63&D|128);return b-R}},{}],11:[function(se,ee,x){var I=x,C=se(14),w=se(33);function b(m,R,f,g){if(R.resolvedType)if(R.resolvedType instanceof C){m("switch(d%s){",g);for(var y=R.resolvedType.values,M=Object.keys(y),j=0;j<M.length;++j)R.repeated&&y[M[j]]===R.typeDefault&&m("default:"),m("case%j:",M[j])("case %i:",y[M[j]])("m%s=%j",g,y[M[j]])("break");m("}")}else m('if(typeof d%s!=="object")',g)("throw TypeError(%j)",R.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",g,f,g);else{var A=!1;switch(R.type){case"double":case"float":m("m%s=Number(d%s)",g,g);break;case"uint32":case"fixed32":m("m%s=d%s>>>0",g,g);break;case"int32":case"sint32":case"sfixed32":m("m%s=d%s|0",g,g);break;case"uint64":A=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":m("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",g,g,A)('else if(typeof d%s==="string")',g)("m%s=parseInt(d%s,10)",g,g)('else if(typeof d%s==="number")',g)("m%s=d%s",g,g)('else if(typeof d%s==="object")',g)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",g,g,g,A?"true":"");break;case"bytes":m('if(typeof d%s==="string")',g)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",g,g,g)("else if(d%s.length)",g)("m%s=d%s",g,g);break;case"string":m("m%s=String(d%s)",g,g);break;case"bool":m("m%s=Boolean(d%s)",g,g)}}return m}function D(m,R,f,g){if(R.resolvedType)R.resolvedType instanceof C?m("d%s=o.enums===String?types[%i].values[m%s]:m%s",g,f,g,g):m("d%s=types[%i].toObject(m%s,o)",g,f,g);else{var y=!1;switch(R.type){case"double":case"float":m("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",g,g,g,g);break;case"uint64":y=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":m('if(typeof m%s==="number")',g)("d%s=o.longs===String?String(m%s):m%s",g,g,g)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",g,g,g,g,y?"true":"",g);break;case"bytes":m("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",g,g,g,g,g);break;default:m("d%s=m%s",g,g)}}return m}I.fromObject=function(m){var R=m.fieldsArray,f=w.codegen(["d"],m.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!R.length)return f("return new this.ctor");f("var m=new this.ctor");for(var g=0;g<R.length;++g){var y=R[g].resolve(),M=w.safeProp(y.name);y.map?(f("if(d%s){",M)('if(typeof d%s!=="object")',M)("throw TypeError(%j)",y.fullName+": object expected")("m%s={}",M)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",M),b(f,y,g,M+"[ks[i]]")("}")("}")):y.repeated?(f("if(d%s){",M)("if(!Array.isArray(d%s))",M)("throw TypeError(%j)",y.fullName+": array expected")("m%s=[]",M)("for(var i=0;i<d%s.length;++i){",M),b(f,y,g,M+"[i]")("}")("}")):(y.resolvedType instanceof C||f("if(d%s!=null){",M),b(f,y,g,M),y.resolvedType instanceof C||f("}"))}return f("return m")},I.toObject=function(m){var R=m.fieldsArray.slice().sort(w.compareFieldsById);if(!R.length)return w.codegen()("return {}");for(var f=w.codegen(["m","o"],m.name+"$toObject")("if(!o)")("o={}")("var d={}"),g=[],y=[],M=[],j=0;j<R.length;++j)R[j].partOf||(R[j].resolve().repeated?g:R[j].map?y:M).push(R[j]);if(g.length){for(f("if(o.arrays||o.defaults){"),j=0;j<g.length;++j)f("d%s=[]",w.safeProp(g[j].name));f("}")}if(y.length){for(f("if(o.objects||o.defaults){"),j=0;j<y.length;++j)f("d%s={}",w.safeProp(y[j].name));f("}")}if(M.length){for(f("if(o.defaults){"),j=0;j<M.length;++j){var A=M[j],E=w.safeProp(A.name);if(A.resolvedType instanceof C)f("d%s=o.enums===String?%j:%j",E,A.resolvedType.valuesById[A.typeDefault],A.typeDefault);else if(A.long)f("if(util.Long){")("var n=new util.Long(%i,%i,%j)",A.typeDefault.low,A.typeDefault.high,A.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",E)("}else")("d%s=o.longs===String?%j:%i",E,A.typeDefault.toString(),A.typeDefault.toNumber());else if(A.bytes){var F="["+Array.prototype.slice.call(A.typeDefault).join(",")+"]";f("if(o.bytes===String)d%s=%j",E,String.fromCharCode.apply(String,A.typeDefault))("else{")("d%s=%s",E,F)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",E,E)("}")}else f("d%s=%j",E,A.typeDefault)}f("}")}var N=!1;for(j=0;j<R.length;++j){var H=m._fieldsArray.indexOf(A=R[j]);E=w.safeProp(A.name),A.map?(N||(N=!0,f("var ks2")),f("if(m%s&&(ks2=Object.keys(m%s)).length){",E,E)("d%s={}",E)("for(var j=0;j<ks2.length;++j){"),D(f,A,H,E+"[ks2[j]]")("}")):A.repeated?(f("if(m%s&&m%s.length){",E,E)("d%s=[]",E)("for(var j=0;j<m%s.length;++j){",E),D(f,A,H,E+"[j]")("}")):(f("if(m%s!=null&&m.hasOwnProperty(%j)){",E,A.name),D(f,A,H,E),A.partOf&&f("if(o.oneofs)")("d%s=%j",w.safeProp(A.partOf.name),A.name)),f("}")}return f("return d")}},{14:14,33:33}],12:[function(se,ee,x){ee.exports=function(D){var m=w.codegen(["r","l"],D.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(D.fieldsArray.filter(function(j){return j.map}).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()");D.group&&m("if((t&7)===4)")("break"),m("switch(t>>>3){");for(var R=0;R<D.fieldsArray.length;++R){var f=D._fieldsArray[R].resolve(),g=f.resolvedType instanceof I?"int32":f.type,y="m"+w.safeProp(f.name);m("case %i:",f.id),f.map?(m("if(%s===util.emptyObject)",y)("%s={}",y)("var c2 = r.uint32()+r.pos"),C.defaults[f.keyType]!==undefined?m("k=%j",C.defaults[f.keyType]):m("k=null"),C.defaults[g]!==undefined?m("value=%j",C.defaults[g]):m("value=null"),m("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",f.keyType)("case 2:"),C.basic[g]===undefined?m("value=types[%i].decode(r,r.uint32())",R):m("value=r.%s()",g),m("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),m(C.long[f.keyType]!==undefined?'%s[typeof k==="object"?util.longToHash(k):k]=value':"%s[k]=value",y)):f.repeated?(m("if(!(%s&&%s.length))",y,y)("%s=[]",y),C.packed[g]!==undefined&&m("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",y,g)("}else"),C.basic[g]===undefined?m(f.resolvedType.group?"%s.push(types[%i].decode(r))":"%s.push(types[%i].decode(r,r.uint32()))",y,R):m("%s.push(r.%s())",y,g)):C.basic[g]===undefined?m(f.resolvedType.group?"%s=types[%i].decode(r)":"%s=types[%i].decode(r,r.uint32())",y,R):m("%s=r.%s()",y,g),m("break")}for(m("default:")("r.skipType(t&7)")("break")("}")("}"),R=0;R<D._fieldsArray.length;++R){var M=D._fieldsArray[R];M.required&&m("if(!m.hasOwnProperty(%j))",M.name)("throw util.ProtocolError(%j,{instance:m})",b(M))}return m("return m")};var I=se(14),C=se(32),w=se(33);function b(D){return"missing required '"+D.name+"'"}},{14:14,32:32,33:33}],13:[function(se,ee,x){ee.exports=function(D){for(var m,R=w.codegen(["m","w"],D.name+"$encode")("if(!w)")("w=Writer.create()"),f=D.fieldsArray.slice().sort(w.compareFieldsById),g=0;g<f.length;++g){var y=f[g].resolve(),M=D._fieldsArray.indexOf(y),j=y.resolvedType instanceof I?"int32":y.type,A=C.basic[j];m="m"+w.safeProp(y.name),y.map?(R("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",m,y.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",m)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(y.id<<3|2)>>>0,8|C.mapKey[y.keyType],y.keyType),A===undefined?R("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",M,m):R(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|A,j,m),R("}")("}")):y.repeated?(R("if(%s!=null&&%s.length){",m,m),y.packed&&C.packed[j]!==undefined?R("w.uint32(%i).fork()",(y.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",m)("w.%s(%s[i])",j,m)("w.ldelim()"):(R("for(var i=0;i<%s.length;++i)",m),A===undefined?b(R,y,M,m+"[i]"):R("w.uint32(%i).%s(%s[i])",(y.id<<3|A)>>>0,j,m)),R("}")):(y.optional&&R("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",m,y.name),A===undefined?b(R,y,M,m):R("w.uint32(%i).%s(%s)",(y.id<<3|A)>>>0,j,m))}return R("return w")};var I=se(14),C=se(32),w=se(33);function b(D,m,R,f){return m.resolvedType.group?D("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",R,f,(m.id<<3|3)>>>0,(m.id<<3|4)>>>0):D("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",R,f,(m.id<<3|2)>>>0)}},{14:14,32:32,33:33}],14:[function(se,ee,x){ee.exports=b;var I=se(22);((b.prototype=Object.create(I.prototype)).constructor=b).className="Enum";var C=se(21),w=se(33);function b(D,m,R,f,g){if(I.call(this,D,R),m&&"object"!=typeof m)throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=f,this.comments=g||{},this.reserved=undefined,m)for(var y=Object.keys(m),M=0;M<y.length;++M)"number"==typeof m[y[M]]&&(this.valuesById[this.values[y[M]]=m[y[M]]]=y[M])}b.fromJSON=function(D,m){var R=new b(D,m.values,m.options,m.comment,m.comments);return R.reserved=m.reserved,R},b.prototype.toJSON=function(D){var m=!!D&&Boolean(D.keepComments);return w.toObject(["options",this.options,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:undefined,"comment",m?this.comment:undefined,"comments",m?this.comments:undefined])},b.prototype.add=function(D,m,R){if(!w.isString(D))throw TypeError("name must be a string");if(!w.isInteger(m))throw TypeError("id must be an integer");if(this.values[D]!==undefined)throw Error("duplicate name '"+D+"' in "+this);if(this.isReservedId(m))throw Error("id "+m+" is reserved in "+this);if(this.isReservedName(D))throw Error("name '"+D+"' is reserved in "+this);if(this.valuesById[m]!==undefined){if(!this.options||!this.options.allow_alias)throw Error("duplicate id "+m+" in "+this);this.values[D]=m}else this.valuesById[this.values[D]=m]=D;return this.comments[D]=R||null,this},b.prototype.remove=function(D){if(!w.isString(D))throw TypeError("name must be a string");var m=this.values[D];if(null==m)throw Error("name '"+D+"' does not exist in "+this);return delete this.valuesById[m],delete this.values[D],delete this.comments[D],this},b.prototype.isReservedId=function(D){return C.isReservedId(this.reserved,D)},b.prototype.isReservedName=function(D){return C.isReservedName(this.reserved,D)}},{21:21,22:22,33:33}],15:[function(se,ee,x){ee.exports=R;var I=se(22);((R.prototype=Object.create(I.prototype)).constructor=R).className="Field";var C,w=se(14),b=se(32),D=se(33),m=/^required|optional|repeated$/;function R(f,g,y,M,j,A,E){if(D.isObject(M)?(E=j,A=M,M=j=undefined):D.isObject(j)&&(E=A,A=j,j=undefined),I.call(this,f,A),!D.isInteger(g)||g<0)throw TypeError("id must be a non-negative integer");if(!D.isString(y))throw TypeError("type must be a string");if(M!==undefined&&!m.test(M=M.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(j!==undefined&&!D.isString(j))throw TypeError("extend must be a string");this.rule=M&&"optional"!==M?M:undefined,this.type=y,this.id=g,this.extend=j||undefined,this.required="required"===M,this.optional=!this.required,this.repeated="repeated"===M,this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=!!D.Long&&b.long[y]!==undefined,this.bytes="bytes"===y,this.resolvedType=null,this.extensionField=null,this.declaringField=null,this._packed=null,this.comment=E}R.fromJSON=function(f,g){return new R(f,g.id,g.type,g.rule,g.extend,g.options,g.comment)},Object.defineProperty(R.prototype,"packed",{get:function(){return null===this._packed&&(this._packed=!1!==this.getOption("packed")),this._packed}}),R.prototype.setOption=function(f,g,y){return"packed"===f&&(this._packed=null),I.prototype.setOption.call(this,f,g,y)},R.prototype.toJSON=function(f){var g=!!f&&Boolean(f.keepComments);return D.toObject(["rule","optional"!==this.rule&&this.rule||undefined,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",g?this.comment:undefined])},R.prototype.resolve=function(){if(this.resolved)return this;if((this.typeDefault=b.defaults[this.type])===undefined&&(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.typeDefault=this.resolvedType instanceof C?null:this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]),this.options&&null!=this.options.default&&(this.typeDefault=this.options.default,this.resolvedType instanceof w&&"string"==typeof this.typeDefault&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&(!0!==this.options.packed&&(this.options.packed===undefined||!this.resolvedType||this.resolvedType instanceof w)||delete this.options.packed,Object.keys(this.options).length||(this.options=undefined)),this.long)this.typeDefault=D.Long.fromNumber(this.typeDefault,"u"===this.type.charAt(0)),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&"string"==typeof this.typeDefault){var f;D.base64.test(this.typeDefault)?D.base64.decode(this.typeDefault,f=D.newBuffer(D.base64.length(this.typeDefault)),0):D.utf8.write(this.typeDefault,f=D.newBuffer(D.utf8.length(this.typeDefault)),0),this.typeDefault=f}return this.defaultValue=this.map?D.emptyObject:this.repeated?D.emptyArray:this.typeDefault,this.parent instanceof C&&(this.parent.ctor.prototype[this.name]=this.defaultValue),I.prototype.resolve.call(this)},R.d=function(f,g,y,M){return"function"==typeof g?g=D.decorateType(g).name:g&&"object"==typeof g&&(g=D.decorateEnum(g).name),function(j,A){D.decorateType(j.constructor).add(new R(A,f,g,y,{default:M}))}},R._configure=function(f){C=f}},{14:14,22:22,32:32,33:33}],16:[function(se,ee,x){var I=ee.exports=se(17);I.build="light",I.load=function(C,w,b){return"function"==typeof w?(b=w,w=new I.Root):w||(w=new I.Root),w.load(C,b)},I.loadSync=function(C,w){return w||(w=new I.Root),w.loadSync(C)},I.encoder=se(13),I.decoder=se(12),I.verifier=se(36),I.converter=se(11),I.ReflectionObject=se(22),I.Namespace=se(21),I.Root=se(26),I.Enum=se(14),I.Type=se(31),I.Field=se(15),I.OneOf=se(23),I.MapField=se(18),I.Service=se(30),I.Method=se(20),I.Message=se(19),I.wrappers=se(37),I.types=se(32),I.util=se(33),I.ReflectionObject._configure(I.Root),I.Namespace._configure(I.Type,I.Service,I.Enum),I.Root._configure(I.Type),I.Field._configure(I.Type)},{11:11,12:12,13:13,14:14,15:15,17:17,18:18,19:19,20:20,21:21,22:22,23:23,26:26,30:30,31:31,32:32,33:33,36:36,37:37}],17:[function(se,ee,x){var I=x;function C(){I.util._configure(),I.Writer._configure(I.BufferWriter),I.Reader._configure(I.BufferReader)}I.build="minimal",I.Writer=se(38),I.BufferWriter=se(39),I.Reader=se(24),I.BufferReader=se(25),I.util=se(35),I.rpc=se(28),I.roots=se(27),I.configure=C,C()},{24:24,25:25,27:27,28:28,35:35,38:38,39:39}],18:[function(se,ee,x){ee.exports=b;var I=se(15);((b.prototype=Object.create(I.prototype)).constructor=b).className="MapField";var C=se(32),w=se(33);function b(D,m,R,f,g,y){if(I.call(this,D,m,f,undefined,undefined,g,y),!w.isString(R))throw TypeError("keyType must be a string");this.keyType=R,this.resolvedKeyType=null,this.map=!0}b.fromJSON=function(D,m){return new b(D,m.id,m.keyType,m.type,m.options,m.comment)},b.prototype.toJSON=function(D){var m=!!D&&Boolean(D.keepComments);return w.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",m?this.comment:undefined])},b.prototype.resolve=function(){if(this.resolved)return this;if(C.mapKey[this.keyType]===undefined)throw Error("invalid key type: "+this.keyType);return I.prototype.resolve.call(this)},b.d=function(D,m,R){return"function"==typeof R?R=w.decorateType(R).name:R&&"object"==typeof R&&(R=w.decorateEnum(R).name),function(f,g){w.decorateType(f.constructor).add(new b(g,D,m,R))}}},{15:15,32:32,33:33}],19:[function(se,ee,x){ee.exports=C;var I=se(35);function C(w){if(w)for(var b=Object.keys(w),D=0;D<b.length;++D)this[b[D]]=w[b[D]]}C.create=function(w){return this.$type.create(w)},C.encode=function(w,b){return this.$type.encode(w,b)},C.encodeDelimited=function(w,b){return this.$type.encodeDelimited(w,b)},C.decode=function(w){return this.$type.decode(w)},C.decodeDelimited=function(w){return this.$type.decodeDelimited(w)},C.verify=function(w){return this.$type.verify(w)},C.fromObject=function(w){return this.$type.fromObject(w)},C.toObject=function(w,b){return this.$type.toObject(w,b)},C.prototype.toJSON=function(){return this.$type.toObject(this,I.toJSONOptions)}},{35:35}],20:[function(se,ee,x){ee.exports=w;var I=se(22);((w.prototype=Object.create(I.prototype)).constructor=w).className="Method";var C=se(33);function w(b,D,m,R,f,g,y,M){if(C.isObject(f)?(y=f,f=g=undefined):C.isObject(g)&&(y=g,g=undefined),D!==undefined&&!C.isString(D))throw TypeError("type must be a string");if(!C.isString(m))throw TypeError("requestType must be a string");if(!C.isString(R))throw TypeError("responseType must be a string");I.call(this,b,y),this.type=D||"rpc",this.requestType=m,this.requestStream=!!f||undefined,this.responseType=R,this.responseStream=!!g||undefined,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=M}w.fromJSON=function(b,D){return new w(b,D.type,D.requestType,D.responseType,D.requestStream,D.responseStream,D.options,D.comment)},w.prototype.toJSON=function(b){var D=!!b&&Boolean(b.keepComments);return C.toObject(["type","rpc"!==this.type&&this.type||undefined,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",D?this.comment:undefined])},w.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),I.prototype.resolve.call(this))}},{22:22,33:33}],21:[function(se,ee,x){ee.exports=f;var I=se(22);((f.prototype=Object.create(I.prototype)).constructor=f).className="Namespace";var C,w,b,D=se(15),m=se(33);function R(y,M){if(!y||!y.length)return undefined;for(var j={},A=0;A<y.length;++A)j[y[A].name]=y[A].toJSON(M);return j}function f(y,M){I.call(this,y,M),this.nested=undefined,this._nestedArray=null}function g(y){return y._nestedArray=null,y}f.fromJSON=function(y,M){return new f(y,M.options).addJSON(M.nested)},f.arrayToJSON=R,f.isReservedId=function(y,M){if(y)for(var j=0;j<y.length;++j)if("string"!=typeof y[j]&&y[j][0]<=M&&y[j][1]>M)return!0;return!1},f.isReservedName=function(y,M){if(y)for(var j=0;j<y.length;++j)if(y[j]===M)return!0;return!1},Object.defineProperty(f.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=m.toArray(this.nested))}}),f.prototype.toJSON=function(y){return m.toObject(["options",this.options,"nested",R(this.nestedArray,y)])},f.prototype.addJSON=function(y){if(y)for(var M,j=Object.keys(y),A=0;A<j.length;++A)this.add(((M=y[j[A]]).fields!==undefined?C.fromJSON:M.values!==undefined?b.fromJSON:M.methods!==undefined?w.fromJSON:M.id!==undefined?D.fromJSON:f.fromJSON)(j[A],M));return this},f.prototype.get=function(y){return this.nested&&this.nested[y]||null},f.prototype.getEnum=function(y){if(this.nested&&this.nested[y]instanceof b)return this.nested[y].values;throw Error("no such enum: "+y)},f.prototype.add=function(y){if(!(y instanceof D&&y.extend!==undefined||y instanceof C||y instanceof b||y instanceof w||y instanceof f))throw TypeError("object must be a valid nested object");if(this.nested){var M=this.get(y.name);if(M){if(!(M instanceof f&&y instanceof f)||M instanceof C||M instanceof w)throw Error("duplicate name '"+y.name+"' in "+this);for(var j=M.nestedArray,A=0;A<j.length;++A)y.add(j[A]);this.remove(M),this.nested||(this.nested={}),y.setOptions(M.options,!0)}}else this.nested={};return this.nested[y.name]=y,y.onAdd(this),g(this)},f.prototype.remove=function(y){if(!(y instanceof I))throw TypeError("object must be a ReflectionObject");if(y.parent!==this)throw Error(y+" is not a member of "+this);return delete this.nested[y.name],Object.keys(this.nested).length||(this.nested=undefined),y.onRemove(this),g(this)},f.prototype.define=function(y,M){if(m.isString(y))y=y.split(".");else if(!Array.isArray(y))throw TypeError("illegal path");if(y&&y.length&&""===y[0])throw Error("path must be relative");for(var j=this;y.length>0;){var A=y.shift();if(j.nested&&j.nested[A]){if(!((j=j.nested[A])instanceof f))throw Error("path conflicts with non-namespace objects")}else j.add(j=new f(A))}return M&&j.addJSON(M),j},f.prototype.resolveAll=function(){for(var y=this.nestedArray,M=0;M<y.length;)y[M]instanceof f?y[M++].resolveAll():y[M++].resolve();return this.resolve()},f.prototype.lookup=function(y,M,j){if("boolean"==typeof M?(j=M,M=undefined):M&&!Array.isArray(M)&&(M=[M]),m.isString(y)&&y.length){if("."===y)return this.root;y=y.split(".")}else if(!y.length)return this;if(""===y[0])return this.root.lookup(y.slice(1),M);var A=this.get(y[0]);if(A){if(1===y.length){if(!M||M.indexOf(A.constructor)>-1)return A}else if(A instanceof f&&(A=A.lookup(y.slice(1),M,!0)))return A}else for(var E=0;E<this.nestedArray.length;++E)if(this._nestedArray[E]instanceof f&&(A=this._nestedArray[E].lookup(y,M,!0)))return A;return null===this.parent||j?null:this.parent.lookup(y,M)},f.prototype.lookupType=function(y){var M=this.lookup(y,[C]);if(!M)throw Error("no such type: "+y);return M},f.prototype.lookupEnum=function(y){var M=this.lookup(y,[b]);if(!M)throw Error("no such Enum '"+y+"' in "+this);return M},f.prototype.lookupTypeOrEnum=function(y){var M=this.lookup(y,[C,b]);if(!M)throw Error("no such Type or Enum '"+y+"' in "+this);return M},f.prototype.lookupService=function(y){var M=this.lookup(y,[w]);if(!M)throw Error("no such Service '"+y+"' in "+this);return M},f._configure=function(y,M,j){C=y,w=M,b=j}},{15:15,22:22,33:33}],22:[function(se,ee,x){ee.exports=w,w.className="ReflectionObject";var I,C=se(33);function w(b,D){if(!C.isString(b))throw TypeError("name must be a string");if(D&&!C.isObject(D))throw TypeError("options must be an object");this.options=D,this.parsedOptions=null,this.name=b,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(w.prototype,{root:{get:function(){for(var b=this;null!==b.parent;)b=b.parent;return b}},fullName:{get:function(){for(var b=[this.name],D=this.parent;D;)b.unshift(D.name),D=D.parent;return b.join(".")}}}),w.prototype.toJSON=function(){throw Error()},w.prototype.onAdd=function(b){this.parent&&this.parent!==b&&this.parent.remove(this),this.parent=b,this.resolved=!1;var D=b.root;D instanceof I&&D._handleAdd(this)},w.prototype.onRemove=function(b){var D=b.root;D instanceof I&&D._handleRemove(this),this.parent=null,this.resolved=!1},w.prototype.resolve=function(){return this.resolved||this.root instanceof I&&(this.resolved=!0),this},w.prototype.getOption=function(b){return this.options?this.options[b]:undefined},w.prototype.setOption=function(b,D,m){return m&&this.options&&this.options[b]!==undefined||((this.options||(this.options={}))[b]=D),this},w.prototype.setParsedOption=function(b,D,m){this.parsedOptions||(this.parsedOptions=[]);var R=this.parsedOptions;if(m){var f=R.find(function(M){return Object.prototype.hasOwnProperty.call(M,b)});f?C.setProperty(f[b],m,D):((f={})[b]=C.setProperty({},m,D),R.push(f))}else{var y={};y[b]=D,R.push(y)}return this},w.prototype.setOptions=function(b,D){if(b)for(var m=Object.keys(b),R=0;R<m.length;++R)this.setOption(m[R],b[m[R]],D);return this},w.prototype.toString=function(){var b=this.constructor.className,D=this.fullName;return D.length?b+" "+D:b},w._configure=function(b){I=b}},{33:33}],23:[function(se,ee,x){ee.exports=b;var I=se(22);((b.prototype=Object.create(I.prototype)).constructor=b).className="OneOf";var C=se(15),w=se(33);function b(m,R,f,g){if(Array.isArray(R)||(f=R,R=undefined),I.call(this,m,f),R!==undefined&&!Array.isArray(R))throw TypeError("fieldNames must be an Array");this.oneof=R||[],this.fieldsArray=[],this.comment=g}function D(m){if(m.parent)for(var R=0;R<m.fieldsArray.length;++R)m.fieldsArray[R].parent||m.parent.add(m.fieldsArray[R])}b.fromJSON=function(m,R){return new b(m,R.oneof,R.options,R.comment)},b.prototype.toJSON=function(m){var R=!!m&&Boolean(m.keepComments);return w.toObject(["options",this.options,"oneof",this.oneof,"comment",R?this.comment:undefined])},b.prototype.add=function(m){if(!(m instanceof C))throw TypeError("field must be a Field");return m.parent&&m.parent!==this.parent&&m.parent.remove(m),this.oneof.push(m.name),this.fieldsArray.push(m),m.partOf=this,D(this),this},b.prototype.remove=function(m){if(!(m instanceof C))throw TypeError("field must be a Field");var R=this.fieldsArray.indexOf(m);if(R<0)throw Error(m+" is not a member of "+this);return this.fieldsArray.splice(R,1),(R=this.oneof.indexOf(m.name))>-1&&this.oneof.splice(R,1),m.partOf=null,this},b.prototype.onAdd=function(m){I.prototype.onAdd.call(this,m);for(var R=0;R<this.oneof.length;++R){var f=m.get(this.oneof[R]);f&&!f.partOf&&(f.partOf=this,this.fieldsArray.push(f))}D(this)},b.prototype.onRemove=function(m){for(var R,f=0;f<this.fieldsArray.length;++f)(R=this.fieldsArray[f]).parent&&R.parent.remove(R);I.prototype.onRemove.call(this,m)},b.d=function(){for(var m=new Array(arguments.length),R=0;R<arguments.length;)m[R]=arguments[R++];return function(f,g){w.decorateType(f.constructor).add(new b(g,m)),Object.defineProperty(f,g,{get:w.oneOfGetter(m),set:w.oneOfSetter(m)})}}},{15:15,22:22,33:33}],24:[function(se,ee,x){ee.exports=m;var I,C=se(35),w=C.LongBits,b=C.utf8;function D(A,E){return RangeError("index out of range: "+A.pos+" + "+(E||1)+" > "+A.len)}function m(A){this.buf=A,this.pos=0,this.len=A.length}var R,f="undefined"!=typeof Uint8Array?function(A){if(A instanceof Uint8Array||Array.isArray(A))return new m(A);throw Error("illegal buffer")}:function(A){if(Array.isArray(A))return new m(A);throw Error("illegal buffer")},g=function(){return C.Buffer?function(A){return(m.create=function(E){return C.Buffer.isBuffer(E)?new I(E):f(E)})(A)}:f};function y(){var A=new w(0,0),E=0;if(!(this.len-this.pos>4)){for(;E<3;++E){if(this.pos>=this.len)throw D(this);if(A.lo=(A.lo|(127&this.buf[this.pos])<<7*E)>>>0,this.buf[this.pos++]<128)return A}return A.lo=(A.lo|(127&this.buf[this.pos++])<<7*E)>>>0,A}for(;E<4;++E)if(A.lo=(A.lo|(127&this.buf[this.pos])<<7*E)>>>0,this.buf[this.pos++]<128)return A;if(A.lo=(A.lo|(127&this.buf[this.pos])<<28)>>>0,A.hi=(A.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return A;if(E=0,this.len-this.pos>4){for(;E<5;++E)if(A.hi=(A.hi|(127&this.buf[this.pos])<<7*E+3)>>>0,this.buf[this.pos++]<128)return A}else for(;E<5;++E){if(this.pos>=this.len)throw D(this);if(A.hi=(A.hi|(127&this.buf[this.pos])<<7*E+3)>>>0,this.buf[this.pos++]<128)return A}throw Error("invalid varint encoding")}function M(A,E){return(A[E-4]|A[E-3]<<8|A[E-2]<<16|A[E-1]<<24)>>>0}function j(){if(this.pos+8>this.len)throw D(this,8);return new w(M(this.buf,this.pos+=4),M(this.buf,this.pos+=4))}m.create=g(),m.prototype._slice=C.Array.prototype.subarray||C.Array.prototype.slice,m.prototype.uint32=(R=4294967295,function(){if(R=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128||(R=(R|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)||(R=(R|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)||(R=(R|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)||(R=(R|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128))return R;if((this.pos+=5)>this.len)throw this.pos=this.len,D(this,10);return R}),m.prototype.int32=function(){return 0|this.uint32()},m.prototype.sint32=function(){var A=this.uint32();return A>>>1^-(1&A)|0},m.prototype.bool=function(){return 0!==this.uint32()},m.prototype.fixed32=function(){if(this.pos+4>this.len)throw D(this,4);return M(this.buf,this.pos+=4)},m.prototype.sfixed32=function(){if(this.pos+4>this.len)throw D(this,4);return 0|M(this.buf,this.pos+=4)},m.prototype.float=function(){if(this.pos+4>this.len)throw D(this,4);var A=C.float.readFloatLE(this.buf,this.pos);return this.pos+=4,A},m.prototype.double=function(){if(this.pos+8>this.len)throw D(this,4);var A=C.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,A},m.prototype.bytes=function(){var A=this.uint32(),E=this.pos,F=this.pos+A;if(F>this.len)throw D(this,A);return this.pos+=A,Array.isArray(this.buf)?this.buf.slice(E,F):E===F?new this.buf.constructor(0):this._slice.call(this.buf,E,F)},m.prototype.string=function(){var A=this.bytes();return b.read(A,0,A.length)},m.prototype.skip=function(A){if("number"==typeof A){if(this.pos+A>this.len)throw D(this,A);this.pos+=A}else do{if(this.pos>=this.len)throw D(this)}while(128&this.buf[this.pos++]);return this},m.prototype.skipType=function(A){switch(A){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(A=7&this.uint32());)this.skipType(A);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+A+" at offset "+this.pos)}return this},m._configure=function(A){I=A,m.create=g(),I._configure();var E=C.Long?"toLong":"toNumber";C.merge(m.prototype,{int64:function(){return y.call(this)[E](!1)},uint64:function(){return y.call(this)[E](!0)},sint64:function(){return y.call(this).zzDecode()[E](!1)},fixed64:function(){return j.call(this)[E](!0)},sfixed64:function(){return j.call(this)[E](!1)}})}},{35:35}],25:[function(se,ee,x){ee.exports=w;var I=se(24);(w.prototype=Object.create(I.prototype)).constructor=w;var C=se(35);function w(b){I.call(this,b)}w._configure=function(){C.Buffer&&(w.prototype._slice=C.Buffer.prototype.slice)},w.prototype.string=function(){var b=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+b,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+b,this.len))},w._configure()},{24:24,35:35}],26:[function(se,ee,x){ee.exports=g;var I=se(21);((g.prototype=Object.create(I.prototype)).constructor=g).className="Root";var C,w,b,D=se(15),m=se(14),R=se(23),f=se(33);function g(A){I.call(this,"",A),this.deferred=[],this.files=[]}function y(){}g.fromJSON=function(A,E){return E||(E=new g),A.options&&E.setOptions(A.options),E.addJSON(A.nested)},g.prototype.resolvePath=f.path.resolve,g.prototype.fetch=f.fetch,g.prototype.load=function A(E,F,N){"function"==typeof F&&(N=F,F=undefined);var H=this;if(!N)return f.asPromise(A,H,E,F);var O=N===y;function J(B,S){if(N){var c=N;if(N=null,O)throw B;c(B,S)}}function te(B){var S=B.lastIndexOf("google/protobuf/");if(S>-1){var c=B.substring(S);if(c in b)return c}return null}function Y(B,S){try{if(f.isString(S)&&"{"===S.charAt(0)&&(S=JSON.parse(S)),f.isString(S)){w.filename=B;var c,z=w(S,H,F),d=0;if(z.imports)for(;d<z.imports.length;++d)(c=te(z.imports[d])||H.resolvePath(B,z.imports[d]))&&ne(c);if(z.weakImports)for(d=0;d<z.weakImports.length;++d)(c=te(z.weakImports[d])||H.resolvePath(B,z.weakImports[d]))&&ne(c,!0)}else H.setOptions(S.options).addJSON(S.nested)}catch(T){J(T)}O||G||J(null,H)}function ne(B,S){if(!(H.files.indexOf(B)>-1))if(H.files.push(B),B in b)O?Y(B,b[B]):(++G,setTimeout(function(){--G,Y(B,b[B])}));else if(O){var c;try{c=f.fs.readFileSync(B).toString("utf8")}catch(z){return void(S||J(z))}Y(B,c)}else++G,H.fetch(B,function(z,d){--G,N&&(z?S?G||J(null,H):J(z):Y(B,d))})}var G=0;f.isString(E)&&(E=[E]);for(var _,u=0;u<E.length;++u)(_=H.resolvePath("",E[u]))&&ne(_);return O?H:(G||J(null,H),undefined)},g.prototype.loadSync=function(A,E){if(!f.isNode)throw Error("not supported");return this.load(A,E,y)},g.prototype.resolveAll=function(){if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map(function(A){return"'extend "+A.extend+"' in "+A.parent.fullName}).join(", "));return I.prototype.resolveAll.call(this)};var M=/^[A-Z]/;function j(A,E){var F=E.parent.lookup(E.extend);if(F){var N=new D(E.fullName,E.id,E.type,E.rule,undefined,E.options);return N.declaringField=E,E.extensionField=N,F.add(N),!0}return!1}g.prototype._handleAdd=function(A){if(A instanceof D)A.extend===undefined||A.extensionField||j(0,A)||this.deferred.push(A);else if(A instanceof m)M.test(A.name)&&(A.parent[A.name]=A.values);else if(!(A instanceof R)){if(A instanceof C)for(var E=0;E<this.deferred.length;)j(0,this.deferred[E])?this.deferred.splice(E,1):++E;for(var F=0;F<A.nestedArray.length;++F)this._handleAdd(A._nestedArray[F]);M.test(A.name)&&(A.parent[A.name]=A)}},g.prototype._handleRemove=function(A){if(A instanceof D){if(A.extend!==undefined)if(A.extensionField)A.extensionField.parent.remove(A.extensionField),A.extensionField=null;else{var E=this.deferred.indexOf(A);E>-1&&this.deferred.splice(E,1)}}else if(A instanceof m)M.test(A.name)&&delete A.parent[A.name];else if(A instanceof I){for(var F=0;F<A.nestedArray.length;++F)this._handleRemove(A._nestedArray[F]);M.test(A.name)&&delete A.parent[A.name]}},g._configure=function(A,E,F){C=A,w=E,b=F}},{14:14,15:15,21:21,23:23,33:33}],27:[function(se,ee,x){ee.exports={}},{}],28:[function(se,ee,x){x.Service=se(29)},{29:29}],29:[function(se,ee,x){ee.exports=C;var I=se(35);function C(w,b,D){if("function"!=typeof w)throw TypeError("rpcImpl must be a function");I.EventEmitter.call(this),this.rpcImpl=w,this.requestDelimited=Boolean(b),this.responseDelimited=Boolean(D)}(C.prototype=Object.create(I.EventEmitter.prototype)).constructor=C,C.prototype.rpcCall=function w(b,D,m,R,f){if(!R)throw TypeError("request must be specified");var g=this;if(!f)return I.asPromise(w,g,b,D,m,R);if(!g.rpcImpl)return setTimeout(function(){f(Error("already ended"))},0),undefined;try{return g.rpcImpl(b,D[g.requestDelimited?"encodeDelimited":"encode"](R).finish(),function(y,M){if(y)return g.emit("error",y,b),f(y);if(null===M)return g.end(!0),undefined;if(!(M instanceof m))try{M=m[g.responseDelimited?"decodeDelimited":"decode"](M)}catch(j){return g.emit("error",j,b),f(j)}return g.emit("data",M,b),f(null,M)})}catch(y){return g.emit("error",y,b),setTimeout(function(){f(y)},0),undefined}},C.prototype.end=function(w){return this.rpcImpl&&(w||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},{35:35}],30:[function(se,ee,x){ee.exports=D;var I=se(21);((D.prototype=Object.create(I.prototype)).constructor=D).className="Service";var C=se(20),w=se(33),b=se(28);function D(R,f){I.call(this,R,f),this.methods={},this._methodsArray=null}function m(R){return R._methodsArray=null,R}D.fromJSON=function(R,f){var g=new D(R,f.options);if(f.methods)for(var y=Object.keys(f.methods),M=0;M<y.length;++M)g.add(C.fromJSON(y[M],f.methods[y[M]]));return f.nested&&g.addJSON(f.nested),g.comment=f.comment,g},D.prototype.toJSON=function(R){var f=I.prototype.toJSON.call(this,R),g=!!R&&Boolean(R.keepComments);return w.toObject(["options",f&&f.options||undefined,"methods",I.arrayToJSON(this.methodsArray,R)||{},"nested",f&&f.nested||undefined,"comment",g?this.comment:undefined])},Object.defineProperty(D.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=w.toArray(this.methods))}}),D.prototype.get=function(R){return this.methods[R]||I.prototype.get.call(this,R)},D.prototype.resolveAll=function(){for(var R=this.methodsArray,f=0;f<R.length;++f)R[f].resolve();return I.prototype.resolve.call(this)},D.prototype.add=function(R){if(this.get(R.name))throw Error("duplicate name '"+R.name+"' in "+this);return R instanceof C?(this.methods[R.name]=R,R.parent=this,m(this)):I.prototype.add.call(this,R)},D.prototype.remove=function(R){if(R instanceof C){if(this.methods[R.name]!==R)throw Error(R+" is not a member of "+this);return delete this.methods[R.name],R.parent=null,m(this)}return I.prototype.remove.call(this,R)},D.prototype.create=function(R,f,g){for(var y,M=new b.Service(R,f,g),j=0;j<this.methodsArray.length;++j){var A=w.lcFirst((y=this._methodsArray[j]).resolve().name).replace(/[^$\w_]/g,"");M[A]=w.codegen(["r","c"],w.isReserved(A)?A+"_":A)("return this.rpcCall(m,q,s,r,c)")({m:y,q:y.resolvedRequestType.ctor,s:y.resolvedResponseType.ctor})}return M}},{20:20,21:21,28:28,33:33}],31:[function(se,ee,x){ee.exports=N;var I=se(21);((N.prototype=Object.create(I.prototype)).constructor=N).className="Type";var C=se(14),w=se(23),b=se(15),D=se(18),m=se(30),R=se(19),f=se(24),g=se(38),y=se(33),M=se(13),j=se(12),A=se(36),E=se(11),F=se(37);function N(O,J){I.call(this,O,J),this.fields={},this.oneofs=undefined,this.extensions=undefined,this.reserved=undefined,this.group=undefined,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}function H(O){return O._fieldsById=O._fieldsArray=O._oneofsArray=null,delete O.encode,delete O.decode,delete O.verify,O}Object.defineProperties(N.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var O=Object.keys(this.fields),J=0;J<O.length;++J){var te=this.fields[O[J]],Y=te.id;if(this._fieldsById[Y])throw Error("duplicate id "+Y+" in "+this);this._fieldsById[Y]=te}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=y.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=y.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=N.generateConstructor(this)())},set:function(O){var J=O.prototype;J instanceof R||((O.prototype=new R).constructor=O,y.merge(O.prototype,J)),O.$type=O.prototype.$type=this,y.merge(O,R,!0),this._ctor=O;for(var te=0;te<this.fieldsArray.length;++te)this._fieldsArray[te].resolve();var Y={};for(te=0;te<this.oneofsArray.length;++te)Y[this._oneofsArray[te].resolve().name]={get:y.oneOfGetter(this._oneofsArray[te].oneof),set:y.oneOfSetter(this._oneofsArray[te].oneof)};te&&Object.defineProperties(O.prototype,Y)}}}),N.generateConstructor=function(O){for(var J,te=y.codegen(["p"],O.name),Y=0;Y<O.fieldsArray.length;++Y)(J=O._fieldsArray[Y]).map?te("this%s={}",y.safeProp(J.name)):J.repeated&&te("this%s=[]",y.safeProp(J.name));return te("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")},N.fromJSON=function(O,J){var te=new N(O,J.options);te.extensions=J.extensions,te.reserved=J.reserved;for(var Y=Object.keys(J.fields),ne=0;ne<Y.length;++ne)te.add((void 0!==J.fields[Y[ne]].keyType?D.fromJSON:b.fromJSON)(Y[ne],J.fields[Y[ne]]));if(J.oneofs)for(Y=Object.keys(J.oneofs),ne=0;ne<Y.length;++ne)te.add(w.fromJSON(Y[ne],J.oneofs[Y[ne]]));if(J.nested)for(Y=Object.keys(J.nested),ne=0;ne<Y.length;++ne){var G=J.nested[Y[ne]];te.add((G.id!==undefined?b.fromJSON:G.fields!==undefined?N.fromJSON:G.values!==undefined?C.fromJSON:G.methods!==undefined?m.fromJSON:I.fromJSON)(Y[ne],G))}return J.extensions&&J.extensions.length&&(te.extensions=J.extensions),J.reserved&&J.reserved.length&&(te.reserved=J.reserved),J.group&&(te.group=!0),J.comment&&(te.comment=J.comment),te},N.prototype.toJSON=function(O){var J=I.prototype.toJSON.call(this,O),te=!!O&&Boolean(O.keepComments);return y.toObject(["options",J&&J.options||undefined,"oneofs",I.arrayToJSON(this.oneofsArray,O),"fields",I.arrayToJSON(this.fieldsArray.filter(function(Y){return!Y.declaringField}),O)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:undefined,"reserved",this.reserved&&this.reserved.length?this.reserved:undefined,"group",this.group||undefined,"nested",J&&J.nested||undefined,"comment",te?this.comment:undefined])},N.prototype.resolveAll=function(){for(var O=this.fieldsArray,J=0;J<O.length;)O[J++].resolve();var te=this.oneofsArray;for(J=0;J<te.length;)te[J++].resolve();return I.prototype.resolveAll.call(this)},N.prototype.get=function(O){return this.fields[O]||this.oneofs&&this.oneofs[O]||this.nested&&this.nested[O]||null},N.prototype.add=function(O){if(this.get(O.name))throw Error("duplicate name '"+O.name+"' in "+this);if(O instanceof b&&O.extend===undefined){if(this._fieldsById?this._fieldsById[O.id]:this.fieldsById[O.id])throw Error("duplicate id "+O.id+" in "+this);if(this.isReservedId(O.id))throw Error("id "+O.id+" is reserved in "+this);if(this.isReservedName(O.name))throw Error("name '"+O.name+"' is reserved in "+this);return O.parent&&O.parent.remove(O),this.fields[O.name]=O,O.message=this,O.onAdd(this),H(this)}return O instanceof w?(this.oneofs||(this.oneofs={}),this.oneofs[O.name]=O,O.onAdd(this),H(this)):I.prototype.add.call(this,O)},N.prototype.remove=function(O){if(O instanceof b&&O.extend===undefined){if(!this.fields||this.fields[O.name]!==O)throw Error(O+" is not a member of "+this);return delete this.fields[O.name],O.parent=null,O.onRemove(this),H(this)}if(O instanceof w){if(!this.oneofs||this.oneofs[O.name]!==O)throw Error(O+" is not a member of "+this);return delete this.oneofs[O.name],O.parent=null,O.onRemove(this),H(this)}return I.prototype.remove.call(this,O)},N.prototype.isReservedId=function(O){return I.isReservedId(this.reserved,O)},N.prototype.isReservedName=function(O){return I.isReservedName(this.reserved,O)},N.prototype.create=function(O){return new this.ctor(O)},N.prototype.setup=function(){for(var O=this.fullName,J=[],te=0;te<this.fieldsArray.length;++te)J.push(this._fieldsArray[te].resolve().resolvedType);this.encode=M(this)({Writer:g,types:J,util:y}),this.decode=j(this)({Reader:f,types:J,util:y}),this.verify=A(this)({types:J,util:y}),this.fromObject=E.fromObject(this)({types:J,util:y}),this.toObject=E.toObject(this)({types:J,util:y});var Y=F[O];if(Y){var ne=Object.create(this);ne.fromObject=this.fromObject,this.fromObject=Y.fromObject.bind(ne),ne.toObject=this.toObject,this.toObject=Y.toObject.bind(ne)}return this},N.prototype.encode=function(O,J){return this.setup().encode(O,J)},N.prototype.encodeDelimited=function(O,J){return this.encode(O,J&&J.len?J.fork():J).ldelim()},N.prototype.decode=function(O,J){return this.setup().decode(O,J)},N.prototype.decodeDelimited=function(O){return O instanceof f||(O=f.create(O)),this.decode(O,O.uint32())},N.prototype.verify=function(O){return this.setup().verify(O)},N.prototype.fromObject=function(O){return this.setup().fromObject(O)},N.prototype.toObject=function(O,J){return this.setup().toObject(O,J)},N.d=function(O){return function(J){y.decorateType(J,O)}}},{11:11,12:12,13:13,14:14,15:15,18:18,19:19,21:21,23:23,24:24,30:30,33:33,36:36,37:37,38:38}],32:[function(se,ee,x){var I=x,C=se(33),w=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function b(D,m){var R=0,f={};for(m|=0;R<D.length;)f[w[R+m]]=D[R++];return f}I.basic=b([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]),I.defaults=b([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",C.emptyArray,null]),I.long=b([0,0,0,1,1],7),I.mapKey=b([0,0,0,5,5,0,0,0,1,1,0,2],2),I.packed=b([1,5,0,0,0,5,5,0,0,0,1,1,0])},{33:33}],33:[function(se,ee,x){var I,C,w=ee.exports=se(35),b=se(27);w.codegen=se(3),w.fetch=se(5),w.path=se(8),w.fs=w.inquire("fs"),w.toArray=function(g){if(g){for(var y=Object.keys(g),M=new Array(y.length),j=0;j<y.length;)M[j]=g[y[j++]];return M}return[]},w.toObject=function(g){for(var y={},M=0;M<g.length;){var j=g[M++],A=g[M++];A!==undefined&&(y[j]=A)}return y};var D=/\\/g,m=/"/g;w.isReserved=function(g){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(g)},w.safeProp=function(g){return!/^[$\w_]+$/.test(g)||w.isReserved(g)?'["'+g.replace(D,"\\\\").replace(m,'\\"')+'"]':"."+g},w.ucFirst=function(g){return g.charAt(0).toUpperCase()+g.substring(1)};var R=/_([a-z])/g;w.camelCase=function(g){return g.substring(0,1)+g.substring(1).replace(R,function(y,M){return M.toUpperCase()})},w.compareFieldsById=function(g,y){return g.id-y.id},w.decorateType=function(g,y){if(g.$type)return y&&g.$type.name!==y&&(w.decorateRoot.remove(g.$type),g.$type.name=y,w.decorateRoot.add(g.$type)),g.$type;I||(I=se(31));var M=new I(y||g.name);return w.decorateRoot.add(M),M.ctor=g,Object.defineProperty(g,"$type",{value:M,enumerable:!1}),Object.defineProperty(g.prototype,"$type",{value:M,enumerable:!1}),M};var f=0;w.decorateEnum=function(g){if(g.$type)return g.$type;C||(C=se(14));var y=new C("Enum"+f++,g);return w.decorateRoot.add(y),Object.defineProperty(g,"$type",{value:y,enumerable:!1}),y},w.setProperty=function(g,y,M){if("object"!=typeof g)throw TypeError("dst must be an object");if(!y)throw TypeError("path must be specified");return function j(A,E,F){var N=E.shift();if(E.length>0)A[N]=j(A[N]||{},E,F);else{var H=A[N];H&&(F=[].concat(H).concat(F)),A[N]=F}return A}(g,y=y.split("."),M)},Object.defineProperty(w,"decorateRoot",{get:function(){return b.decorated||(b.decorated=new(se(26)))}})},{14:14,26:26,27:27,3:3,31:31,35:35,5:5,8:8}],34:[function(se,ee,x){ee.exports=C;var I=se(35);function C(m,R){this.lo=m>>>0,this.hi=R>>>0}var w=C.zero=new C(0,0);w.toNumber=function(){return 0},w.zzEncode=w.zzDecode=function(){return this},w.length=function(){return 1};var b=C.zeroHash="\0\0\0\0\0\0\0\0";C.fromNumber=function(m){if(0===m)return w;var R=m<0;R&&(m=-m);var f=m>>>0,g=(m-f)/4294967296>>>0;return R&&(g=~g>>>0,f=~f>>>0,++f>4294967295&&(f=0,++g>4294967295&&(g=0))),new C(f,g)},C.from=function(m){if("number"==typeof m)return C.fromNumber(m);if(I.isString(m)){if(!I.Long)return C.fromNumber(parseInt(m,10));m=I.Long.fromString(m)}return m.low||m.high?new C(m.low>>>0,m.high>>>0):w},C.prototype.toNumber=function(m){if(!m&&this.hi>>>31){var R=1+~this.lo>>>0,f=~this.hi>>>0;return R||(f=f+1>>>0),-(R+4294967296*f)}return this.lo+4294967296*this.hi},C.prototype.toLong=function(m){return I.Long?new I.Long(0|this.lo,0|this.hi,Boolean(m)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(m)}};var D=String.prototype.charCodeAt;C.fromHash=function(m){return m===b?w:new C((D.call(m,0)|D.call(m,1)<<8|D.call(m,2)<<16|D.call(m,3)<<24)>>>0,(D.call(m,4)|D.call(m,5)<<8|D.call(m,6)<<16|D.call(m,7)<<24)>>>0)},C.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},C.prototype.zzEncode=function(){var m=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^m)>>>0,this.lo=(this.lo<<1^m)>>>0,this},C.prototype.zzDecode=function(){var m=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^m)>>>0,this.hi=(this.hi>>>1^m)>>>0,this},C.prototype.length=function(){var m=this.lo,R=(this.lo>>>28|this.hi<<4)>>>0,f=this.hi>>>24;return 0===f?0===R?m<16384?m<128?1:2:m<2097152?3:4:R<16384?R<128?5:6:R<2097152?7:8:f<128?9:10}},{35:35}],35:[function(se,ee,x){var I=x;function C(b,D,m){for(var R=Object.keys(D),f=0;f<R.length;++f)b[R[f]]!==undefined&&m||(b[R[f]]=D[R[f]]);return b}function w(b){function D(m,R){if(!(this instanceof D))return new D(m,R);Object.defineProperty(this,"message",{get:function(){return m}}),Error.captureStackTrace?Error.captureStackTrace(this,D):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),R&&C(this,R)}return(D.prototype=Object.create(Error.prototype)).constructor=D,Object.defineProperty(D.prototype,"name",{get:function(){return b}}),D.prototype.toString=function(){return this.name+": "+this.message},D}I.asPromise=se(1),I.base64=se(2),I.EventEmitter=se(4),I.float=se(6),I.inquire=se(7),I.utf8=se(10),I.pool=se(9),I.LongBits=se(34),I.isNode=Boolean(void 0!==global&&global&&global.process&&global.process.versions&&global.process.versions.node),I.global=I.isNode&&global||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,I.emptyArray=Object.freeze?Object.freeze([]):[],I.emptyObject=Object.freeze?Object.freeze({}):{},I.isInteger=Number.isInteger||function(b){return"number"==typeof b&&isFinite(b)&&Math.floor(b)===b},I.isString=function(b){return"string"==typeof b||b instanceof String},I.isObject=function(b){return b&&"object"==typeof b},I.isset=I.isSet=function(b,D){var m=b[D];return!(null==m||!b.hasOwnProperty(D))&&("object"!=typeof m||(Array.isArray(m)?m.length:Object.keys(m).length)>0)},I.Buffer=function(){try{var b=I.inquire("buffer").Buffer;return b.prototype.utf8Write?b:null}catch(D){return null}}(),I._Buffer_from=null,I._Buffer_allocUnsafe=null,I.newBuffer=function(b){return"number"==typeof b?I.Buffer?I._Buffer_allocUnsafe(b):new I.Array(b):I.Buffer?I._Buffer_from(b):"undefined"==typeof Uint8Array?b:new Uint8Array(b)},I.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,I.Long=I.global.dcodeIO&&I.global.dcodeIO.Long||I.global.Long||I.inquire("long"),I.key2Re=/^true|false|0|1$/,I.key32Re=/^-?(?:0|[1-9][0-9]*)$/,I.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,I.longToHash=function(b){return b?I.LongBits.from(b).toHash():I.LongBits.zeroHash},I.longFromHash=function(b,D){var m=I.LongBits.fromHash(b);return I.Long?I.Long.fromBits(m.lo,m.hi,D):m.toNumber(Boolean(D))},I.merge=C,I.lcFirst=function(b){return b.charAt(0).toLowerCase()+b.substring(1)},I.newError=w,I.ProtocolError=w("ProtocolError"),I.oneOfGetter=function(b){for(var D={},m=0;m<b.length;++m)D[b[m]]=1;return function(){for(var R=Object.keys(this),f=R.length-1;f>-1;--f)if(1===D[R[f]]&&this[R[f]]!==undefined&&null!==this[R[f]])return R[f]}},I.oneOfSetter=function(b){return function(D){for(var m=0;m<b.length;++m)b[m]!==D&&delete this[b[m]]}},I.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},I._configure=function(){var b=I.Buffer;b?(I._Buffer_from=b.from!==Uint8Array.from&&b.from||function(D,m){return new b(D,m)},I._Buffer_allocUnsafe=b.allocUnsafe||function(D){return new b(D)}):I._Buffer_from=I._Buffer_allocUnsafe=null}},{1:1,10:10,2:2,34:34,4:4,6:6,7:7,9:9}],36:[function(se,ee,x){ee.exports=function(m){var R=C.codegen(["m"],m.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),g={};m.oneofsArray.length&&R("var p={}");for(var y=0;y<m.fieldsArray.length;++y){var M=m._fieldsArray[y].resolve(),j="m"+C.safeProp(M.name);if(M.optional&&R("if(%s!=null&&m.hasOwnProperty(%j)){",j,M.name),M.map)R("if(!util.isObject(%s))",j)("return%j",w(M,"object"))("var k=Object.keys(%s)",j)("for(var i=0;i<k.length;++i){"),D(R,M,"k[i]"),b(R,M,y,j+"[k[i]]")("}");else if(M.repeated)R("if(!Array.isArray(%s))",j)("return%j",w(M,"array"))("for(var i=0;i<%s.length;++i){",j),b(R,M,y,j+"[i]")("}");else{if(M.partOf){var A=C.safeProp(M.partOf.name);1===g[M.partOf.name]&&R("if(p%s===1)",A)("return%j",M.partOf.name+": multiple values"),g[M.partOf.name]=1,R("p%s=1",A)}b(R,M,y,j)}M.optional&&R("}")}return R("return null")};var I=se(14),C=se(33);function w(m,R){return m.name+": "+R+(m.repeated&&"array"!==R?"[]":m.map&&"object"!==R?"{k:"+m.keyType+"}":"")+" expected"}function b(m,R,f,g){if(R.resolvedType)if(R.resolvedType instanceof I){m("switch(%s){",g)("default:")("return%j",w(R,"enum value"));for(var y=Object.keys(R.resolvedType.values),M=0;M<y.length;++M)m("case %i:",R.resolvedType.values[y[M]]);m("break")("}")}else m("{")("var e=types[%i].verify(%s);",f,g)("if(e)")("return%j+e",R.name+".")("}");else switch(R.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":m("if(!util.isInteger(%s))",g)("return%j",w(R,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":m("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",g,g,g,g)("return%j",w(R,"integer|Long"));break;case"float":case"double":m('if(typeof %s!=="number")',g)("return%j",w(R,"number"));break;case"bool":m('if(typeof %s!=="boolean")',g)("return%j",w(R,"boolean"));break;case"string":m("if(!util.isString(%s))",g)("return%j",w(R,"string"));break;case"bytes":m('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',g,g,g)("return%j",w(R,"buffer"))}return m}function D(m,R,f){switch(R.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":m("if(!util.key32Re.test(%s))",f)("return%j",w(R,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":m("if(!util.key64Re.test(%s))",f)("return%j",w(R,"integer|Long key"));break;case"bool":m("if(!util.key2Re.test(%s))",f)("return%j",w(R,"boolean key"))}return m}},{14:14,33:33}],37:[function(se,ee,x){var I=x,C=se(19);I[".google.protobuf.Any"]={fromObject:function(w){if(w&&w["@type"]){var b=w["@type"].substring(w["@type"].lastIndexOf("/")+1),D=this.lookup(b);if(D){var m="."===w["@type"].charAt(0)?w["@type"].substr(1):w["@type"];return-1===m.indexOf("/")&&(m="/"+m),this.create({type_url:m,value:D.encode(D.fromObject(w)).finish()})}}return this.fromObject(w)},toObject:function(w,b){var D="",m="";if(b&&b.json&&w.type_url&&w.value){m=w.type_url.substring(w.type_url.lastIndexOf("/")+1),D=w.type_url.substring(0,w.type_url.lastIndexOf("/")+1);var R=this.lookup(m);R&&(w=R.decode(w.value))}if(!(w instanceof this.ctor)&&w instanceof C){var f=w.$type.toObject(w,b);return""===D&&(D="type.googleapis.com/"),m=D+("."===w.$type.fullName[0]?w.$type.fullName.substr(1):w.$type.fullName),f["@type"]=m,f}return this.toObject(w,b)}}},{19:19}],38:[function(se,ee,x){ee.exports=g;var I,C=se(35),w=C.LongBits,b=C.base64,D=C.utf8;function m(N,H,O){this.fn=N,this.len=H,this.next=undefined,this.val=O}function R(){}function f(N){this.head=N.head,this.tail=N.tail,this.len=N.len,this.next=N.states}function g(){this.len=0,this.head=new m(R,0,0),this.tail=this.head,this.states=null}var y=function(){return C.Buffer?function(){return(g.create=function(){return new I})()}:function(){return new g}};function M(N,H,O){H[O]=255&N}function j(N,H){this.len=N,this.next=undefined,this.val=H}function A(N,H,O){for(;N.hi;)H[O++]=127&N.lo|128,N.lo=(N.lo>>>7|N.hi<<25)>>>0,N.hi>>>=7;for(;N.lo>127;)H[O++]=127&N.lo|128,N.lo=N.lo>>>7;H[O++]=N.lo}function E(N,H,O){H[O]=255&N,H[O+1]=N>>>8&255,H[O+2]=N>>>16&255,H[O+3]=N>>>24}g.create=y(),g.alloc=function(N){return new C.Array(N)},C.Array!==Array&&(g.alloc=C.pool(g.alloc,C.Array.prototype.subarray)),g.prototype._push=function(N,H,O){return this.tail=this.tail.next=new m(N,H,O),this.len+=H,this},(j.prototype=Object.create(m.prototype)).fn=function(N,H,O){for(;N>127;)H[O++]=127&N|128,N>>>=7;H[O]=N},g.prototype.uint32=function(N){return this.len+=(this.tail=this.tail.next=new j((N>>>=0)<128?1:N<16384?2:N<2097152?3:N<268435456?4:5,N)).len,this},g.prototype.int32=function(N){return N<0?this._push(A,10,w.fromNumber(N)):this.uint32(N)},g.prototype.sint32=function(N){return this.uint32((N<<1^N>>31)>>>0)},g.prototype.int64=g.prototype.uint64=function(N){var H=w.from(N);return this._push(A,H.length(),H)},g.prototype.sint64=function(N){var H=w.from(N).zzEncode();return this._push(A,H.length(),H)},g.prototype.bool=function(N){return this._push(M,1,N?1:0)},g.prototype.sfixed32=g.prototype.fixed32=function(N){return this._push(E,4,N>>>0)},g.prototype.sfixed64=g.prototype.fixed64=function(N){var H=w.from(N);return this._push(E,4,H.lo)._push(E,4,H.hi)},g.prototype.float=function(N){return this._push(C.float.writeFloatLE,4,N)},g.prototype.double=function(N){return this._push(C.float.writeDoubleLE,8,N)};var F=C.Array.prototype.set?function(N,H,O){H.set(N,O)}:function(N,H,O){for(var J=0;J<N.length;++J)H[O+J]=N[J]};g.prototype.bytes=function(N){var H=N.length>>>0;if(!H)return this._push(M,1,0);if(C.isString(N)){var O=g.alloc(H=b.length(N));b.decode(N,O,0),N=O}return this.uint32(H)._push(F,H,N)},g.prototype.string=function(N){var H=D.length(N);return H?this.uint32(H)._push(D.write,H,N):this._push(M,1,0)},g.prototype.fork=function(){return this.states=new f(this),this.head=this.tail=new m(R,0,0),this.len=0,this},g.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new m(R,0,0),this.len=0),this},g.prototype.ldelim=function(){var N=this.head,H=this.tail,O=this.len;return this.reset().uint32(O),O&&(this.tail.next=N.next,this.tail=H,this.len+=O),this},g.prototype.finish=function(){for(var N=this.head.next,H=this.constructor.alloc(this.len),O=0;N;)N.fn(N.val,H,O),O+=N.len,N=N.next;return H},g._configure=function(N){I=N,g.create=y(),I._configure()}},{35:35}],39:[function(se,ee,x){ee.exports=w;var I=se(38);(w.prototype=Object.create(I.prototype)).constructor=w;var C=se(35);function w(){I.call(this)}function b(D,m,R){D.length<40?C.utf8.write(D,m,R):m.utf8Write?m.utf8Write(D,R):m.write(D,R)}w._configure=function(){w.alloc=C._Buffer_allocUnsafe,w.writeBytesBuffer=C.Buffer&&C.Buffer.prototype instanceof Uint8Array&&"set"===C.Buffer.prototype.set.name?function(D,m,R){m.set(D,R)}:function(D,m,R){if(D.copy)D.copy(m,R,0,D.length);else for(var f=0;f<D.length;)m[R++]=D[f++]}},w.prototype.bytes=function(D){C.isString(D)&&(D=C._Buffer_from(D,"base64"));var m=D.length>>>0;return this.uint32(m),m&&this._push(w.writeBytesBuffer,m,D),this},w.prototype.string=function(D){var m=C.Buffer.byteLength(D);return this.uint32(m),m&&this._push(b,m,D),this},w._configure()},{35:35,38:38}]},ee={},I=function C(w){var b=ee[w];return b||se[w][0].call(b=ee[w]={exports:{}},C,b,b.exports),b.exports}(16),I.util.global.protobuf=I,__WEBPACK_AMD_DEFINE_ARRAY__=[__nested_webpack_require_639250__(61)],(__WEBPACK_AMD_DEFINE_RESULT__=function(C){return C&&C.isLong&&(I.util.Long=C,I.configure()),I}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__))===undefined||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__),module&&module.exports&&(module.exports=I)})()}).call(this,__nested_webpack_require_639250__(33),__nested_webpack_require_639250__(60)(module))},function(se,ee){se.exports=function(x){return x.webpackPolyfill||(x.deprecate=function(){},x.paths=[],x.children||(x.children=[]),Object.defineProperty(x,"loaded",{enumerable:!0,get:function(){return x.l}}),Object.defineProperty(x,"id",{enumerable:!0,get:function(){return x.i}}),x.webpackPolyfill=1),x}},function(se,ee){se.exports=I;var x=null;try{x=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(_){}function I(_,u,B){this.low=0|_,this.high=0|u,this.unsigned=!!B}function C(_){return!0===(_&&_.__isLong__)}Object.defineProperty(I.prototype,"__isLong__",{value:!0}),I.isLong=C;var w={},b={};function D(_,u){var B,S,c;return u?(c=0<=(_>>>=0)&&_<256)&&(S=b[_])?S:(B=R(_,(0|_)<0?-1:0,!0),c&&(b[_]=B),B):(c=-128<=(_|=0)&&_<128)&&(S=w[_])?S:(B=R(_,_<0?-1:0,!1),c&&(w[_]=B),B)}function m(_,u){if(isNaN(_))return u?N:F;if(u){if(_<0)return N;if(_>=j)return Y}else{if(_<=-A)return ne;if(_+1>=A)return te}return _<0?m(-_,u).neg():R(_%M|0,_/M|0,u)}function R(_,u,B){return new I(_,u,B)}I.fromInt=D,I.fromNumber=m,I.fromBits=R;var f=Math.pow;function g(_,u,B){if(0===_.length)throw Error("empty string");if("NaN"===_||"Infinity"===_||"+Infinity"===_||"-Infinity"===_)return F;if("number"==typeof u?(B=u,u=!1):u=!!u,(B=B||10)<2||36<B)throw RangeError("radix");var S;if((S=_.indexOf("-"))>0)throw Error("interior hyphen");if(0===S)return g(_.substring(1),u,B).neg();for(var c=m(f(B,8)),z=F,d=0;d<_.length;d+=8){var T=Math.min(8,_.length-d),L=parseInt(_.substring(d,d+T),B);if(T<8){var $=m(f(B,T));z=z.mul($).add(m(L))}else z=(z=z.mul(c)).add(m(L))}return z.unsigned=u,z}function y(_,u){return"number"==typeof _?m(_,u):"string"==typeof _?g(_,u):R(_.low,_.high,"boolean"==typeof u?u:_.unsigned)}I.fromString=g,I.fromValue=y;var M=4294967296,j=M*M,A=j/2,E=D(1<<24),F=D(0);I.ZERO=F;var N=D(0,!0);I.UZERO=N;var H=D(1);I.ONE=H;var O=D(1,!0);I.UONE=O;var J=D(-1);I.NEG_ONE=J;var te=R(-1,2147483647,!1);I.MAX_VALUE=te;var Y=R(-1,-1,!0);I.MAX_UNSIGNED_VALUE=Y;var ne=R(0,-2147483648,!1);I.MIN_VALUE=ne;var G=I.prototype;G.toInt=function(){return this.unsigned?this.low>>>0:this.low},G.toNumber=function(){return this.unsigned?(this.high>>>0)*M+(this.low>>>0):this.high*M+(this.low>>>0)},G.toString=function(_){if((_=_||10)<2||36<_)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(ne)){var u=m(_),B=this.div(u),S=B.mul(u).sub(this);return B.toString(_)+S.toInt().toString(_)}return"-"+this.neg().toString(_)}for(var c=m(f(_,6),this.unsigned),z=this,d="";;){var T=z.div(c),L=(z.sub(T.mul(c)).toInt()>>>0).toString(_);if((z=T).isZero())return L+d;for(;L.length<6;)L="0"+L;d=""+L+d}},G.getHighBits=function(){return this.high},G.getHighBitsUnsigned=function(){return this.high>>>0},G.getLowBits=function(){return this.low},G.getLowBitsUnsigned=function(){return this.low>>>0},G.getNumBitsAbs=function(){if(this.isNegative())return this.eq(ne)?64:this.neg().getNumBitsAbs();for(var _=0!=this.high?this.high:this.low,u=31;u>0&&0==(_&1<<u);u--);return 0!=this.high?u+33:u+1},G.isZero=function(){return 0===this.high&&0===this.low},G.eqz=G.isZero,G.isNegative=function(){return!this.unsigned&&this.high<0},G.isPositive=function(){return this.unsigned||this.high>=0},G.isOdd=function(){return 1==(1&this.low)},G.isEven=function(){return 0==(1&this.low)},G.equals=function(_){return C(_)||(_=y(_)),(this.unsigned===_.unsigned||this.high>>>31!=1||_.high>>>31!=1)&&this.high===_.high&&this.low===_.low},G.eq=G.equals,G.notEquals=function(_){return!this.eq(_)},G.neq=G.notEquals,G.ne=G.notEquals,G.lessThan=function(_){return this.comp(_)<0},G.lt=G.lessThan,G.lessThanOrEqual=function(_){return this.comp(_)<=0},G.lte=G.lessThanOrEqual,G.le=G.lessThanOrEqual,G.greaterThan=function(_){return this.comp(_)>0},G.gt=G.greaterThan,G.greaterThanOrEqual=function(_){return this.comp(_)>=0},G.gte=G.greaterThanOrEqual,G.ge=G.greaterThanOrEqual,G.compare=function(_){if(C(_)||(_=y(_)),this.eq(_))return 0;var u=this.isNegative(),B=_.isNegative();return u&&!B?-1:!u&&B?1:this.unsigned?_.high>>>0>this.high>>>0||_.high===this.high&&_.low>>>0>this.low>>>0?-1:1:this.sub(_).isNegative()?-1:1},G.comp=G.compare,G.negate=function(){return!this.unsigned&&this.eq(ne)?ne:this.not().add(H)},G.neg=G.negate,G.add=function(_){C(_)||(_=y(_));var L=0,$=0,Z=0,ce=0;return Z+=(ce+=(65535&this.low)+(65535&_.low))>>>16,$+=(Z+=(this.low>>>16)+(_.low>>>16))>>>16,L+=($+=(65535&this.high)+(65535&_.high))>>>16,L+=(this.high>>>16)+(_.high>>>16),R((Z&=65535)<<16|(ce&=65535),(L&=65535)<<16|($&=65535),this.unsigned)},G.subtract=function(_){return C(_)||(_=y(_)),this.add(_.neg())},G.sub=G.subtract,G.multiply=function(_){if(this.isZero())return F;if(C(_)||(_=y(_)),x)return R(x.mul(this.low,this.high,_.low,_.high),x.get_high(),this.unsigned);if(_.isZero())return F;if(this.eq(ne))return _.isOdd()?ne:F;if(_.eq(ne))return this.isOdd()?ne:F;if(this.isNegative())return _.isNegative()?this.neg().mul(_.neg()):this.neg().mul(_).neg();if(_.isNegative())return this.mul(_.neg()).neg();if(this.lt(E)&&_.lt(E))return m(this.toNumber()*_.toNumber(),this.unsigned);var B=65535&this.high,S=this.low>>>16,c=65535&this.low,d=65535&_.high,T=_.low>>>16,L=65535&_.low,$=0,Z=0,ce=0,re=0;return ce+=(re+=c*L)>>>16,Z+=(ce+=S*L)>>>16,ce&=65535,Z+=(ce+=c*T)>>>16,$+=(Z+=B*L)>>>16,Z&=65535,$+=(Z+=S*T)>>>16,Z&=65535,$+=(Z+=c*d)>>>16,$+=(this.high>>>16)*L+B*T+S*d+c*(_.high>>>16),R((ce&=65535)<<16|(re&=65535),($&=65535)<<16|(Z&=65535),this.unsigned)},G.mul=G.multiply,G.divide=function(_){if(C(_)||(_=y(_)),_.isZero())throw Error("division by zero");var u,B,S;if(x)return this.unsigned||-2147483648!==this.high||-1!==_.low||-1!==_.high?R((this.unsigned?x.div_u:x.div_s)(this.low,this.high,_.low,_.high),x.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?N:F;if(this.unsigned){if(_.unsigned||(_=_.toUnsigned()),_.gt(this))return N;if(_.gt(this.shru(1)))return O;S=N}else{if(this.eq(ne))return _.eq(H)||_.eq(J)?ne:_.eq(ne)?H:(u=this.shr(1).div(_).shl(1)).eq(F)?_.isNegative()?H:J:(B=this.sub(_.mul(u)),S=u.add(B.div(_)));if(_.eq(ne))return this.unsigned?N:F;if(this.isNegative())return _.isNegative()?this.neg().div(_.neg()):this.neg().div(_).neg();if(_.isNegative())return this.div(_.neg()).neg();S=F}for(B=this;B.gte(_);){u=Math.max(1,Math.floor(B.toNumber()/_.toNumber()));for(var c=Math.ceil(Math.log(u)/Math.LN2),z=c<=48?1:f(2,c-48),d=m(u),T=d.mul(_);T.isNegative()||T.gt(B);)T=(d=m(u-=z,this.unsigned)).mul(_);d.isZero()&&(d=H),S=S.add(d),B=B.sub(T)}return S},G.div=G.divide,G.modulo=function(_){return C(_)||(_=y(_)),x?R((this.unsigned?x.rem_u:x.rem_s)(this.low,this.high,_.low,_.high),x.get_high(),this.unsigned):this.sub(this.div(_).mul(_))},G.mod=G.modulo,G.rem=G.modulo,G.not=function(){return R(~this.low,~this.high,this.unsigned)},G.and=function(_){return C(_)||(_=y(_)),R(this.low&_.low,this.high&_.high,this.unsigned)},G.or=function(_){return C(_)||(_=y(_)),R(this.low|_.low,this.high|_.high,this.unsigned)},G.xor=function(_){return C(_)||(_=y(_)),R(this.low^_.low,this.high^_.high,this.unsigned)},G.shiftLeft=function(_){return C(_)&&(_=_.toInt()),0==(_&=63)?this:_<32?R(this.low<<_,this.high<<_|this.low>>>32-_,this.unsigned):R(0,this.low<<_-32,this.unsigned)},G.shl=G.shiftLeft,G.shiftRight=function(_){return C(_)&&(_=_.toInt()),0==(_&=63)?this:_<32?R(this.low>>>_|this.high<<32-_,this.high>>_,this.unsigned):R(this.high>>_-32,this.high>=0?0:-1,this.unsigned)},G.shr=G.shiftRight,G.shiftRightUnsigned=function(_){if(C(_)&&(_=_.toInt()),0==(_&=63))return this;var u=this.high;return _<32?R(this.low>>>_|u<<32-_,u>>>_,this.unsigned):R(32===_?u:u>>>_-32,0,this.unsigned)},G.shru=G.shiftRightUnsigned,G.shr_u=G.shiftRightUnsigned,G.toSigned=function(){return this.unsigned?R(this.low,this.high,!1):this},G.toUnsigned=function(){return this.unsigned?this:R(this.low,this.high,!0)},G.toBytes=function(_){return _?this.toBytesLE():this.toBytesBE()},G.toBytesLE=function(){var _=this.high,u=this.low;return[255&u,u>>>8&255,u>>>16&255,u>>>24,255&_,_>>>8&255,_>>>16&255,_>>>24]},G.toBytesBE=function(){var _=this.high,u=this.low;return[_>>>24,_>>>16&255,_>>>8&255,255&_,u>>>24,u>>>16&255,u>>>8&255,255&u]},I.fromBytes=function(_,u,B){return B?I.fromBytesLE(_,u):I.fromBytesBE(_,u)},I.fromBytesLE=function(_,u){return new I(_[0]|_[1]<<8|_[2]<<16|_[3]<<24,_[4]|_[5]<<8|_[6]<<16|_[7]<<24,u)},I.fromBytesBE=function(_,u){return new I(_[4]<<24|_[5]<<16|_[6]<<8|_[7],_[0]<<24|_[1]<<16|_[2]<<8|_[3],u)}},function(se){se.exports=JSON.parse('{"PeerPublishStatus":408,"JoinChannelTimeout":407,"OnUpdateStream":356,"OnRemoveStream":355,"OnAddVideoStream":353,"OnAddAudioStream":352,"FirstAudioDecode":351,"FirstVideoDecode":350,"FirstAudioReceived":349,"FirstVideoReceived":348,"ReqUserAccount":196,"ApiInvoke":41,"RequestProxyWorkerManager":36,"RequestProxyAppCenter":35,"VideoSendingStopped":34,"AudioSendingStopped":33,"StreamSwitch":32,"FirstFrame":31,"Publish":30,"Subscribe":29,"JoinGateway":28,"JoinChooseServer":27,"Session":26,"APWorkerEvent":160,"WorkerEvent":156,"JoinWebProxyAP":700,"WebSocketQuit":671}')},function(se){se.exports=JSON.parse('{"nested":{"protobuf":{"nested":{"Session":{"fields":{"sid":{"type":"string","id":1},"cname":{"type":"string","id":2},"cid":{"type":"int64","id":3},"lts":{"type":"int64","id":4},"ip":{"type":"string","id":5},"uid":{"type":"int64","id":6},"success":{"type":"bool","id":7},"elapse":{"type":"int64","id":8},"peer":{"type":"int64","id":9},"eventType":{"type":"string","id":10},"version":{"type":"string","id":11},"browser":{"type":"string","id":12},"appid":{"type":"string","id":13},"mode":{"type":"string","id":14},"extend":{"type":"string","id":15},"process":{"type":"string","id":16},"build":{"type":"string","id":17},"ipv6":{"type":"string","id":18},"sourceHost":{"type":"string","id":19},"sourcePath":{"type":"string","id":20},"collectorHost":{"type":"string","id":21},"collectorName":{"type":"string","id":22}}},"JoinChooseServer":{"fields":{"sid":{"type":"string","id":1},"cname":{"type":"string","id":2},"cid":{"type":"int64","id":3},"lts":{"type":"int64","id":4},"ip":{"type":"string","id":5},"uid":{"type":"int64","id":6},"success":{"type":"bool","id":7},"elapse":{"type":"int64","id":8},"peer":{"type":"int64","id":9},"eventType":{"type":"string","id":10},"chooseServerAddr":{"type":"string","id":11},"chooseServerAddrList":{"type":"string","id":12},"errorCode":{"type":"string","id":13},"eventElapse":{"type":"int64","id":14},"chooseServerIp":{"type":"string","id":15}}},"JoinGateway":{"fields":{"sid":{"type":"string","id":1},"cname":{"type":"string","id":2},"cid":{"type":"int64","id":3},"lts":{"type":"int64","id":4},"ip":{"type":"string","id":5},"uid":{"type":"int64","id":6},"success":{"type":"bool","id":7},"elapse":{"type":"int64","id":8},"peer":{"type":"int64","id":9},"eventType":{"type":"string","id":10},"gatewayAddr":{"type":"string","id":11},"errorCode":{"type":"string","id":12},"eventElapse":{"type":"int64","id":13},"firstSuccess":{"type":"bool","id":14}}},"Subscribe":{"fields":{"sid":{"type":"string","id":1},"cname":{"type":"string","id":2},"cid":{"type":"int64","id":3},"lts":{"type":"int64","id":4},"ip":{"type":"string","id":5},"uid":{"type":"int64","id":6},"success":{"type":"bool","id":7},"elapse":{"type":"int64","id":8},"peer":{"type":"int64","id":9},"eventType":{"type":"string","id":10},"localSdp":{"type":"string","id":11},"remoteSdp":{"type":"string","id":12},"extend":{"type":"string","id":13},"errorCode":{"type":"string","id":14},"eventElapse":{"type":"int64","id":15},"video":{"type":"bool","id":16},"audio":{"type":"bool","id":17},"subscribeRequestid":{"type":"int32","id":18},"p2pid":{"type":"int32","id":19}}},"Publish":{"fields":{"sid":{"type":"string","id":1},"cname":{"type":"string","id":2},"cid":{"type":"int64","id":3},"lts":{"type":"int64","id":4},"ip":{"type":"string","id":5},"uid":{"type":"int64","id":6},"success":{"type":"bool","id":7},"elapse":{"type":"int64","id":8},"peer":{"type":"int64","id":9},"eventType":{"type":"string","id":10},"localSdp":{"type":"string","id":11},"remoteSdp":{"type":"string","id":12},"extend":{"type":"string","id":13},"errorCode":{"type":"string","id":14},"eventElapse":{"type":"int64","id":15},"videoName":{"type":"string","id":16},"audioName":{"type":"string","id":17},"screenName":{"type":"string","id":18},"video":{"type":"bool","id":19},"audio":{"type":"bool","id":20},"publishRequestid":{"type":"int32","id":21},"p2pid":{"type":"int32","id":22},"screenshare":{"type":"bool","id":23}}},"FirstFrame":{"fields":{"sid":{"type":"string","id":1},"cname":{"type":"string","id":2},"cid":{"type":"int64","id":3},"lts":{"type":"int64","id":4},"ip":{"type":"string","id":5},"uid":{"type":"int64","id":6},"success":{"type":"bool","id":7},"elapse":{"type":"int64","id":8},"peer":{"type":"int64","id":9},"eventType":{"type":"string","id":10},"extend":{"type":"string","id":11},"errorCode":{"type":"string","id":12},"width":{"type":"int64","id":13},"height":{"type":"int64","id":14}}},"StreamSwitch":{"fields":{"sid":{"type":"string","id":1},"cname":{"type":"string","id":2},"cid":{"type":"int64","id":3},"lts":{"type":"int64","id":4},"ip":{"type":"string","id":5},"uid":{"type":"int64","id":6},"success":{"type":"bool","id":7},"elapse":{"type":"int64","id":8},"peer":{"type":"int64","id":9},"eventType":{"type":"string","id":10},"isDual":{"type":"bool","id":11}}},"AudioSendingStopped":{"fields":{"sid":{"type":"string","id":1},"cname":{"type":"string","id":2},"cid":{"type":"int64","id":3},"lts":{"type":"int64","id":4},"ip":{"type":"string","id":5},"uid":{"type":"int64","id":6},"success":{"type":"bool","id":7},"elapse":{"type":"int64","id":8},"peer":{"type":"int64","id":9},"reason":{"type":"string","id":10},"eventType":{"type":"string","id":11}}},"VideoSendingStopped":{"fields":{"sid":{"type":"string","id":1},"cname":{"type":"string","id":2},"cid":{"type":"int64","id":3},"lts":{"type":"int64","id":4},"ip":{"type":"string","id":5},"uid":{"type":"int64","id":6},"success":{"type":"bool","id":7},"elapse":{"type":"int64","id":8},"peer":{"type":"int64","id":9},"reason":{"type":"string","id":10},"eventType":{"type":"string","id":11}}},"RequestProxyAppCenter":{"fields":{"sid":{"type":"string","id":1},"cname":{"type":"string","id":2},"cid":{"type":"int64","id":3},"lts":{"type":"int64","id":4},"ip":{"type":"string","id":5},"uid":{"type":"int64","id":6},"success":{"type":"bool","id":7},"elapse":{"type":"int64","id":8},"peer":{"type":"int64","id":9},"eventType":{"type":"string","id":10},"APAddr":{"type":"string","id":11},"workerManagerList":{"type":"string","id":12},"errorCode":{"type":"string","id":13},"eventElapse":{"type":"int64","id":14},"extend":{"type":"string","id":15},"response":{"type":"string","id":16}}},"RequestProxyWorkerManager":{"fields":{"sid":{"type":"string","id":1},"cname":{"type":"string","id":2},"cid":{"type":"int64","id":3},"lts":{"type":"int64","id":4},"ip":{"type":"string","id":5},"uid":{"type":"int64","id":6},"success":{"type":"bool","id":7},"elapse":{"type":"int64","id":8},"peer":{"type":"int64","id":9},"eventType":{"type":"string","id":10},"workerManagerAddr":{"type":"string","id":11},"errorCode":{"type":"string","id":12},"eventElapse":{"type":"int64","id":13},"extend":{"type":"string","id":14},"response":{"type":"string","id":15}}},"ApiInvoke":{"fields":{"sid":{"type":"string","id":1},"cname":{"type":"string","id":2},"cid":{"type":"int64","id":3},"lts":{"type":"int64","id":4},"ip":{"type":"string","id":5},"uid":{"type":"int64","id":6},"success":{"type":"bool","id":7},"elapse":{"type":"int64","id":8},"apiName":{"type":"string","id":9},"errorCode":{"type":"string","id":10},"options":{"type":"string","id":11},"execElapse":{"type":"int64","id":12},"execStates":{"type":"string","id":13},"execResult":{"type":"string","id":14},"invokeId":{"type":"int64","id":15}}},"ReqUserAccount":{"fields":{"sid":{"type":"string","id":1},"cname":{"type":"string","id":2},"cid":{"type":"int64","id":3},"lts":{"type":"int64","id":4},"ip":{"type":"string","id":5},"uid":{"type":"int64","id":6},"success":{"type":"bool","id":7},"elapse":{"type":"int64","id":8},"eventType":{"type":"string","id":9},"serverAddress":{"type":"string","id":10},"stringUid":{"type":"string","id":11},"errorCode":{"type":"string","id":12},"extend":{"type":"string","id":13}}},"FirstVideoReceived":{"fields":{"lts":{"type":"int64","id":1},"peer":{"type":"int64","id":2},"elapse":{"type":"int64","id":3},"sid":{"type":"string","id":4},"cname":{"type":"string","id":5},"cid":{"type":"int64","id":6},"uid":{"type":"int64","id":8},"subscribeRequestid":{"type":"int32","id":9},"p2pid":{"type":"int32","id":10},"subscribeElapse":{"type":"int64","id":11}}},"FirstAudioReceived":{"fields":{"lts":{"type":"int64","id":1},"sid":{"type":"string","id":2},"cname":{"type":"string","id":3},"cid":{"type":"int64","id":4},"uid":{"type":"int64","id":6},"peer":{"type":"int64","id":7},"elapse":{"type":"int64","id":8},"subscribeRequestid":{"type":"int32","id":9},"p2pid":{"type":"int32","id":10},"subscribeElapse":{"type":"int64","id":11}}},"FirstVideoDecode":{"fields":{"lts":{"type":"int64","id":1},"sid":{"type":"string","id":2},"cname":{"type":"string","id":3},"cid":{"type":"int64","id":4},"uid":{"type":"int64","id":6},"peer":{"type":"int64","id":7},"elapse":{"type":"int64","id":8},"videowidth":{"type":"int32","id":9},"videoheight":{"type":"int32","id":10},"subscribeRequestid":{"type":"int32","id":11},"p2pid":{"type":"int32","id":12},"subscribeElapse":{"type":"int64","id":13}}},"FirstAudioDecode":{"fields":{"lts":{"type":"int64","id":1},"sid":{"type":"string","id":2},"cname":{"type":"string","id":3},"cid":{"type":"int64","id":4},"uid":{"type":"int64","id":6},"peer":{"type":"int64","id":7},"elapse":{"type":"int64","id":8},"subscribeRequestid":{"type":"int32","id":9},"p2pid":{"type":"int32","id":10},"subscribeElapse":{"type":"int64","id":11}}},"OnAddAudioStream":{"fields":{"lts":{"type":"int64","id":1},"sid":{"type":"string","id":2},"cname":{"type":"string","id":3},"cid":{"type":"int64","id":4},"uid":{"type":"int64","id":6},"peer":{"type":"int64","id":7}}},"OnAddVideoStream":{"fields":{"lts":{"type":"int64","id":1},"sid":{"type":"string","id":2},"cname":{"type":"string","id":3},"cid":{"type":"int64","id":4},"uid":{"type":"int64","id":6},"peer":{"type":"int64","id":7}}},"OnRemoveStream":{"fields":{"lts":{"type":"int64","id":1},"sid":{"type":"string","id":2},"cname":{"type":"string","id":3},"cid":{"type":"int64","id":4},"uid":{"type":"int64","id":6},"peer":{"type":"int64","id":7}}},"OnUpdateStream":{"fields":{"lts":{"type":"int64","id":1},"sid":{"type":"string","id":2},"cname":{"type":"string","id":3},"cid":{"type":"int64","id":4},"uid":{"type":"int64","id":6},"peer":{"type":"int64","id":7},"audio":{"type":"bool","id":8},"video":{"type":"bool","id":9}}},"JoinChannelTimeout":{"fields":{"lts":{"type":"int64","id":1},"sid":{"type":"string","id":2},"cname":{"type":"string","id":3},"cid":{"type":"int64","id":4},"uid":{"type":"int64","id":5},"elapse":{"type":"int64","id":6},"timeout":{"type":"int32","id":7}}},"PeerPublishStatus":{"fields":{"lts":{"type":"int64","id":1},"sid":{"type":"string","id":2},"cname":{"type":"string","id":3},"cid":{"type":"int64","id":4},"uid":{"type":"int64","id":5},"peer":{"type":"int64","id":6},"elapse":{"type":"int64","id":7},"peerPublishDuration":{"type":"int64","id":8},"joinChannelSuccessElapse":{"type":"int64","id":9},"subscribeElapse":{"type":"int64","id":10},"audiotag":{"type":"int32","id":11},"videotag":{"type":"int32","id":12},"screensharetag":{"type":"int32","id":13},"firsttimetag":{"type":"int32","id":14}}},"WebSocketQuit":{"fields":{"lts":{"type":"int64","id":1},"sid":{"type":"string","id":2},"cname":{"type":"string","id":3},"cid":{"type":"int64","id":4},"uid":{"type":"int64","id":5},"elapse":{"type":"int64","id":6},"succ":{"type":"int32","id":7},"errorCode":{"type":"string","id":8},"ip":{"type":"string","id":9}}},"Message":{"fields":{"id":{"type":"int64","id":1},"msg":{"type":"bytes","id":2}}},"ProtoRaws":{"fields":{"sendTs":{"type":"int64","id":1},"payloads":{"rule":"repeated","type":"Message","id":2},"vid":{"type":"int32","id":3}}},"APWorkerEvent":{"fields":{"sid":{"type":"string","id":1},"cname":{"type":"string","id":2},"cid":{"type":"int64","id":3},"lts":{"type":"int64","id":4},"ip":{"type":"string","id":5},"uid":{"type":"int64","id":6},"success":{"type":"bool","id":7},"elapse":{"type":"int64","id":8},"peer":{"type":"int64","id":9},"ec":{"type":"int32","id":10},"sc":{"type":"int32","id":11},"serverIp":{"type":"string","id":12},"firstSuccess":{"type":"bool","id":13},"responseTime":{"type":"int32","id":14},"serviceName":{"type":"string","id":15},"responseDetail":{"type":"string","id":16}}},"WorkerEvent":{"fields":{"sid":{"type":"string","id":1},"cname":{"type":"string","id":2},"cid":{"type":"int64","id":3},"lts":{"type":"int64","id":4},"ip":{"type":"string","id":5},"uid":{"type":"int64","id":6},"success":{"type":"bool","id":7},"elapse":{"type":"int64","id":8},"peer":{"type":"int64","id":9},"command":{"type":"string","id":10},"actionType":{"type":"string","id":11},"url":{"type":"string","id":12},"payload":{"type":"string","id":13},"serverCode":{"type":"int32","id":14},"code":{"type":"int32","id":15},"traceId":{"type":"string","id":16},"workerType":{"type":"int32","id":17},"responseTime":{"type":"int32","id":18},"requestId":{"type":"int64","id":19},"packIndex":{"type":"int32","id":20},"requestByUser":{"type":"bool","id":21},"tid":{"type":"string","id":22}}},"JoinWebProxyAP":{"fields":{"lts":{"type":"int64","id":1},"sid":{"type":"string","id":2},"cname":{"type":"string","id":3},"cid":{"type":"int64","id":4},"ip":{"type":"string","id":5},"uid":{"type":"int64","id":6},"sucess":{"type":"int32","id":7},"elapse":{"type":"int64","id":8},"eventType":{"type":"string","id":9},"apServerAddr":{"type":"string","id":10},"turnServerAddrList":{"type":"string","id":11},"errorCode":{"type":"string","id":12}}}}}}}')},function(se,ee,x){var I=function(C){"use strict";var w=Object.prototype,b=w.hasOwnProperty,D="function"==typeof Symbol?Symbol:{},m=D.iterator||"@@iterator",R=D.asyncIterator||"@@asyncIterator",f=D.toStringTag||"@@toStringTag";function g(S,c,z,d){var Z,ce,re,U,L=Object.create((c&&c.prototype instanceof j?c:j).prototype),$=new _(d||[]);return L._invoke=(Z=S,ce=z,re=$,U="suspendedStart",function(V,q){if("executing"===U)throw new Error("Generator is already running");if("completed"===U){if("throw"===V)throw q;return{value:void 0,done:!0}}for(re.method=V,re.arg=q;;){var pe=re.delegate;if(pe){var oe=Y(pe,re);if(oe){if(oe===M)continue;return oe}}if("next"===re.method)re.sent=re._sent=re.arg;else if("throw"===re.method){if("suspendedStart"===U)throw U="completed",re.arg;re.dispatchException(re.arg)}else"return"===re.method&&re.abrupt("return",re.arg);U="executing";var de=y(Z,ce,re);if("normal"===de.type){if(U=re.done?"completed":"suspendedYield",de.arg===M)continue;return{value:de.arg,done:re.done}}"throw"===de.type&&(U="completed",re.method="throw",re.arg=de.arg)}}),L}function y(S,c,z){try{return{type:"normal",arg:S.call(c,z)}}catch(d){return{type:"throw",arg:d}}}C.wrap=g;var M={};function j(){}function A(){}function E(){}var F={};F[m]=function(){return this};var N=Object.getPrototypeOf,H=N&&N(N(u([])));H&&H!==w&&b.call(H,m)&&(F=H);var O=E.prototype=j.prototype=Object.create(F);function J(S){["next","throw","return"].forEach(function(c){S[c]=function(z){return this._invoke(c,z)}})}function te(S,c){var z;this._invoke=function(d,T){function L(){return new c(function($,Z){!function ce(re,U,V,q){var pe=y(S[re],S,U);if("throw"!==pe.type){var oe=pe.arg,de=oe.value;return de&&"object"==typeof de&&b.call(de,"__await")?c.resolve(de.__await).then(function(ye){ce("next",ye,V,q)},function(ye){ce("throw",ye,V,q)}):c.resolve(de).then(function(ye){oe.value=ye,V(oe)},function(ye){return ce("throw",ye,V,q)})}q(pe.arg)}(d,T,$,Z)})}return z=z?z.then(L,L):L()}}function Y(S,c){var z=S.iterator[c.method];if(void 0===z){if(c.delegate=null,"throw"===c.method){if(S.iterator.return&&(c.method="return",c.arg=void 0,Y(S,c),"throw"===c.method))return M;c.method="throw",c.arg=new TypeError("The iterator does not provide a 'throw' method")}return M}var d=y(z,S.iterator,c.arg);if("throw"===d.type)return c.method="throw",c.arg=d.arg,c.delegate=null,M;var T=d.arg;return T?T.done?(c[S.resultName]=T.value,c.next=S.nextLoc,"return"!==c.method&&(c.method="next",c.arg=void 0),c.delegate=null,M):T:(c.method="throw",c.arg=new TypeError("iterator result is not an object"),c.delegate=null,M)}function ne(S){var c={tryLoc:S[0]};1 in S&&(c.catchLoc=S[1]),2 in S&&(c.finallyLoc=S[2],c.afterLoc=S[3]),this.tryEntries.push(c)}function G(S){var c=S.completion||{};c.type="normal",delete c.arg,S.completion=c}function _(S){this.tryEntries=[{tryLoc:"root"}],S.forEach(ne,this),this.reset(!0)}function u(S){if(S){var c=S[m];if(c)return c.call(S);if("function"==typeof S.next)return S;if(!isNaN(S.length)){var z=-1,d=function T(){for(;++z<S.length;)if(b.call(S,z))return T.value=S[z],T.done=!1,T;return T.value=void 0,T.done=!0,T};return d.next=d}}return{next:B}}function B(){return{value:void 0,done:!0}}return A.prototype=O.constructor=E,E.constructor=A,E[f]=A.displayName="GeneratorFunction",C.isGeneratorFunction=function(S){var c="function"==typeof S&&S.constructor;return!!c&&(c===A||"GeneratorFunction"===(c.displayName||c.name))},C.mark=function(S){return Object.setPrototypeOf?Object.setPrototypeOf(S,E):(S.__proto__=E,f in S||(S[f]="GeneratorFunction")),S.prototype=Object.create(O),S},C.awrap=function(S){return{__await:S}},J(te.prototype),te.prototype[R]=function(){return this},C.AsyncIterator=te,C.async=function(S,c,z,d,T){void 0===T&&(T=Promise);var L=new te(g(S,c,z,d),T);return C.isGeneratorFunction(c)?L:L.next().then(function($){return $.done?$.value:L.next()})},J(O),O[f]="Generator",O[m]=function(){return this},O.toString=function(){return"[object Generator]"},C.keys=function(S){var c=[];for(var z in S)c.push(z);return c.reverse(),function d(){for(;c.length;){var T=c.pop();if(T in S)return d.value=T,d.done=!1,d}return d.done=!0,d}},C.values=u,_.prototype={constructor:_,reset:function(S){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(G),!S)for(var c in this)"t"===c.charAt(0)&&b.call(this,c)&&!isNaN(+c.slice(1))&&(this[c]=void 0)},stop:function(){this.done=!0;var S=this.tryEntries[0].completion;if("throw"===S.type)throw S.arg;return this.rval},dispatchException:function(S){if(this.done)throw S;var c=this;function z(ce,re){return L.type="throw",L.arg=S,c.next=ce,re&&(c.method="next",c.arg=void 0),!!re}for(var d=this.tryEntries.length-1;d>=0;--d){var T=this.tryEntries[d],L=T.completion;if("root"===T.tryLoc)return z("end");if(T.tryLoc<=this.prev){var $=b.call(T,"catchLoc"),Z=b.call(T,"finallyLoc");if($&&Z){if(this.prev<T.catchLoc)return z(T.catchLoc,!0);if(this.prev<T.finallyLoc)return z(T.finallyLoc)}else if($){if(this.prev<T.catchLoc)return z(T.catchLoc,!0)}else{if(!Z)throw new Error("try statement without catch or finally");if(this.prev<T.finallyLoc)return z(T.finallyLoc)}}}},abrupt:function(S,c){for(var z=this.tryEntries.length-1;z>=0;--z){var d=this.tryEntries[z];if(d.tryLoc<=this.prev&&b.call(d,"finallyLoc")&&this.prev<d.finallyLoc){var T=d;break}}T&&("break"===S||"continue"===S)&&T.tryLoc<=c&&c<=T.finallyLoc&&(T=null);var L=T?T.completion:{};return L.type=S,L.arg=c,T?(this.method="next",this.next=T.finallyLoc,M):this.complete(L)},complete:function(S,c){if("throw"===S.type)throw S.arg;return"break"===S.type||"continue"===S.type?this.next=S.arg:"return"===S.type?(this.rval=this.arg=S.arg,this.method="return",this.next="end"):"normal"===S.type&&c&&(this.next=c),M},finish:function(S){for(var c=this.tryEntries.length-1;c>=0;--c){var z=this.tryEntries[c];if(z.finallyLoc===S)return this.complete(z.completion,z.afterLoc),G(z),M}},catch:function(S){for(var c=this.tryEntries.length-1;c>=0;--c){var z=this.tryEntries[c];if(z.tryLoc===S){var d=z.completion;if("throw"===d.type){var T=d.arg;G(z)}return T}}throw new Error("illegal catch attempt")},delegateYield:function(S,c,z){return this.delegate={iterator:u(S),resultName:c,nextLoc:z},"next"===this.method&&(this.arg=void 0),M}},C}(se.exports);try{regeneratorRuntime=I}catch(C){Function("r","regeneratorRuntime = r")(I)}},function(se,ee){se.exports=function(x){if(Array.isArray(x))return x}},function(se,ee){se.exports=function(x,I){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(x)){var C=[],w=!0,b=!1,D=void 0;try{for(var m,R=x[Symbol.iterator]();!(w=(m=R.next()).done)&&(C.push(m.value),!I||C.length!==I);w=!0);}catch(f){b=!0,D=f}finally{try{w||null==R.return||R.return()}finally{if(b)throw D}}return C}}},function(se,ee){se.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(se,ee,x){"use strict";Object.defineProperty(ee,"__esModule",{value:!0});var I="object"==typeof window&&window.RTCPeerConnection,C="object"==typeof window&&window.webkitRTCPeerConnection,w="object"==typeof window&&window.mozRTCPeerConnection;ee.createRTCPeerConnection=function(b){var D=I||C||w;return D?new D(b):null}},function(se,ee,x){var I;!function(C){"use strict";function w(){}var b=w.prototype,D=C.EventEmitter;function m(f,g){for(var y=f.length;y--;)if(f[y].listener===g)return y;return-1}function R(f){return function(){return this[f].apply(this,arguments)}}b.getListeners=function(f){var g,y,M=this._getEvents();if(f instanceof RegExp)for(y in g={},M)M.hasOwnProperty(y)&&f.test(y)&&(g[y]=M[y]);else g=M[f]||(M[f]=[]);return g},b.flattenListeners=function(f){var g,y=[];for(g=0;g<f.length;g+=1)y.push(f[g].listener);return y},b.getListenersAsObject=function(f){var g,y=this.getListeners(f);return y instanceof Array&&((g={})[f]=y),g||y},b.addListener=function(f,g){if(!function A(E){return"function"==typeof E||E instanceof RegExp||!(!E||"object"!=typeof E)&&A(E.listener)}(g))throw new TypeError("listener must be a function");var y,M=this.getListenersAsObject(f),j="object"==typeof g;for(y in M)M.hasOwnProperty(y)&&-1===m(M[y],g)&&M[y].push(j?g:{listener:g,once:!1});return this},b.on=R("addListener"),b.addOnceListener=function(f,g){return this.addListener(f,{listener:g,once:!0})},b.once=R("addOnceListener"),b.defineEvent=function(f){return this.getListeners(f),this},b.defineEvents=function(f){for(var g=0;g<f.length;g+=1)this.defineEvent(f[g]);return this},b.removeListener=function(f,g){var y,M,j=this.getListenersAsObject(f);for(M in j)j.hasOwnProperty(M)&&-1!==(y=m(j[M],g))&&j[M].splice(y,1);return this},b.off=R("removeListener"),b.addListeners=function(f,g){return this.manipulateListeners(!1,f,g)},b.removeListeners=function(f,g){return this.manipulateListeners(!0,f,g)},b.manipulateListeners=function(f,g,y){var M,j,A=f?this.removeListener:this.addListener,E=f?this.removeListeners:this.addListeners;if("object"!=typeof g||g instanceof RegExp)for(M=y.length;M--;)A.call(this,g,y[M]);else for(M in g)g.hasOwnProperty(M)&&(j=g[M])&&("function"==typeof j?A.call(this,M,j):E.call(this,M,j));return this},b.removeEvent=function(f){var g,y=typeof f,M=this._getEvents();if("string"===y)delete M[f];else if(f instanceof RegExp)for(g in M)M.hasOwnProperty(g)&&f.test(g)&&delete M[g];else delete this._events;return this},b.removeAllListeners=R("removeEvent"),b.emitEvent=function(f,g){var y,M,j,A,E=this.getListenersAsObject(f);for(A in E)if(E.hasOwnProperty(A))for(y=E[A].slice(0),j=0;j<y.length;j++)!0===(M=y[j]).once&&this.removeListener(f,M.listener),M.listener.apply(this,g||[])===this._getOnceReturnValue()&&this.removeListener(f,M.listener);return this},b.trigger=R("emitEvent"),b.emit=function(f){var g=Array.prototype.slice.call(arguments,1);return this.emitEvent(f,g)},b.setOnceReturnValue=function(f){return this._onceReturnValue=f,this},b._getOnceReturnValue=function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue},b._getEvents=function(){return this._events||(this._events={})},w.noConflict=function(){return C.EventEmitter=D,w},void 0===(I=function(){return w}.call(C,x,C,se))||(se.exports=I)}("undefined"!=typeof window?window:this||{})},function(se,ee,x){var I=x(35);se.exports=function(C){if(Array.isArray(C))return I(C)}},function(se,ee){se.exports=function(x){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(x))return Array.from(x)}},function(se,ee){se.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(se,ee,x){(function(I){var C;se.exports=(C=C||function(w,b){var D;if("undefined"!=typeof window&&window.crypto&&(D=window.crypto),"undefined"!=typeof self&&self.crypto&&(D=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(D=globalThis.crypto),!D&&"undefined"!=typeof window&&window.msCrypto&&(D=window.msCrypto),!D&&void 0!==I&&I.crypto&&(D=I.crypto),!D)try{D=x(74)}catch(O){}var m=function(){if(D){if("function"==typeof D.getRandomValues)try{return D.getRandomValues(new Uint32Array(1))[0]}catch(O){}if("function"==typeof D.randomBytes)try{return D.randomBytes(4).readInt32LE()}catch(O){}}throw new Error("Native crypto module could not be used to get secure random number.")},R=Object.create||function(){function O(){}return function(J){var te;return O.prototype=J,te=new O,O.prototype=null,te}}(),f={},g=f.lib={},y=g.Base={extend:function(O){var J=R(this);return O&&J.mixIn(O),J.hasOwnProperty("init")&&this.init!==J.init||(J.init=function(){J.$super.init.apply(this,arguments)}),J.init.prototype=J,J.$super=this,J},create:function(){var O=this.extend();return O.init.apply(O,arguments),O},init:function(){},mixIn:function(O){for(var J in O)O.hasOwnProperty(J)&&(this[J]=O[J]);O.hasOwnProperty("toString")&&(this.toString=O.toString)},clone:function(){return this.init.prototype.extend(this)}},M=g.WordArray=y.extend({init:function(O,J){O=this.words=O||[],this.sigBytes=null!=J?J:4*O.length},toString:function(O){return(O||A).stringify(this)},concat:function(O){var J=this.words,te=O.words,Y=this.sigBytes,ne=O.sigBytes;if(this.clamp(),Y%4)for(var G=0;G<ne;G++)J[Y+G>>>2]|=(te[G>>>2]>>>24-G%4*8&255)<<24-(Y+G)%4*8;else for(var u=0;u<ne;u+=4)J[Y+u>>>2]=te[u>>>2];return this.sigBytes+=ne,this},clamp:function(){var O=this.words,J=this.sigBytes;O[J>>>2]&=4294967295<<32-J%4*8,O.length=w.ceil(J/4)},clone:function(){var O=y.clone.call(this);return O.words=this.words.slice(0),O},random:function(O){for(var J=[],te=0;te<O;te+=4)J.push(m());return new M.init(J,O)}}),j=f.enc={},A=j.Hex={stringify:function(O){for(var J=O.words,te=O.sigBytes,Y=[],ne=0;ne<te;ne++){var G=J[ne>>>2]>>>24-ne%4*8&255;Y.push((G>>>4).toString(16)),Y.push((15&G).toString(16))}return Y.join("")},parse:function(O){for(var J=O.length,te=[],Y=0;Y<J;Y+=2)te[Y>>>3]|=parseInt(O.substr(Y,2),16)<<24-Y%8*4;return new M.init(te,J/2)}},E=j.Latin1={stringify:function(O){for(var J=O.words,te=O.sigBytes,Y=[],ne=0;ne<te;ne++)Y.push(String.fromCharCode(J[ne>>>2]>>>24-ne%4*8&255));return Y.join("")},parse:function(O){for(var J=O.length,te=[],Y=0;Y<J;Y++)te[Y>>>2]|=(255&O.charCodeAt(Y))<<24-Y%4*8;return new M.init(te,J)}},F=j.Utf8={stringify:function(O){try{return decodeURIComponent(escape(E.stringify(O)))}catch(J){throw new Error("Malformed UTF-8 data")}},parse:function(O){return E.parse(unescape(encodeURIComponent(O)))}},N=g.BufferedBlockAlgorithm=y.extend({reset:function(){this._data=new M.init,this._nDataBytes=0},_append:function(O){"string"==typeof O&&(O=F.parse(O)),this._data.concat(O),this._nDataBytes+=O.sigBytes},_process:function(O){var J,te=this._data,Y=te.words,ne=te.sigBytes,G=this.blockSize,_=ne/(4*G),u=(_=O?w.ceil(_):w.max((0|_)-this._minBufferSize,0))*G,B=w.min(4*u,ne);if(u){for(var S=0;S<u;S+=G)this._doProcessBlock(Y,S);J=Y.splice(0,u),te.sigBytes-=B}return new M.init(J,B)},clone:function(){var O=y.clone.call(this);return O._data=this._data.clone(),O},_minBufferSize:0}),H=(g.Hasher=N.extend({cfg:y.extend(),init:function(O){this.cfg=this.cfg.extend(O),this.reset()},reset:function(){N.reset.call(this),this._doReset()},update:function(O){return this._append(O),this._process(),this},finalize:function(O){return O&&this._append(O),this._doFinalize()},blockSize:16,_createHelper:function(O){return function(J,te){return new O.init(te).finalize(J)}},_createHmacHelper:function(O){return function(J,te){return new H.HMAC.init(O,te).finalize(J)}}}),f.algo={});return f}(Math),C)}).call(this,x(33))},function(se,ee){},function(se,ee,x){"use strict";var I=this&&this.__assign||function(){return(I=Object.assign||function(E){for(var F,N=1,H=arguments.length;N<H;N++)for(var O in F=arguments[N])Object.prototype.hasOwnProperty.call(F,O)&&(E[O]=F[O]);return E}).apply(this,arguments)},C=this&&this.__awaiter||function(E,F,N,H){return new(N||(N=Promise))(function(O,J){function te(G){try{ne(H.next(G))}catch(_){J(_)}}function Y(G){try{ne(H.throw(G))}catch(_){J(_)}}function ne(G){var _;G.done?O(G.value):(_=G.value,_ instanceof N?_:new N(function(u){u(_)})).then(te,Y)}ne((H=H.apply(E,F||[])).next())})},w=this&&this.__generator||function(E,F){var N,H,O,J,te={label:0,sent:function(){if(1&O[0])throw O[1];return O[1]},trys:[],ops:[]};return J={next:Y(0),throw:Y(1),return:Y(2)},"function"==typeof Symbol&&(J[Symbol.iterator]=function(){return this}),J;function Y(ne){return function(G){return function(_){if(N)throw new TypeError("Generator is already executing.");for(;te;)try{if(N=1,H&&(O=2&_[0]?H.return:_[0]?H.throw||((O=H.return)&&O.call(H),0):H.next)&&!(O=O.call(H,_[1])).done)return O;switch(H=0,O&&(_=[2&_[0],O.value]),_[0]){case 0:case 1:O=_;break;case 4:return te.label++,{value:_[1],done:!1};case 5:te.label++,H=_[1],_=[0];continue;case 7:_=te.ops.pop(),te.trys.pop();continue;default:if(!((O=(O=te.trys).length>0&&O[O.length-1])||6!==_[0]&&2!==_[0])){te=0;continue}if(3===_[0]&&(!O||_[1]>O[0]&&_[1]<O[3])){te.label=_[1];break}if(6===_[0]&&te.label<O[1]){te.label=O[1],O=_;break}if(O&&te.label<O[2]){te.label=O[2],te.ops.push(_);break}O[2]&&te.ops.pop(),te.trys.pop();continue}_=F.call(E,te)}catch(u){_=[6,u],H=0}finally{N=O=0}if(5&_[0])throw _[1];return{value:_[0]?_[1]:void 0,done:!0}}([ne,G])}}},b=this&&this.__importDefault||function(E){return E&&E.__esModule?E:{default:E}};Object.defineProperty(ee,"__esModule",{value:!0});var D=x(76),m=x(27),R=x(95),f=x(20),g=x(24),y=x(31),M=b(x(0)),j=b(x(37)),A=function(){function E(F){this.retryTimeout=1e4,this.streamingTasks=new Map,this.isStartingStreamingTask=!1,this.taskMutex=new R.PromiseMutex("LS"),this.cancelToken=j.default.CancelToken.source(),this.injectConfig=I({},m.DEFAULT_INJECT_CONFIG),this.injectLoopTimes=0,this.lastTaskId=1,this.statusError=new Map,this.spec=F}return Object.defineProperty(E.prototype,"isNeedReset",{get:function(){for(var F=this,N=0,H=Array.from(this.streamingTasks.values());N<H.length;N++){var O=H[N];if(O.mode===m.LiveStreamingServiceMode.INJECT||O.mode===m.LiveStreamingServiceMode.TRANSCODE&&(this.transcodingConfig&&(this.transcodingConfig.userConfigs||this.transcodingConfig.transcodingUsers)||[]).find(function(J){return J.uid===F.spec.uid}))return!0}return!1},enumerable:!0,configurable:!0}),E.prototype.setTranscodingConfig=function(F){return C(this,void 0,void 0,function(){var N,H,O,J,te,Y=this;return w(this,function(ne){switch(ne.label){case 0:(N=I(I({},m.DEFAULT_TRANSCODING_CONFIG),F)).transcodingUsers||(N.transcodingUsers=N.userConfigs),66!==N.videoCodecProfile&&77!==N.videoCodecProfile&&100!==N.videoCodecProfile&&(M.default.debug("["+this.spec.clientId+"] set transcoding config, fix video codec profile: "+N.videoCodecProfile+" -> 100"),N.videoCodecProfile=100),N.transcodingUsers&&(N.transcodingUsers=N.transcodingUsers.map(function(G){return I(I(I({},m.DEFAULT_LIVE_STREAMING_TRANSCODING_USER),G),{zOrder:G.zOrder?G.zOrder+1:1})})),N.images&&(N.images=N.images.map(function(G){return I(I({},m.DEFAULT_LIVE_STREAMING_TRANSCODING_WATERMARK),G)}));try{m.isLiveStreamingTranscodingConfig(N)}catch(G){throw G}return N.transcodingUsers&&(N.userConfigs=N.transcodingUsers.map(function(G){return I({},G)}),N.userCount=N.transcodingUsers.length,delete N.transcodingUsers),H=(N.userConfigs||[]).map(function(G){return"number"==typeof G.uid?Promise.resolve(G.uid):f.getUserAccount(Y.spec,null,G.uid)}),[4,this.taskMutex.lock()];case 1:return O=ne.sent(),[4,Promise.all(H)];case 2:if(ne.sent().forEach(function(G,_){N.userConfigs&&N.userConfigs[_]&&(N.userConfigs[_].uid=G&&G.uid||G)}),this.transcodingConfig=N,!this.connection)return O(),[2];ne.label=3;case 3:return ne.trys.push([3,5,,6]),[4,this.connection.request("request",{clientRequest:{command:"UpdateTranscoding",transcodingConfig:this.transcodingConfig}},!1,{command:"UpdateTranscoding",workerType:1,requestByUser:!0,tid:Array.from(this.streamingTasks.values()).map(function(G){return G.taskId}).join("#")})];case 4:return J=ne.sent(),O(),M.default.debug("["+this.spec.clientId+"] update live transcoding config success, code: "+J.code+", config:",JSON.stringify(this.transcodingConfig)),[3,6];case 5:if(te=ne.sent(),O(),!te.data||!te.data.retry)throw te;return te.data.changeAddress&&this.connection.tryNextAddress(),this.streamingTasks.forEach(function(G){M.default.warning("["+Y.spec.clientId+"] live streaming receive error",te.toString(),"try to republish",G.url),Y.startLiveStreamingTask(G.url,G.mode,te).then(function(){M.default.debug("["+Y.spec.clientId+"] live streaming republish "+G.url+" success")}).catch(function(_){M.default.error("["+Y.spec.clientId+"] live streaming republish failed",G.url,_.toString()),Y.onLiveStreamError&&Y.onLiveStreamError(G.url,_)})}),[3,6];case 6:return[2]}})})},E.prototype.setInjectStreamConfig=function(F,N){this.injectConfig=Object.assign({},this.injectConfig,F),this.injectLoopTimes=N},E.prototype.startLiveStreamingTask=function(F,N,H){return C(this,void 0,void 0,function(){var O,J,te,Y,ne,G,_,u,B=this;return w(this,function(S){switch(S.label){case 0:return Array.from(this.streamingTasks.values()).find(function(c){return c.mode===m.LiveStreamingServiceMode.INJECT})&&N===m.LiveStreamingServiceMode.INJECT?[2,new g.AgoraRTCError(g.AgoraRTCErrorCode.LIVE_STREAMING_TASK_CONFLICT,"inject stream over limit").throw()]:(O={command:"PublishStream",ts:Date.now(),url:F,uid:this.spec.uid.toString(),autoDestroyTime:30},M.default.debug("["+this.spec.clientId+"] start live streaming "+F+", mode: "+N),[4,this.taskMutex.lock()]);case 1:if(J=S.sent(),!this.transcodingConfig&&N===m.LiveStreamingServiceMode.TRANSCODE)throw J(),new g.AgoraRTCError(g.AgoraRTCErrorCode.INVALID_OPERATION,"[LiveStreaming] no transcoding config found, can not start transcoding streaming task");if(!this.connection&&H)return J(),[2];if(this.streamingTasks.get(F)&&!H)return J(),[2,new g.AgoraRTCError(g.AgoraRTCErrorCode.LIVE_STREAMING_TASK_CONFLICT).throw()];if(!this.transcodingConfig&&N===m.LiveStreamingServiceMode.TRANSCODE)throw J(),new g.AgoraRTCError(g.AgoraRTCErrorCode.INVALID_OPERATION,"[LiveStreaming] no transcoding config found, can not start transcoding streaming task");S.label=2;case 2:return S.trys.push([2,5,,6]),this.connection?[3,4]:(te=this,[4,this.connect(N)]);case 3:te.connection=S.sent(),S.label=4;case 4:return[3,6];case 5:throw Y=S.sent(),J(),Y;case 6:switch(N){case m.LiveStreamingServiceMode.TRANSCODE:O.transcodingConfig=I({},this.transcodingConfig);break;case m.LiveStreamingServiceMode.RAW:break;case m.LiveStreamingServiceMode.INJECT:O={cname:this.spec.cname,command:"InjectStream",sid:this.spec.sid,transcodingConfig:this.injectConfig,ts:Date.now(),url:F,loopTimes:this.injectLoopTimes}}this.uapResponse&&this.uapResponse.vid&&(O.vid=this.uapResponse.vid),this.isStartingStreamingTask=!0,ne=this.lastTaskId++,S.label=7;case 7:return S.trys.push([7,9,,14]),G=new Promise(function(c,z){y.wait(B.retryTimeout).then(function(){if(H)return z(H);var d=B.statusError.get(F);return d?(B.statusError.delete(F),z(d)):void 0})}),[4,Promise.race([this.connection.request("request",{clientRequest:O},!0,{url:F,command:"PublishStream",workerType:N===m.LiveStreamingServiceMode.TRANSCODE?1:2,requestByUser:!H,tid:ne.toString()}),G])];case 8:return _=S.sent(),this.isStartingStreamingTask=!1,M.default.debug("["+this.spec.clientId+"] live streaming started, code: "+_.code),this.streamingTasks.set(F,{clientRequest:O,mode:N,url:F,taskId:ne}),J(),[3,14];case 9:if(u=S.sent(),J(),this.isStartingStreamingTask=!1,!u.data||!u.data.retry||H)throw u;return u.data.changeAddress?[3,11]:[4,this.startLiveStreamingTask(F,N,u)];case 10:return[2,S.sent()];case 11:return this.connection.tryNextAddress(),[4,this.startLiveStreamingTask(F,N,u)];case 12:return[2,S.sent()];case 13:return[3,14];case 14:return[2]}})})},E.prototype.stopLiveStreamingTask=function(F){var N=this;return new Promise(function(H,O){var J=N.streamingTasks.get(F);if(!J||!N.connection)return new g.AgoraRTCError(g.AgoraRTCErrorCode.UNEXPECTED_ERROR,"can not find streaming task to stop").throw();var te=J.mode;J.abortTask=function(){M.default.debug("["+N.spec.clientId+"] stop live streaming success(worker exception)"),N.streamingTasks.delete(F),H()},M.default.debug("stop live streaming task request: "+JSON.stringify(F)),N.connection.request("request",{clientRequest:{command:te===m.LiveStreamingServiceMode.INJECT?"UninjectStream":"UnpublishStream",url:J.url}},!1,{url:F,command:"UnPublishStream",workerType:te===m.LiveStreamingServiceMode.TRANSCODE?1:2,requestByUser:!0,tid:(N.lastTaskId++).toString()}).then(function(Y){M.default.debug("["+N.spec.clientId+"] stop live streaming success, code: "+Y.code),N.streamingTasks.delete(F),0===N.streamingTasks.size&&te!==m.LiveStreamingServiceMode.INJECT&&(N.connection.close(),N.connection=void 0),H()}).catch(O)})},E.prototype.controlInjectStream=function(F,N,H,O){return C(this,void 0,void 0,function(){var J;return w(this,function(te){switch(te.label){case 0:if(!(J=this.streamingTasks.get(F))||!this.connection||J.mode!==m.LiveStreamingServiceMode.INJECT)throw new g.AgoraRTCError(g.AgoraRTCErrorCode.INVALID_OPERATION,"can not find inject stream task to control");return[4,this.connection.request("request",{clientRequest:{command:"ControlStream",url:F,control:N,audioVolume:H,position:O}})];case 1:return[2,te.sent().serverResponse]}})})},E.prototype.resetAllTask=function(){var F=this,N=Array.from(this.streamingTasks.values());this.terminate();for(var H=function(Y){O.startLiveStreamingTask(Y.url,Y.mode).catch(function(ne){F.onLiveStreamError&&F.onLiveStreamError(Y.url,ne)})},O=this,J=0,te=N;J<te.length;J++)H(te[J])},E.prototype.setGatewayConnectionState=function(F){this.connection&&(this.connection.gatewayConnectionState=F)},E.prototype.terminate=function(){this.cancelToken&&this.cancelToken.cancel(),this.streamingTasks=new Map,this.isStartingStreamingTask=!1,this.statusError=new Map,this.cancelToken=j.default.CancelToken.source(),this.uapResponse=void 0,this.connection&&this.connection.close(),this.connection=void 0},E.prototype.connect=function(F){return C(this,void 0,void 0,function(){var N,H=this;return w(this,function(O){switch(O.label){case 0:if(this.connection)throw new g.AgoraRTCError(g.AgoraRTCErrorCode.UNEXPECTED_ERROR,"live streaming connection has already connected");return[4,y.getLiveStreamingWorkerMangerResult(F,this.spec,this.cancelToken.token)];case 1:return N=O.sent(),this.uapResponse=N,this.connection=new D.AgoraLiveStreamingUapSignal(N.workerToken,this.spec,F),this.connection.on(m.LiveStreamingUapSignalEvents.WARNING,function(J,te){return H.onLiveStreamWarning&&H.onLiveStreamWarning(te,J)}),this.connection.on(m.LiveStreamingUapSignalEvents.PUBLISH_STREAM_STATUS,function(J){return H.handlePublishStreamServer(J)}),this.connection.on(m.LiveStreamingUapSignalEvents.INJECT_STREAM_STATUS,function(J){return H.handleInjectStreamServerStatus(J)}),this.connection.on(m.LiveStreamingUapSignalEvents.REQUEST_NEW_ADDRESS,function(J,te){if(!H.connection)return te(new g.AgoraRTCError(g.AgoraRTCErrorCode.UNEXPECTED_ERROR,"can not get new live streaming address list"));y.getLiveStreamingWorkerMangerResult(F,H.spec,H.cancelToken.token).then(function(Y){H.uapResponse=Y,J(Y.addressList)}).catch(te)}),[4,this.connection.init(N.addressList)];case 2:return O.sent(),[2,this.connection]}})})},E.prototype.handlePublishStreamServer=function(F){var N=this,H=F.serverStatus&&F.serverStatus.url;if(!H)throw new g.AgoraRTCError(g.AgoraRTCErrorCode.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"empty url",{code:F.code});var O=this.streamingTasks.get(H);switch(F.code){case m.LIVE_STREAM_ERROR_CODE.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case m.LIVE_STREAM_ERROR_CODE.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case m.LIVE_STREAM_ERROR_CODE.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case m.LIVE_STREAM_ERROR_CODE.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:var J=new g.AgoraRTCError(g.AgoraRTCErrorCode.LIVE_STREAMING_CDN_ERROR,"",{code:F.code});if(O)return M.default.error(J.toString()),this.onLiveStreamError&&this.onLiveStreamError(H,J);if(!this.isStartingStreamingTask)return;this.statusError.set(H,J);case m.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_WORKER_LOST:case m.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_WORKER_QUIT:if(!this.connection||0===this.streamingTasks.size)return;this.connection.tryNextAddress();for(var te=Array.from(this.streamingTasks.values()),Y=function(u){if(u.abortTask)return u.abortTask(),"continue";M.default.warning("["+ne.spec.clientId+"] publish stream status code",F.code,"try to republish",u.url),ne.startLiveStreamingTask(u.url,u.mode,new g.AgoraRTCError(g.AgoraRTCErrorCode.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:F.code})).then(function(){M.default.debug("["+N.spec.clientId+"] republish live stream success",u.url)}).catch(function(B){M.default.error(B.toString()),N.onLiveStreamError&&N.onLiveStreamError(u.url,B)})},ne=this,G=0,_=te;G<_.length;G++)Y(_[G]);return}},E.prototype.handleInjectStreamServerStatus=function(F){var N=Number(F.uid),H=F.serverStatus&&F.serverStatus.url;switch(F.code){case 200:return void(this.onInjectStatusChange&&this.onInjectStatusChange(0,N,H));case 451:return this.onInjectStatusChange&&this.onInjectStatusChange(1,N,H),void this.streamingTasks.delete(H);case 453:return this.onInjectStatusChange&&this.onInjectStatusChange(2,N,H),void this.streamingTasks.delete(H);case 470:return this.onInjectStatusChange&&this.onInjectStatusChange(10,N,H),void this.streamingTasks.delete(H);case 499:return this.onInjectStatusChange&&this.onInjectStatusChange(3,N,H),void this.streamingTasks.delete(H);default:return void M.default.debug("inject stream server status",F)}},E.prototype.haveUrl=function(F){return this.streamingTasks.has(F)||void 0},E}();ee.AgoraRTCLiveStreamingClient=A},function(se,ee,x){"use strict";var I,C=this&&this.__extends||(I=function(N,H){return(I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(O,J){O.__proto__=J}||function(O,J){for(var te in J)J.hasOwnProperty(te)&&(O[te]=J[te])})(N,H)},function(N,H){function O(){this.constructor=N}I(N,H),N.prototype=null===H?Object.create(H):(O.prototype=H.prototype,new O)}),w=this&&this.__assign||function(){return(w=Object.assign||function(N){for(var H,O=1,J=arguments.length;O<J;O++)for(var te in H=arguments[O])Object.prototype.hasOwnProperty.call(H,te)&&(N[te]=H[te]);return N}).apply(this,arguments)},b=this&&this.__awaiter||function(N,H,O,J){return new(O||(O=Promise))(function(te,Y){function ne(u){try{_(J.next(u))}catch(B){Y(B)}}function G(u){try{_(J.throw(u))}catch(B){Y(B)}}function _(u){var B;u.done?te(u.value):(B=u.value,B instanceof O?B:new O(function(S){S(B)})).then(ne,G)}_((J=J.apply(N,H||[])).next())})},D=this&&this.__generator||function(N,H){var O,J,te,Y,ne={label:0,sent:function(){if(1&te[0])throw te[1];return te[1]},trys:[],ops:[]};return Y={next:G(0),throw:G(1),return:G(2)},"function"==typeof Symbol&&(Y[Symbol.iterator]=function(){return this}),Y;function G(_){return function(u){return function(B){if(O)throw new TypeError("Generator is already executing.");for(;ne;)try{if(O=1,J&&(te=2&B[0]?J.return:B[0]?J.throw||((te=J.return)&&te.call(J),0):J.next)&&!(te=te.call(J,B[1])).done)return te;switch(J=0,te&&(B=[2&B[0],te.value]),B[0]){case 0:case 1:te=B;break;case 4:return ne.label++,{value:B[1],done:!1};case 5:ne.label++,J=B[1],B=[0];continue;case 7:B=ne.ops.pop(),ne.trys.pop();continue;default:if(!((te=(te=ne.trys).length>0&&te[te.length-1])||6!==B[0]&&2!==B[0])){ne=0;continue}if(3===B[0]&&(!te||B[1]>te[0]&&B[1]<te[3])){ne.label=B[1];break}if(6===B[0]&&ne.label<te[1]){ne.label=te[1],te=B;break}if(te&&ne.label<te[2]){ne.label=te[2],ne.ops.push(B);break}te[2]&&ne.ops.pop(),ne.trys.pop();continue}B=H.call(N,ne)}catch(S){B=[6,S],J=0}finally{O=te=0}if(5&B[0])throw B[1];return{value:B[0]?B[1]:void 0,done:!0}}([_,u])}}},m=this&&this.__importDefault||function(N){return N&&N.__esModule?N:{default:N}};Object.defineProperty(ee,"__esModule",{value:!0});var R=x(27),f=x(77),g=x(36),y=x(24),M=x(2),j=m(x(0)),A=x(1),E=x(31),F=function(N){function H(O,J,te){var Y=N.call(this)||this;return Y._gatewayConnectionState="CONNECTED",Y.reconnectMode="retry",Y.reqId=0,Y.commandReqId=0,Y.waitingResponseList=[],Y.handleWebSocketOpen=function(){Y.reconnectMode="retry",Y.startPingPong()},Y.handleWebSocketMessage=function(ne){if(ne.data){var G=JSON.parse(ne.data);if(G.requestId)Y.emit("@"+G.requestId,G);else if(Y.serviceMode===R.LiveStreamingServiceMode.INJECT)Y.emit(R.LiveStreamingUapSignalEvents.INJECT_STREAM_STATUS,G);else{A.report.requestWorkerEvent(Y.spec.sid,{actionType:"status",serverCode:G.code,workerType:Y.serviceMode===R.LiveStreamingServiceMode.TRANSCODE?1:2});var _=G.serverStatus&&G.serverStatus.url;_&&Y.waitingResponseList.includes(_)&&200===G.code&&Y.emit(_),Y.emit(R.LiveStreamingUapSignalEvents.PUBLISH_STREAM_STATUS,G)}}},Y.spec=J,Y.token=O,Y.serviceMode=te,Y.websocket=new f.AgoraWebSocketManager("live-streaming"),Y.websocket.on(R.WebSocketManagerEvents.CONNECTED,Y.handleWebSocketOpen),Y.websocket.on(R.WebSocketManagerEvents.ON_MESSAGE,Y.handleWebSocketMessage),Y.websocket.on(R.WebSocketManagerEvents.REQUEST_NEW_URLS,function(ne,G){g.emitAsPromise(Y,R.LiveStreamingUapSignalEvents.REQUEST_NEW_ADDRESS).then(ne).catch(G)}),Y.websocket.on(R.WebSocketManagerEvents.RECONNECTING,function(){Y.websocket.reconnectMode=Y.reconnectMode}),Y}return C(H,N),Object.defineProperty(H.prototype,"gatewayConnectionState",{get:function(){return this._gatewayConnectionState},set:function(O){this._gatewayConnectionState=O,"CONNECTED"===O&&this.emit("gateway-connected",O)},enumerable:!0,configurable:!0}),H.prototype.init=function(O){return this.websocket.init(O)},H.prototype.request=function(O,J,te,Y){return b(this,void 0,void 0,function(){var ne,G,_,u,B,S,c,z,d,T,L=this;return D(this,function($){switch($.label){case 0:if(this.reqId+=1,ne=this.reqId,"request"===O&&(this.commandReqId+=1),G=this.commandReqId,!ne||!this.websocket)throw new y.AgoraRTCError(y.AgoraRTCErrorCode.UNEXPECTED_ERROR);if(_=M.VERSION,"closed"===this.websocket.state)throw new y.AgoraRTCError(y.AgoraRTCErrorCode.WS_DISCONNECT);return u=function(){return new Promise(function(Z,ce){var re=function(){"CONNECTED"===L.gatewayConnectionState&&"connected"===L.websocket.state&&(L.off("gateway-connected",re),L.websocket.off(R.WebSocketManagerEvents.CONNECTED,re),Z(void 0))};L.on("gateway-connected",re),L.websocket.once(R.WebSocketManagerEvents.CLOSED,function(){return ce(new y.AgoraRTCError(y.AgoraRTCErrorCode.WS_ABORT))}),L.websocket.on(R.WebSocketManagerEvents.CONNECTED,re)})},"connected"===this.websocket.state&&"CONNECTED"===this.gatewayConnectionState?[3,2]:[4,u()];case 1:$.sent(),$.label=2;case 2:B=Promise.race([new Promise(function(Z,ce){var re=function(){ce(new y.AgoraRTCError(y.AgoraRTCErrorCode.WS_ABORT))};L.websocket.once(R.WebSocketManagerEvents.RECONNECTING,re),L.websocket.once(R.WebSocketManagerEvents.CLOSED,re),L.once("@"+ne,function(U){Z(U)})}),E.wait(M.getParameter("LIVE_STREAMING_TIMEOUT")).then(function(){return!1})]),(S=w({command:O,sdkVersion:_,seq:ne,requestId:ne,allocate:te,cname:this.spec.cname,appId:this.spec.appId,sid:this.spec.sid,uid:this.spec.uid.toString(),ts:Math.floor(Date.now()/1e3)},J)).clientRequest&&(S.clientRequest.workerToken=this.token),Y&&A.report.requestWorkerEvent(this.spec.sid,w(w({},Y),{requestId:G,actionType:"request",payload:JSON.stringify(J.clientRequest),serverCode:0,code:0})),c=Date.now(),this.websocket.sendMessage(S),z=null,$.label=3;case 3:return $.trys.push([3,5,,8]),[4,B];case 4:return z=$.sent(),[3,8];case 5:if(d=$.sent(),"closed"===this.websocket.state)throw d;return[4,u()];case 6:return $.sent(),[4,this.request(O,J,te,Y)];case 7:return[2,$.sent()];case 8:if(!1===z)throw T=new y.AgoraRTCError(y.AgoraRTCErrorCode.NETWORK_TIMEOUT,(J&&J.clientRequest&&J.clientRequest.command)+" timeout",{changeAddress:!0,retry:!0}),this.emit(R.LiveStreamingUapSignalEvents.WARNING,T,Y&&Y.url||"unknown url"),Y&&A.report.requestWorkerEvent(this.spec.sid,w(w({},Y),{requestId:G,actionType:"response",payload:"TIMEOUT",serverCode:0,success:0,responseTime:Date.now()-c})),T;return Y&&A.report.requestWorkerEvent(this.spec.sid,w(w({},Y),{requestId:G,actionType:"response",payload:JSON.stringify(z.serverResponse),serverCode:z.code,success:200===z.code,responseTime:Date.now()-c})),200===z.code?[3,10]:[4,this.handleResponseError(z)];case 9:$.sent(),$.label=10;case 10:return[2,z]}})})},H.prototype.tryNextAddress=function(){this.reconnectMode="tryNext",this.websocket.reconnect("tryNext")},H.prototype.close=function(){var O="__VERSION__"===M.VERSION?"0.0.1":M.VERSION;this.reqId+=1,"connected"===this.websocket.state?(this.websocket.sendMessage({command:"request",appId:this.spec.appId,cname:this.spec.cname,uid:this.spec.uid.toString(),sdkVersion:O,sid:this.spec.sid,seq:this.reqId,ts:Math.floor(Date.now()/1e3),requestId:this.reqId,clientRequest:{command:"DestroyWorker"}}),this.websocket.close(!1,!0)):this.websocket.close(!1),this.pingpongTimer&&(window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0)},H.prototype.handleResponseError=function(O){return b(this,void 0,void 0,function(){var J,te,Y,ne,G=this;return D(this,function(_){switch(j.default.debug("[live-streaming] receive response error "+O.code),O.code){case R.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM:return j.default.warning("live stream response already exists stream"),this.emit(R.LiveStreamingUapSignalEvents.WARNING,"live stream response already exists stream, code 454",J=O.serverResponse.url),this.waitingResponseList.includes(J)||this.waitingResponseList.push(J),[2,new Promise(function(u,B){G.once(J,function(){G.waitingResponseList.splice(G.waitingResponseList.indexOf(J),1),u()}),setTimeout(function(){G.waitingResponseList.splice(G.waitingResponseList.indexOf(J),1),B(new y.AgoraRTCError(y.AgoraRTCErrorCode.TIMEOUT,"live stream timeout waiting 454",{code:O.code}))},1e4)})];case R.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR:case R.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_BAD_STREAM:case R.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR:return[2,new y.AgoraRTCError(y.AgoraRTCErrorCode.LIVE_STREAMING_INVALID_ARGUMENT,"",{code:O.code}).throw()];case R.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_INGNORE_MESSAGE:throw new y.AgoraRTCError(y.AgoraRTCErrorCode.LIVE_STREAMING_INVALID_ARGUMENT,"",{retry:!0,changeAddress:!0});case R.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST:if("UnpublishStream"===O.serverResponse.command||"UninjectStream"===O.serverResponse.command)return[2];throw new y.AgoraRTCError(y.AgoraRTCErrorCode.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case R.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED:return[2,new y.AgoraRTCError(y.AgoraRTCErrorCode.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED,"",{code:O.code}).throw()];case R.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:return te=new y.AgoraRTCError(y.AgoraRTCErrorCode.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE),[2,this.emit(R.LiveStreamingUapSignalEvents.WARNING,te,O.serverResponse.url)];case R.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN:return te=new y.AgoraRTCError(y.AgoraRTCErrorCode.LIVE_STREAMING_WARN_FREQUENT_REQUEST),[2,this.emit(R.LiveStreamingUapSignalEvents.WARNING,te,O.serverResponse.url)];case R.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH:throw new y.AgoraRTCError(y.AgoraRTCErrorCode.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case R.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_NOT_SUPPORTED:return[2,new y.AgoraRTCError(y.AgoraRTCErrorCode.LIVE_STREAMING_TRANSCODING_NOT_SUPPORT,"",{code:O.code}).throw()];case R.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM:return te=new y.AgoraRTCError(y.AgoraRTCErrorCode.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT),[2,this.emit(R.LiveStreamingUapSignalEvents.WARNING,te,O.serverResponse.url)];case R.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR:return[2,new y.AgoraRTCError(y.AgoraRTCErrorCode.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:O.code}).throw()];case R.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT:throw new y.AgoraRTCError(y.AgoraRTCErrorCode.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream resource limit",{retry:!0,changeAddress:!0});case R.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_WORKER_LOST:case R.LIVE_STREAM_ERROR_CODE.LIVE_STREAM_RESPONSE_WORKER_QUIT:if("UnpublishStream"===O.serverResponse.command||"UninjectStream"===O.serverResponse.command)return[2];throw new y.AgoraRTCError(y.AgoraRTCErrorCode.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case R.LIVE_STREAM_ERROR_CODE.ERROR_FAIL_SEND_MESSAGE:if("UnpublishStream"===O.serverResponse.command||"UninjectStream"===O.serverResponse.command)return[2];if("UpdateTranscoding"===O.serverResponse.command||"ControlStream"===O.serverResponse.command)return[2,new y.AgoraRTCError(y.AgoraRTCErrorCode.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{code:O.code}).throw()];throw new y.AgoraRTCError(y.AgoraRTCErrorCode.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case R.LIVE_STREAM_ERROR_CODE.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case R.LIVE_STREAM_ERROR_CODE.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case R.LIVE_STREAM_ERROR_CODE.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case R.LIVE_STREAM_ERROR_CODE.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:return this.waitingResponseList.includes(Y=O.serverResponse.url)||this.waitingResponseList.push(Y),ne=new y.AgoraRTCError(y.AgoraRTCErrorCode.LIVE_STREAMING_CDN_ERROR,"",{code:O.code}),this.emit(R.LiveStreamingUapSignalEvents.WARNING,ne,Y),[2,new Promise(function(u,B){G.once(Y,function(){G.waitingResponseList.splice(G.waitingResponseList.indexOf(Y),1),u()}),setTimeout(function(){G.waitingResponseList.splice(G.waitingResponseList.indexOf(Y),1),B(ne)},1e4)})]}return[2]})})},H.prototype.startPingPong=function(){var O=this;this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(function(){"connected"===O.websocket.state&&O.request("ping",{}).catch(function(){})},6e3)},H}(g.EventEmitter);ee.AgoraLiveStreamingUapSignal=F},function(se,ee,x){"use strict";var I,C=this&&this.__extends||(I=function(j,A){return(I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(E,F){E.__proto__=F}||function(E,F){for(var N in F)F.hasOwnProperty(N)&&(E[N]=F[N])})(j,A)},function(j,A){function E(){this.constructor=j}I(j,A),j.prototype=null===A?Object.create(A):(E.prototype=A.prototype,new E)}),w=this&&this.__awaiter||function(j,A,E,F){return new(E||(E=Promise))(function(N,H){function O(Y){try{te(F.next(Y))}catch(ne){H(ne)}}function J(Y){try{te(F.throw(Y))}catch(ne){H(ne)}}function te(Y){var ne;Y.done?N(Y.value):(ne=Y.value,ne instanceof E?ne:new E(function(G){G(ne)})).then(O,J)}te((F=F.apply(j,A||[])).next())})},b=this&&this.__generator||function(j,A){var E,F,N,H,O={label:0,sent:function(){if(1&N[0])throw N[1];return N[1]},trys:[],ops:[]};return H={next:J(0),throw:J(1),return:J(2)},"function"==typeof Symbol&&(H[Symbol.iterator]=function(){return this}),H;function J(te){return function(Y){return function(ne){if(E)throw new TypeError("Generator is already executing.");for(;O;)try{if(E=1,F&&(N=2&ne[0]?F.return:ne[0]?F.throw||((N=F.return)&&N.call(F),0):F.next)&&!(N=N.call(F,ne[1])).done)return N;switch(F=0,N&&(ne=[2&ne[0],N.value]),ne[0]){case 0:case 1:N=ne;break;case 4:return O.label++,{value:ne[1],done:!1};case 5:O.label++,F=ne[1],ne=[0];continue;case 7:ne=O.ops.pop(),O.trys.pop();continue;default:if(!((N=(N=O.trys).length>0&&N[N.length-1])||6!==ne[0]&&2!==ne[0])){O=0;continue}if(3===ne[0]&&(!N||ne[1]>N[0]&&ne[1]<N[3])){O.label=ne[1];break}if(6===ne[0]&&O.label<N[1]){O.label=N[1],N=ne;break}if(N&&O.label<N[2]){O.label=N[2],O.ops.push(ne);break}N[2]&&O.ops.pop(),O.trys.pop();continue}ne=A.call(j,O)}catch(G){ne=[6,G],F=0}finally{E=N=0}if(5&ne[0])throw ne[1];return{value:ne[0]?ne[1]:void 0,done:!0}}([te,Y])}}},D=this&&this.__importDefault||function(j){return j&&j.__esModule?j:{default:j}};Object.defineProperty(ee,"__esModule",{value:!0});var m=x(24),R=x(36),f=x(31),g=x(27),y=D(x(0)),M=function(j){function A(E){var F=j.call(this)||this;return F.connectionID=0,F.currentURLIndex=0,F.reconnectMode="tryNext",F._state="closed",F.retryConfig=f.DEFAULT_RETRY_CONFIG,F.reconnectCount=0,F.name=E,F}return C(A,j),Object.defineProperty(A.prototype,"url",{get:function(){return this.websocket?this.websocket.url:null},enumerable:!0,configurable:!0}),Object.defineProperty(A.prototype,"state",{get:function(){return this._state},set:function(E){E!==this._state&&(this._state=E,"reconnecting"===this._state?this.emit(g.WebSocketManagerEvents.RECONNECTING,this.reconnectMode):"connected"===this._state?this.emit(g.WebSocketManagerEvents.CONNECTED):"closed"===this._state?this.emit(g.WebSocketManagerEvents.CLOSED):"failed"===this._state&&this.emit(g.WebSocketManagerEvents.FAILED))},enumerable:!0,configurable:!0}),A.prototype.init=function(E){var F=this;return new Promise(function(N,H){F.urls=E;var O=F.urls[F.currentURLIndex];F.state="connecting",F.createWebSocketConnection(O).then(N).catch(H),F.once(g.WebSocketManagerEvents.CLOSED,function(){return H(new m.AgoraRTCError(m.AgoraRTCErrorCode.WS_DISCONNECT))}),F.once(g.WebSocketManagerEvents.CONNECTED,function(){return N()})})},A.prototype.close=function(E,F){if(this.currentURLIndex=0,this.reconnectCount=0,this.websocket){this.websocket.onclose=null,this.websocket.onopen=null,this.websocket.onmessage=null;var N=this.websocket;F?setTimeout(function(){return N.close()},500):N.close(),this.websocket=void 0}this.state=E?"failed":"closed"},A.prototype.reconnect=function(E){if(this.websocket){void 0!==E&&(this.reconnectMode=E);var F=this.websocket.onclose;this.websocket.onclose=null,this.websocket.close(),F&&F.bind(this.websocket)({code:9999})}else y.default.warning("["+this.name+"] can not reconnect, no websocket")},A.prototype.sendMessage=function(E){if(!this.websocket||this.websocket.readyState!==WebSocket.OPEN)throw new m.AgoraRTCError(m.AgoraRTCErrorCode.WS_ABORT,"websocket is not ready");var F=JSON.stringify(E);try{this.websocket.send(F)}catch(N){throw new m.AgoraRTCError(m.AgoraRTCErrorCode.WS_ERR,"send websocket message error"+N.toString())}},A.prototype.createWebSocketConnection=function(E){return w(this,void 0,void 0,function(){var F,N=this;return b(this,function(H){return this.connectionID+=1,F=this.connectionID,[2,new Promise(function(O,J){N.websocket&&(N.websocket.onclose=null,N.websocket.close()),y.default.debug("["+N.name+"] start connect, url: "+E);try{N.websocket=new WebSocket(E),N.websocket.binaryType="arraybuffer"}catch(Y){var te=new m.AgoraRTCError(m.AgoraRTCErrorCode.WS_ERR,"init websocket failed! Error: "+Y.toString());return y.default.error("["+N.name+"]"+te),void J(te)}f.wait(5e3).then(function(){F===N.connectionID&&N.websocket&&N.websocket.readyState!==WebSocket.OPEN&&N.websocket&&N.websocket.close()}),N.websocket.onopen=function(){y.default.debug("["+N.name+"] websockect opened:",E),N.reconnectMode="retry",N.state="connected",N.reconnectCount=0,O()},N.websocket.onclose=function(Y){return w(N,void 0,void 0,function(){var ne,G;return b(this,function(_){switch(_.label){case 0:return y.default.debug("["+this.name+"] websocket close "+(this.websocket&&this.websocket.url)+", code: "+Y.code+", reason: "+Y.reason+", current mode: "+this.reconnectMode),this.reconnectCount<this.retryConfig.maxRetryCount?("connected"===this.state&&(this.state="reconnecting"),ne=R.emitAsInvokerNoResponse(this,g.WebSocketManagerEvents.WILL_RECONNECT,this.reconnectMode)||this.reconnectMode,[4,this.reconnectWithAction(ne)]):[3,2];case 1:return G=_.sent(),"closed"===this.state?(y.default.debug("["+this.connectionID+"] ws is closed, no need to reconnect"),[2]):G?(O(),[3,3]):(J(new m.AgoraRTCError(m.AgoraRTCErrorCode.WS_DISCONNECT,"websocket reconnect failed: "+Y.code)),this.close(!0),[2]);case 2:J(new m.AgoraRTCError(m.AgoraRTCErrorCode.WS_DISCONNECT,"websocket close: "+Y.code)),this.close(),_.label=3;case 3:return[2]}})})},N.websocket.onmessage=function(Y){N.emit(g.WebSocketManagerEvents.ON_MESSAGE,Y)}})]})})},A.prototype.reconnectWithAction=function(E,F){return w(this,void 0,void 0,function(){var N,H,J;return b(this,function(te){switch(te.label){case 0:return!F&&this.reconnectCount>=this.retryConfig.maxRetryCount?[2,!1]:this.urls?"closed"===this.state?[2,!1]:(N=f.getRetryWaitTime(this.reconnectCount,this.retryConfig),y.default.debug("["+this.name+"] wait "+N+"ms to reconnect websocket, mode: "+E),[4,f.wait(N)]):[2,!1];case 1:if(te.sent(),"closed"===this.state)return[2,!1];this.reconnectCount+=1,te.label=2;case 2:return te.trys.push([2,12,,14]),"retry"!==E?[3,4]:[4,this.createWebSocketConnection(this.urls[this.currentURLIndex])];case 3:return te.sent(),[3,11];case 4:return"tryNext"!==E?[3,8]:(this.currentURLIndex+=1,this.currentURLIndex>=this.urls.length?[4,this.reconnectWithAction("recover")]:[3,6]);case 5:return[2,te.sent()];case 6:return y.default.debug("["+this.name+"] websocket url length: "+this.urls.length+" current index: "+this.currentURLIndex),[4,this.createWebSocketConnection(this.urls[this.currentURLIndex])];case 7:return te.sent(),[3,11];case 8:return"recover"!==E?[3,11]:(y.default.debug("["+this.name+"] request new urls"),H=this,[4,R.emitAsPromise(this,g.WebSocketManagerEvents.REQUEST_NEW_URLS)]);case 9:return H.urls=te.sent(),this.currentURLIndex=0,[4,this.createWebSocketConnection(this.urls[this.currentURLIndex])];case 10:te.sent(),te.label=11;case 11:return[2,!0];case 12:return J=te.sent(),y.default.error("["+this.name+"] reconnect failed",J.toString()),[4,this.reconnectWithAction(E)];case 13:return[2,te.sent()];case 14:return[2]}})})},A}(R.EventEmitter);ee.AgoraWebSocketManager=M},function(se,ee,x){"use strict";var I=x(18),C=x(38),w=x(79),b=x(44);function D(R){var f=new w(R),g=C(w.prototype.request,f);return I.extend(g,w.prototype,f),I.extend(g,f),g}var m=D(x(41));m.Axios=w,m.create=function(R){return D(b(m.defaults,R))},m.Cancel=x(45),m.CancelToken=x(93),m.isCancel=x(40),m.all=function(R){return Promise.all(R)},m.spread=x(94),se.exports=m,se.exports.default=m},function(se,ee,x){"use strict";var I=x(18),C=x(39),w=x(80),b=x(81),D=x(44);function m(R){this.defaults=R,this.interceptors={request:new w,response:new w}}m.prototype.request=function(R){"string"==typeof R?(R=arguments[1]||{}).url=arguments[0]:R=R||{},R.method=(R=D(this.defaults,R)).method?R.method.toLowerCase():this.defaults.method?this.defaults.method.toLowerCase():"get";var f=[b,void 0],g=Promise.resolve(R);for(this.interceptors.request.forEach(function(y){f.unshift(y.fulfilled,y.rejected)}),this.interceptors.response.forEach(function(y){f.push(y.fulfilled,y.rejected)});f.length;)g=g.then(f.shift(),f.shift());return g},m.prototype.getUri=function(R){return R=D(this.defaults,R),C(R.url,R.params,R.paramsSerializer).replace(/^\?/,"")},I.forEach(["delete","get","head","options"],function(R){m.prototype[R]=function(f,g){return this.request(I.merge(g||{},{method:R,url:f}))}}),I.forEach(["post","put","patch"],function(R){m.prototype[R]=function(f,g,y){return this.request(I.merge(y||{},{method:R,url:f,data:g}))}}),se.exports=m},function(se,ee,x){"use strict";var I=x(18);function C(){this.handlers=[]}C.prototype.use=function(w,b){return this.handlers.push({fulfilled:w,rejected:b}),this.handlers.length-1},C.prototype.eject=function(w){this.handlers[w]&&(this.handlers[w]=null)},C.prototype.forEach=function(w){I.forEach(this.handlers,function(b){null!==b&&w(b)})},se.exports=C},function(se,ee,x){"use strict";var I=x(18),C=x(82),w=x(40),b=x(41);function D(m){m.cancelToken&&m.cancelToken.throwIfRequested()}se.exports=function(m){return D(m),m.headers=m.headers||{},m.data=C(m.data,m.headers,m.transformRequest),m.headers=I.merge(m.headers.common||{},m.headers[m.method]||{},m.headers),I.forEach(["delete","get","head","post","put","patch","common"],function(R){delete m.headers[R]}),(m.adapter||b.adapter)(m).then(function(R){return D(m),R.data=C(R.data,R.headers,m.transformResponse),R},function(R){return w(R)||(D(m),R&&R.response&&(R.response.data=C(R.response.data,R.response.headers,m.transformResponse))),Promise.reject(R)})}},function(se,ee,x){"use strict";var I=x(18);se.exports=function(C,w,b){return I.forEach(b,function(D){C=D(C,w)}),C}},function(se,ee){var x,I,C=se.exports={};function w(){throw new Error("setTimeout has not been defined")}function b(){throw new Error("clearTimeout has not been defined")}function D(E){if(x===setTimeout)return setTimeout(E,0);if((x===w||!x)&&setTimeout)return x=setTimeout,setTimeout(E,0);try{return x(E,0)}catch(F){try{return x.call(null,E,0)}catch(N){return x.call(this,E,0)}}}!function(){try{x="function"==typeof setTimeout?setTimeout:w}catch(E){x=w}try{I="function"==typeof clearTimeout?clearTimeout:b}catch(E){I=b}}();var m,R=[],f=!1,g=-1;function y(){f&&m&&(f=!1,m.length?R=m.concat(R):g=-1,R.length&&M())}function M(){if(!f){var E=D(y);f=!0;for(var F=R.length;F;){for(m=R,R=[];++g<F;)m&&m[g].run();g=-1,F=R.length}m=null,f=!1,function(N){if(I===clearTimeout)return clearTimeout(N);if((I===b||!I)&&clearTimeout)return I=clearTimeout,clearTimeout(N);try{I(N)}catch(H){try{return I.call(null,N)}catch(O){return I.call(this,N)}}}(E)}}function j(E,F){this.fun=E,this.array=F}function A(){}C.nextTick=function(E){var F=new Array(arguments.length-1);if(arguments.length>1)for(var N=1;N<arguments.length;N++)F[N-1]=arguments[N];R.push(new j(E,F)),1!==R.length||f||D(M)},j.prototype.run=function(){this.fun.apply(null,this.array)},C.title="browser",C.browser=!0,C.env={},C.argv=[],C.version="",C.versions={},C.on=A,C.addListener=A,C.once=A,C.off=A,C.removeListener=A,C.removeAllListeners=A,C.emit=A,C.prependListener=A,C.prependOnceListener=A,C.listeners=function(E){return[]},C.binding=function(E){throw new Error("process.binding is not supported")},C.cwd=function(){return"/"},C.chdir=function(E){throw new Error("process.chdir is not supported")},C.umask=function(){return 0}},function(se,ee,x){"use strict";var I=x(18);se.exports=function(C,w){I.forEach(C,function(b,D){D!==w&&D.toUpperCase()===w.toUpperCase()&&(C[w]=b,delete C[D])})}},function(se,ee,x){"use strict";var I=x(43);se.exports=function(C,w,b){var D=b.config.validateStatus;!D||D(b.status)?C(b):w(I("Request failed with status code "+b.status,b.config,null,b.request,b))}},function(se,ee,x){"use strict";se.exports=function(I,C,w,b,D){return I.config=C,w&&(I.code=w),I.request=b,I.response=D,I.isAxiosError=!0,I.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},I}},function(se,ee,x){"use strict";var I=x(88),C=x(89);se.exports=function(w,b){return w&&!I(b)?C(w,b):b}},function(se,ee,x){"use strict";se.exports=function(I){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(I)}},function(se,ee,x){"use strict";se.exports=function(I,C){return C?I.replace(/\/+$/,"")+"/"+C.replace(/^\/+/,""):I}},function(se,ee,x){"use strict";var I=x(18),C=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];se.exports=function(w){var b,D,m,R={};return w&&I.forEach(w.split("\n"),function(f){if(m=f.indexOf(":"),b=I.trim(f.substr(0,m)).toLowerCase(),D=I.trim(f.substr(m+1)),b){if(R[b]&&C.indexOf(b)>=0)return;R[b]="set-cookie"===b?(R[b]?R[b]:[]).concat([D]):R[b]?R[b]+", "+D:D}}),R}},function(se,ee,x){"use strict";var I=x(18);se.exports=I.isStandardBrowserEnv()?function(){var C,w=/(msie|trident)/i.test(navigator.userAgent),b=document.createElement("a");function D(m){var R=m;return w&&(b.setAttribute("href",R),R=b.href),b.setAttribute("href",R),{href:b.href,protocol:b.protocol?b.protocol.replace(/:$/,""):"",host:b.host,search:b.search?b.search.replace(/^\?/,""):"",hash:b.hash?b.hash.replace(/^#/,""):"",hostname:b.hostname,port:b.port,pathname:"/"===b.pathname.charAt(0)?b.pathname:"/"+b.pathname}}return C=D(window.location.href),function(m){var R=I.isString(m)?D(m):m;return R.protocol===C.protocol&&R.host===C.host}}():function(){return!0}},function(se,ee,x){"use strict";var I=x(18);se.exports=I.isStandardBrowserEnv()?{write:function(C,w,b,D,m,R){var f=[];f.push(C+"="+encodeURIComponent(w)),I.isNumber(b)&&f.push("expires="+new Date(b).toGMTString()),I.isString(D)&&f.push("path="+D),I.isString(m)&&f.push("domain="+m),!0===R&&f.push("secure"),document.cookie=f.join("; ")},read:function(C){var w=document.cookie.match(new RegExp("(^|;\\s*)("+C+")=([^;]*)"));return w?decodeURIComponent(w[3]):null},remove:function(C){this.write(C,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(se,ee,x){"use strict";var I=x(45);function C(w){if("function"!=typeof w)throw new TypeError("executor must be a function.");var b;this.promise=new Promise(function(m){b=m});var D=this;w(function(m){D.reason||(D.reason=new I(m),b(D.reason))})}C.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},C.source=function(){var w;return{token:new C(function(b){w=b}),cancel:w}},se.exports=C},function(se,ee,x){"use strict";se.exports=function(I){return function(C){return I.apply(null,C)}}},function(se,ee,x){"use strict";var I=this&&this.__importDefault||function(D){return D&&D.__esModule?D:{default:D}};Object.defineProperty(ee,"__esModule",{value:!0});var C=I(x(0)),w=1,b=function(){function D(m){this.lockingPromise=Promise.resolve(),this.locks=0,this.name="",this.lockId=w++,m&&(this.name=m),C.default.debug("[lock-"+this.name+"-"+this.lockId+"] is created.")}return Object.defineProperty(D.prototype,"isLocked",{get:function(){return this.locks>0},enumerable:!0,configurable:!0}),D.prototype.lock=function(){var m,R=this;this.locks+=1,C.default.debug("[lock-"+this.name+"-"+this.lockId+"] is locked, current queue "+this.locks+".");var f=new Promise(function(y){m=function(){R.locks-=1,C.default.debug("[lock-"+R.name+"-"+R.lockId+"] is not locked, current queue "+R.locks+"."),y()}}),g=this.lockingPromise.then(function(){return m});return this.lockingPromise=this.lockingPromise.then(function(){return f}),g},D}();ee.PromiseMutex=b},function(se,ee,x){"use strict";x.r(ee);var I=x(2),C=x(0),w=x(1),b=x(8),D=x(5),m=function(){};m.prototype.set=function(le,k){["BatteryLevel"].indexOf(le)>-1&&(this[le]=k)};var R=new function(){var le=Object(b.b)();return le.states={UNINIT:"UNINIT",INITING:"INITING",INITED:"INITED"},le.state=le.states.UNINIT,le.batteryManager=null,le._init=function(k,Ae){le.state=le.states.INITING,navigator.getBattery?navigator.getBattery().then(function(Ge){le.batteryManager=Ge,k&&setTimeout(function(){k()},0)}).catch(function(Ge){C.default.debug("navigator.getBattery is disabled",Ge),k&&k()}):(le.state=le.states.INITED,k&&k())},le._getBatteryStats=function(){var k={};return k.BatteryLevel=le.batteryManager&&le.batteryManager.level?Math.floor(100*le.batteryManager.level):"UNSUPPORTED",k},le.getStats=function(k,Ae){var Ge=new m,Ve=le._getBatteryStats();Ve&&Ve.BatteryLevel&&Ge.set("BatteryLevel",Ve.BatteryLevel),k&&k(Ge)},le._init(),le},f=x(22),g=x(19),y=x(26),M=x(53),j=x(9),A=["live","rtc","web","interop","h264_interop","web-only"],E=["vp8","vp9","h264"],F=["aes-128-gcm","aes-256-gcm","aes-128-xts","aes-256-xts","aes-128-ecb","sm4-128-ecb","aes-256-gcm2","aes-128-gcm2"],N=x(11),H=x.n(N),O=x(7),J=x.n(O),te=x(13),Y=x(4),ne=x(10),G=x(20),_=x(6),u=x(14),B={1001:"FRAMERATE_INPUT_TOO_LOW",1002:"FRAMERATE_SENT_TOO_LOW",1003:"SEND_VIDEO_BITRATE_TOO_LOW",1005:"RECV_VIDEO_DECODE_FAILED",2001:"AUDIO_INPUT_LEVEL_TOO_LOW",2002:"AUDIO_OUTPUT_LEVEL_TOO_LOW",2003:"SEND_AUDIO_BITRATE_TOO_LOW",2005:"RECV_AUDIO_DECODE_FAILED",3001:"FRAMERATE_INPUT_TOO_LOW_RECOVER",3002:"FRAMERATE_SENT_TOO_LOW_RECOVER",3003:"SEND_VIDEO_BITRATE_TOO_LOW_RECOVER",3005:"RECV_VIDEO_DECODE_FAILED_RECOVER",4001:"AUDIO_INPUT_LEVEL_TOO_LOW_RECOVER",4002:"AUDIO_OUTPUT_LEVEL_TOO_LOW_RECOVER",4003:"SEND_AUDIO_BITRATE_TOO_LOW_RECOVER",4005:"RECV_AUDIO_DECODE_FAILED_RECOVER"},S={FramerateInput:1001,FramerateSent:1002,SendVideoBitrate:1003,VideoDecode:1005,AudioIntputLevel:2001,AudioOutputLevel:2002,SendAudioBitrate:2003,AudioDecode:2005},c=function(le){var k={remoteStreamStorage:{},localStreamStorage:{}};return k.gatewayClient=le,k.checkAudioOutputLevel=function(Ae){return!(Ae&&parseInt(Ae.audioRecvBytesDelta)>0&&parseInt(Ae.audioDecodingNormalDelta)>0&&0===parseInt(Ae.audioOutputLevel))},k.checkAudioIntputLevel=function(Ae){return!Ae||0!==parseInt(Ae.audioInputLevel)},k.checkFramerateInput=function(Ae,Ge){if(!Ae||!Ge.attributes)return!0;var Ve=parseInt(Ge.attributes.maxFrameRate),Fe=parseInt(Ae.googFrameRateInput);return!Ve||!Fe||!(Ve>10&&Fe<5||Ve<10&&Ve>=5&&Fe<=1)},k.checkFramerateSent=function(Ae){return!(Ae&&parseInt(Ae.googFrameRateInput)>5&&parseInt(Ae.googFrameRateSent)<=1)},k.checkSendVideoBitrate=function(Ae){return!Ae||0!==parseInt(Ae.videoSendBytesDelta)},k.checkSendAudioBitrate=function(Ae){return!Ae||0!==parseInt(Ae.audioSendBytesDelta)},k.checkVideoDecode=function(Ae){return!Ae||0===parseInt(Ae.videoRecvBytesDelta)||0!==parseInt(Ae.googFrameRateDecoded)},k.checkAudioDecode=function(Ae){return!Ae||0===parseInt(Ae.audioRecvBytesDelta)||0!==parseInt(Ae.audioDecodingNormalDelta)},k.record=function(Ae,Ge,Ve,Fe,We){Ve[Ae]||(Ve[Ae]={isPrevNormal:!0,record:[]});var ie=Ve[Ae],h=k["check"+Ae](Ge,We);if(ie.record.push(h),ie.record.length>=5){ie.isCurNormal=-1!==ie.record.indexOf(!0);var Q=S[Ae];ie.isPrevNormal&&!ie.isCurNormal&&k.gatewayClient.dispatchEvent({type:"exception",code:Q,msg:B[Q],uid:Fe}),!ie.isPrevNormal&&ie.isCurNormal&&k.gatewayClient.dispatchEvent({type:"exception",code:Q+2e3,msg:B[Q+2e3],uid:Fe}),ie.isPrevNormal=ie.isCurNormal,ie.record=[]}},k.setLocalStats=function(Ae){var Ge={};Object.keys(Ae).map(function(Ve){var Fe=Ae[Ve],We=k.gatewayClient.localStreams[parseInt(Ve)],ie=k.localStreamStorage[Ve]||{};We&&We.hasVideo()&&(k.record("SendVideoBitrate",Fe.videoStats,ie,Ve),k.record("FramerateInput",Fe.videoStats,ie,Ve,We),k.record("FramerateSent",Fe.videoStats,ie,Ve)),We&&We.hasAudio()&&(k.record("AudioIntputLevel",Fe.audioStats,ie,Ve),k.record("SendAudioBitrate",Fe.audioStats,ie,Ve)),Ge[Ve]=ie}),k.localStreamStorage=Ge},k.setRemoteStats=function(Ae){var Ge={};Object.keys(Ae).map(function(Ve){var Fe=Ae[Ve],We=le.remoteStreams[Ve],ie=k.remoteStreamStorage[Ve]||{};We&&We.hasVideo()&&We.isPlaying()&&k.record("VideoDecode",Fe.videoStats,ie,Ve),We&&We.hasAudio()&&We.isPlaying()&&(k.record("AudioOutputLevel",Fe.audioStats,ie,Ve),k.record("AudioDecode",Fe.audioStats,ie,Ve)),Ge[Ve]=ie}),k.remoteStreamStorage=Ge},k};function d(le,k){(null==k||k>le.length)&&(k=le.length);for(var Ae=0,Ge=new Array(k);Ae<k;Ae++)Ge[Ae]=le[Ae];return Ge}var T,L=x(3),$=new function(){var le=Object(b.b)();return le.states={UNINIT:"UNINIT",INITING:"INITING",INITED:"INITED"},le.state=le.states.UNINIT,le.type=null,le.lastConnectedAt=null,le.lastDisconnectedAt=null,le.lastTypeChangedAt=null,le.networkChangeTimer=null,le._init=function(k,Ae){if(le.state=le.states.INITING,navigator.connection&&navigator.connection.addEventListener){var Ge=le._getNetworkInfo();le.type=Ge&&Ge.type,le.state=le.states.INITED,k&&k()}else le.state=le.states.UNINIT,Ae&&Ae("DO_NOT_SUPPORT")},le._getNetworkInfo=function(){return navigator.connection},le._reloadNetworkInfo=function(){var k=le._getNetworkInfo(),Ae=k&&k.type||"UNSUPPORTED",Ge=Date.now();Ae!==le.type&&(le.lastTypeChangedAt=Ge,"none"==Ae?le.lastDisconnectedAt=Ge:"none"==le.type&&(le.lastConnectedAt=Ge),le.type=Ae,le.dispatchEvent({type:"networkTypeChanged",networkType:Ae}))},le.getStats=function(k,Ae){var Ge={},Ve=le._getNetworkInfo();Ve&&(Ge.NetworkType=Ve.type||"UNSUPPORTED"),setTimeout(function(){k(Ge)},0)},le._init(function(){navigator.connection.addEventListener("change",function(){le._reloadNetworkInfo()}),le.networkChangeTimer=setInterval(function(){le._reloadNetworkInfo()},5e3)},function(k){}),le},Z=x(55),ce=x(16),re=x(56),U=x.n(re),V=x(21),q=function(){return"HTTPS"===(T||T||(T=(window.location.protocol.split(":")[0]||"").toUpperCase()))},pe=function(){return void 0!==window.isSecureContext},oe="host",de=function(le){var ie,h,k={key:void 0,highStream:null,lowStream:null,lowStreamParameter:null,isDualStream:!1,highStreamState:2,lowStreamState:2,proxyServer:null,turnServers:[],useProxyServer:!1,useLocalAccessPoint:!1};if(k.mode=le.mode,k.codec=le.codec,k.clientId=Object(ne.generateSessionId)().slice(0,5),k.uintUid=null,k.customReportCount=0,le=J()({},le),k.aespassword=null,k.aesmode="none",k.hasPublished=!1,k.getSessionId=function(){return le.sessionId},k.startChannelMediaRelay=function(ie,h){var Q=w.report.reportApiInvoke(le.sessionId,{callback:function(me){if(me)return h&&h(me);h&&h()},name:"Client.startChannelMediaRelay",options:arguments,tag:"tracer"});if(!(ie instanceof j.ChannelMediaRelayConfiguration))throw"Configration should be instance of [ChannelMediaRelayConfiguration]";var ae=ie.getSrcChannelMediaInfo(),fe=ie.getDestChannelMediaInfos();if(Object(L.isEmpty)(ae))throw"srcChannelMediaInfo should not be empty";if(Object(L.isEmpty)(fe)||0===fe.length)throw"destChannelMediaInfos should not be empty";if(!Object(ne.is32Uint)(ae.uid))throw"Invalid uid in srcChannelMediaInfo";if(!Object(L.isValidChannelName)(ae.channelName))throw"Invalid channelName in srcChannelMediaInfo";if(ae.token&&!Object(L.isValidToken)(ae.token))throw"Invalid token in srcChannelMediaInfo";if(fe.forEach(function(me){if(!Object(ne.is32Uint)(me.uid))throw"Invalid uid in destChannelMediaInfo";if(!Object(L.isValidChannelName)(me.channelName))throw"Invalid channelName in destChannelMediaInfo";if(me.token&&!Object(L.isValidToken)(me.token))throw"Invalid token in destChannelMediaInfo"}),k.gatewayClient.state!==te.a.CONNECTED)throw"startChannelMediaRelay should be used after join";k.gatewayClient.startChannelMediaRelay(ie).then(function(){Q&&Q()}).catch(function(me){Q&&Q(me)})},k.updateChannelMediaRelay=function(ie,h){var Q=w.report.reportApiInvoke(le.sessionId,{callback:function(me){if(me)return h&&h(me);h&&h()},name:"Client.updateChannelMediaRelay",options:arguments,tag:"tracer"});if(!(ie instanceof j.ChannelMediaRelayConfiguration))throw"Configration should be instance of [ChannelMediaRelayConfiguration]";var ae=ie.getSrcChannelMediaInfo(),fe=ie.getDestChannelMediaInfos();if(Object(L.isEmpty)(ae))throw"srcChannelMediaInfo should not be empty";if(Object(L.isEmpty)(fe)||0===fe.length)throw"destChannelMediaInfos should not be empty";if(!Object(ne.is32Uint)(ae.uid))throw"Invalid uid in srcChannelMediaInfo";if(!Object(L.isValidChannelName)(ae.channelName))throw"Invalid channelName in srcChannelMediaInfo";if(ae.token&&!Object(L.isValidToken)(ae.token))throw"Invalid token in srcChannelMediaInfo";if(fe.forEach(function(me){if(!Object(ne.is32Uint)(me.uid))throw"Invalid uid in destChannelMediaInfo";if(!Object(L.isValidChannelName)(me.channelName))throw"Invalid channelName in destChannelMediaInfo";if(me.token&&!Object(L.isValidToken)(me.token))throw"Invalid token in destChannelMediaInfo"}),k.gatewayClient.state!==te.a.CONNECTED)throw"updateChannelMediaRelay should be used after join";k.gatewayClient.updateChannelMediaRelay(ie).then(function(){Q&&Q()}).catch(function(me){Q&&Q(me)})},k.stopChannelMediaRelay=function(ie){var h=w.report.reportApiInvoke(le.sessionId,{callback:function(Q){if(Q)return ie&&ie(Q);ie&&ie()},name:"Client.stopChannelMediaRelay",options:arguments,tag:"tracer"});k.gatewayClient.stopChannelMediaRelay().then(function(){h&&h()}).catch(function(Q){h&&h(Q)})},k.getConnectionState=function(){var ie=w.report.reportApiInvoke(le.sessionId,{name:"Client.getConnectionState",options:arguments,tag:"tracer"}),h=te.a.connetionStateMap[k.gatewayClient.state];return ie(),h},k.setClientRole=function(ie,h){var Q=w.report.reportApiInvoke(le.sessionId,{callback:h,name:"Client.setClientRole",options:arguments,tag:"tracer"});if(Object(L.checkValidEnum)(ie,"setClientRole",[oe,"audience"]),"rtc"===k.mode){var ae="RTC mode can not use setClientRole";return C.default.warning("[".concat(k.clientId,"] ").concat(ae)),Q&&Q(ae)}k.gatewayClient&&k.gatewayClient.state===te.a.CONNECTED?("audience"===ie&&(0===this.highStreamState?this._unpublish(this.highStream,function(){Q&&Q(null,{role:ie})},function(fe){Q&&Q(fe)}):k.gatewayClient.setClientRole("audience",Q)),ie===oe&&k.gatewayClient.setClientRole(oe,Q)):(k.gatewayClient.role=ie,Q&&Q(null,{role:ie}))},k.getGatewayInfo=function(ie){if(k.gatewayClient.state!==te.a.CONNECTED){var h="Client is not in connected state";return C.default.error("[".concat(k.clientId,"] ").concat(h)),void ie(h)}k.gatewayClient.getGatewayInfo(function(Q){ie(null,Q)},ie)},k.renewToken=function(ie,h,Q){var ae=w.report.reportApiInvoke(le.sessionId,{callback:function(fe,me){if(fe)return C.default.error("Failed to renew token ".concat(fe),me),Q&&Q(fe);h&&h(me)},name:"Client.renewToken",options:arguments,tag:"tracer"});if(!Object(L.isValidToken)(ie))throw new Error("Invalid token: Token is of the string type .Length of the string: [1,255]. ASCII characters only.");return k.gatewayClient?k.key?(k.key=ie,void k.gatewayClient.renewToken(ie,function(fe){return ae(null,fe)},ae)):(C.default.error("[".concat(k.clientId,"] renewToken should not be called before user join")),ae(Y.default.INVALID_OPERATION)):(C.default.error("[".concat(k.clientId,"] renewToken Failed. GatewayClient not Exist")),ae(Y.default.INVALID_OPERATION))},k.setLowStreamParameter=function(ie){var h=w.report.reportApiInvoke(le.sessionId,{name:"Client.setLowStreamParameter",options:arguments,tag:"tracer"});Object(L.checkValidObject)(ie,"param");var Q=ie.width,ae=ie.height,fe=ie.framerate,me=ie.bitrate;Object(L.isEmpty)(Q)||Object(L.checkValidNumber)(Q,"width"),Object(L.isEmpty)(ae)||Object(L.checkValidNumber)(ae,"height"),Object(L.isEmpty)(fe)||Object(L.checkValidNumber)(fe,"framerate"),Object(L.isEmpty)(me)||Object(L.checkValidNumber)(me,"bitrate",1,1e7),(!Q&&ae||Q&&!ae)&&C.default.warning("[".concat(k.clientId,"] The width and height parameters take effect only when both are set")),k.lowStreamParameter=ie,h()},k.init=function(ie,h,Q){var ae=w.report.reportApiInvoke(le.sessionId,{callback:function(fe,me){if(fe)return Q&&Q(fe);h&&h(me)},name:"Client.init",options:arguments,tag:"tracer"});Object(L.checkValidString)(ie),Object(D.isChromeKernel)()&&Object(D.getChromeKernelVersion)()<=48?Q?ae(Y.default.BAD_ENVIRONMENT):Object(ne.popBanTip)():(le.appId=ie,le.sessionId=Object(ne.generateSessionId)(),ae())},k.setTurnServer=function(ie){var h=w.report.reportApiInvoke(le.sessionId,{name:"Client.setTurnServer",options:arguments,tag:"tracer"});if(k.gatewayClient&&k.gatewayClient.state!==te.a.DISCONNECTED)throw new Error("Set turn server before join channel");if(k.useProxyServer)throw new Error("You have already set the proxy");if(k.useLocalAccessPoint)throw new Error("You have already set the local proxy");ie instanceof Array||(ie=[ie]);var Q=[];ie.map(function(ae,fe){Object(L.checkValidObject)(ae,"turnServer");var me=ae.turnServerURL,K=ae.username,ge=ae.password,ve=ae.udpport,be=ae.forceturn,_e=ae.tcpport;if(Object(L.checkValidString)(me,"turnServerURL"),Object(L.checkValidString)(K,"username"),Object(L.checkValidString)(ge,"password"),Object(L.checkValidString)(ve,"udpport"),0===parseInt(ve))throw new Error("udpport should not be ".concat(ve));Object(L.isEmpty)(be)||Object(L.checkValidBoolean)(be,"forceturn");var Pe={mode:"manual"};if(Pe.url=me,Pe.udpport=ve,Pe.username=K,Pe.credential=ge,Pe.forceturn=be||!1,!Object(L.isEmpty)(_e)){if(Object(L.checkValidString)(_e,"tcpport"),0===parseInt(_e))throw new Error("tcpport should not be ".concat(_e));Pe.tcpport=_e,C.default.info("[".concat(k.clientId,"] Set turnserver[").concat(fe,"] tcpurl. ").concat(Pe.url,":").concat(Pe.tcpport))}C.default.info("[".concat(k.clientId,"] Set turnserver[").concat(fe,"] udpurl. ").concat(Pe.url,":").concat(Pe.udpport,",username: ").concat(Pe.username)),Q.push(Pe)}),k.turnServers=Q,h()},k.setProxyServer=function(ie){var h=w.report.reportApiInvoke(le.sessionId,{name:"Client.setProxyServer",options:arguments,tag:"tracer"});if(k.gatewayClient&&k.gatewayClient.state!==te.a.DISCONNECTED)throw new Error("Set proxy server before join channel");if(!ie)throw new Error("Do not set the proxyServer parameter as empty");if(k.useProxyServer)throw new Error("You have already set the proxy");if(k.useLocalAccessPoint)throw new Error("You have already set the local proxy");Object(L.checkValidString)(ie,"proxyServer"),k.proxyServer=ie,w.report.setProxyServer(ie),C.default.setProxyServer(ie),h()},k.startProxyServer=function(ie){var h=w.report.reportApiInvoke(le.sessionId,{name:"Client.startProxyServer",options:arguments,tag:"tracer"});if(k.gatewayClient&&k.gatewayClient.state!==te.a.DISCONNECTED)throw new Error("Start proxy server before join channel");if(k.proxyServer)throw new Error("You have already set the proxy");if(k.useLocalAccessPoint)throw new Error("You have already set the local proxy");k.useProxyServer=!0,k.proxyServerType=ie||1,h()},k.stopProxyServer=function(){var ie=w.report.reportApiInvoke(le.sessionId,{name:"Client.stopProxyServer",options:arguments,tag:"tracer"});if(k.gatewayClient&&k.gatewayClient.state!==te.a.DISCONNECTED)throw new Error("Stop proxy server after leave channel");w.report.setProxyServer(),C.default.setProxyServer(),k.turnServers=[],k.proxyServer=null,k.useProxyServer=!1,k.proxyServerType=null,ie()},k.setEncryptionSecret=function(ie){var h=w.report.reportApiInvoke(le.sessionId,{name:"Client.setEncryptionSecret",options:arguments,tag:"tracer"});Object(L.checkValidString)(ie,"password");var Q=new RegExp("^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*])(?=.{8,})");Q.test(ie)||console.warn("The secret is not strong:\n      The secret must contain at least 1 lowercase alphabetical character,\n      The secret must contain at least 1 uppercase alphabetical character,\n      The secret must contain at least 1 numeric character,\n      The secret must contain at least one special character,\n      The secret must be eight characters or longer,\n      "),k.aespassword=ie,h()},k.setEncryptionMode=function(ie,h){var Q=w.report.reportApiInvoke(le.sessionId,{name:"Client.setEncryptionMode",options:arguments,tag:"tracer"});if(Object(L.checkValidString)(ie,"encryptionMode"),-1===F.indexOf(ie))throw new Error('Invalid encryptionMode: encryptionMode should be "aes-128-xts" | "aes-256-xts" | "aes-128-ecb" | "sm4-128-ecb" | "aes-128-gcm" | "aes-256-gcm" | "aes-128-gcm2" | "aes-256-gcm2"');var ae=["aes-128-gcm2","aes-256-gcm2"];if(-1!==ae.indexOf(ie)){if(!h||!(h instanceof Uint8Array&&32===h.length))throw Error("salt must be an Uint8Array and exactly equal to 32 bytes")}else if(h)throw new Error("Only ".concat("aes-128-gcm2"," and ").concat("aes-256-gcm2"," support use salt"));h&&(k.aesSalt=Object(ne.uint8ArrayToBase64)(h)),k.aesmode=ie,Q()},k.configPublisher=function(ie){var h=w.report.reportApiInvoke(le.sessionId,{name:"Client.configPublisher",options:arguments,tag:"tracer"});Object(L.checkValidObject)(ie,"config");var Q=ie.width,ae=ie.height,fe=ie.framerate,me=ie.bitrate,K=ie.publisherUrl;Object(L.checkValidNumber)(Q,"width"),Object(L.checkValidNumber)(ae,"height"),Object(L.checkValidNumber)(fe,"framerate"),Object(L.checkValidNumber)(me,"bitrate",1,1e7),K&&Object(L.checkValidString)(K,"publisherUrl"),k.gatewayClient.configPublisher(ie),h()},k.enableDualStream=function(ie,h){var Q=w.report.reportApiInvoke(le.sessionId,{callback:function(ae,fe){if(ae)return h&&h(ae);ie&&ie(fe)},name:"Client.enableDualStream",options:arguments,tag:"tracer"});return"iOS"===Object(D.getBrowserOS)()?(w.report.streamSwitch(le.sessionId,{lts:(new Date).getTime(),isdual:!0,succ:!1}),Q(Y.default.IOS_NOT_SUPPORT)):Object(D.isWeChatBrowser)()?(w.report.streamSwitch(le.sessionId,{lts:(new Date).getTime(),isdual:!0,succ:!1}),Q(Y.default.WECHAT_NOT_SUPPORT)):(w.report.streamSwitch(le.sessionId,{lts:(new Date).getTime(),isdual:!0,succ:!0}),k.isDualStream=!0,k.highStream&&(k.highStream.isDualStream=!0),void(0===k.highStreamState?k._publishLowStream(function(ae){return Q(null,ae)},function(ae){C.default.warning("[".concat(k.clientId,"]"),ae),Q(Y.default.ENABLE_DUALSTREAM_FAILED)}):Q(1===k.highStreamState?Y.default.STILL_ON_PUBLISHING:null)))},k.disableDualStream=function(ie,h){var Q=w.report.reportApiInvoke(le.sessionId,{callback:function(ae,fe){if(ae)return h&&h(ae);ie&&ie(fe)},name:"Client.disableDualStream",options:arguments,tag:"tracer"});w.report.streamSwitch(le.sessionId,{lts:(new Date).getTime(),isdual:!1,succ:!0}),k.isDualStream=!1,k.highStream&&(k.highStream.isDualStream=!1),0===k.highStreamState?k._unpublishLowStream(function(){k.highStream.lowStream=null,Q()},function(ae){C.default.warning("[".concat(k.clientId,"]"),ae),Q(Y.default.DISABLE_DUALSTREAM_FAILED)}):1===k.highStreamState?Q(Y.default.STILL_ON_PUBLISHING):Q()},k._getLowStream=function(ie,h){k.lowStream?ie(k.lowStream):k._createLowStream(function(Q){k.lowStream=Q,ie(k.lowStream)},h)},k._createLowStream=function(ie,h){if(k.highStream&&k.highStream.stream){var Q=J()({},k.highStream.params);if(Q.streamID+=1,Q.audio=!1,Q.video)if(k.highStream.stream.getVideoTracks()[0]){var ae=new f.a(Q);ae.isLowStream=!0,ae.streamId=k.highStream.getId()+1;var fe={};k.lowStreamParameter&&(fe=J()({},k.lowStreamParameter)),fe.width&&fe.height||(fe.width=160,fe.height=120),fe.framerate=fe.framerate||15,fe.bitrate=fe.bitrate||50,ae.setVideoProfileCustomPlus(fe);try{var me=U()(k.highStream,{width:ae.videoConstraint.width.ideal,height:ae.videoConstraint.height.ideal,framerate:ae.videoConstraint.frameRate});return ae.stream=me,k.highStream.lowStream=ae,k.highStream.userMuteVideo&&ae.muteVideo(),ie&&ie(ae)}catch(K){return h&&h(K)}}else h&&h(Y.default.HIGH_STREAM_NOT_VIDEO_TRACE);else h&&h(Y.default.HIGH_STREAM_NOT_VIDEO_TRACE)}else h&&h(Y.default.HIGH_STREAM_NOT_VIDEO_TRACE)},k._publishLowStream=function(ie,h){return 2!==k.lowStreamState?h&&h(Y.default.LOW_STREAM_ALREADY_PUBLISHED):k.highStream&&k.highStream.hasScreen()?h&&h(Y.default.SHARING_SCREEN_NOT_SUPPORT):void k._getLowStream(function(Q){k.lowStreamState=1,k.gatewayClient.publish(Q,{streamType:1},function(){k.lowStreamState=0,ie&&ie()},function(ae){1===k.lowStreamState&&(k.lowStreamState=2),C.default.debug("[".concat(k.clientId,"] publish low stream failed")),h&&h(ae)})},h)},k._unpublishLowStream=function(ie,h){if(0!==k.lowStreamState)return h&&h(Y.default.LOW_STREAM_NOT_YET_PUBLISHED);k.lowStream&&(k.gatewayClient.unpublish(k.lowStream,{streamType:1},function(){},function(Q){C.default.debug("[".concat(k.clientId,"] unpublish low stream failed")),h&&h(Q)}),k.lowStream.close(),k.lowStream=null,k.lowStreamState=2,ie&&ie())},k.join=function(ie,h,Q,ae,fe,me){ae&&"function"==typeof ae&&(me=fe,fe=ae,ae=null);var K=q(),ge="The website must be running in a secure context (About secure context: https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts ), otherwise the media collection will be restricted by the browser",ve=pe()?window.isSecureContext:"Browser Not Support",be=function(){C.default.warning(ge)};pe()?window.isSecureContext||be():K||be();var _e=w.report.reportApiInvoke(le.sessionId,{callback:function(Be,ct){if(Be)return me&&me(Be);fe&&fe(ct)},name:"Client.join",options:arguments,getStates:function(){return{isHttps:K,isSecureContext:ve}},tag:"tracer"});if(ie&&!Object(L.isValidToken)(ie))return C.default.warning("[".concat(k.clientId,"] Param channelKey should be string")),_e(Y.default.INVALID_PARAMETER);if(!Object(L.isValidChannelName)(h))return C.default.error("Invalid Channel Name ".concat(h)),C.default.warning("[".concat(k.clientId,"] The length must be within 64 bytes. The supported characters: a-z,A-Z,0-9,space,!, #, $, %, &, (, ), +, -, :, ;, <, =, ., >, ?, @, [, ], ^, _,  {, }, |, ~, ,")),_e(Y.default.INVALID_PARAMETER);if("string"==typeof h&&""===h)return C.default.warning("[".concat(k.clientId,"] Param channel should not be empty")),_e(Y.default.INVALID_PARAMETER);if(ae&&!Object(L.isValidString)(ae))return C.default.warning("[".concat(k.clientId,"] optionalInfo should be string")),_e(Y.default.INVALID_PARAMETER);if(Q&&!Object(ne.is32Uint)(Q)&&!Object(L.isValidString)(Q,1,255))return C.default.error("Invalid UID ".concat(Q," ").concat(H()(Q))),C.default.warning("[".concat(k.clientId,"] [String uid] Length of the string: [1,255]. ASCII characters only. [Number uid] The value range is 32Uint")),_e(Y.default.INVALID_PARAMETER);if("string"==typeof Q&&0==Q.length)return C.default.warning("[".concat(k.clientId,"] String uid should not be empty")),_e(Y.default.INVALID_PARAMETER);if("string"==typeof Q&&Q.length>256)return C.default.warning("[".concat(k.clientId,"] Length of string uid should be less than 255")),_e(Y.default.INVALID_PARAMETER);C.default.stopWaitJoin(),k.highStream=null,k.lowStream=null,k.lowStreamParameter=null,k.isDualStream=!1,k.highStreamState=2,k.lowStreamState=2;var Pe=Date.now(),ke=setTimeout(function(){if(1!=k.gatewayClient.hasJoined){C.default.debug("[".concat(k.clientId,"] The time to join the channel is greater than 5 seconds "));var Be=Date.now();w.report.joinChannelTimeOut({lts:Be,sid:le.sessionId,cname:h,cid:xe&&xe.cid,uid:xe.uid||("string"==typeof Q?void 0:Q),elapse:Be-Pe,timeout:5})}},5e3),xe={clientId:k.clientId,appId:le.appId,sid:le.sessionId,cname:h,uid:Q,turnServers:k.turnServers.concat(),proxyServer:k.proxyServer,token:ie||le.appId,useProxyServer:k.useProxyServer,useLocalAccessPoint:k.useLocalAccessPoint,proxyServerType:k.proxyServerType,optionalInfo:ae};if("string"==typeof Q&&(xe.stringUid=Q,k.uintUid?(xe.uid=k.uintUid,delete k.uintUid):xe.uid=0),k.aespassword&&"none"!==k.aesmode&&J()(xe,{aespassword:k.aespassword,aesmode:k.aesmode}),k.aesSalt&&(xe.aes_salt=k.aesSalt),w.report.sessionInit(le.sessionId,{lts:(new Date).getTime(),cname:h,appid:le.appId,mode:le.mode,succ:!0}),k.onSuccess=function(Be){clearTimeout(ke),k.rtcStatsCollector.startNetworkQualityTimer(),k.onSuccess=null,_e(null,Be)},k.onFailure=function(Be){return _e(Be)},k.channel=h,k.gatewayClient.state!==te.a.DISCONNECTED)return C.default.error("[".concat(k.clientId,"] Client already in connecting/connected state")),_e(Y.default.INVALID_OPERATION),void w.report.joinGateway(le.sessionId,{lts:Date.now(),succ:!1,ec:Y.default.INVALID_OPERATION,addr:null});k.gatewayClient.state=te.a.CONNECTING;var ze=function(Be,ct){C.default.info("[".concat(k.clientId,"] Joining channel: ").concat(h)),k.gatewayClient.dispatchEvent({type:"config-distribute",config:ct,joinInfo:xe}),k.key=ie||le.appId,xe.cid=Be.cid,xe.uid||(xe.uid=Be.uid),xe.vid=Be.vid,xe.clientId=k.clientId,xe.apResponse=Be.res,Be.uni_lbs_ip&&Be.uni_lbs_ip[1]&&(xe.uni_lbs_ip=Be.uni_lbs_ip[1]),xe.gatewayAddr=Be.gateway_addr,k.joinInfo=xe,k.gatewayClient.join(xe,k.key,function(Je){C.default.info("[".concat(k.clientId,"] Join channel ").concat(h," success, join with uid: ").concat(Je,".")),k.onSuccess=null,k.rtcStatsCollector.startNetworkQualityTimer(),_e(null,Je)},function(Je){return _e(Je)})};xe.stringUid&&!xe.uid?(k.userAccountReq&&!k.userAccountReq.isFinished()&&k.userAccountReq.cancel(),k.userAccountReq=Object(G.getUserAccount)(xe,k.gatewayClient),k.userAccountReq.then(function(Be){C.default.debug("getUserAccount Success ".concat(Be.url," ").concat(xe.stringUid," => ").concat(Be.uid)),xe.uid=Be.uid,Object(G.getGatewayList)(xe,ze,function(ct){return _e(ct)})}).catch(function(Be){C.default.error("getUserAccount rejected",Be),_e(Be)})):Object(G.getGatewayList)(xe,ze,function(Be){return _e(Be)})},k.renewChannelKey=function(ie,h,Q){var ae=w.report.reportApiInvoke(le.sessionId,{callback:function(fe,me){if(fe)return Q&&Q(fe);h&&h(me)},name:"Client.renewChannelKey",options:arguments,tag:"tracer"});Object(L.checkValidString)(ie,"key",1,2047),void 0===k.key?(C.default.error("[".concat(k.clientId,"] renewChannelKey should not be called before user join")),ae(Y.default.INVALID_OPERATION)):(k.key=ie,k.gatewayClient.joinInfo.token=ie,k.gatewayClient.key=ie,k.gatewayClient.recover(),ae())},k.leave=function(ie,h){k.gatewayClient.isFirstSuccess=!0,k.gatewayClient.hasInvokeLeave=!0;var Q=!1,ae=w.report.reportApiInvoke(le.sessionId,{callback:function(fe,me){if(fe)return h&&h(fe);k.gatewayClient.reconnectingCS=!1,k.gatewayClient.state=te.a.DISCONNECTED,clearTimeout(Object(G._getReconnectCSTimer)(k.clientId)),k._renewSession(),k.rtcStatsCollector.clearNetworkQualityTimer(),ie&&ie(me)},name:"Client.leave",options:arguments,tag:"tracer"});C.default.info("[".concat(k.clientId,"] Leaving channel")),k.userAccountReq&&!k.userAccountReq.isFinished()&&(k.userAccountReq.cancel(),k.gatewayClient.state===te.a.CONNECTING&&(k.gatewayClient.state=te.a.DISCONNECTED)),k._terminateLiveStreaming(),k.gatewayClient.leave(function(fe){Q=!0,ae(null,fe)},ae),setTimeout(function(){Q||(k.gatewayClient.socket&&(k.gatewayClient.socket.close(),k.gatewayClient.socket=null),k.gatewayClient.state=te.a.DISCONNECTED,ae(null,"LEAVE_MSG_TIMEOUT"))},Object(I.getParameter)("LEAVE_MSG_TIMEOUT"))},k._renewSession=function(){var ie=Object(ne.generateSessionId)();if(C.default.debug("renewSession ".concat(le.sessionId," => ").concat(ie)),le.sessionId=ie,k.gatewayClient.peerPublishDurationMap.clear(),k.joinInfo&&(k.joinInfo.sid=ie),k.gatewayClient&&(k.gatewayClient.joinInfo&&(k.gatewayClient.joinInfo.sid=ie),k.gatewayClient.localStreams))for(var h in k.gatewayClient.localStreams){var Q=k.gatewayClient.localStreams[h];Q&&(Q.sid=ie)}},k._publish=function(ie,h,Q,ae){if(2!==k.highStreamState)return C.default.warning("[".concat(k.clientId,"] Can't publish stream when stream already publish ").concat(ie.getId())),Q&&Q(Y.default.STREAM_ALREADY_PUBLISHED);if(0===k.turnServers.length&&Object(I.getParameter)("FORCE_TURN")&&!Object(I.getParameter)("TURN_ENABLE_TCP")&&!Object(I.getParameter)("TURN_ENABLE_UDP"))throw new Error("force TURN With No TURN Configuration");C.default.info("[".concat(k.clientId,"] Publishing stream, uid ").concat(ie.getId())),k.highStream=ie,k.highStreamState=1,k.highStream.streamId=k.joinInfo.stringUid||k.joinInfo.uid,k.hasPublished=!1;var fe=function(me,K,ge){k.gatewayClient.publish(me,{streamType:0},function(){me.sid=le.sessionId,k.highStreamState=0,C.default.info("[".concat(k.clientId,"] Publish success, uid: ").concat(me.getId())),k.highStream&&(k.highStream.isDualStream=k.isDualStream),k.isDualStream?k._publishLowStream(function(){K&&K()},function(ve){C.default.warning("[".concat(k.clientId,"] "),ve),ce.a.replaceWithCanvasTrack(me).then(function(){K&&K()})}):ce.a.replaceWithCanvasTrack(me).then(function(){K&&K()})},ge)};"audience"!==k.gatewayClient.role||"live"!==k.mode||ae?fe(ie,h,Q):k.gatewayClient.setClientRole(oe,function(me){if(me)return Q&&Q(me);fe(ie,h,Q)})},k._unpublish=function(ie,h,Q,ae){if(0!==k.highStreamState)return C.default.warning("[".concat(k.clientId,"] Can't unpublish stream when stream not publish")),Q&&Q(Y.default.STREAM_NOT_YET_PUBLISHED);C.default.info("[".concat(k.clientId,"] Unpublish stream, uid ").concat(ie.getId()));var fe=function(me,K,ge){k.isDualStream&&k.lowStream&&k._unpublishLowStream(null,ge),k.gatewayClient.unpublish(me,{streamType:0},function(){k.highStreamState=2,C.default.info("[".concat(k.clientId,"] Unpublish stream success, uid: ").concat(me.getId())),k.gatewayClient.dispatchEvent({type:"stream-unpublished",stream:me}),K&&K()},function(ve){C.default.info("[".concat(k.clientId,"] Unpublish stream fail, uid: ").concat(me.getId())),ge&&ge(ve)})};k.gatewayClient.role!==oe||"live"!==k.mode||ae?fe(ie,h,Q):k.gatewayClient.setClientRole("audience",function(me){if(me)return Q&&Q(me);fe(ie,h,Q)})},k.publish=function(ie,h){var Q=w.report.reportApiInvoke(le.sessionId,{callback:function(ae,fe){if(ae)return 1===k.highStreamState&&"REQUEST_ABORT"!==ae&&(k.highStreamState=2),h&&h(ae)},name:"Client.publish",tag:"tracer",options:{stream:"too long to show",onFailure:!!h}});2===k.highStreamState?ie._hasVideoTracks()||ie._hasAudioTracks()?(k.gatewayClient.publishRequestId=Object(ne.generateId)(),k._publish(ie,function(ae){return Q(null,ae)},function(ae){return Q(ae)})):Q(Y.default.NO_TRACK_IN_STREAM):Q(Y.default.STREAM_ALREADY_PUBLISHED)},k.unpublish=function(ie,h,Q){var ae=w.report.reportApiInvoke(le.sessionId,{callback:function(fe,me){if(fe)return h&&h(fe);Q&&Q(me)},name:"Client.unpublish",tag:"tracer",options:{stream:"too long to show",onFailure:!!h}});0===k.highStreamState?(k.gatewayClient.publishRequestId=null,k._unpublish(ie,function(fe){return ae(null,fe)},function(fe){return ae(fe)})):ae(Y.default.STREAM_NOT_YET_PUBLISHED)},k.subscribe=function(ie,h,Q){var ae=w.report.reportApiInvoke(le.sessionId,{callback:function(K,ge){if(K)return Q&&Q(K)},name:"Client.subscribe",tag:"tracer",options:{stream:"too long to show",options:h,onFailure:!!Q}});"function"==typeof h&&(Q=h,h=null),Object(L.checkValidObject)(ie,"stream"),Object(L.isEmpty)(h)||(Object(L.checkValidObject)(h,"options"),Object(L.isEmpty)(h.video)||Object(L.checkValidBoolean)(h.video,"options.video"),Object(L.isEmpty)(h.audio)||Object(L.checkValidBoolean)(h.audio,"options.audio"));var fe={video:!0,audio:!0};if(!Object(L.isEmpty)(h)){if(Object(D.isSafari)()&&(!h.video||!h.audio)){var me="SAFARI_NOT_SUPPORTED_FOR_TRACK_SUBSCRIPTION";return C.default.error("[".concat(k.clientId,"] "),me),void ae(me)}if(!Object(L.isEmpty)(h.video)&&!Object(L.isValidBoolean)(h.video)||!Object(L.isEmpty)(h.audio)&&!Object(L.isValidBoolean)(h.audio)||!1===h.audio&&!1===h.video)return me="INVALID_PARAMETER ".concat(JSON.stringify(h)),C.default.error("[".concat(k.clientId,"] "),me),void ae(me)}ie.subscribeOptions?(J()(ie.subscribeOptions,fe,h),k.gatewayClient.subscribeChange(ie,function(K){return ae(null,K)},ae)):(k.gatewayClient.subscribeRequestId.set(ie.getId(),Object(ne.generateId)()),ie.subscribeOptions=J()({},fe,h),k.gatewayClient.subscribe(ie,function(K){return ae(null,K)},ae))},k.unsubscribe=function(ie,h){var Q=w.report.reportApiInvoke(le.sessionId,{callback:function(ae,fe){if(ae)return h&&h(ae)},name:"Client.unsubscribe",tag:"tracer",options:{stream:"too long to show",onFailure:!!h}});C.default.info("[".concat(k.clientId,"] Unsubscribe stream, uid: ").concat(ie.getId())),k.gatewayClient.subscribeRequestId.delete(ie.getId()),k.gatewayClient.unsubscribe(ie,function(ae){return Q(null,ae)},Q)},k.setRemoteVideoStreamType=function(ie,h){var Q=w.report.reportApiInvoke(le.sessionId,{name:"Client.setRemoteVideoStreamType",tag:"tracer",options:{stream:"too long to show",streamType:h}});Object(L.checkValidEnum)(h,"streamType",[0,1]),k.gatewayClient.setRemoteVideoStreamType(ie,h),Q()},k.setStreamFallbackOption=function(ie,h){var Q=w.report.reportApiInvoke(le.sessionId,{name:"Client.setStreamFallbackOption",tag:"tracer",options:{stream:"too long to show",fallbackType:h}});Object(L.checkValidEnum)(h,"fallbackType",[0,1,2]),k.gatewayClient.setStreamFallbackOption(ie,h),Q()},k.enableAudioVolumeIndicator=function(ie,h){var Q=w.report.reportApiInvoke(le.sessionId,{name:"Client.enableAudioVolumeIndicator",options:arguments,tag:"tracer"});ie=ie||2e3,h=h||3,Object(L.checkValidNumber)(h,"smooth",1,100),Object(L.checkValidNumber)(ie,"interval",50,1e5),k.audioVolumeIndication=k.audioVolumeIndication||{enabled:!0},k.audioVolumeIndication.interval=ie,k.audioVolumeIndication.smooth=h,k.audioVolumeIndication={interval:ie,smooth:h},C.default.info("[".concat(k.clientId,"] enableAudioVolumeIndicator interval ").concat(ie," smooth ").concat(h)),k.gatewayClient.enableAudioVolumeIndicator(ie,h),Q()},k.getNetworkStats=function(ie,h){return C.default.deprecate("[".concat(k.clientId,"] client.getNetworkStats is deprecated. Use client.getTransportStats instead.")),$.getStats(ie,h)},k.getSystemStats=function(ie,h){return R.getStats(ie,h)},k.getRecordingDevices=function(ie,h){return g.a.getRecordingDevices(ie,h)},k.getPlayoutDevices=function(ie,h){return g.a.getPlayoutDevices(ie,h)},k.getCameras=function(ie,h){return g.a.getCameras(ie,h)},k.getRemoteAudioStats=function(ie,h){return k.rtcStatsCollector.getRemoteAudioStats(ie,h)},k.getLocalAudioStats=function(ie,h){return k.rtcStatsCollector.getLocalAudioStats(ie,h)},k.getRemoteVideoStats=function(ie,h){return k.rtcStatsCollector.getRemoteVideoStats(ie,h)},k.getLocalVideoStats=function(ie,h){return k.rtcStatsCollector.getLocalVideoStats(ie,h)},k._getRemoteVideoQualityStats=function(ie,h){return k.rtcStatsCollector.getRemoteVideoQualityStats(ie,h)},k._getRemoteAudioQualityStats=function(ie,h){return k.rtcStatsCollector.getRemoteAudioQualityStats(ie,h)},k.getTransportStats=function(ie,h){return k.rtcStatsCollector.getTransportStats(function(Q){return $.getStats(function(ae){var fe=J()({},Q,ae);ie&&ie(fe)},h)},h)},k.getSessionStats=function(ie,h){return k.rtcStatsCollector.getSessionStats(ie,h)},k.onNetworkQuality=function(){return k.rtcStatsCollector.onNetworkQuality(onSuccess,onFailure)},k.sendMetadata=function(ie,h){var Q=w.report.reportApiInvoke(le.sessionId,{name:"Client.sendMetadata",tag:"tracer",callback:function(ae){if(ae)return h&&h(ae);h&&h()}});k.gatewayClient.sendMetadata(ie,Q)},k.sendCustomReportMessage=function(ie,h,Q,ae,fe,me){Object(I.getParameter)("CR")?k.customReportCount>Object(I.getParameter)("CRL")?me&&me("REPORT_LIMITED"):(k.gatewayClient.hasJoined||(C.default.WARNING("Should invoke Client.sendCustomReportMessage after join"),me&&me("REPORT_BEFORE_JOINED")),k.customReportTimer||(k.customReportTimer=setInterval(function(){k.customReportCount=0},Object(I.getParameter)("CRI"))),Object(L.checkValidString)(ie,"reportId",0,100,!1),Object(L.checkValidString)(h,"category",0,100,!1),Object(L.checkValidString)(Q,"event",0,100,!1),Object(L.checkValidString)(ae,"label",0,100,!1),Object(L.checkValidNumber)(fe,"value",Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER),k.customReportCount++,w.report.sendCustomReportMessage(le.sessionId,{reportId:ie,category:h,event:Q,label:ae,value:fe,lts:Date.now()},function(K){K?me&&me("REPORT_FAILED"):me&&me()})):me&&me("REPORT_FORBIDDEN")},k.setLocalAccessPoints=function(ie,h){var Q=w.report.reportApiInvoke(le.sessionId,{name:"Client.setLocalAccessPoints",tag:"tracer"});if(Object(L.checkValidArray)(ie,"serverList"),Object(L.checkValidString)(h,"domain"),k.useProxyServer)throw new Error("You have already set the proxy");var ae=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/;ie=ie.map(function(fe){return ae.test(fe)?"".concat(fe.replace(/\./g,"-"),".").concat(h):fe}),k.useLocalAccessPoint=!0,Object(I.setParameter)("WEBCS_DOMAIN",ie),Object(I.setParameter)("WEBCS_DOMAIN_BACKUP_LIST",ie),Object(I.setParameter)("GATEWAY_DOMAINS",[h]),Object(I.setParameter)("EVENT_REPORT_DOMAIN",ie[Math.floor(Math.random()*ie.length)]),Object(I.setParameter)("EVENT_REPORT_BACKUP_DOMAIN",ie[Math.floor(Math.random()*ie.length)]),Object(I.setParameter)("LOG_UPLOAD_SERVER","".concat(ie[Math.floor(Math.random()*ie.length)],":6444")),Q()},le.clientId=k.clientId,k.gatewayClient=Object(te.a)(le),k.listenerLoggerTimer=null,k.listenerLoggerCache=[],k.on=function(ie,h){k.gatewayClient.on(ie,h),k.listenerLoggerCache.push("".concat(ie).concat(h.name?":"+h.name:"")),k.listenerLoggerTimer?clearTimeout(k.listenerLoggerTimer):C.default.info("[".concat(k.clientId,"] Adding event handler on ").concat(ie)),k.listenerLoggerTimer=setTimeout(function(){k.listenerLoggerCache.length&&(k.listenerLoggerTimer=null,C.default.info("[".concat(k.clientId,"] Added event handler on ").concat(k.listenerLoggerCache.join(", "))),k.listenerLoggerCache=[])},0)},k.off=function(ie,h){C.default.info("remove event handler from [".concat(ie,"]")),k.gatewayClient.removeEventListener(ie,h)},k.rtcStatsCollector=(ie=k.gatewayClient,(h=Object(b.b)()).gatewayClient=ie,h.exceptionMonitor=new c(ie),h.localStats={},h.remoteStats={},h.session={sendBytes:0,recvBytes:0,WSSendBytes:0,WSSendBytesDelta:0,WSRecvBytes:0,WSRecvBytesDelta:0,HTTPSendBytes:0,HTTPSendBytesDelta:0,HTTPRecvBytes:0,HTTPRecvBytesDelta:0},h.getRemoteAudioStats=function(Q){var ae=h.gatewayClient.traffic_stats,fe={};for(var me in h.remoteStats){var K={},ge=h.remoteStats[me];if(Object(_.b)(K,"End2EndDelay",ge.peer_delay&&ge.peer_delay.audio_delay),Object(_.b)(K,"TransportDelay",ge.peer_delay&&ge.peer_delay.e2e_delay),Object(_.b)(K,"PacketLossRate",ge.peer_delay&&ge.peer_delay.e2e_audio_lost_ratio_400ms),Object(_.b)(K,"RecvLevel",ge.audioStats&&ge.audioStats.audioOutputLevel),Object(_.b)(K,"RecvBitrate",ge.audioRecvBitrate),Object(_.b)(K,"CodecType",ge.audioStats&&ge.audioStats.googCodecName),Object(_.b)(K,"MuteState",ge.audioDisabled),Object(_.b)(K,"TotalFreezeTime",ge.audioStats&&ge.audioStats.audioTotalFreezeTime),Object(_.b)(K,"TotalPlayDuration",ge.audioStats&&ge.audioStats.audioTotalPlayDuration),ae&&ae.peer_delay){var ve=ae.peer_delay.find(function(_e){return _e.peer_uid==me});if(ve){var be=ve.peer_publish_audio_duration+(Date.now()-ae.timestamp);Object(_.b)(K,"AudioPublishDuration",be)}else Object(_.b)(K,"AudioPublishDuration",-1)}fe[me]=K}Q&&Q(fe)},h.getLocalAudioStats=function(Q){var ae={};for(var fe in h.localStats){var me={},K=h.localStats[fe];Object(_.b)(me,"RecordingLevel",K.audioStats&&K.audioStats.audioInputLevel),Object(_.b)(me,"SendLevel",K.audioStats&&K.audioStats.totalAudioEnergy),Object(_.b)(me,"SamplingRate",K.audioStats&&K.audioStats.totalSamplesDuration),Object(_.b)(me,"SendBitrate",K.audioSendBitrate),Object(_.b)(me,"CodecType",K.audioStats&&K.audioStats.googCodecName),Object(_.b)(me,"MuteState",K.audioDisabled),Object(_.b)(me,"audioSendPacketsLost",K.audioStats&&K.audioStats.packetsLost);var ge=h.gatewayClient.localStreams[fe];ge&&ge.isPlaying()&&Object(_.b)(me,"MuteState",ge.userMuteAudio?"1":"0"),ae[fe]=me}Q&&Q(ae)},h.getRemoteVideoStats=function(Q){var ae=h.gatewayClient.traffic_stats,fe={};for(var me in h.remoteStats){var K={},ge=h.remoteStats[me];if(Object(_.b)(K,"End2EndDelay",ge.peer_delay&&ge.peer_delay.video_delay),Object(_.b)(K,"TransportDelay",ge.peer_delay&&ge.peer_delay.e2e_delay),Object(_.b)(K,"PacketLossRate",ge.peer_delay&&ge.peer_delay.e2e_video_lost_ratio_400ms),Object(_.b)(K,"RecvBitrate",ge.videoRecvBitrate),Object(_.b)(K,"RecvResolutionWidth",ge.videoStats&&ge.videoStats.googFrameWidthReceived),Object(_.b)(K,"RecvResolutionHeight",ge.videoStats&&ge.videoStats.googFrameHeightReceived),Object(_.b)(K,"RenderResolutionWidth",ge.videoStats&&ge.videoStats.renderRemoteWidth),Object(_.b)(K,"RenderResolutionHeight",ge.videoStats&&ge.videoStats.renderRemoteHeight),Object(_.b)(K,"RenderFrameRate",ge.videoStats&&ge.videoStats.googFrameRateOutput),Object(_.b)(K,"MuteState",ge.videoDisabled),Object(_.b)(K,"TotalFreezeTime",ge.videoStats&&ge.videoStats.videoTotalFreezeTime),Object(_.b)(K,"TotalPlayDuration",ge.videoStats&&ge.videoStats.videoTotalPlayDuration),ae&&ae.peer_delay){var ve=ae.peer_delay.find(function(_e){return _e.peer_uid==me});if(ve){var be=ve.peer_publish_video_duration+(Date.now()-ae.timestamp);Object(_.b)(K,"VideoPublishDuration",be)}else Object(_.b)(K,"VideoPublishDuration",-1)}fe[me]=K}Q&&Q(fe)},h.getLocalVideoStats=function(Q){var ae={};for(var fe in h.localStats){var me={},K=h.localStats[fe];Object(_.b)(me,"TargetSendBitrate",K.videoTargetSendBitrate),Object(_.b)(me,"SendFrameRate",K.videoStats&&K.videoStats.googFrameRateSent),Object(_.b)(me,"SendBitrate",K.videoSendBitrate),Object(_.b)(me,"SendResolutionWidth",K.videoStats&&K.videoStats.googFrameWidthSent),Object(_.b)(me,"SendResolutionHeight",K.videoStats&&K.videoStats.googFrameHeightSent),Object(_.b)(me,"CaptureResolutionWidth",K.videoStats&&K.videoStats.googFrameWidthInput),Object(_.b)(me,"CaptureResolutionHeight",K.videoStats&&K.videoStats.googFrameHeightInput),Object(_.b)(me,"EncodeDelay",K.videoStats&&K.videoStats.googAvgEncodeMs),Object(_.b)(me,"MuteState",K.videoDisabled),Object(_.b)(me,"TotalFreezeTime",K.videoStats&&K.videoStats.videoTotalFreezeTime),Object(_.b)(me,"TotalDuration",K.videoStats&&K.videoStats.videoTotalPlayDuration),Object(_.b)(me,"CaptureFrameRate",K.videoStats&&K.videoStats.googFrameRateSent),Object(_.b)(me,"videoSendPacketsLost",K.videoStats&&K.videoStats.packetsLost),K.videoStats&&!K.videoStats.googFrameWidthInput&&Object(_.b)(me,"CaptureResolutionWidth",K.videoStats&&K.videoStats.renderLocalWidth),K.videoStats&&!K.videoStats.googFrameHeightInput&&Object(_.b)(me,"CaptureResolutionHeight",K.videoStats&&K.videoStats.renderLocalHeight),ae[fe]=me}Q&&Q(ae)},h.getRemoteVideoQualityStats=function(Q){var ae={};for(var fe in h.remoteStats){var me={},K=h.remoteStats[fe];Object(_.b)(me,"videoReceiveDelay",K.videoStats&&K.videoStats.googCurrentDelayMs),Object(_.b)(me,"VideoFreezeRate",K.videoStats&&K.videoStats.videoFreezeRate),Object(_.b)(me,"FirstFrameTime",K.firstFrameTime),ae[fe]=me}Q&&Q(ae)},h.getRemoteAudioQualityStats=function(Q){var ae={};for(var fe in h.remoteStats){var me={},K=h.remoteStats[fe];Object(_.b)(me,"audioReceiveDelay",K.audioStats&&K.audioStats.googCurrentDelayMs),Object(_.b)(me,"AudioFreezeRate",K.videoStats&&K.videoStats.videoFreezeRate),ae[fe]=me}Q&&Q(ae)},h.getTransportStats=function(Q){var ae={},fe={},me=h.gatewayClient.traffic_stats,K=me.peer_delay;if(Object(_.b)(ae,"OutgoingAvailableBandwidth",h.gatewayClient.OutgoingAvailableBandwidth/1e3),Object(_.b)(ae,"RTT",me&&2*me.access_delay),K){var ge,ve=function z(le){if("undefined"==typeof Symbol||null==le[Symbol.iterator]){if(Array.isArray(le)||(le=function(ie,h){if(ie){if("string"==typeof ie)return d(ie,h);var Q=Object.prototype.toString.call(ie).slice(8,-1);if("Object"===Q&&ie.constructor&&(Q=ie.constructor.name),"Map"===Q||"Set"===Q)return Array.from(Q);if("Arguments"===Q||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Q))return d(ie,h)}}(le))){var k=0,Ae=function(){};return{s:Ae,n:function(){return k>=le.length?{done:!0}:{done:!1,value:le[k++]}},e:function(ie){throw ie},f:Ae}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var Ge,Ve,Fe=!0,We=!1;return{s:function(){Ge=le[Symbol.iterator]()},n:function(){var ie=Ge.next();return Fe=ie.done,ie},e:function(ie){We=!0,Ve=ie},f:function(){try{Fe||null==Ge.return||Ge.return()}finally{if(We)throw Ve}}}}(K);try{for(ve.s();!(ge=ve.n()).done;){var be=ge.value;be.downlink_estimate_bandwidth&&(fe[be.peer_uid]=be.downlink_estimate_bandwidth/1e3+"")}}catch(_e){ve.e(_e)}finally{ve.f()}}ae.IncomingAvailableBandwidth=fe,Q&&Q(ae)},h.getSessionStats=function(Q){var ae={},fe=h.gatewayClient.traffic_stats,me=h.gatewayClient.socket,K=0,ge=0;for(var ve in h.remoteStats)(be=h.remoteStats[ve])&&be.videoStats&&be.videoStats.videoRecvBytesDelta&&(ge+=parseInt(be.videoStats.videoRecvBytesDelta)),be&&be.audioStats&&be.audioStats.audioRecvBytesDelta&&(ge+=parseInt(be.audioStats.audioRecvBytesDelta));for(var ve in h.localStats){var be;(be=h.localStats[ve])&&be.videoStats&&be.videoStats.videoSendBytesDelta&&(K+=parseInt(be.videoStats.videoSendBytesDelta)),be&&be.audioStats&&be.audioStats.audioSendBytesDelta&&(K+=parseInt(be.audioStats.audioSendBytesDelta))}var _e=K+h.session.WSSendBytesDelta+h.session.HTTPSendBytesDelta,Pe=ge+h.session.WSRecvBytesDelta+h.session.HTTPRecvBytesDelta,ke=h.session.sendBytes+Object(u.getHTTPSendBytes)(),xe=h.session.recvBytes+Object(u.getHTTPRecvBytes)();h.gatewayClient.socket&&h.gatewayClient.socket.state===h.gatewayClient.CONNECTED&&(ke+=me.getSendBytes(),xe+=me.getRecvBytes());var ze=1;fe.peer_delay&&(ze=fe.peer_delay.length,ze+=1),me?Object(_.b)(ae,"Duration",me.getDuration()):Object(_.b)(ae,"Duration",0),Object(_.b)(ae,"UserCount",ze),Object(_.b)(ae,"SendBytes",ke),Object(_.b)(ae,"RecvBytes",xe),Object(_.b)(ae,"SendBitrate",8*_e/1e3),Object(_.b)(ae,"RecvBitrate",8*Pe/1e3),Q&&Q(ae)},h.isLocalVideoFreeze=function(Q,ae){var fe=0,me=0;if(!Q||!ae)return!1;if(Object(D.isChrome)()||Object(D.isOpera)())fe=Q.googFrameRateInput,me=Q.googFrameRateSent;else if(Object(D.isSafari)())fe=parseInt(Q.framerateMean),me=parseInt(Q.framesEncoded)-parseInt(ae.framesEncoded);else{if(!Object(D.isFireFox)())return!1;fe=parseInt(Q.framerateMean),me=parseInt(Q.framesEncoded)-parseInt(ae.framesEncoded)}return fe>5&&me<3},h.isRemoteVideoFreeze=function(Q,ae){var fe=0,me=0;if(!Q||!ae)return!1;if(Object(D.isChrome)()||Object(D.isOpera)())fe=Q.googFrameRateReceived,me=Q.googFrameRateDecoded;else if(Object(D.isSafari)())fe=Q.framerateMean,me=parseInt(Q.framesDecoded)-parseInt(ae.framesDecoded);else{if(!Object(D.isFireFox)())return!1;fe=parseInt(Q.framesReceived)-parseInt(ae.framesReceived),me=parseInt(Q.framesDecoded)-parseInt(ae.framesDecoded)}return fe>5&&fe<10&&me<3||fe>10&&fe<20&&me<4||fe>20&&me<5},h.isAudioFreeze=function(Q){if(Object(D.isChrome)()&&Q){if(Q.googDecodingPLC&&Q.googDecodingPLCCNG&&Q.googDecodingCTN)return(parseInt(Q.googDecodingPLC)+parseInt(Q.googDecodingPLCCNG))/parseInt(Q.googDecodingCTN)>.2}else if((Object(D.isSafari)()||Object(D.isFireFox)())&&Q.packetsLost&&Q.packetsReceived)return parseInt(Q.packetsLost)/(parseInt(Q.packetsLost)+parseInt(Q.packetsReceived))>.2;return!1},h.isAudioDecodeFailed=function(Q){return!!((Object(D.isChrome)()||Object(D.isOpera)())&&Q&&parseInt(Q.bytesReceived)>0&&0===parseInt(Q.googDecodingNormal))},h.startNetworkQualityTimer=function(){h.clearNetworkQualityTimer(),h.networkQualityTimer=setInterval(function(){if(h.gatewayClient.state===te.a.CONNECTED&&navigator.onLine){var Q=h.gatewayClient.traffic_stats;h.gatewayClient.dispatchEvent({type:"network-quality",uplinkNetworkQuality:h.networkQualityTrans(Q.uplink_network_quality),downlinkNetworkQuality:h.networkQualityTrans(Q.downlink_network_quality)})}else h.gatewayClient.dispatchEvent({type:"network-quality",uplinkNetworkQuality:0,downlinkNetworkQuality:0})},2e3)},h.clearNetworkQualityTimer=function(){h.networkQualityTimer&&clearInterval(h.networkQualityTimer)},h.networkQualityTrans=function(Q){return Q>=0&&Q<.17?1:Q>=.17&&Q<.36?2:Q>=.36&&Q<.59?3:Q>=.59&&Q<=1?4:Q>1?5:0},h.getStatsTimer=setInterval(function(){var Q=h.gatewayClient.traffic_stats,ae=Date.now();h.gatewayClient.dispatchEvent({type:"_testException"}),Object.keys(h.localStats).length&&h.exceptionMonitor.setLocalStats(h.localStats),Object.keys(h.remoteStats).length&&h.exceptionMonitor.setRemoteStats(h.remoteStats);var fe={};Object.keys(h.gatewayClient.remoteStreams).forEach(function(ge){var ve=h.gatewayClient.remoteStreams[ge],be=h.remoteStats[ge],_e={id:ge,updatedAt:ae};fe[ge]=_e,_e.firstFrameTime=ve.firstFrameTime,be?(_e.audioTotalPlayDuration=be.audioTotalPlayDuration+1,_e.audioTotalFreezeTime=be.audioTotalFreezeTime,_e.isAudioFreeze=!1,_e.isAudioDecodeFailed=!1,_e.videoTotalPlayDuration=be.videoTotalPlayDuration+1,_e.videoTotalFreezeTime=be.videoTotalFreezeTime,_e.isVideoFreeze=!1):(_e.audioTotalPlayDuration=1,_e.audioTotalFreezeTime=0,_e.videoTotalPlayDuration=1,_e.videoTotalFreezeTime=0);var Pe=Q&&Q.peer_delay&&Q.peer_delay.find(function(ke){return ke.peer_uid==ge});Pe&&(_e.peer_delay=Pe),ve&&(ve.isPlaying()&&(_e.audioDisabled=ve.userMuteAudio||ve.peerMuteAudio?"1":"0",_e.videoDisabled=ve.userMuteVideo||ve.peerMuteVideo?"1":"0"),be&&be.peer_delay&&Pe&&be.peer_delay.stream_type!==Pe.stream_type&&h.gatewayClient.dispatchEvent({type:"streamTypeChange",uid:ge,streamType:Pe.stream_type}),ve.pc&&"established"==ve.pc.state&&ve.pc.getStats(function(ke){if(_e.pcStats=ke,_e.audioStats=ke.find(function(Je){return"audio"==Je.mediaType&&(Je.id.indexOf("_recv")>-1||Je.id.toLowerCase().indexOf("inbound")>-1)}),_e.videoStats=ke.find(function(Je){return"video"==Je.mediaType&&(Je.id.indexOf("_recv")>-1||Je.id.toLowerCase().indexOf("inbound")>-1)}),be&&be.audioStats&&_e.audioStats){var xe=parseInt(_e.audioStats.bytesReceived)-parseInt(be.audioStats.bytesReceived),ze=parseInt(_e.audioStats.googDecodingNormal)-parseInt(be.audioStats.googDecodingNormal);if(_e.audioStats.audioRecvBytesDelta=xe,_e.audioStats.audioDecodingNormalDelta=ze,h.session.recvBytes+=xe,isFinite(xe)&&_e.audioStats.timestamp){var Be=_e.audioStats.timestamp.getTime()-be.audioStats.timestamp.getTime();_e.audioRecvBitrate=Math.floor(8*xe/Be)}h.isAudioFreeze(_e.audioStats)&&_e.audioTotalPlayDuration>10&&(_e.audioTotalFreezeTime++,_e.isAudioFreeze=!0),h.isAudioDecodeFailed(_e.audioStats)&&_e.audioTotalPlayDuration>10&&(_e.isAudioDecodeFailed=!0),_e.audioStats.audioTotalFreezeTime=_e.audioTotalFreezeTime,_e.audioStats.audioTotalPlayDuration=_e.audioTotalPlayDuration,_e.audioStats.audioFreezeRate=Math.ceil(100*_e.audioTotalFreezeTime/_e.audioTotalPlayDuration)}if(be&&be.videoStats&&_e.videoStats){var ct=parseInt(_e.videoStats.bytesReceived)-parseInt(be.videoStats.bytesReceived);_e.videoStats.videoRecvBytesDelta=ct,h.session.recvBytes+=ct,isFinite(ct)&&_e.videoStats.timestamp&&(Be=_e.videoStats.timestamp.getTime()-be.videoStats.timestamp.getTime(),_e.videoRecvBitrate=Math.floor(8*ct/Be)),h.isRemoteVideoFreeze(_e.videoStats,be.videoStats)&&(_e.videoTotalFreezeTime++,_e.isVideoFreeze=!0),_e.videoStats.videoTotalFreezeTime=_e.videoTotalFreezeTime,_e.videoStats.videoTotalPlayDuration=_e.videoTotalPlayDuration,_e.videoStats.videoFreezeRate=Math.ceil(100*_e.videoTotalFreezeTime/_e.videoTotalPlayDuration),ve.player&&ve.player.video&&ve.player.video.videoWidth&&ve.player.video.videoHeight?(_e.videoStats.renderRemoteWidth=ve.player.video.videoWidth,_e.videoStats.renderRemoteHeight=ve.player.video.videoHeight):(_e.videoStats.renderRemoteWidth=ve.videoWidth||_e.videoStats.googFrameWidthReceived,_e.videoStats.renderRemoteHeight=ve.videoHeight||_e.videoStats.googFrameHeightReceived)}}))}),h.remoteStats=fe;var me={};if(Object.keys(h.gatewayClient.localStreams).forEach(function(ge){var ve=h.gatewayClient.localStreams[ge],be=h.localStats[ge],_e={id:ge,updatedAt:ae};me[ge]=_e,be?(_e.videoTotalPlayDuration=be.videoTotalPlayDuration+1,_e.videoTotalFreezeTime=be.videoTotalFreezeTime,_e.isVideoFreeze=!1):(_e.videoTotalPlayDuration=1,_e.videoTotalFreezeTime=0),ve&&(ve.isPlaying()&&(_e.audioDisabled=ve.userMuteAudio?"1":"0",_e.videoDisabled=ve.userMuteVideo?"1":"0"),ve.video&&ve.attributes.maxVideoBW?_e.videoTargetSendBitrate=ve.attributes.maxVideoBW:ve.video&&ve.screenAttributes&&(_e.videoTargetSendBitrate=ve.screenAttributes.maxVideoBW),ve.pc&&"established"==ve.pc.state&&ve.pc.getStats(function(Pe){if(_e.pcStats=Pe.reverse(),_e.audioStats=Pe.find(function(Be){return"audio"==Be.mediaType&&(Be.id.indexOf("_send")>-1||Be.id.toLowerCase().indexOf("outbound")>-1)}),_e.videoStats=Pe.find(function(Be){return"video"==Be.mediaType&&(Be.id.indexOf("_send")>-1||Be.id.toLowerCase().indexOf("outbound")>-1)}),_e.audioStats&&be&&be.audioStats){var ke=parseInt(_e.audioStats.bytesSent)-parseInt(be.audioStats.bytesSent);if(_e.audioStats.audioSendBytesDelta=ke,h.session.sendBytes+=ke,isFinite(ke)&&_e.audioStats.timestamp){var xe=_e.audioStats.timestamp.getTime()-be.audioStats.timestamp.getTime();_e.audioSendBitrate=Math.floor(8*ke/xe)}}if(_e.videoStats&&be&&be.videoStats){var ze=parseInt(_e.videoStats.bytesSent)-parseInt(be.videoStats.bytesSent);_e.videoStats.videoSendBytesDelta=ze,h.session.sendBytes+=ze,isFinite(ze)&&_e.videoStats.timestamp&&(xe=_e.videoStats.timestamp.getTime()-be.videoStats.timestamp.getTime(),_e.videoSendBitrate=Math.floor(8*ze/xe)),h.isLocalVideoFreeze(_e.videoStats,be.videoStats)&&(_e.videoTotalFreezeTime++,_e.isVideoFreeze=!0),_e.videoStats.videoTotalFreezeTime=_e.videoTotalFreezeTime,_e.videoStats.videoTotalPlayDuration=_e.videoTotalPlayDuration,_e.videoStats.videoFreezeRate=Math.ceil(100*_e.videoTotalFreezeTime/_e.videoTotalPlayDuration),_e.videoStats.renderLocalWidth=ve.videoWidth||_e.videoStats.googFrameWidthSent,_e.videoStats.renderLocalHeight=ve.videoHeight||_e.videoStats.googFrameHeightSent}}))}),h.localStats=me,h.session.HTTPSendBytesDelta=Object(u.getHTTPSendBytes)()-h.session.HTTPSendBytes,h.session.HTTPSendBytes=Object(u.getHTTPSendBytes)(),h.session.HTTPRecvBytesDelta=Object(u.getHTTPRecvBytes)()-h.session.HTTPRecvBytes,h.session.HTTPRecvBytes=Object(u.getHTTPRecvBytes)(),h.gatewayClient.socket&&h.gatewayClient.socket.state===h.gatewayClient.CONNECTED){var K=h.gatewayClient.socket;h.session.WSSendBytesDelta=K.getSendBytes()-h.session.WSSendBytes,h.session.WSSendBytes=K.getSendBytes(),h.session.WSRecvBytesDelta=K.getRecvBytes()-h.session.WSRecvBytes,h.session.WSRecvBytes=K.getRecvBytes()}},1e3),h.gatewayClient.on("join",function(){h.session={sendBytes:0,recvBytes:0,WSSendBytes:0,WSSendBytesDelta:0,WSRecvBytes:0,WSRecvBytesDelta:0,HTTPSendBytes:0,HTTPSendBytesDelta:0,HTTPRecvBytes:0,HTTPRecvBytesDelta:0}}),h),k.configDistributManager=function(ie){var h={};return h.client=ie,h.client.gatewayClient&&h.client.gatewayClient.on("config-distribute",function(Q){var ae=Q.joinInfo,fe=Q.config;if(fe){Object(L.isEmpty)(fe.uploadLog)||(Object(I.setParameter)("UPLOAD_LOG",fe.uploadLog),w.report.reportApiInvoke(ae.sid,{name:"_configDistribute",options:{feature:"uploadLog",value:fe.uploadLog}})()),Object(L.isEmpty)(fe.dualStream)||(ie.isDualStream=fe.dualStream,w.report.reportApiInvoke(ae.sid,{name:"_configDistribute",options:{feature:"dualStream",value:fe.dualStream}})()),Object(L.isEmpty)(fe.streamFallbackOption)||h.client.gatewayClient&&h.client.gatewayClient.on("stream-subscribed",function(me){var K=me.stream;K?(h.client.gatewayClient.setStreamFallbackOption(K,fe.streamFallbackOption),w.report.reportApiInvoke(ae.sid,{name:"_configDistribute",options:{feature:"streamFallbackOption",value:fe.streamFallbackOption,streamId:K.getId()}})()):w.report.reportApiInvoke(ae.sid,{name:"_configDistribute",options:{feature:"streamFallbackOption",value:fe.streamFallbackOption,streamId:K.getId(),err:"invalid stream"}})()});try{C.default.debug("[".concat(ie.clientId,"] setParameter in distribution: ").concat(JSON.stringify(fe))),Object.keys(fe).map(function(me){return Object(I.setParameter)(me,fe[me])})}catch(me){C.default.debug("[".concat(ie.clientId,"] setParameter in distribution failed: ").concat(JSON.stringify(fe)))}}}),h}(k),Object(Z.addLiveStreamingCapability)(k,le),le.areaCode){var Ge=le.areaCode,Ve=le.excludedArea,Fe=Object(V.getAreaCodeByConfig)({areaCode:Ge,excludedArea:Ve});Object(I.setParameter)("AREA_SETTING",Fe);var We=Object(V.getAreaDomainConfig)(Fe);Object.keys(We).map(function(ie){var h=We[ie];"LOG_UPLOAD_SERVER"==ie||"EVENT_REPORT_DOMAIN"==ie||"EVENT_REPORT_BACKUP_DOMAIN"==ie||"NGINX"==ie?Object(I.setParameter)(ie,h[0]):Object(I.setParameter)(ie,h)})}return Object(L.isEmpty)(le.turnServer)||k.setTurnServer(le.turnServer),Object(L.isEmpty)(le.proxyServer)||k.setProxyServer(le.proxyServer),"live"===k.mode&&(k.gatewayClient.role="audience"),"rtc"===k.mode&&(k.gatewayClient.role=oe),k.gatewayClient.on("onMultiIP",function(ie){k.gatewayClient.closeGateway(),k.gatewayClient.socket=void 0,k.gatewayClient.hasChangeBGPAddress=!0,k.joinInfo.multiIP=ie.option,k.gatewayClient.state=te.a.CONNECTING;var h=function(Q){C.default.info("[".concat(k.clientId,"] Joining channel: ").concat(k.channel)),k.joinInfo.cid=Q.cid,k.joinInfo.uid||(k.joinInfo.uid=Q.uid),k.joinInfo.uni_lbs_ip=Q.uni_lbs_ip,k.joinInfo.gatewayAddr=Q.gateway_addr,k.onSuccess?k.gatewayClient.join(k.joinInfo,k.key,function(ae){C.default.info("[".concat(k.clientId,"] Join channel ").concat(k.channel," success"));var fe=k.onSuccess;k.onSuccess=null,k.onFailure=null,fe(ae)},k.onFailure):(k.gatewayClient.joinInfo=J()({},k.joinInfo),k.gatewayClient.rejoin())};k.joinInfo.stringUid&&!k.joinInfo.uid?(k.userAccountReq&&!k.userAccountReq.isFinished()&&k.userAccountReq.cancel(),k.userAccountReq=Object(G.getUserAccount)(joinInfo,k.gatewayClient),k.userAccountReq.then(function(Q){C.default.error("getUserAccount Success ".concat(Q.url," ").concat(joinInfo.stringUid," => ").concat(Q.uid)),k.joinInfo.uid=Q.uid,Object(G.getGatewayList)(k.joinInfo,h,k.onFailure)}).catch(function(Q){C.default.error("getUserAccount rejected",Q),k.onFailure(Q)})):Object(G.getGatewayList)(k.joinInfo,h,k.onFailure)}),k.gatewayClient.on("rejoin-start",function(){k._renewSession(),w.report.sessionInit(le.sessionId,{lts:(new Date).getTime(),extend:{rejoin:!0},cname:k.channel,appid:le.appId,mode:le.mode,succ:!0})}),k.gatewayClient.on("recover",function(){k._renewSession(),console.log("recover",le.sessionId),w.report.sessionInit(le.sessionId,{lts:(new Date).getTime(),extend:{recover:!0},cname:k.channel,appid:le.appId,mode:le.mode,succ:!0})}),k.gatewayClient.on("rejoin",function(){var ie=k.highStreamState;if(C.default.debug("[".concat(k.clientId,"] Client local stream preState: ").concat(ie)),k.onSuccess){var h=k.onSuccess;k.onSuccess=null,k.onFailure=null,h(k.joinInfo.uid)}!k.highStream||0!==ie&&1!==ie||(C.default.info("[".concat(k.clientId,"] publish after rejoin")),k.highStreamState=2,k.lowStreamState=2,k.publish(k.highStream,function(Q){Q&&C.default.info("[".concat(k.clientId,"] "),Q)}))}),k.gatewayClient.on("streamPublished",function(ie){k.hasPublished||(k.hasPublished=!0,k.gatewayClient.dispatchEvent({type:"stream-published",stream:ie.stream,proxy:ie.proxy}))}),k.gatewayClient.on("pubP2PLost",function(ie){C.default.debug("[".concat(k.clientId,"] Start reconnect local peerConnection: ").concat(k.highStream.getId())),k.gatewayClient.dispatchEvent({type:"stream-reconnect-start",uid:k.highStream.getId()}),1===k.highStreamState&&(k.highStreamState=0,k.lowStreamState=0),k._unpublish(k.highStream,function(){k._publish(k.highStream,function(){C.default.debug("[".concat(k.clientId,"] Reconnect local peerConnection success: ").concat(k.highStream.getId())),k.gatewayClient.dispatchEvent({type:"stream-reconnect-end",uid:k.highStream.getId(),success:!0,reason:""})},function(h){C.default.debug("[".concat(k.clientId,"] Reconnect local peerConnection failed: ").concat(h)),k.gatewayClient.dispatchEvent({type:"stream-reconnect-end",uid:k.highStream.getId(),success:!1,reason:h})},!0)},function(h){C.default.debug("[".concat(k.clientId,"] Reconnect local peerConnection failed: ").concat(h)),k.gatewayClient.dispatchEvent({type:"stream-reconnect-end",uid:k.highStream.getId(),success:!1,reason:h})},!0)}),k.gatewayClient.on("subP2PLost",function(ie){C.default.debug("[".concat(k.clientId,"] Start reconnect remote peerConnection: ").concat(ie.stream.getId()," ").concat(ie.stream.subscribeOptions)),k.gatewayClient.dispatchEvent({type:"stream-reconnect-start",uid:ie.stream.getId()});var h=ie.stream.subscribeOptions;console.log("Re-subscribe stream",h,ie.stream),k.gatewayClient.unsubscribe(ie.stream,function(){ie.stream.subscribeOptions=h,k.gatewayClient.subscribe(ie.stream,function(){C.default.debug("[".concat(k.clientId,"] Reconnect remote peerConnection success: ").concat(ie.stream.getId())),k.gatewayClient.dispatchEvent({type:"stream-reconnect-end",uid:ie.stream.getId(),success:!0,reason:""})},function(Q){C.default.debug("[".concat(k.clientId,"] Reconnect remote peerConnection failed: "),Q),k.gatewayClient.dispatchEvent({type:"stream-reconnect-end",uid:ie.stream.getId(),success:!1,reason:Q})})},function(Q){C.default.debug("[".concat(k.clientId,"] Reconnect remote peerConnection failed: "),Q),k.gatewayClient.dispatchEvent({type:"stream-reconnect-end",uid:ie.stream.getId(),success:!1,reason:Q})})}),$.on("networkTypeChanged",function(ie){k.gatewayClient&&k.gatewayClient.dispatchEvent(ie);var h=J()({},ie,{type:"network-type-changed"});k.gatewayClient.dispatchEvent(h)}),g.a.on("recordingDeviceChanged",function(ie){k.gatewayClient&&k.gatewayClient.dispatchEvent(ie);var h=J()({},ie,{type:"recording-device-changed"});k.gatewayClient.dispatchEvent(h)}),g.a.on("playoutDeviceChanged",function(ie){k.gatewayClient&&k.gatewayClient.dispatchEvent(ie);var h=J()({},ie,{type:"playout-device-changed"});k.gatewayClient.dispatchEvent(h)}),g.a.on("cameraChanged",function(ie){k.gatewayClient&&k.gatewayClient.dispatchEvent(ie);var h=J()({},ie,{type:"camera-changed"});k.gatewayClient.dispatchEvent(h)}),k.gatewayClient.on("streamTypeChange",function(ie){var h=J()({},ie,{type:"stream-type-changed"});k.gatewayClient.dispatchEvent(h),w.report.reportApiInvoke(le.sessionId,{name:"streamTypeChange"})(null,JSON.stringify(ie))}),k},Te=function(le){return"h264_interop"===le?"h264":"vp8"},Re=function(le){return-1===A.indexOf(le.mode)?Y.default.INVALID_CLIENT_MODE:-1===E.indexOf(le.codec)?Y.default.INVALID_CLIENT_CODEC:"h264_interop"==le.mode&&"h264"!==le.codec&&Y.default.CLIENT_MODE_CODEC_MISMATCH},Ce=function(le){switch(le.mode){case"interop":case"h264_interop":le.mode="live";break;case"web-only":le.mode="rtc"}},Ee=g.a.getDevices,Le=y.a.getScreenSources,p=JSON.parse(JSON.stringify(I.SUPPORT_RESOLUTION_LIST));ee.default={TranscodingUser:{uid:0,x:0,y:0,width:0,height:0,zOrder:0,alpha:1},LiveTranscoding:{width:640,height:360,videoBitrate:400,videoFramerate:15,lowLatency:!1,audioSampleRate:48e3,audioBitrate:48,audioChannels:1,videoGop:30,videoCodecProfile:100,userCount:0,userConfigExtraInfo:{},backgroundColor:0,transcodingUsers:[]},createClient:function(le){var k=w.report.reportApiInvoke(null,{name:"createClient",options:arguments,tag:"tracer"});(le=J()({},le||{})).codec||(le.codec=Te(le.mode));var Ae=Re(le);if(Ae)throw C.default.error("Invalid parameter setting MODE: ".concat(le.mode," CODEC: ").concat(le.codec," ERROR ").concat(Ae)),k(Ae),new Error(Ae);return C.default.info("Creating client, MODE: ".concat(le.mode," CODEC: ").concat(le.codec)),Ce(le),k(null,le),de(le)},createStream:f.b,Logger:C.default,report:w.report,getDevices:Ee,getScreenSources:Le,getParameter:I.getParameter,setParameter:I.setParameter,checkSystemRequirements:function(){var le=w.report.reportApiInvoke(null,{name:"checkSystemRequirements",options:arguments,tag:"tracer"}),k=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,Ae=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.msGetUserMedia||navigator.mozGetUserMedia||navigator.mediaDevices&&navigator.mediaDevices.getUserMedia,Ge=window.WebSocket,Ve=!!k&&!!Ae&&!!Ge,Fe=!1;D.isChrome()&&D.getBrowserVersion()>=58&&"iOS"!==D.getBrowserOS()&&(Fe=!0),D.isFireFox()&&D.getBrowserVersion()>=56&&(Fe=!0),D.isOpera()&&D.getBrowserVersion()>=45&&(Fe=!0),D.isSafari()&&D.getBrowserVersion()>=11&&(Fe=!0),D.isEdge()&&(Fe=!0),(D.isWeChatBrowser()||D.isQQBrowser())&&"iOS"!==D.getBrowserOS()&&(Fe=!0),D.isSupportedPC()||D.isSupportedMobile()||(Fe=!1),C.default.debug(D.getBrowserInfo(),"isAPISupport: "+Ve+", isVendorAndVersionSupport: "+Fe);var We=Ve&&Fe;return le(null,We),We},getSupportedCodec:M.getSupportedCodec,ChannelMediaRelayConfiguration:j.ChannelMediaRelayConfiguration,VERSION:I.VERSION,BUILD:I.BUILD,PROFILE_TABLE:p,AUDIO_SAMPLE_RATE_32000:32e3,AUDIO_SAMPLE_RATE_44100:44100,AUDIO_SAMPLE_RATE_48000:48e3,VIDEO_CODEC_PROFILE_BASELINE:66,VIDEO_CODEC_PROFILE_MAIN:77,VIDEO_CODEC_PROFILE_HIGH:100,REMOTE_VIDEO_STREAM_HIGH:0,REMOTE_VIDEO_STREAM_LOW:1,REMOTE_VIDEO_STREAM_MEDIUM:2,AREAS:V.AREAS,AREA_VERSION:"global"}}]).default},module.exports=ee()}},se=>{se(se.s=558)}]);